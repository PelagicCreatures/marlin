{"mappings":"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","sources":["node_modules/orderedmap/index.es.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/index.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/common/utils.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/common/entities.js","node_modules/prosemirror-markdown/node_modules/entities/lib/maps/entities.json","node_modules/uc.micro/categories/P/regex.js","node_modules/mdurl/index.js","node_modules/mdurl/encode.js","node_modules/mdurl/decode.js","node_modules/mdurl/format.js","node_modules/mdurl/parse.js","node_modules/uc.micro/index.js","node_modules/uc.micro/properties/Any/regex.js","node_modules/uc.micro/categories/Cc/regex.js","node_modules/uc.micro/categories/Cf/regex.js","node_modules/uc.micro/categories/Z/regex.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/helpers/index.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/helpers/parse_link_label.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/helpers/parse_link_destination.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/helpers/parse_link_title.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/renderer.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/parser_core.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/ruler.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/normalize.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/block.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/inline.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/linkify.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/replacements.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/smartquotes.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_core/state_core.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/token.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/parser_block.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/table.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/code.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/fence.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/blockquote.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/hr.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/list.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/reference.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/html_block.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/common/html_blocks.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/common/html_re.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/heading.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/lheading.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/paragraph.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_block/state_block.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/parser_inline.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/text.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/newline.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/escape.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/backticks.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/strikethrough.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/emphasis.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/link.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/image.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/autolink.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/html_inline.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/entity.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/balance_pairs.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/text_collapse.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/rules_inline/state_inline.js","node_modules/prosemirror-markdown/node_modules/linkify-it/index.js","node_modules/prosemirror-markdown/node_modules/linkify-it/lib/re.js","node_modules/punycode/punycode.es6.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/presets/default.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/presets/zero.js","node_modules/prosemirror-markdown/node_modules/markdown-it/lib/presets/commonmark.js","node_modules/prosemirror-model/src/diff.js","node_modules/prosemirror-model/src/fragment.js","node_modules/prosemirror-model/src/comparedeep.js","node_modules/prosemirror-model/src/mark.js","node_modules/prosemirror-model/src/replace.js","node_modules/prosemirror-model/src/resolvedpos.js","node_modules/prosemirror-model/src/node.js","node_modules/prosemirror-model/src/content.js","node_modules/prosemirror-model/src/schema.js","node_modules/prosemirror-model/src/from_dom.js","node_modules/prosemirror-model/src/to_dom.js","node_modules/prosemirror-transform/src/map.js","node_modules/prosemirror-transform/src/transform.js","node_modules/prosemirror-transform/src/step.js","node_modules/prosemirror-transform/src/replace_step.js","node_modules/prosemirror-transform/src/structure.js","node_modules/prosemirror-transform/src/mark_step.js","node_modules/prosemirror-transform/src/replace.js","node_modules/prosemirror-transform/src/mark.js","node_modules/prosemirror-state/src/selection.js","node_modules/prosemirror-state/src/transaction.js","node_modules/prosemirror-state/src/state.js","node_modules/prosemirror-state/src/plugin.js","node_modules/prosemirror-view/src/browser.js","node_modules/prosemirror-view/src/dom.js","node_modules/prosemirror-view/src/domcoords.js","node_modules/prosemirror-view/src/viewdesc.js","node_modules/prosemirror-view/src/selection.js","node_modules/prosemirror-view/src/capturekeys.js","node_modules/prosemirror-view/src/domchange.js","node_modules/prosemirror-view/src/clipboard.js","node_modules/prosemirror-view/src/domobserver.js","node_modules/prosemirror-view/src/input.js","node_modules/prosemirror-view/src/decoration.js","node_modules/prosemirror-view/src/index.js","node_modules/prosemirror-markdown/node_modules/markdown-it/index.js","node_modules/prosemirror-markdown/src/schema.js","node_modules/prosemirror-markdown/src/from_markdown.js","node_modules/prosemirror-markdown/src/to_markdown.js","node_modules/w3c-keyname/index.es.js","node_modules/prosemirror-keymap/src/keymap.js","node_modules/rope-sequence/dist/index.es.js","node_modules/prosemirror-history/src/history.js","node_modules/prosemirror-commands/src/commands.js","node_modules/prosemirror-dropcursor/src/dropcursor.js","node_modules/prosemirror-gapcursor/src/gapcursor.js","node_modules/prosemirror-gapcursor/src/index.js","node_modules/crelt/index.es.js","node_modules/prosemirror-menu/src/icons.js","node_modules/prosemirror-menu/src/menu.js","node_modules/prosemirror-menu/src/menubar.js","node_modules/prosemirror-schema-list/src/schema-list.js","node_modules/prosemirror-inputrules/src/inputrules.js","node_modules/prosemirror-inputrules/src/rules.js","node_modules/prosemirror-inputrules/src/rulebuilders.js","node_modules/prosemirror-example-setup/src/prompt.js","node_modules/prosemirror-example-setup/src/menu.js","node_modules/prosemirror-example-setup/src/keymap.js","node_modules/prosemirror-example-setup/src/inputrules.js","node_modules/prosemirror-example-setup/src/index.js","assets/modules/prose-mirror.mjs","assets/modules/markdown-editor.mjs"],"sourcesContent":["// ::- Persistent data structure representing an ordered mapping from\n// strings to values, with some convenient update methods.\nfunction OrderedMap(content) {\n  this.content = content;\n}\n\nOrderedMap.prototype = {\n  constructor: OrderedMap,\n\n  find: function(key) {\n    for (var i = 0; i < this.content.length; i += 2)\n      if (this.content[i] === key) return i\n    return -1\n  },\n\n  // :: (string) → ?any\n  // Retrieve the value stored under `key`, or return undefined when\n  // no such key exists.\n  get: function(key) {\n    var found = this.find(key);\n    return found == -1 ? undefined : this.content[found + 1]\n  },\n\n  // :: (string, any, ?string) → OrderedMap\n  // Create a new map by replacing the value of `key` with a new\n  // value, or adding a binding to the end of the map. If `newKey` is\n  // given, the key of the binding will be replaced with that key.\n  update: function(key, value, newKey) {\n    var self = newKey && newKey != key ? this.remove(newKey) : this;\n    var found = self.find(key), content = self.content.slice();\n    if (found == -1) {\n      content.push(newKey || key, value);\n    } else {\n      content[found + 1] = value;\n      if (newKey) content[found] = newKey;\n    }\n    return new OrderedMap(content)\n  },\n\n  // :: (string) → OrderedMap\n  // Return a map with the given key removed, if it existed.\n  remove: function(key) {\n    var found = this.find(key);\n    if (found == -1) return this\n    var content = this.content.slice();\n    content.splice(found, 2);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, any) → OrderedMap\n  // Add a new key to the start of the map.\n  addToStart: function(key, value) {\n    return new OrderedMap([key, value].concat(this.remove(key).content))\n  },\n\n  // :: (string, any) → OrderedMap\n  // Add a new key to the end of the map.\n  addToEnd: function(key, value) {\n    var content = this.remove(key).content.slice();\n    content.push(key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: (string, string, any) → OrderedMap\n  // Add a key after the given key. If `place` is not found, the new\n  // key is added to the end.\n  addBefore: function(place, key, value) {\n    var without = this.remove(key), content = without.content.slice();\n    var found = without.find(place);\n    content.splice(found == -1 ? content.length : found, 0, key, value);\n    return new OrderedMap(content)\n  },\n\n  // :: ((key: string, value: any))\n  // Call the given function for each key/value pair in the map, in\n  // order.\n  forEach: function(f) {\n    for (var i = 0; i < this.content.length; i += 2)\n      f(this.content[i], this.content[i + 1]);\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a new map by prepending the keys in this map that don't\n  // appear in `map` before the keys in `map`.\n  prepend: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(map.content.concat(this.subtract(map).content))\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a new map by appending the keys in this map that don't\n  // appear in `map` after the keys in `map`.\n  append: function(map) {\n    map = OrderedMap.from(map);\n    if (!map.size) return this\n    return new OrderedMap(this.subtract(map).content.concat(map.content))\n  },\n\n  // :: (union<Object, OrderedMap>) → OrderedMap\n  // Create a map containing all the keys in this map that don't\n  // appear in `map`.\n  subtract: function(map) {\n    var result = this;\n    map = OrderedMap.from(map);\n    for (var i = 0; i < map.content.length; i += 2)\n      result = result.remove(map.content[i]);\n    return result\n  },\n\n  // :: number\n  // The amount of keys in this map.\n  get size() {\n    return this.content.length >> 1\n  }\n};\n\n// :: (?union<Object, OrderedMap>) → OrderedMap\n// Return a map with the given content. If null, create an empty\n// map. If given an ordered map, return that map itself. If given an\n// object, create a map from the object's properties.\nOrderedMap.from = function(value) {\n  if (value instanceof OrderedMap) return value\n  var content = [];\n  if (value) for (var prop in value) content.push(prop, value[prop]);\n  return new OrderedMap(content)\n};\n\nvar orderedmap = OrderedMap;\n\nexport default orderedmap;\n","// Main parser class\n\n'use strict';\n\n\nvar utils        = require('./common/utils');\nvar helpers      = require('./helpers');\nvar Renderer     = require('./renderer');\nvar ParserCore   = require('./parser_core');\nvar ParserBlock  = require('./parser_block');\nvar ParserInline = require('./parser_inline');\nvar LinkifyIt    = require('linkify-it');\nvar mdurl        = require('mdurl');\nvar punycode     = require('punycode');\n\n\nvar config = {\n  default: require('./presets/default'),\n  zero: require('./presets/zero'),\n  commonmark: require('./presets/commonmark')\n};\n\n////////////////////////////////////////////////////////////////////////////////\n//\n// This validator can prohibit more than really needed to prevent XSS. It's a\n// tradeoff to keep code simple and to be secure by default.\n//\n// If you need different setup - override validator method as you wish. Or\n// replace it with dummy function and use external sanitizer.\n//\n\nvar BAD_PROTO_RE = /^(vbscript|javascript|file|data):/;\nvar GOOD_DATA_RE = /^data:image\\/(gif|png|jpeg|webp);/;\n\nfunction validateLink(url) {\n  // url should be normalized at this point, and existing entities are decoded\n  var str = url.trim().toLowerCase();\n\n  return BAD_PROTO_RE.test(str) ? (GOOD_DATA_RE.test(str) ? true : false) : true;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n\nvar RECODE_HOSTNAME_FOR = [ 'http:', 'https:', 'mailto:' ];\n\nfunction normalizeLink(url) {\n  var parsed = mdurl.parse(url, true);\n\n  if (parsed.hostname) {\n    // Encode hostnames in urls like:\n    // `http://host/`, `https://host/`, `mailto:user@host`, `//host/`\n    //\n    // We don't encode unknown schemas, because it's likely that we encode\n    // something we shouldn't (e.g. `skype:name` treated as `skype:host`)\n    //\n    if (!parsed.protocol || RECODE_HOSTNAME_FOR.indexOf(parsed.protocol) >= 0) {\n      try {\n        parsed.hostname = punycode.toASCII(parsed.hostname);\n      } catch (er) { /**/ }\n    }\n  }\n\n  return mdurl.encode(mdurl.format(parsed));\n}\n\nfunction normalizeLinkText(url) {\n  var parsed = mdurl.parse(url, true);\n\n  if (parsed.hostname) {\n    // Encode hostnames in urls like:\n    // `http://host/`, `https://host/`, `mailto:user@host`, `//host/`\n    //\n    // We don't encode unknown schemas, because it's likely that we encode\n    // something we shouldn't (e.g. `skype:name` treated as `skype:host`)\n    //\n    if (!parsed.protocol || RECODE_HOSTNAME_FOR.indexOf(parsed.protocol) >= 0) {\n      try {\n        parsed.hostname = punycode.toUnicode(parsed.hostname);\n      } catch (er) { /**/ }\n    }\n  }\n\n  // add '%' to exclude list because of https://github.com/markdown-it/markdown-it/issues/720\n  return mdurl.decode(mdurl.format(parsed), mdurl.decode.defaultChars + '%');\n}\n\n\n/**\n * class MarkdownIt\n *\n * Main parser/renderer class.\n *\n * ##### Usage\n *\n * ```javascript\n * // node.js, \"classic\" way:\n * var MarkdownIt = require('markdown-it'),\n *     md = new MarkdownIt();\n * var result = md.render('# markdown-it rulezz!');\n *\n * // node.js, the same, but with sugar:\n * var md = require('markdown-it')();\n * var result = md.render('# markdown-it rulezz!');\n *\n * // browser without AMD, added to \"window\" on script load\n * // Note, there are no dash.\n * var md = window.markdownit();\n * var result = md.render('# markdown-it rulezz!');\n * ```\n *\n * Single line rendering, without paragraph wrap:\n *\n * ```javascript\n * var md = require('markdown-it')();\n * var result = md.renderInline('__markdown-it__ rulezz!');\n * ```\n **/\n\n/**\n * new MarkdownIt([presetName, options])\n * - presetName (String): optional, `commonmark` / `zero`\n * - options (Object)\n *\n * Creates parser instanse with given config. Can be called without `new`.\n *\n * ##### presetName\n *\n * MarkdownIt provides named presets as a convenience to quickly\n * enable/disable active syntax rules and options for common use cases.\n *\n * - [\"commonmark\"](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/commonmark.js) -\n *   configures parser to strict [CommonMark](http://commonmark.org/) mode.\n * - [default](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/default.js) -\n *   similar to GFM, used when no preset name given. Enables all available rules,\n *   but still without html, typographer & autolinker.\n * - [\"zero\"](https://github.com/markdown-it/markdown-it/blob/master/lib/presets/zero.js) -\n *   all rules disabled. Useful to quickly setup your config via `.enable()`.\n *   For example, when you need only `bold` and `italic` markup and nothing else.\n *\n * ##### options:\n *\n * - __html__ - `false`. Set `true` to enable HTML tags in source. Be careful!\n *   That's not safe! You may need external sanitizer to protect output from XSS.\n *   It's better to extend features via plugins, instead of enabling HTML.\n * - __xhtmlOut__ - `false`. Set `true` to add '/' when closing single tags\n *   (`<br />`). This is needed only for full CommonMark compatibility. In real\n *   world you will need HTML output.\n * - __breaks__ - `false`. Set `true` to convert `\\n` in paragraphs into `<br>`.\n * - __langPrefix__ - `language-`. CSS language class prefix for fenced blocks.\n *   Can be useful for external highlighters.\n * - __linkify__ - `false`. Set `true` to autoconvert URL-like text to links.\n * - __typographer__  - `false`. Set `true` to enable [some language-neutral\n *   replacement](https://github.com/markdown-it/markdown-it/blob/master/lib/rules_core/replacements.js) +\n *   quotes beautification (smartquotes).\n * - __quotes__ - `“”‘’`, String or Array. Double + single quotes replacement\n *   pairs, when typographer enabled and smartquotes on. For example, you can\n *   use `'«»„“'` for Russian, `'„“‚‘'` for German, and\n *   `['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›']` for French (including nbsp).\n * - __highlight__ - `null`. Highlighter function for fenced code blocks.\n *   Highlighter `function (str, lang)` should return escaped HTML. It can also\n *   return empty string if the source was not changed and should be escaped\n *   externaly. If result starts with <pre... internal wrapper is skipped.\n *\n * ##### Example\n *\n * ```javascript\n * // commonmark mode\n * var md = require('markdown-it')('commonmark');\n *\n * // default mode\n * var md = require('markdown-it')();\n *\n * // enable everything\n * var md = require('markdown-it')({\n *   html: true,\n *   linkify: true,\n *   typographer: true\n * });\n * ```\n *\n * ##### Syntax highlighting\n *\n * ```js\n * var hljs = require('highlight.js') // https://highlightjs.org/\n *\n * var md = require('markdown-it')({\n *   highlight: function (str, lang) {\n *     if (lang && hljs.getLanguage(lang)) {\n *       try {\n *         return hljs.highlight(str, { language: lang, ignoreIllegals: true }).value;\n *       } catch (__) {}\n *     }\n *\n *     return ''; // use external default escaping\n *   }\n * });\n * ```\n *\n * Or with full wrapper override (if you need assign class to `<pre>`):\n *\n * ```javascript\n * var hljs = require('highlight.js') // https://highlightjs.org/\n *\n * // Actual default values\n * var md = require('markdown-it')({\n *   highlight: function (str, lang) {\n *     if (lang && hljs.getLanguage(lang)) {\n *       try {\n *         return '<pre class=\"hljs\"><code>' +\n *                hljs.highlight(str, { language: lang, ignoreIllegals: true }).value +\n *                '</code></pre>';\n *       } catch (__) {}\n *     }\n *\n *     return '<pre class=\"hljs\"><code>' + md.utils.escapeHtml(str) + '</code></pre>';\n *   }\n * });\n * ```\n *\n **/\nfunction MarkdownIt(presetName, options) {\n  if (!(this instanceof MarkdownIt)) {\n    return new MarkdownIt(presetName, options);\n  }\n\n  if (!options) {\n    if (!utils.isString(presetName)) {\n      options = presetName || {};\n      presetName = 'default';\n    }\n  }\n\n  /**\n   * MarkdownIt#inline -> ParserInline\n   *\n   * Instance of [[ParserInline]]. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.inline = new ParserInline();\n\n  /**\n   * MarkdownIt#block -> ParserBlock\n   *\n   * Instance of [[ParserBlock]]. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.block = new ParserBlock();\n\n  /**\n   * MarkdownIt#core -> Core\n   *\n   * Instance of [[Core]] chain executor. You may need it to add new rules when\n   * writing plugins. For simple rules control use [[MarkdownIt.disable]] and\n   * [[MarkdownIt.enable]].\n   **/\n  this.core = new ParserCore();\n\n  /**\n   * MarkdownIt#renderer -> Renderer\n   *\n   * Instance of [[Renderer]]. Use it to modify output look. Or to add rendering\n   * rules for new token types, generated by plugins.\n   *\n   * ##### Example\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   *\n   * function myToken(tokens, idx, options, env, self) {\n   *   //...\n   *   return result;\n   * };\n   *\n   * md.renderer.rules['my_token'] = myToken\n   * ```\n   *\n   * See [[Renderer]] docs and [source code](https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js).\n   **/\n  this.renderer = new Renderer();\n\n  /**\n   * MarkdownIt#linkify -> LinkifyIt\n   *\n   * [linkify-it](https://github.com/markdown-it/linkify-it) instance.\n   * Used by [linkify](https://github.com/markdown-it/markdown-it/blob/master/lib/rules_core/linkify.js)\n   * rule.\n   **/\n  this.linkify = new LinkifyIt();\n\n  /**\n   * MarkdownIt#validateLink(url) -> Boolean\n   *\n   * Link validation function. CommonMark allows too much in links. By default\n   * we disable `javascript:`, `vbscript:`, `file:` schemas, and almost all `data:...` schemas\n   * except some embedded image types.\n   *\n   * You can change this behaviour:\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   * // enable everything\n   * md.validateLink = function () { return true; }\n   * ```\n   **/\n  this.validateLink = validateLink;\n\n  /**\n   * MarkdownIt#normalizeLink(url) -> String\n   *\n   * Function used to encode link url to a machine-readable format,\n   * which includes url-encoding, punycode, etc.\n   **/\n  this.normalizeLink = normalizeLink;\n\n  /**\n   * MarkdownIt#normalizeLinkText(url) -> String\n   *\n   * Function used to decode link url to a human-readable format`\n   **/\n  this.normalizeLinkText = normalizeLinkText;\n\n\n  // Expose utils & helpers for easy acces from plugins\n\n  /**\n   * MarkdownIt#utils -> utils\n   *\n   * Assorted utility functions, useful to write plugins. See details\n   * [here](https://github.com/markdown-it/markdown-it/blob/master/lib/common/utils.js).\n   **/\n  this.utils = utils;\n\n  /**\n   * MarkdownIt#helpers -> helpers\n   *\n   * Link components parser functions, useful to write plugins. See details\n   * [here](https://github.com/markdown-it/markdown-it/blob/master/lib/helpers).\n   **/\n  this.helpers = utils.assign({}, helpers);\n\n\n  this.options = {};\n  this.configure(presetName);\n\n  if (options) { this.set(options); }\n}\n\n\n/** chainable\n * MarkdownIt.set(options)\n *\n * Set parser options (in the same format as in constructor). Probably, you\n * will never need it, but you can change options after constructor call.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')()\n *             .set({ html: true, breaks: true })\n *             .set({ typographer, true });\n * ```\n *\n * __Note:__ To achieve the best possible performance, don't modify a\n * `markdown-it` instance options on the fly. If you need multiple configurations\n * it's best to create multiple instances and initialize each with separate\n * config.\n **/\nMarkdownIt.prototype.set = function (options) {\n  utils.assign(this.options, options);\n  return this;\n};\n\n\n/** chainable, internal\n * MarkdownIt.configure(presets)\n *\n * Batch load of all options and compenent settings. This is internal method,\n * and you probably will not need it. But if you will - see available presets\n * and data structure [here](https://github.com/markdown-it/markdown-it/tree/master/lib/presets)\n *\n * We strongly recommend to use presets instead of direct config loads. That\n * will give better compatibility with next versions.\n **/\nMarkdownIt.prototype.configure = function (presets) {\n  var self = this, presetName;\n\n  if (utils.isString(presets)) {\n    presetName = presets;\n    presets = config[presetName];\n    if (!presets) { throw new Error('Wrong `markdown-it` preset \"' + presetName + '\", check name'); }\n  }\n\n  if (!presets) { throw new Error('Wrong `markdown-it` preset, can\\'t be empty'); }\n\n  if (presets.options) { self.set(presets.options); }\n\n  if (presets.components) {\n    Object.keys(presets.components).forEach(function (name) {\n      if (presets.components[name].rules) {\n        self[name].ruler.enableOnly(presets.components[name].rules);\n      }\n      if (presets.components[name].rules2) {\n        self[name].ruler2.enableOnly(presets.components[name].rules2);\n      }\n    });\n  }\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.enable(list, ignoreInvalid)\n * - list (String|Array): rule name or list of rule names to enable\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable list or rules. It will automatically find appropriate components,\n * containing rules with given names. If rule not found, and `ignoreInvalid`\n * not set - throws exception.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')()\n *             .enable(['sub', 'sup'])\n *             .disable('smartquotes');\n * ```\n **/\nMarkdownIt.prototype.enable = function (list, ignoreInvalid) {\n  var result = [];\n\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  [ 'core', 'block', 'inline' ].forEach(function (chain) {\n    result = result.concat(this[chain].ruler.enable(list, true));\n  }, this);\n\n  result = result.concat(this.inline.ruler2.enable(list, true));\n\n  var missed = list.filter(function (name) { return result.indexOf(name) < 0; });\n\n  if (missed.length && !ignoreInvalid) {\n    throw new Error('MarkdownIt. Failed to enable unknown rule(s): ' + missed);\n  }\n\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.disable(list, ignoreInvalid)\n * - list (String|Array): rule name or list of rule names to disable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * The same as [[MarkdownIt.enable]], but turn specified rules off.\n **/\nMarkdownIt.prototype.disable = function (list, ignoreInvalid) {\n  var result = [];\n\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  [ 'core', 'block', 'inline' ].forEach(function (chain) {\n    result = result.concat(this[chain].ruler.disable(list, true));\n  }, this);\n\n  result = result.concat(this.inline.ruler2.disable(list, true));\n\n  var missed = list.filter(function (name) { return result.indexOf(name) < 0; });\n\n  if (missed.length && !ignoreInvalid) {\n    throw new Error('MarkdownIt. Failed to disable unknown rule(s): ' + missed);\n  }\n  return this;\n};\n\n\n/** chainable\n * MarkdownIt.use(plugin, params)\n *\n * Load specified plugin with given params into current parser instance.\n * It's just a sugar to call `plugin(md, params)` with curring.\n *\n * ##### Example\n *\n * ```javascript\n * var iterator = require('markdown-it-for-inline');\n * var md = require('markdown-it')()\n *             .use(iterator, 'foo_replace', 'text', function (tokens, idx) {\n *               tokens[idx].content = tokens[idx].content.replace(/foo/g, 'bar');\n *             });\n * ```\n **/\nMarkdownIt.prototype.use = function (plugin /*, params, ... */) {\n  var args = [ this ].concat(Array.prototype.slice.call(arguments, 1));\n  plugin.apply(plugin, args);\n  return this;\n};\n\n\n/** internal\n * MarkdownIt.parse(src, env) -> Array\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Parse input string and return list of block tokens (special token type\n * \"inline\" will contain list of inline tokens). You should not call this\n * method directly, until you write custom renderer (for example, to produce\n * AST).\n *\n * `env` is used to pass data between \"distributed\" rules and return additional\n * metadata like reference info, needed for the renderer. It also can be used to\n * inject data in specific cases. Usually, you will be ok to pass `{}`,\n * and then pass updated object to renderer.\n **/\nMarkdownIt.prototype.parse = function (src, env) {\n  if (typeof src !== 'string') {\n    throw new Error('Input data should be a String');\n  }\n\n  var state = new this.core.State(src, this, env);\n\n  this.core.process(state);\n\n  return state.tokens;\n};\n\n\n/**\n * MarkdownIt.render(src [, env]) -> String\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Render markdown string into html. It does all magic for you :).\n *\n * `env` can be used to inject additional metadata (`{}` by default).\n * But you will not need it with high probability. See also comment\n * in [[MarkdownIt.parse]].\n **/\nMarkdownIt.prototype.render = function (src, env) {\n  env = env || {};\n\n  return this.renderer.render(this.parse(src, env), this.options, env);\n};\n\n\n/** internal\n * MarkdownIt.parseInline(src, env) -> Array\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * The same as [[MarkdownIt.parse]] but skip all block rules. It returns the\n * block tokens list with the single `inline` element, containing parsed inline\n * tokens in `children` property. Also updates `env` object.\n **/\nMarkdownIt.prototype.parseInline = function (src, env) {\n  var state = new this.core.State(src, this, env);\n\n  state.inlineMode = true;\n  this.core.process(state);\n\n  return state.tokens;\n};\n\n\n/**\n * MarkdownIt.renderInline(src [, env]) -> String\n * - src (String): source string\n * - env (Object): environment sandbox\n *\n * Similar to [[MarkdownIt.render]] but for single paragraph content. Result\n * will NOT be wrapped into `<p>` tags.\n **/\nMarkdownIt.prototype.renderInline = function (src, env) {\n  env = env || {};\n\n  return this.renderer.render(this.parseInline(src, env), this.options, env);\n};\n\n\nmodule.exports = MarkdownIt;\n","// Utilities\n//\n'use strict';\n\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\n\nfunction isString(obj) { return _class(obj) === '[object String]'; }\n\nvar _hasOwnProperty = Object.prototype.hasOwnProperty;\n\nfunction has(object, key) {\n  return _hasOwnProperty.call(object, key);\n}\n\n// Merge objects\n//\nfunction assign(obj /*from1, from2, from3, ...*/) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  sources.forEach(function (source) {\n    if (!source) { return; }\n\n    if (typeof source !== 'object') {\n      throw new TypeError(source + 'must be object');\n    }\n\n    Object.keys(source).forEach(function (key) {\n      obj[key] = source[key];\n    });\n  });\n\n  return obj;\n}\n\n// Remove element from array and put another array at those position.\n// Useful for some operations with tokens\nfunction arrayReplaceAt(src, pos, newElements) {\n  return [].concat(src.slice(0, pos), newElements, src.slice(pos + 1));\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction isValidEntityCode(c) {\n  /*eslint no-bitwise:0*/\n  // broken sequence\n  if (c >= 0xD800 && c <= 0xDFFF) { return false; }\n  // never used\n  if (c >= 0xFDD0 && c <= 0xFDEF) { return false; }\n  if ((c & 0xFFFF) === 0xFFFF || (c & 0xFFFF) === 0xFFFE) { return false; }\n  // control codes\n  if (c >= 0x00 && c <= 0x08) { return false; }\n  if (c === 0x0B) { return false; }\n  if (c >= 0x0E && c <= 0x1F) { return false; }\n  if (c >= 0x7F && c <= 0x9F) { return false; }\n  // out of range\n  if (c > 0x10FFFF) { return false; }\n  return true;\n}\n\nfunction fromCodePoint(c) {\n  /*eslint no-bitwise:0*/\n  if (c > 0xffff) {\n    c -= 0x10000;\n    var surrogate1 = 0xd800 + (c >> 10),\n        surrogate2 = 0xdc00 + (c & 0x3ff);\n\n    return String.fromCharCode(surrogate1, surrogate2);\n  }\n  return String.fromCharCode(c);\n}\n\n\nvar UNESCAPE_MD_RE  = /\\\\([!\"#$%&'()*+,\\-.\\/:;<=>?@[\\\\\\]^_`{|}~])/g;\nvar ENTITY_RE       = /&([a-z#][a-z0-9]{1,31});/gi;\nvar UNESCAPE_ALL_RE = new RegExp(UNESCAPE_MD_RE.source + '|' + ENTITY_RE.source, 'gi');\n\nvar DIGITAL_ENTITY_TEST_RE = /^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))/i;\n\nvar entities = require('./entities');\n\nfunction replaceEntityPattern(match, name) {\n  var code = 0;\n\n  if (has(entities, name)) {\n    return entities[name];\n  }\n\n  if (name.charCodeAt(0) === 0x23/* # */ && DIGITAL_ENTITY_TEST_RE.test(name)) {\n    code = name[1].toLowerCase() === 'x' ?\n      parseInt(name.slice(2), 16) : parseInt(name.slice(1), 10);\n\n    if (isValidEntityCode(code)) {\n      return fromCodePoint(code);\n    }\n  }\n\n  return match;\n}\n\n/*function replaceEntities(str) {\n  if (str.indexOf('&') < 0) { return str; }\n\n  return str.replace(ENTITY_RE, replaceEntityPattern);\n}*/\n\nfunction unescapeMd(str) {\n  if (str.indexOf('\\\\') < 0) { return str; }\n  return str.replace(UNESCAPE_MD_RE, '$1');\n}\n\nfunction unescapeAll(str) {\n  if (str.indexOf('\\\\') < 0 && str.indexOf('&') < 0) { return str; }\n\n  return str.replace(UNESCAPE_ALL_RE, function (match, escaped, entity) {\n    if (escaped) { return escaped; }\n    return replaceEntityPattern(match, entity);\n  });\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar HTML_ESCAPE_TEST_RE = /[&<>\"]/;\nvar HTML_ESCAPE_REPLACE_RE = /[&<>\"]/g;\nvar HTML_REPLACEMENTS = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;'\n};\n\nfunction replaceUnsafeChar(ch) {\n  return HTML_REPLACEMENTS[ch];\n}\n\nfunction escapeHtml(str) {\n  if (HTML_ESCAPE_TEST_RE.test(str)) {\n    return str.replace(HTML_ESCAPE_REPLACE_RE, replaceUnsafeChar);\n  }\n  return str;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar REGEXP_ESCAPE_RE = /[.?*+^$[\\]\\\\(){}|-]/g;\n\nfunction escapeRE(str) {\n  return str.replace(REGEXP_ESCAPE_RE, '\\\\$&');\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction isSpace(code) {\n  switch (code) {\n    case 0x09:\n    case 0x20:\n      return true;\n  }\n  return false;\n}\n\n// Zs (unicode class) || [\\t\\f\\v\\r\\n]\nfunction isWhiteSpace(code) {\n  if (code >= 0x2000 && code <= 0x200A) { return true; }\n  switch (code) {\n    case 0x09: // \\t\n    case 0x0A: // \\n\n    case 0x0B: // \\v\n    case 0x0C: // \\f\n    case 0x0D: // \\r\n    case 0x20:\n    case 0xA0:\n    case 0x1680:\n    case 0x202F:\n    case 0x205F:\n    case 0x3000:\n      return true;\n  }\n  return false;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n/*eslint-disable max-len*/\nvar UNICODE_PUNCT_RE = require('uc.micro/categories/P/regex');\n\n// Currently without astral characters support.\nfunction isPunctChar(ch) {\n  return UNICODE_PUNCT_RE.test(ch);\n}\n\n\n// Markdown ASCII punctuation characters.\n//\n// !, \", #, $, %, &, ', (, ), *, +, ,, -, ., /, :, ;, <, =, >, ?, @, [, \\, ], ^, _, `, {, |, }, or ~\n// http://spec.commonmark.org/0.15/#ascii-punctuation-character\n//\n// Don't confuse with unicode punctuation !!! It lacks some chars in ascii range.\n//\nfunction isMdAsciiPunct(ch) {\n  switch (ch) {\n    case 0x21/* ! */:\n    case 0x22/* \" */:\n    case 0x23/* # */:\n    case 0x24/* $ */:\n    case 0x25/* % */:\n    case 0x26/* & */:\n    case 0x27/* ' */:\n    case 0x28/* ( */:\n    case 0x29/* ) */:\n    case 0x2A/* * */:\n    case 0x2B/* + */:\n    case 0x2C/* , */:\n    case 0x2D/* - */:\n    case 0x2E/* . */:\n    case 0x2F/* / */:\n    case 0x3A/* : */:\n    case 0x3B/* ; */:\n    case 0x3C/* < */:\n    case 0x3D/* = */:\n    case 0x3E/* > */:\n    case 0x3F/* ? */:\n    case 0x40/* @ */:\n    case 0x5B/* [ */:\n    case 0x5C/* \\ */:\n    case 0x5D/* ] */:\n    case 0x5E/* ^ */:\n    case 0x5F/* _ */:\n    case 0x60/* ` */:\n    case 0x7B/* { */:\n    case 0x7C/* | */:\n    case 0x7D/* } */:\n    case 0x7E/* ~ */:\n      return true;\n    default:\n      return false;\n  }\n}\n\n// Hepler to unify [reference labels].\n//\nfunction normalizeReference(str) {\n  // Trim and collapse whitespace\n  //\n  str = str.trim().replace(/\\s+/g, ' ');\n\n  // In node v10 'ẞ'.toLowerCase() === 'Ṿ', which is presumed to be a bug\n  // fixed in v12 (couldn't find any details).\n  //\n  // So treat this one as a special case\n  // (remove this when node v10 is no longer supported).\n  //\n  if ('ẞ'.toLowerCase() === 'Ṿ') {\n    str = str.replace(/ẞ/g, 'ß');\n  }\n\n  // .toLowerCase().toUpperCase() should get rid of all differences\n  // between letter variants.\n  //\n  // Simple .toLowerCase() doesn't normalize 125 code points correctly,\n  // and .toUpperCase doesn't normalize 6 of them (list of exceptions:\n  // İ, ϴ, ẞ, Ω, K, Å - those are already uppercased, but have differently\n  // uppercased versions).\n  //\n  // Here's an example showing how it happens. Lets take greek letter omega:\n  // uppercase U+0398 (Θ), U+03f4 (ϴ) and lowercase U+03b8 (θ), U+03d1 (ϑ)\n  //\n  // Unicode entries:\n  // 0398;GREEK CAPITAL LETTER THETA;Lu;0;L;;;;;N;;;;03B8;\n  // 03B8;GREEK SMALL LETTER THETA;Ll;0;L;;;;;N;;;0398;;0398\n  // 03D1;GREEK THETA SYMBOL;Ll;0;L;<compat> 03B8;;;;N;GREEK SMALL LETTER SCRIPT THETA;;0398;;0398\n  // 03F4;GREEK CAPITAL THETA SYMBOL;Lu;0;L;<compat> 0398;;;;N;;;;03B8;\n  //\n  // Case-insensitive comparison should treat all of them as equivalent.\n  //\n  // But .toLowerCase() doesn't change ϑ (it's already lowercase),\n  // and .toUpperCase() doesn't change ϴ (already uppercase).\n  //\n  // Applying first lower then upper case normalizes any character:\n  // '\\u0398\\u03f4\\u03b8\\u03d1'.toLowerCase().toUpperCase() === '\\u0398\\u0398\\u0398\\u0398'\n  //\n  // Note: this is equivalent to unicode case folding; unicode normalization\n  // is a different step that is not required here.\n  //\n  // Final result should be uppercased, because it's later stored in an object\n  // (this avoid a conflict with Object.prototype members,\n  // most notably, `__proto__`)\n  //\n  return str.toLowerCase().toUpperCase();\n}\n\n////////////////////////////////////////////////////////////////////////////////\n\n// Re-export libraries commonly used in both markdown-it and its plugins,\n// so plugins won't have to depend on them explicitly, which reduces their\n// bundled size (e.g. a browser build).\n//\nexports.lib                 = {};\nexports.lib.mdurl           = require('mdurl');\nexports.lib.ucmicro         = require('uc.micro');\n\nexports.assign              = assign;\nexports.isString            = isString;\nexports.has                 = has;\nexports.unescapeMd          = unescapeMd;\nexports.unescapeAll         = unescapeAll;\nexports.isValidEntityCode   = isValidEntityCode;\nexports.fromCodePoint       = fromCodePoint;\n// exports.replaceEntities     = replaceEntities;\nexports.escapeHtml          = escapeHtml;\nexports.arrayReplaceAt      = arrayReplaceAt;\nexports.isSpace             = isSpace;\nexports.isWhiteSpace        = isWhiteSpace;\nexports.isMdAsciiPunct      = isMdAsciiPunct;\nexports.isPunctChar         = isPunctChar;\nexports.escapeRE            = escapeRE;\nexports.normalizeReference  = normalizeReference;\n","// HTML5 entities map: { name -> utf16string }\n//\n'use strict';\n\n/*eslint quotes:0*/\nmodule.exports = require('entities/lib/maps/entities.json');\n","{\"Aacute\":\"Á\",\"aacute\":\"á\",\"Abreve\":\"Ă\",\"abreve\":\"ă\",\"ac\":\"∾\",\"acd\":\"∿\",\"acE\":\"∾̳\",\"Acirc\":\"Â\",\"acirc\":\"â\",\"acute\":\"´\",\"Acy\":\"А\",\"acy\":\"а\",\"AElig\":\"Æ\",\"aelig\":\"æ\",\"af\":\"⁡\",\"Afr\":\"𝔄\",\"afr\":\"𝔞\",\"Agrave\":\"À\",\"agrave\":\"à\",\"alefsym\":\"ℵ\",\"aleph\":\"ℵ\",\"Alpha\":\"Α\",\"alpha\":\"α\",\"Amacr\":\"Ā\",\"amacr\":\"ā\",\"amalg\":\"⨿\",\"amp\":\"&\",\"AMP\":\"&\",\"andand\":\"⩕\",\"And\":\"⩓\",\"and\":\"∧\",\"andd\":\"⩜\",\"andslope\":\"⩘\",\"andv\":\"⩚\",\"ang\":\"∠\",\"ange\":\"⦤\",\"angle\":\"∠\",\"angmsdaa\":\"⦨\",\"angmsdab\":\"⦩\",\"angmsdac\":\"⦪\",\"angmsdad\":\"⦫\",\"angmsdae\":\"⦬\",\"angmsdaf\":\"⦭\",\"angmsdag\":\"⦮\",\"angmsdah\":\"⦯\",\"angmsd\":\"∡\",\"angrt\":\"∟\",\"angrtvb\":\"⊾\",\"angrtvbd\":\"⦝\",\"angsph\":\"∢\",\"angst\":\"Å\",\"angzarr\":\"⍼\",\"Aogon\":\"Ą\",\"aogon\":\"ą\",\"Aopf\":\"𝔸\",\"aopf\":\"𝕒\",\"apacir\":\"⩯\",\"ap\":\"≈\",\"apE\":\"⩰\",\"ape\":\"≊\",\"apid\":\"≋\",\"apos\":\"'\",\"ApplyFunction\":\"⁡\",\"approx\":\"≈\",\"approxeq\":\"≊\",\"Aring\":\"Å\",\"aring\":\"å\",\"Ascr\":\"𝒜\",\"ascr\":\"𝒶\",\"Assign\":\"≔\",\"ast\":\"*\",\"asymp\":\"≈\",\"asympeq\":\"≍\",\"Atilde\":\"Ã\",\"atilde\":\"ã\",\"Auml\":\"Ä\",\"auml\":\"ä\",\"awconint\":\"∳\",\"awint\":\"⨑\",\"backcong\":\"≌\",\"backepsilon\":\"϶\",\"backprime\":\"‵\",\"backsim\":\"∽\",\"backsimeq\":\"⋍\",\"Backslash\":\"∖\",\"Barv\":\"⫧\",\"barvee\":\"⊽\",\"barwed\":\"⌅\",\"Barwed\":\"⌆\",\"barwedge\":\"⌅\",\"bbrk\":\"⎵\",\"bbrktbrk\":\"⎶\",\"bcong\":\"≌\",\"Bcy\":\"Б\",\"bcy\":\"б\",\"bdquo\":\"„\",\"becaus\":\"∵\",\"because\":\"∵\",\"Because\":\"∵\",\"bemptyv\":\"⦰\",\"bepsi\":\"϶\",\"bernou\":\"ℬ\",\"Bernoullis\":\"ℬ\",\"Beta\":\"Β\",\"beta\":\"β\",\"beth\":\"ℶ\",\"between\":\"≬\",\"Bfr\":\"𝔅\",\"bfr\":\"𝔟\",\"bigcap\":\"⋂\",\"bigcirc\":\"◯\",\"bigcup\":\"⋃\",\"bigodot\":\"⨀\",\"bigoplus\":\"⨁\",\"bigotimes\":\"⨂\",\"bigsqcup\":\"⨆\",\"bigstar\":\"★\",\"bigtriangledown\":\"▽\",\"bigtriangleup\":\"△\",\"biguplus\":\"⨄\",\"bigvee\":\"⋁\",\"bigwedge\":\"⋀\",\"bkarow\":\"⤍\",\"blacklozenge\":\"⧫\",\"blacksquare\":\"▪\",\"blacktriangle\":\"▴\",\"blacktriangledown\":\"▾\",\"blacktriangleleft\":\"◂\",\"blacktriangleright\":\"▸\",\"blank\":\"␣\",\"blk12\":\"▒\",\"blk14\":\"░\",\"blk34\":\"▓\",\"block\":\"█\",\"bne\":\"=⃥\",\"bnequiv\":\"≡⃥\",\"bNot\":\"⫭\",\"bnot\":\"⌐\",\"Bopf\":\"𝔹\",\"bopf\":\"𝕓\",\"bot\":\"⊥\",\"bottom\":\"⊥\",\"bowtie\":\"⋈\",\"boxbox\":\"⧉\",\"boxdl\":\"┐\",\"boxdL\":\"╕\",\"boxDl\":\"╖\",\"boxDL\":\"╗\",\"boxdr\":\"┌\",\"boxdR\":\"╒\",\"boxDr\":\"╓\",\"boxDR\":\"╔\",\"boxh\":\"─\",\"boxH\":\"═\",\"boxhd\":\"┬\",\"boxHd\":\"╤\",\"boxhD\":\"╥\",\"boxHD\":\"╦\",\"boxhu\":\"┴\",\"boxHu\":\"╧\",\"boxhU\":\"╨\",\"boxHU\":\"╩\",\"boxminus\":\"⊟\",\"boxplus\":\"⊞\",\"boxtimes\":\"⊠\",\"boxul\":\"┘\",\"boxuL\":\"╛\",\"boxUl\":\"╜\",\"boxUL\":\"╝\",\"boxur\":\"└\",\"boxuR\":\"╘\",\"boxUr\":\"╙\",\"boxUR\":\"╚\",\"boxv\":\"│\",\"boxV\":\"║\",\"boxvh\":\"┼\",\"boxvH\":\"╪\",\"boxVh\":\"╫\",\"boxVH\":\"╬\",\"boxvl\":\"┤\",\"boxvL\":\"╡\",\"boxVl\":\"╢\",\"boxVL\":\"╣\",\"boxvr\":\"├\",\"boxvR\":\"╞\",\"boxVr\":\"╟\",\"boxVR\":\"╠\",\"bprime\":\"‵\",\"breve\":\"˘\",\"Breve\":\"˘\",\"brvbar\":\"¦\",\"bscr\":\"𝒷\",\"Bscr\":\"ℬ\",\"bsemi\":\"⁏\",\"bsim\":\"∽\",\"bsime\":\"⋍\",\"bsolb\":\"⧅\",\"bsol\":\"\\\\\",\"bsolhsub\":\"⟈\",\"bull\":\"•\",\"bullet\":\"•\",\"bump\":\"≎\",\"bumpE\":\"⪮\",\"bumpe\":\"≏\",\"Bumpeq\":\"≎\",\"bumpeq\":\"≏\",\"Cacute\":\"Ć\",\"cacute\":\"ć\",\"capand\":\"⩄\",\"capbrcup\":\"⩉\",\"capcap\":\"⩋\",\"cap\":\"∩\",\"Cap\":\"⋒\",\"capcup\":\"⩇\",\"capdot\":\"⩀\",\"CapitalDifferentialD\":\"ⅅ\",\"caps\":\"∩︀\",\"caret\":\"⁁\",\"caron\":\"ˇ\",\"Cayleys\":\"ℭ\",\"ccaps\":\"⩍\",\"Ccaron\":\"Č\",\"ccaron\":\"č\",\"Ccedil\":\"Ç\",\"ccedil\":\"ç\",\"Ccirc\":\"Ĉ\",\"ccirc\":\"ĉ\",\"Cconint\":\"∰\",\"ccups\":\"⩌\",\"ccupssm\":\"⩐\",\"Cdot\":\"Ċ\",\"cdot\":\"ċ\",\"cedil\":\"¸\",\"Cedilla\":\"¸\",\"cemptyv\":\"⦲\",\"cent\":\"¢\",\"centerdot\":\"·\",\"CenterDot\":\"·\",\"cfr\":\"𝔠\",\"Cfr\":\"ℭ\",\"CHcy\":\"Ч\",\"chcy\":\"ч\",\"check\":\"✓\",\"checkmark\":\"✓\",\"Chi\":\"Χ\",\"chi\":\"χ\",\"circ\":\"ˆ\",\"circeq\":\"≗\",\"circlearrowleft\":\"↺\",\"circlearrowright\":\"↻\",\"circledast\":\"⊛\",\"circledcirc\":\"⊚\",\"circleddash\":\"⊝\",\"CircleDot\":\"⊙\",\"circledR\":\"®\",\"circledS\":\"Ⓢ\",\"CircleMinus\":\"⊖\",\"CirclePlus\":\"⊕\",\"CircleTimes\":\"⊗\",\"cir\":\"○\",\"cirE\":\"⧃\",\"cire\":\"≗\",\"cirfnint\":\"⨐\",\"cirmid\":\"⫯\",\"cirscir\":\"⧂\",\"ClockwiseContourIntegral\":\"∲\",\"CloseCurlyDoubleQuote\":\"”\",\"CloseCurlyQuote\":\"’\",\"clubs\":\"♣\",\"clubsuit\":\"♣\",\"colon\":\":\",\"Colon\":\"∷\",\"Colone\":\"⩴\",\"colone\":\"≔\",\"coloneq\":\"≔\",\"comma\":\",\",\"commat\":\"@\",\"comp\":\"∁\",\"compfn\":\"∘\",\"complement\":\"∁\",\"complexes\":\"ℂ\",\"cong\":\"≅\",\"congdot\":\"⩭\",\"Congruent\":\"≡\",\"conint\":\"∮\",\"Conint\":\"∯\",\"ContourIntegral\":\"∮\",\"copf\":\"𝕔\",\"Copf\":\"ℂ\",\"coprod\":\"∐\",\"Coproduct\":\"∐\",\"copy\":\"©\",\"COPY\":\"©\",\"copysr\":\"℗\",\"CounterClockwiseContourIntegral\":\"∳\",\"crarr\":\"↵\",\"cross\":\"✗\",\"Cross\":\"⨯\",\"Cscr\":\"𝒞\",\"cscr\":\"𝒸\",\"csub\":\"⫏\",\"csube\":\"⫑\",\"csup\":\"⫐\",\"csupe\":\"⫒\",\"ctdot\":\"⋯\",\"cudarrl\":\"⤸\",\"cudarrr\":\"⤵\",\"cuepr\":\"⋞\",\"cuesc\":\"⋟\",\"cularr\":\"↶\",\"cularrp\":\"⤽\",\"cupbrcap\":\"⩈\",\"cupcap\":\"⩆\",\"CupCap\":\"≍\",\"cup\":\"∪\",\"Cup\":\"⋓\",\"cupcup\":\"⩊\",\"cupdot\":\"⊍\",\"cupor\":\"⩅\",\"cups\":\"∪︀\",\"curarr\":\"↷\",\"curarrm\":\"⤼\",\"curlyeqprec\":\"⋞\",\"curlyeqsucc\":\"⋟\",\"curlyvee\":\"⋎\",\"curlywedge\":\"⋏\",\"curren\":\"¤\",\"curvearrowleft\":\"↶\",\"curvearrowright\":\"↷\",\"cuvee\":\"⋎\",\"cuwed\":\"⋏\",\"cwconint\":\"∲\",\"cwint\":\"∱\",\"cylcty\":\"⌭\",\"dagger\":\"†\",\"Dagger\":\"‡\",\"daleth\":\"ℸ\",\"darr\":\"↓\",\"Darr\":\"↡\",\"dArr\":\"⇓\",\"dash\":\"‐\",\"Dashv\":\"⫤\",\"dashv\":\"⊣\",\"dbkarow\":\"⤏\",\"dblac\":\"˝\",\"Dcaron\":\"Ď\",\"dcaron\":\"ď\",\"Dcy\":\"Д\",\"dcy\":\"д\",\"ddagger\":\"‡\",\"ddarr\":\"⇊\",\"DD\":\"ⅅ\",\"dd\":\"ⅆ\",\"DDotrahd\":\"⤑\",\"ddotseq\":\"⩷\",\"deg\":\"°\",\"Del\":\"∇\",\"Delta\":\"Δ\",\"delta\":\"δ\",\"demptyv\":\"⦱\",\"dfisht\":\"⥿\",\"Dfr\":\"𝔇\",\"dfr\":\"𝔡\",\"dHar\":\"⥥\",\"dharl\":\"⇃\",\"dharr\":\"⇂\",\"DiacriticalAcute\":\"´\",\"DiacriticalDot\":\"˙\",\"DiacriticalDoubleAcute\":\"˝\",\"DiacriticalGrave\":\"`\",\"DiacriticalTilde\":\"˜\",\"diam\":\"⋄\",\"diamond\":\"⋄\",\"Diamond\":\"⋄\",\"diamondsuit\":\"♦\",\"diams\":\"♦\",\"die\":\"¨\",\"DifferentialD\":\"ⅆ\",\"digamma\":\"ϝ\",\"disin\":\"⋲\",\"div\":\"÷\",\"divide\":\"÷\",\"divideontimes\":\"⋇\",\"divonx\":\"⋇\",\"DJcy\":\"Ђ\",\"djcy\":\"ђ\",\"dlcorn\":\"⌞\",\"dlcrop\":\"⌍\",\"dollar\":\"$\",\"Dopf\":\"𝔻\",\"dopf\":\"𝕕\",\"Dot\":\"¨\",\"dot\":\"˙\",\"DotDot\":\"⃜\",\"doteq\":\"≐\",\"doteqdot\":\"≑\",\"DotEqual\":\"≐\",\"dotminus\":\"∸\",\"dotplus\":\"∔\",\"dotsquare\":\"⊡\",\"doublebarwedge\":\"⌆\",\"DoubleContourIntegral\":\"∯\",\"DoubleDot\":\"¨\",\"DoubleDownArrow\":\"⇓\",\"DoubleLeftArrow\":\"⇐\",\"DoubleLeftRightArrow\":\"⇔\",\"DoubleLeftTee\":\"⫤\",\"DoubleLongLeftArrow\":\"⟸\",\"DoubleLongLeftRightArrow\":\"⟺\",\"DoubleLongRightArrow\":\"⟹\",\"DoubleRightArrow\":\"⇒\",\"DoubleRightTee\":\"⊨\",\"DoubleUpArrow\":\"⇑\",\"DoubleUpDownArrow\":\"⇕\",\"DoubleVerticalBar\":\"∥\",\"DownArrowBar\":\"⤓\",\"downarrow\":\"↓\",\"DownArrow\":\"↓\",\"Downarrow\":\"⇓\",\"DownArrowUpArrow\":\"⇵\",\"DownBreve\":\"̑\",\"downdownarrows\":\"⇊\",\"downharpoonleft\":\"⇃\",\"downharpoonright\":\"⇂\",\"DownLeftRightVector\":\"⥐\",\"DownLeftTeeVector\":\"⥞\",\"DownLeftVectorBar\":\"⥖\",\"DownLeftVector\":\"↽\",\"DownRightTeeVector\":\"⥟\",\"DownRightVectorBar\":\"⥗\",\"DownRightVector\":\"⇁\",\"DownTeeArrow\":\"↧\",\"DownTee\":\"⊤\",\"drbkarow\":\"⤐\",\"drcorn\":\"⌟\",\"drcrop\":\"⌌\",\"Dscr\":\"𝒟\",\"dscr\":\"𝒹\",\"DScy\":\"Ѕ\",\"dscy\":\"ѕ\",\"dsol\":\"⧶\",\"Dstrok\":\"Đ\",\"dstrok\":\"đ\",\"dtdot\":\"⋱\",\"dtri\":\"▿\",\"dtrif\":\"▾\",\"duarr\":\"⇵\",\"duhar\":\"⥯\",\"dwangle\":\"⦦\",\"DZcy\":\"Џ\",\"dzcy\":\"џ\",\"dzigrarr\":\"⟿\",\"Eacute\":\"É\",\"eacute\":\"é\",\"easter\":\"⩮\",\"Ecaron\":\"Ě\",\"ecaron\":\"ě\",\"Ecirc\":\"Ê\",\"ecirc\":\"ê\",\"ecir\":\"≖\",\"ecolon\":\"≕\",\"Ecy\":\"Э\",\"ecy\":\"э\",\"eDDot\":\"⩷\",\"Edot\":\"Ė\",\"edot\":\"ė\",\"eDot\":\"≑\",\"ee\":\"ⅇ\",\"efDot\":\"≒\",\"Efr\":\"𝔈\",\"efr\":\"𝔢\",\"eg\":\"⪚\",\"Egrave\":\"È\",\"egrave\":\"è\",\"egs\":\"⪖\",\"egsdot\":\"⪘\",\"el\":\"⪙\",\"Element\":\"∈\",\"elinters\":\"⏧\",\"ell\":\"ℓ\",\"els\":\"⪕\",\"elsdot\":\"⪗\",\"Emacr\":\"Ē\",\"emacr\":\"ē\",\"empty\":\"∅\",\"emptyset\":\"∅\",\"EmptySmallSquare\":\"◻\",\"emptyv\":\"∅\",\"EmptyVerySmallSquare\":\"▫\",\"emsp13\":\" \",\"emsp14\":\" \",\"emsp\":\" \",\"ENG\":\"Ŋ\",\"eng\":\"ŋ\",\"ensp\":\" \",\"Eogon\":\"Ę\",\"eogon\":\"ę\",\"Eopf\":\"𝔼\",\"eopf\":\"𝕖\",\"epar\":\"⋕\",\"eparsl\":\"⧣\",\"eplus\":\"⩱\",\"epsi\":\"ε\",\"Epsilon\":\"Ε\",\"epsilon\":\"ε\",\"epsiv\":\"ϵ\",\"eqcirc\":\"≖\",\"eqcolon\":\"≕\",\"eqsim\":\"≂\",\"eqslantgtr\":\"⪖\",\"eqslantless\":\"⪕\",\"Equal\":\"⩵\",\"equals\":\"=\",\"EqualTilde\":\"≂\",\"equest\":\"≟\",\"Equilibrium\":\"⇌\",\"equiv\":\"≡\",\"equivDD\":\"⩸\",\"eqvparsl\":\"⧥\",\"erarr\":\"⥱\",\"erDot\":\"≓\",\"escr\":\"ℯ\",\"Escr\":\"ℰ\",\"esdot\":\"≐\",\"Esim\":\"⩳\",\"esim\":\"≂\",\"Eta\":\"Η\",\"eta\":\"η\",\"ETH\":\"Ð\",\"eth\":\"ð\",\"Euml\":\"Ë\",\"euml\":\"ë\",\"euro\":\"€\",\"excl\":\"!\",\"exist\":\"∃\",\"Exists\":\"∃\",\"expectation\":\"ℰ\",\"exponentiale\":\"ⅇ\",\"ExponentialE\":\"ⅇ\",\"fallingdotseq\":\"≒\",\"Fcy\":\"Ф\",\"fcy\":\"ф\",\"female\":\"♀\",\"ffilig\":\"ﬃ\",\"fflig\":\"ﬀ\",\"ffllig\":\"ﬄ\",\"Ffr\":\"𝔉\",\"ffr\":\"𝔣\",\"filig\":\"ﬁ\",\"FilledSmallSquare\":\"◼\",\"FilledVerySmallSquare\":\"▪\",\"fjlig\":\"fj\",\"flat\":\"♭\",\"fllig\":\"ﬂ\",\"fltns\":\"▱\",\"fnof\":\"ƒ\",\"Fopf\":\"𝔽\",\"fopf\":\"𝕗\",\"forall\":\"∀\",\"ForAll\":\"∀\",\"fork\":\"⋔\",\"forkv\":\"⫙\",\"Fouriertrf\":\"ℱ\",\"fpartint\":\"⨍\",\"frac12\":\"½\",\"frac13\":\"⅓\",\"frac14\":\"¼\",\"frac15\":\"⅕\",\"frac16\":\"⅙\",\"frac18\":\"⅛\",\"frac23\":\"⅔\",\"frac25\":\"⅖\",\"frac34\":\"¾\",\"frac35\":\"⅗\",\"frac38\":\"⅜\",\"frac45\":\"⅘\",\"frac56\":\"⅚\",\"frac58\":\"⅝\",\"frac78\":\"⅞\",\"frasl\":\"⁄\",\"frown\":\"⌢\",\"fscr\":\"𝒻\",\"Fscr\":\"ℱ\",\"gacute\":\"ǵ\",\"Gamma\":\"Γ\",\"gamma\":\"γ\",\"Gammad\":\"Ϝ\",\"gammad\":\"ϝ\",\"gap\":\"⪆\",\"Gbreve\":\"Ğ\",\"gbreve\":\"ğ\",\"Gcedil\":\"Ģ\",\"Gcirc\":\"Ĝ\",\"gcirc\":\"ĝ\",\"Gcy\":\"Г\",\"gcy\":\"г\",\"Gdot\":\"Ġ\",\"gdot\":\"ġ\",\"ge\":\"≥\",\"gE\":\"≧\",\"gEl\":\"⪌\",\"gel\":\"⋛\",\"geq\":\"≥\",\"geqq\":\"≧\",\"geqslant\":\"⩾\",\"gescc\":\"⪩\",\"ges\":\"⩾\",\"gesdot\":\"⪀\",\"gesdoto\":\"⪂\",\"gesdotol\":\"⪄\",\"gesl\":\"⋛︀\",\"gesles\":\"⪔\",\"Gfr\":\"𝔊\",\"gfr\":\"𝔤\",\"gg\":\"≫\",\"Gg\":\"⋙\",\"ggg\":\"⋙\",\"gimel\":\"ℷ\",\"GJcy\":\"Ѓ\",\"gjcy\":\"ѓ\",\"gla\":\"⪥\",\"gl\":\"≷\",\"glE\":\"⪒\",\"glj\":\"⪤\",\"gnap\":\"⪊\",\"gnapprox\":\"⪊\",\"gne\":\"⪈\",\"gnE\":\"≩\",\"gneq\":\"⪈\",\"gneqq\":\"≩\",\"gnsim\":\"⋧\",\"Gopf\":\"𝔾\",\"gopf\":\"𝕘\",\"grave\":\"`\",\"GreaterEqual\":\"≥\",\"GreaterEqualLess\":\"⋛\",\"GreaterFullEqual\":\"≧\",\"GreaterGreater\":\"⪢\",\"GreaterLess\":\"≷\",\"GreaterSlantEqual\":\"⩾\",\"GreaterTilde\":\"≳\",\"Gscr\":\"𝒢\",\"gscr\":\"ℊ\",\"gsim\":\"≳\",\"gsime\":\"⪎\",\"gsiml\":\"⪐\",\"gtcc\":\"⪧\",\"gtcir\":\"⩺\",\"gt\":\">\",\"GT\":\">\",\"Gt\":\"≫\",\"gtdot\":\"⋗\",\"gtlPar\":\"⦕\",\"gtquest\":\"⩼\",\"gtrapprox\":\"⪆\",\"gtrarr\":\"⥸\",\"gtrdot\":\"⋗\",\"gtreqless\":\"⋛\",\"gtreqqless\":\"⪌\",\"gtrless\":\"≷\",\"gtrsim\":\"≳\",\"gvertneqq\":\"≩︀\",\"gvnE\":\"≩︀\",\"Hacek\":\"ˇ\",\"hairsp\":\" \",\"half\":\"½\",\"hamilt\":\"ℋ\",\"HARDcy\":\"Ъ\",\"hardcy\":\"ъ\",\"harrcir\":\"⥈\",\"harr\":\"↔\",\"hArr\":\"⇔\",\"harrw\":\"↭\",\"Hat\":\"^\",\"hbar\":\"ℏ\",\"Hcirc\":\"Ĥ\",\"hcirc\":\"ĥ\",\"hearts\":\"♥\",\"heartsuit\":\"♥\",\"hellip\":\"…\",\"hercon\":\"⊹\",\"hfr\":\"𝔥\",\"Hfr\":\"ℌ\",\"HilbertSpace\":\"ℋ\",\"hksearow\":\"⤥\",\"hkswarow\":\"⤦\",\"hoarr\":\"⇿\",\"homtht\":\"∻\",\"hookleftarrow\":\"↩\",\"hookrightarrow\":\"↪\",\"hopf\":\"𝕙\",\"Hopf\":\"ℍ\",\"horbar\":\"―\",\"HorizontalLine\":\"─\",\"hscr\":\"𝒽\",\"Hscr\":\"ℋ\",\"hslash\":\"ℏ\",\"Hstrok\":\"Ħ\",\"hstrok\":\"ħ\",\"HumpDownHump\":\"≎\",\"HumpEqual\":\"≏\",\"hybull\":\"⁃\",\"hyphen\":\"‐\",\"Iacute\":\"Í\",\"iacute\":\"í\",\"ic\":\"⁣\",\"Icirc\":\"Î\",\"icirc\":\"î\",\"Icy\":\"И\",\"icy\":\"и\",\"Idot\":\"İ\",\"IEcy\":\"Е\",\"iecy\":\"е\",\"iexcl\":\"¡\",\"iff\":\"⇔\",\"ifr\":\"𝔦\",\"Ifr\":\"ℑ\",\"Igrave\":\"Ì\",\"igrave\":\"ì\",\"ii\":\"ⅈ\",\"iiiint\":\"⨌\",\"iiint\":\"∭\",\"iinfin\":\"⧜\",\"iiota\":\"℩\",\"IJlig\":\"Ĳ\",\"ijlig\":\"ĳ\",\"Imacr\":\"Ī\",\"imacr\":\"ī\",\"image\":\"ℑ\",\"ImaginaryI\":\"ⅈ\",\"imagline\":\"ℐ\",\"imagpart\":\"ℑ\",\"imath\":\"ı\",\"Im\":\"ℑ\",\"imof\":\"⊷\",\"imped\":\"Ƶ\",\"Implies\":\"⇒\",\"incare\":\"℅\",\"in\":\"∈\",\"infin\":\"∞\",\"infintie\":\"⧝\",\"inodot\":\"ı\",\"intcal\":\"⊺\",\"int\":\"∫\",\"Int\":\"∬\",\"integers\":\"ℤ\",\"Integral\":\"∫\",\"intercal\":\"⊺\",\"Intersection\":\"⋂\",\"intlarhk\":\"⨗\",\"intprod\":\"⨼\",\"InvisibleComma\":\"⁣\",\"InvisibleTimes\":\"⁢\",\"IOcy\":\"Ё\",\"iocy\":\"ё\",\"Iogon\":\"Į\",\"iogon\":\"į\",\"Iopf\":\"𝕀\",\"iopf\":\"𝕚\",\"Iota\":\"Ι\",\"iota\":\"ι\",\"iprod\":\"⨼\",\"iquest\":\"¿\",\"iscr\":\"𝒾\",\"Iscr\":\"ℐ\",\"isin\":\"∈\",\"isindot\":\"⋵\",\"isinE\":\"⋹\",\"isins\":\"⋴\",\"isinsv\":\"⋳\",\"isinv\":\"∈\",\"it\":\"⁢\",\"Itilde\":\"Ĩ\",\"itilde\":\"ĩ\",\"Iukcy\":\"І\",\"iukcy\":\"і\",\"Iuml\":\"Ï\",\"iuml\":\"ï\",\"Jcirc\":\"Ĵ\",\"jcirc\":\"ĵ\",\"Jcy\":\"Й\",\"jcy\":\"й\",\"Jfr\":\"𝔍\",\"jfr\":\"𝔧\",\"jmath\":\"ȷ\",\"Jopf\":\"𝕁\",\"jopf\":\"𝕛\",\"Jscr\":\"𝒥\",\"jscr\":\"𝒿\",\"Jsercy\":\"Ј\",\"jsercy\":\"ј\",\"Jukcy\":\"Є\",\"jukcy\":\"є\",\"Kappa\":\"Κ\",\"kappa\":\"κ\",\"kappav\":\"ϰ\",\"Kcedil\":\"Ķ\",\"kcedil\":\"ķ\",\"Kcy\":\"К\",\"kcy\":\"к\",\"Kfr\":\"𝔎\",\"kfr\":\"𝔨\",\"kgreen\":\"ĸ\",\"KHcy\":\"Х\",\"khcy\":\"х\",\"KJcy\":\"Ќ\",\"kjcy\":\"ќ\",\"Kopf\":\"𝕂\",\"kopf\":\"𝕜\",\"Kscr\":\"𝒦\",\"kscr\":\"𝓀\",\"lAarr\":\"⇚\",\"Lacute\":\"Ĺ\",\"lacute\":\"ĺ\",\"laemptyv\":\"⦴\",\"lagran\":\"ℒ\",\"Lambda\":\"Λ\",\"lambda\":\"λ\",\"lang\":\"⟨\",\"Lang\":\"⟪\",\"langd\":\"⦑\",\"langle\":\"⟨\",\"lap\":\"⪅\",\"Laplacetrf\":\"ℒ\",\"laquo\":\"«\",\"larrb\":\"⇤\",\"larrbfs\":\"⤟\",\"larr\":\"←\",\"Larr\":\"↞\",\"lArr\":\"⇐\",\"larrfs\":\"⤝\",\"larrhk\":\"↩\",\"larrlp\":\"↫\",\"larrpl\":\"⤹\",\"larrsim\":\"⥳\",\"larrtl\":\"↢\",\"latail\":\"⤙\",\"lAtail\":\"⤛\",\"lat\":\"⪫\",\"late\":\"⪭\",\"lates\":\"⪭︀\",\"lbarr\":\"⤌\",\"lBarr\":\"⤎\",\"lbbrk\":\"❲\",\"lbrace\":\"{\",\"lbrack\":\"[\",\"lbrke\":\"⦋\",\"lbrksld\":\"⦏\",\"lbrkslu\":\"⦍\",\"Lcaron\":\"Ľ\",\"lcaron\":\"ľ\",\"Lcedil\":\"Ļ\",\"lcedil\":\"ļ\",\"lceil\":\"⌈\",\"lcub\":\"{\",\"Lcy\":\"Л\",\"lcy\":\"л\",\"ldca\":\"⤶\",\"ldquo\":\"“\",\"ldquor\":\"„\",\"ldrdhar\":\"⥧\",\"ldrushar\":\"⥋\",\"ldsh\":\"↲\",\"le\":\"≤\",\"lE\":\"≦\",\"LeftAngleBracket\":\"⟨\",\"LeftArrowBar\":\"⇤\",\"leftarrow\":\"←\",\"LeftArrow\":\"←\",\"Leftarrow\":\"⇐\",\"LeftArrowRightArrow\":\"⇆\",\"leftarrowtail\":\"↢\",\"LeftCeiling\":\"⌈\",\"LeftDoubleBracket\":\"⟦\",\"LeftDownTeeVector\":\"⥡\",\"LeftDownVectorBar\":\"⥙\",\"LeftDownVector\":\"⇃\",\"LeftFloor\":\"⌊\",\"leftharpoondown\":\"↽\",\"leftharpoonup\":\"↼\",\"leftleftarrows\":\"⇇\",\"leftrightarrow\":\"↔\",\"LeftRightArrow\":\"↔\",\"Leftrightarrow\":\"⇔\",\"leftrightarrows\":\"⇆\",\"leftrightharpoons\":\"⇋\",\"leftrightsquigarrow\":\"↭\",\"LeftRightVector\":\"⥎\",\"LeftTeeArrow\":\"↤\",\"LeftTee\":\"⊣\",\"LeftTeeVector\":\"⥚\",\"leftthreetimes\":\"⋋\",\"LeftTriangleBar\":\"⧏\",\"LeftTriangle\":\"⊲\",\"LeftTriangleEqual\":\"⊴\",\"LeftUpDownVector\":\"⥑\",\"LeftUpTeeVector\":\"⥠\",\"LeftUpVectorBar\":\"⥘\",\"LeftUpVector\":\"↿\",\"LeftVectorBar\":\"⥒\",\"LeftVector\":\"↼\",\"lEg\":\"⪋\",\"leg\":\"⋚\",\"leq\":\"≤\",\"leqq\":\"≦\",\"leqslant\":\"⩽\",\"lescc\":\"⪨\",\"les\":\"⩽\",\"lesdot\":\"⩿\",\"lesdoto\":\"⪁\",\"lesdotor\":\"⪃\",\"lesg\":\"⋚︀\",\"lesges\":\"⪓\",\"lessapprox\":\"⪅\",\"lessdot\":\"⋖\",\"lesseqgtr\":\"⋚\",\"lesseqqgtr\":\"⪋\",\"LessEqualGreater\":\"⋚\",\"LessFullEqual\":\"≦\",\"LessGreater\":\"≶\",\"lessgtr\":\"≶\",\"LessLess\":\"⪡\",\"lesssim\":\"≲\",\"LessSlantEqual\":\"⩽\",\"LessTilde\":\"≲\",\"lfisht\":\"⥼\",\"lfloor\":\"⌊\",\"Lfr\":\"𝔏\",\"lfr\":\"𝔩\",\"lg\":\"≶\",\"lgE\":\"⪑\",\"lHar\":\"⥢\",\"lhard\":\"↽\",\"lharu\":\"↼\",\"lharul\":\"⥪\",\"lhblk\":\"▄\",\"LJcy\":\"Љ\",\"ljcy\":\"љ\",\"llarr\":\"⇇\",\"ll\":\"≪\",\"Ll\":\"⋘\",\"llcorner\":\"⌞\",\"Lleftarrow\":\"⇚\",\"llhard\":\"⥫\",\"lltri\":\"◺\",\"Lmidot\":\"Ŀ\",\"lmidot\":\"ŀ\",\"lmoustache\":\"⎰\",\"lmoust\":\"⎰\",\"lnap\":\"⪉\",\"lnapprox\":\"⪉\",\"lne\":\"⪇\",\"lnE\":\"≨\",\"lneq\":\"⪇\",\"lneqq\":\"≨\",\"lnsim\":\"⋦\",\"loang\":\"⟬\",\"loarr\":\"⇽\",\"lobrk\":\"⟦\",\"longleftarrow\":\"⟵\",\"LongLeftArrow\":\"⟵\",\"Longleftarrow\":\"⟸\",\"longleftrightarrow\":\"⟷\",\"LongLeftRightArrow\":\"⟷\",\"Longleftrightarrow\":\"⟺\",\"longmapsto\":\"⟼\",\"longrightarrow\":\"⟶\",\"LongRightArrow\":\"⟶\",\"Longrightarrow\":\"⟹\",\"looparrowleft\":\"↫\",\"looparrowright\":\"↬\",\"lopar\":\"⦅\",\"Lopf\":\"𝕃\",\"lopf\":\"𝕝\",\"loplus\":\"⨭\",\"lotimes\":\"⨴\",\"lowast\":\"∗\",\"lowbar\":\"_\",\"LowerLeftArrow\":\"↙\",\"LowerRightArrow\":\"↘\",\"loz\":\"◊\",\"lozenge\":\"◊\",\"lozf\":\"⧫\",\"lpar\":\"(\",\"lparlt\":\"⦓\",\"lrarr\":\"⇆\",\"lrcorner\":\"⌟\",\"lrhar\":\"⇋\",\"lrhard\":\"⥭\",\"lrm\":\"‎\",\"lrtri\":\"⊿\",\"lsaquo\":\"‹\",\"lscr\":\"𝓁\",\"Lscr\":\"ℒ\",\"lsh\":\"↰\",\"Lsh\":\"↰\",\"lsim\":\"≲\",\"lsime\":\"⪍\",\"lsimg\":\"⪏\",\"lsqb\":\"[\",\"lsquo\":\"‘\",\"lsquor\":\"‚\",\"Lstrok\":\"Ł\",\"lstrok\":\"ł\",\"ltcc\":\"⪦\",\"ltcir\":\"⩹\",\"lt\":\"<\",\"LT\":\"<\",\"Lt\":\"≪\",\"ltdot\":\"⋖\",\"lthree\":\"⋋\",\"ltimes\":\"⋉\",\"ltlarr\":\"⥶\",\"ltquest\":\"⩻\",\"ltri\":\"◃\",\"ltrie\":\"⊴\",\"ltrif\":\"◂\",\"ltrPar\":\"⦖\",\"lurdshar\":\"⥊\",\"luruhar\":\"⥦\",\"lvertneqq\":\"≨︀\",\"lvnE\":\"≨︀\",\"macr\":\"¯\",\"male\":\"♂\",\"malt\":\"✠\",\"maltese\":\"✠\",\"Map\":\"⤅\",\"map\":\"↦\",\"mapsto\":\"↦\",\"mapstodown\":\"↧\",\"mapstoleft\":\"↤\",\"mapstoup\":\"↥\",\"marker\":\"▮\",\"mcomma\":\"⨩\",\"Mcy\":\"М\",\"mcy\":\"м\",\"mdash\":\"—\",\"mDDot\":\"∺\",\"measuredangle\":\"∡\",\"MediumSpace\":\" \",\"Mellintrf\":\"ℳ\",\"Mfr\":\"𝔐\",\"mfr\":\"𝔪\",\"mho\":\"℧\",\"micro\":\"µ\",\"midast\":\"*\",\"midcir\":\"⫰\",\"mid\":\"∣\",\"middot\":\"·\",\"minusb\":\"⊟\",\"minus\":\"−\",\"minusd\":\"∸\",\"minusdu\":\"⨪\",\"MinusPlus\":\"∓\",\"mlcp\":\"⫛\",\"mldr\":\"…\",\"mnplus\":\"∓\",\"models\":\"⊧\",\"Mopf\":\"𝕄\",\"mopf\":\"𝕞\",\"mp\":\"∓\",\"mscr\":\"𝓂\",\"Mscr\":\"ℳ\",\"mstpos\":\"∾\",\"Mu\":\"Μ\",\"mu\":\"μ\",\"multimap\":\"⊸\",\"mumap\":\"⊸\",\"nabla\":\"∇\",\"Nacute\":\"Ń\",\"nacute\":\"ń\",\"nang\":\"∠⃒\",\"nap\":\"≉\",\"napE\":\"⩰̸\",\"napid\":\"≋̸\",\"napos\":\"ŉ\",\"napprox\":\"≉\",\"natural\":\"♮\",\"naturals\":\"ℕ\",\"natur\":\"♮\",\"nbsp\":\" \",\"nbump\":\"≎̸\",\"nbumpe\":\"≏̸\",\"ncap\":\"⩃\",\"Ncaron\":\"Ň\",\"ncaron\":\"ň\",\"Ncedil\":\"Ņ\",\"ncedil\":\"ņ\",\"ncong\":\"≇\",\"ncongdot\":\"⩭̸\",\"ncup\":\"⩂\",\"Ncy\":\"Н\",\"ncy\":\"н\",\"ndash\":\"–\",\"nearhk\":\"⤤\",\"nearr\":\"↗\",\"neArr\":\"⇗\",\"nearrow\":\"↗\",\"ne\":\"≠\",\"nedot\":\"≐̸\",\"NegativeMediumSpace\":\"​\",\"NegativeThickSpace\":\"​\",\"NegativeThinSpace\":\"​\",\"NegativeVeryThinSpace\":\"​\",\"nequiv\":\"≢\",\"nesear\":\"⤨\",\"nesim\":\"≂̸\",\"NestedGreaterGreater\":\"≫\",\"NestedLessLess\":\"≪\",\"NewLine\":\"\\n\",\"nexist\":\"∄\",\"nexists\":\"∄\",\"Nfr\":\"𝔑\",\"nfr\":\"𝔫\",\"ngE\":\"≧̸\",\"nge\":\"≱\",\"ngeq\":\"≱\",\"ngeqq\":\"≧̸\",\"ngeqslant\":\"⩾̸\",\"nges\":\"⩾̸\",\"nGg\":\"⋙̸\",\"ngsim\":\"≵\",\"nGt\":\"≫⃒\",\"ngt\":\"≯\",\"ngtr\":\"≯\",\"nGtv\":\"≫̸\",\"nharr\":\"↮\",\"nhArr\":\"⇎\",\"nhpar\":\"⫲\",\"ni\":\"∋\",\"nis\":\"⋼\",\"nisd\":\"⋺\",\"niv\":\"∋\",\"NJcy\":\"Њ\",\"njcy\":\"њ\",\"nlarr\":\"↚\",\"nlArr\":\"⇍\",\"nldr\":\"‥\",\"nlE\":\"≦̸\",\"nle\":\"≰\",\"nleftarrow\":\"↚\",\"nLeftarrow\":\"⇍\",\"nleftrightarrow\":\"↮\",\"nLeftrightarrow\":\"⇎\",\"nleq\":\"≰\",\"nleqq\":\"≦̸\",\"nleqslant\":\"⩽̸\",\"nles\":\"⩽̸\",\"nless\":\"≮\",\"nLl\":\"⋘̸\",\"nlsim\":\"≴\",\"nLt\":\"≪⃒\",\"nlt\":\"≮\",\"nltri\":\"⋪\",\"nltrie\":\"⋬\",\"nLtv\":\"≪̸\",\"nmid\":\"∤\",\"NoBreak\":\"⁠\",\"NonBreakingSpace\":\" \",\"nopf\":\"𝕟\",\"Nopf\":\"ℕ\",\"Not\":\"⫬\",\"not\":\"¬\",\"NotCongruent\":\"≢\",\"NotCupCap\":\"≭\",\"NotDoubleVerticalBar\":\"∦\",\"NotElement\":\"∉\",\"NotEqual\":\"≠\",\"NotEqualTilde\":\"≂̸\",\"NotExists\":\"∄\",\"NotGreater\":\"≯\",\"NotGreaterEqual\":\"≱\",\"NotGreaterFullEqual\":\"≧̸\",\"NotGreaterGreater\":\"≫̸\",\"NotGreaterLess\":\"≹\",\"NotGreaterSlantEqual\":\"⩾̸\",\"NotGreaterTilde\":\"≵\",\"NotHumpDownHump\":\"≎̸\",\"NotHumpEqual\":\"≏̸\",\"notin\":\"∉\",\"notindot\":\"⋵̸\",\"notinE\":\"⋹̸\",\"notinva\":\"∉\",\"notinvb\":\"⋷\",\"notinvc\":\"⋶\",\"NotLeftTriangleBar\":\"⧏̸\",\"NotLeftTriangle\":\"⋪\",\"NotLeftTriangleEqual\":\"⋬\",\"NotLess\":\"≮\",\"NotLessEqual\":\"≰\",\"NotLessGreater\":\"≸\",\"NotLessLess\":\"≪̸\",\"NotLessSlantEqual\":\"⩽̸\",\"NotLessTilde\":\"≴\",\"NotNestedGreaterGreater\":\"⪢̸\",\"NotNestedLessLess\":\"⪡̸\",\"notni\":\"∌\",\"notniva\":\"∌\",\"notnivb\":\"⋾\",\"notnivc\":\"⋽\",\"NotPrecedes\":\"⊀\",\"NotPrecedesEqual\":\"⪯̸\",\"NotPrecedesSlantEqual\":\"⋠\",\"NotReverseElement\":\"∌\",\"NotRightTriangleBar\":\"⧐̸\",\"NotRightTriangle\":\"⋫\",\"NotRightTriangleEqual\":\"⋭\",\"NotSquareSubset\":\"⊏̸\",\"NotSquareSubsetEqual\":\"⋢\",\"NotSquareSuperset\":\"⊐̸\",\"NotSquareSupersetEqual\":\"⋣\",\"NotSubset\":\"⊂⃒\",\"NotSubsetEqual\":\"⊈\",\"NotSucceeds\":\"⊁\",\"NotSucceedsEqual\":\"⪰̸\",\"NotSucceedsSlantEqual\":\"⋡\",\"NotSucceedsTilde\":\"≿̸\",\"NotSuperset\":\"⊃⃒\",\"NotSupersetEqual\":\"⊉\",\"NotTilde\":\"≁\",\"NotTildeEqual\":\"≄\",\"NotTildeFullEqual\":\"≇\",\"NotTildeTilde\":\"≉\",\"NotVerticalBar\":\"∤\",\"nparallel\":\"∦\",\"npar\":\"∦\",\"nparsl\":\"⫽⃥\",\"npart\":\"∂̸\",\"npolint\":\"⨔\",\"npr\":\"⊀\",\"nprcue\":\"⋠\",\"nprec\":\"⊀\",\"npreceq\":\"⪯̸\",\"npre\":\"⪯̸\",\"nrarrc\":\"⤳̸\",\"nrarr\":\"↛\",\"nrArr\":\"⇏\",\"nrarrw\":\"↝̸\",\"nrightarrow\":\"↛\",\"nRightarrow\":\"⇏\",\"nrtri\":\"⋫\",\"nrtrie\":\"⋭\",\"nsc\":\"⊁\",\"nsccue\":\"⋡\",\"nsce\":\"⪰̸\",\"Nscr\":\"𝒩\",\"nscr\":\"𝓃\",\"nshortmid\":\"∤\",\"nshortparallel\":\"∦\",\"nsim\":\"≁\",\"nsime\":\"≄\",\"nsimeq\":\"≄\",\"nsmid\":\"∤\",\"nspar\":\"∦\",\"nsqsube\":\"⋢\",\"nsqsupe\":\"⋣\",\"nsub\":\"⊄\",\"nsubE\":\"⫅̸\",\"nsube\":\"⊈\",\"nsubset\":\"⊂⃒\",\"nsubseteq\":\"⊈\",\"nsubseteqq\":\"⫅̸\",\"nsucc\":\"⊁\",\"nsucceq\":\"⪰̸\",\"nsup\":\"⊅\",\"nsupE\":\"⫆̸\",\"nsupe\":\"⊉\",\"nsupset\":\"⊃⃒\",\"nsupseteq\":\"⊉\",\"nsupseteqq\":\"⫆̸\",\"ntgl\":\"≹\",\"Ntilde\":\"Ñ\",\"ntilde\":\"ñ\",\"ntlg\":\"≸\",\"ntriangleleft\":\"⋪\",\"ntrianglelefteq\":\"⋬\",\"ntriangleright\":\"⋫\",\"ntrianglerighteq\":\"⋭\",\"Nu\":\"Ν\",\"nu\":\"ν\",\"num\":\"#\",\"numero\":\"№\",\"numsp\":\" \",\"nvap\":\"≍⃒\",\"nvdash\":\"⊬\",\"nvDash\":\"⊭\",\"nVdash\":\"⊮\",\"nVDash\":\"⊯\",\"nvge\":\"≥⃒\",\"nvgt\":\">⃒\",\"nvHarr\":\"⤄\",\"nvinfin\":\"⧞\",\"nvlArr\":\"⤂\",\"nvle\":\"≤⃒\",\"nvlt\":\"<⃒\",\"nvltrie\":\"⊴⃒\",\"nvrArr\":\"⤃\",\"nvrtrie\":\"⊵⃒\",\"nvsim\":\"∼⃒\",\"nwarhk\":\"⤣\",\"nwarr\":\"↖\",\"nwArr\":\"⇖\",\"nwarrow\":\"↖\",\"nwnear\":\"⤧\",\"Oacute\":\"Ó\",\"oacute\":\"ó\",\"oast\":\"⊛\",\"Ocirc\":\"Ô\",\"ocirc\":\"ô\",\"ocir\":\"⊚\",\"Ocy\":\"О\",\"ocy\":\"о\",\"odash\":\"⊝\",\"Odblac\":\"Ő\",\"odblac\":\"ő\",\"odiv\":\"⨸\",\"odot\":\"⊙\",\"odsold\":\"⦼\",\"OElig\":\"Œ\",\"oelig\":\"œ\",\"ofcir\":\"⦿\",\"Ofr\":\"𝔒\",\"ofr\":\"𝔬\",\"ogon\":\"˛\",\"Ograve\":\"Ò\",\"ograve\":\"ò\",\"ogt\":\"⧁\",\"ohbar\":\"⦵\",\"ohm\":\"Ω\",\"oint\":\"∮\",\"olarr\":\"↺\",\"olcir\":\"⦾\",\"olcross\":\"⦻\",\"oline\":\"‾\",\"olt\":\"⧀\",\"Omacr\":\"Ō\",\"omacr\":\"ō\",\"Omega\":\"Ω\",\"omega\":\"ω\",\"Omicron\":\"Ο\",\"omicron\":\"ο\",\"omid\":\"⦶\",\"ominus\":\"⊖\",\"Oopf\":\"𝕆\",\"oopf\":\"𝕠\",\"opar\":\"⦷\",\"OpenCurlyDoubleQuote\":\"“\",\"OpenCurlyQuote\":\"‘\",\"operp\":\"⦹\",\"oplus\":\"⊕\",\"orarr\":\"↻\",\"Or\":\"⩔\",\"or\":\"∨\",\"ord\":\"⩝\",\"order\":\"ℴ\",\"orderof\":\"ℴ\",\"ordf\":\"ª\",\"ordm\":\"º\",\"origof\":\"⊶\",\"oror\":\"⩖\",\"orslope\":\"⩗\",\"orv\":\"⩛\",\"oS\":\"Ⓢ\",\"Oscr\":\"𝒪\",\"oscr\":\"ℴ\",\"Oslash\":\"Ø\",\"oslash\":\"ø\",\"osol\":\"⊘\",\"Otilde\":\"Õ\",\"otilde\":\"õ\",\"otimesas\":\"⨶\",\"Otimes\":\"⨷\",\"otimes\":\"⊗\",\"Ouml\":\"Ö\",\"ouml\":\"ö\",\"ovbar\":\"⌽\",\"OverBar\":\"‾\",\"OverBrace\":\"⏞\",\"OverBracket\":\"⎴\",\"OverParenthesis\":\"⏜\",\"para\":\"¶\",\"parallel\":\"∥\",\"par\":\"∥\",\"parsim\":\"⫳\",\"parsl\":\"⫽\",\"part\":\"∂\",\"PartialD\":\"∂\",\"Pcy\":\"П\",\"pcy\":\"п\",\"percnt\":\"%\",\"period\":\".\",\"permil\":\"‰\",\"perp\":\"⊥\",\"pertenk\":\"‱\",\"Pfr\":\"𝔓\",\"pfr\":\"𝔭\",\"Phi\":\"Φ\",\"phi\":\"φ\",\"phiv\":\"ϕ\",\"phmmat\":\"ℳ\",\"phone\":\"☎\",\"Pi\":\"Π\",\"pi\":\"π\",\"pitchfork\":\"⋔\",\"piv\":\"ϖ\",\"planck\":\"ℏ\",\"planckh\":\"ℎ\",\"plankv\":\"ℏ\",\"plusacir\":\"⨣\",\"plusb\":\"⊞\",\"pluscir\":\"⨢\",\"plus\":\"+\",\"plusdo\":\"∔\",\"plusdu\":\"⨥\",\"pluse\":\"⩲\",\"PlusMinus\":\"±\",\"plusmn\":\"±\",\"plussim\":\"⨦\",\"plustwo\":\"⨧\",\"pm\":\"±\",\"Poincareplane\":\"ℌ\",\"pointint\":\"⨕\",\"popf\":\"𝕡\",\"Popf\":\"ℙ\",\"pound\":\"£\",\"prap\":\"⪷\",\"Pr\":\"⪻\",\"pr\":\"≺\",\"prcue\":\"≼\",\"precapprox\":\"⪷\",\"prec\":\"≺\",\"preccurlyeq\":\"≼\",\"Precedes\":\"≺\",\"PrecedesEqual\":\"⪯\",\"PrecedesSlantEqual\":\"≼\",\"PrecedesTilde\":\"≾\",\"preceq\":\"⪯\",\"precnapprox\":\"⪹\",\"precneqq\":\"⪵\",\"precnsim\":\"⋨\",\"pre\":\"⪯\",\"prE\":\"⪳\",\"precsim\":\"≾\",\"prime\":\"′\",\"Prime\":\"″\",\"primes\":\"ℙ\",\"prnap\":\"⪹\",\"prnE\":\"⪵\",\"prnsim\":\"⋨\",\"prod\":\"∏\",\"Product\":\"∏\",\"profalar\":\"⌮\",\"profline\":\"⌒\",\"profsurf\":\"⌓\",\"prop\":\"∝\",\"Proportional\":\"∝\",\"Proportion\":\"∷\",\"propto\":\"∝\",\"prsim\":\"≾\",\"prurel\":\"⊰\",\"Pscr\":\"𝒫\",\"pscr\":\"𝓅\",\"Psi\":\"Ψ\",\"psi\":\"ψ\",\"puncsp\":\" \",\"Qfr\":\"𝔔\",\"qfr\":\"𝔮\",\"qint\":\"⨌\",\"qopf\":\"𝕢\",\"Qopf\":\"ℚ\",\"qprime\":\"⁗\",\"Qscr\":\"𝒬\",\"qscr\":\"𝓆\",\"quaternions\":\"ℍ\",\"quatint\":\"⨖\",\"quest\":\"?\",\"questeq\":\"≟\",\"quot\":\"\\\"\",\"QUOT\":\"\\\"\",\"rAarr\":\"⇛\",\"race\":\"∽̱\",\"Racute\":\"Ŕ\",\"racute\":\"ŕ\",\"radic\":\"√\",\"raemptyv\":\"⦳\",\"rang\":\"⟩\",\"Rang\":\"⟫\",\"rangd\":\"⦒\",\"range\":\"⦥\",\"rangle\":\"⟩\",\"raquo\":\"»\",\"rarrap\":\"⥵\",\"rarrb\":\"⇥\",\"rarrbfs\":\"⤠\",\"rarrc\":\"⤳\",\"rarr\":\"→\",\"Rarr\":\"↠\",\"rArr\":\"⇒\",\"rarrfs\":\"⤞\",\"rarrhk\":\"↪\",\"rarrlp\":\"↬\",\"rarrpl\":\"⥅\",\"rarrsim\":\"⥴\",\"Rarrtl\":\"⤖\",\"rarrtl\":\"↣\",\"rarrw\":\"↝\",\"ratail\":\"⤚\",\"rAtail\":\"⤜\",\"ratio\":\"∶\",\"rationals\":\"ℚ\",\"rbarr\":\"⤍\",\"rBarr\":\"⤏\",\"RBarr\":\"⤐\",\"rbbrk\":\"❳\",\"rbrace\":\"}\",\"rbrack\":\"]\",\"rbrke\":\"⦌\",\"rbrksld\":\"⦎\",\"rbrkslu\":\"⦐\",\"Rcaron\":\"Ř\",\"rcaron\":\"ř\",\"Rcedil\":\"Ŗ\",\"rcedil\":\"ŗ\",\"rceil\":\"⌉\",\"rcub\":\"}\",\"Rcy\":\"Р\",\"rcy\":\"р\",\"rdca\":\"⤷\",\"rdldhar\":\"⥩\",\"rdquo\":\"”\",\"rdquor\":\"”\",\"rdsh\":\"↳\",\"real\":\"ℜ\",\"realine\":\"ℛ\",\"realpart\":\"ℜ\",\"reals\":\"ℝ\",\"Re\":\"ℜ\",\"rect\":\"▭\",\"reg\":\"®\",\"REG\":\"®\",\"ReverseElement\":\"∋\",\"ReverseEquilibrium\":\"⇋\",\"ReverseUpEquilibrium\":\"⥯\",\"rfisht\":\"⥽\",\"rfloor\":\"⌋\",\"rfr\":\"𝔯\",\"Rfr\":\"ℜ\",\"rHar\":\"⥤\",\"rhard\":\"⇁\",\"rharu\":\"⇀\",\"rharul\":\"⥬\",\"Rho\":\"Ρ\",\"rho\":\"ρ\",\"rhov\":\"ϱ\",\"RightAngleBracket\":\"⟩\",\"RightArrowBar\":\"⇥\",\"rightarrow\":\"→\",\"RightArrow\":\"→\",\"Rightarrow\":\"⇒\",\"RightArrowLeftArrow\":\"⇄\",\"rightarrowtail\":\"↣\",\"RightCeiling\":\"⌉\",\"RightDoubleBracket\":\"⟧\",\"RightDownTeeVector\":\"⥝\",\"RightDownVectorBar\":\"⥕\",\"RightDownVector\":\"⇂\",\"RightFloor\":\"⌋\",\"rightharpoondown\":\"⇁\",\"rightharpoonup\":\"⇀\",\"rightleftarrows\":\"⇄\",\"rightleftharpoons\":\"⇌\",\"rightrightarrows\":\"⇉\",\"rightsquigarrow\":\"↝\",\"RightTeeArrow\":\"↦\",\"RightTee\":\"⊢\",\"RightTeeVector\":\"⥛\",\"rightthreetimes\":\"⋌\",\"RightTriangleBar\":\"⧐\",\"RightTriangle\":\"⊳\",\"RightTriangleEqual\":\"⊵\",\"RightUpDownVector\":\"⥏\",\"RightUpTeeVector\":\"⥜\",\"RightUpVectorBar\":\"⥔\",\"RightUpVector\":\"↾\",\"RightVectorBar\":\"⥓\",\"RightVector\":\"⇀\",\"ring\":\"˚\",\"risingdotseq\":\"≓\",\"rlarr\":\"⇄\",\"rlhar\":\"⇌\",\"rlm\":\"‏\",\"rmoustache\":\"⎱\",\"rmoust\":\"⎱\",\"rnmid\":\"⫮\",\"roang\":\"⟭\",\"roarr\":\"⇾\",\"robrk\":\"⟧\",\"ropar\":\"⦆\",\"ropf\":\"𝕣\",\"Ropf\":\"ℝ\",\"roplus\":\"⨮\",\"rotimes\":\"⨵\",\"RoundImplies\":\"⥰\",\"rpar\":\")\",\"rpargt\":\"⦔\",\"rppolint\":\"⨒\",\"rrarr\":\"⇉\",\"Rrightarrow\":\"⇛\",\"rsaquo\":\"›\",\"rscr\":\"𝓇\",\"Rscr\":\"ℛ\",\"rsh\":\"↱\",\"Rsh\":\"↱\",\"rsqb\":\"]\",\"rsquo\":\"’\",\"rsquor\":\"’\",\"rthree\":\"⋌\",\"rtimes\":\"⋊\",\"rtri\":\"▹\",\"rtrie\":\"⊵\",\"rtrif\":\"▸\",\"rtriltri\":\"⧎\",\"RuleDelayed\":\"⧴\",\"ruluhar\":\"⥨\",\"rx\":\"℞\",\"Sacute\":\"Ś\",\"sacute\":\"ś\",\"sbquo\":\"‚\",\"scap\":\"⪸\",\"Scaron\":\"Š\",\"scaron\":\"š\",\"Sc\":\"⪼\",\"sc\":\"≻\",\"sccue\":\"≽\",\"sce\":\"⪰\",\"scE\":\"⪴\",\"Scedil\":\"Ş\",\"scedil\":\"ş\",\"Scirc\":\"Ŝ\",\"scirc\":\"ŝ\",\"scnap\":\"⪺\",\"scnE\":\"⪶\",\"scnsim\":\"⋩\",\"scpolint\":\"⨓\",\"scsim\":\"≿\",\"Scy\":\"С\",\"scy\":\"с\",\"sdotb\":\"⊡\",\"sdot\":\"⋅\",\"sdote\":\"⩦\",\"searhk\":\"⤥\",\"searr\":\"↘\",\"seArr\":\"⇘\",\"searrow\":\"↘\",\"sect\":\"§\",\"semi\":\";\",\"seswar\":\"⤩\",\"setminus\":\"∖\",\"setmn\":\"∖\",\"sext\":\"✶\",\"Sfr\":\"𝔖\",\"sfr\":\"𝔰\",\"sfrown\":\"⌢\",\"sharp\":\"♯\",\"SHCHcy\":\"Щ\",\"shchcy\":\"щ\",\"SHcy\":\"Ш\",\"shcy\":\"ш\",\"ShortDownArrow\":\"↓\",\"ShortLeftArrow\":\"←\",\"shortmid\":\"∣\",\"shortparallel\":\"∥\",\"ShortRightArrow\":\"→\",\"ShortUpArrow\":\"↑\",\"shy\":\"­\",\"Sigma\":\"Σ\",\"sigma\":\"σ\",\"sigmaf\":\"ς\",\"sigmav\":\"ς\",\"sim\":\"∼\",\"simdot\":\"⩪\",\"sime\":\"≃\",\"simeq\":\"≃\",\"simg\":\"⪞\",\"simgE\":\"⪠\",\"siml\":\"⪝\",\"simlE\":\"⪟\",\"simne\":\"≆\",\"simplus\":\"⨤\",\"simrarr\":\"⥲\",\"slarr\":\"←\",\"SmallCircle\":\"∘\",\"smallsetminus\":\"∖\",\"smashp\":\"⨳\",\"smeparsl\":\"⧤\",\"smid\":\"∣\",\"smile\":\"⌣\",\"smt\":\"⪪\",\"smte\":\"⪬\",\"smtes\":\"⪬︀\",\"SOFTcy\":\"Ь\",\"softcy\":\"ь\",\"solbar\":\"⌿\",\"solb\":\"⧄\",\"sol\":\"/\",\"Sopf\":\"𝕊\",\"sopf\":\"𝕤\",\"spades\":\"♠\",\"spadesuit\":\"♠\",\"spar\":\"∥\",\"sqcap\":\"⊓\",\"sqcaps\":\"⊓︀\",\"sqcup\":\"⊔\",\"sqcups\":\"⊔︀\",\"Sqrt\":\"√\",\"sqsub\":\"⊏\",\"sqsube\":\"⊑\",\"sqsubset\":\"⊏\",\"sqsubseteq\":\"⊑\",\"sqsup\":\"⊐\",\"sqsupe\":\"⊒\",\"sqsupset\":\"⊐\",\"sqsupseteq\":\"⊒\",\"square\":\"□\",\"Square\":\"□\",\"SquareIntersection\":\"⊓\",\"SquareSubset\":\"⊏\",\"SquareSubsetEqual\":\"⊑\",\"SquareSuperset\":\"⊐\",\"SquareSupersetEqual\":\"⊒\",\"SquareUnion\":\"⊔\",\"squarf\":\"▪\",\"squ\":\"□\",\"squf\":\"▪\",\"srarr\":\"→\",\"Sscr\":\"𝒮\",\"sscr\":\"𝓈\",\"ssetmn\":\"∖\",\"ssmile\":\"⌣\",\"sstarf\":\"⋆\",\"Star\":\"⋆\",\"star\":\"☆\",\"starf\":\"★\",\"straightepsilon\":\"ϵ\",\"straightphi\":\"ϕ\",\"strns\":\"¯\",\"sub\":\"⊂\",\"Sub\":\"⋐\",\"subdot\":\"⪽\",\"subE\":\"⫅\",\"sube\":\"⊆\",\"subedot\":\"⫃\",\"submult\":\"⫁\",\"subnE\":\"⫋\",\"subne\":\"⊊\",\"subplus\":\"⪿\",\"subrarr\":\"⥹\",\"subset\":\"⊂\",\"Subset\":\"⋐\",\"subseteq\":\"⊆\",\"subseteqq\":\"⫅\",\"SubsetEqual\":\"⊆\",\"subsetneq\":\"⊊\",\"subsetneqq\":\"⫋\",\"subsim\":\"⫇\",\"subsub\":\"⫕\",\"subsup\":\"⫓\",\"succapprox\":\"⪸\",\"succ\":\"≻\",\"succcurlyeq\":\"≽\",\"Succeeds\":\"≻\",\"SucceedsEqual\":\"⪰\",\"SucceedsSlantEqual\":\"≽\",\"SucceedsTilde\":\"≿\",\"succeq\":\"⪰\",\"succnapprox\":\"⪺\",\"succneqq\":\"⪶\",\"succnsim\":\"⋩\",\"succsim\":\"≿\",\"SuchThat\":\"∋\",\"sum\":\"∑\",\"Sum\":\"∑\",\"sung\":\"♪\",\"sup1\":\"¹\",\"sup2\":\"²\",\"sup3\":\"³\",\"sup\":\"⊃\",\"Sup\":\"⋑\",\"supdot\":\"⪾\",\"supdsub\":\"⫘\",\"supE\":\"⫆\",\"supe\":\"⊇\",\"supedot\":\"⫄\",\"Superset\":\"⊃\",\"SupersetEqual\":\"⊇\",\"suphsol\":\"⟉\",\"suphsub\":\"⫗\",\"suplarr\":\"⥻\",\"supmult\":\"⫂\",\"supnE\":\"⫌\",\"supne\":\"⊋\",\"supplus\":\"⫀\",\"supset\":\"⊃\",\"Supset\":\"⋑\",\"supseteq\":\"⊇\",\"supseteqq\":\"⫆\",\"supsetneq\":\"⊋\",\"supsetneqq\":\"⫌\",\"supsim\":\"⫈\",\"supsub\":\"⫔\",\"supsup\":\"⫖\",\"swarhk\":\"⤦\",\"swarr\":\"↙\",\"swArr\":\"⇙\",\"swarrow\":\"↙\",\"swnwar\":\"⤪\",\"szlig\":\"ß\",\"Tab\":\"\\t\",\"target\":\"⌖\",\"Tau\":\"Τ\",\"tau\":\"τ\",\"tbrk\":\"⎴\",\"Tcaron\":\"Ť\",\"tcaron\":\"ť\",\"Tcedil\":\"Ţ\",\"tcedil\":\"ţ\",\"Tcy\":\"Т\",\"tcy\":\"т\",\"tdot\":\"⃛\",\"telrec\":\"⌕\",\"Tfr\":\"𝔗\",\"tfr\":\"𝔱\",\"there4\":\"∴\",\"therefore\":\"∴\",\"Therefore\":\"∴\",\"Theta\":\"Θ\",\"theta\":\"θ\",\"thetasym\":\"ϑ\",\"thetav\":\"ϑ\",\"thickapprox\":\"≈\",\"thicksim\":\"∼\",\"ThickSpace\":\"  \",\"ThinSpace\":\" \",\"thinsp\":\" \",\"thkap\":\"≈\",\"thksim\":\"∼\",\"THORN\":\"Þ\",\"thorn\":\"þ\",\"tilde\":\"˜\",\"Tilde\":\"∼\",\"TildeEqual\":\"≃\",\"TildeFullEqual\":\"≅\",\"TildeTilde\":\"≈\",\"timesbar\":\"⨱\",\"timesb\":\"⊠\",\"times\":\"×\",\"timesd\":\"⨰\",\"tint\":\"∭\",\"toea\":\"⤨\",\"topbot\":\"⌶\",\"topcir\":\"⫱\",\"top\":\"⊤\",\"Topf\":\"𝕋\",\"topf\":\"𝕥\",\"topfork\":\"⫚\",\"tosa\":\"⤩\",\"tprime\":\"‴\",\"trade\":\"™\",\"TRADE\":\"™\",\"triangle\":\"▵\",\"triangledown\":\"▿\",\"triangleleft\":\"◃\",\"trianglelefteq\":\"⊴\",\"triangleq\":\"≜\",\"triangleright\":\"▹\",\"trianglerighteq\":\"⊵\",\"tridot\":\"◬\",\"trie\":\"≜\",\"triminus\":\"⨺\",\"TripleDot\":\"⃛\",\"triplus\":\"⨹\",\"trisb\":\"⧍\",\"tritime\":\"⨻\",\"trpezium\":\"⏢\",\"Tscr\":\"𝒯\",\"tscr\":\"𝓉\",\"TScy\":\"Ц\",\"tscy\":\"ц\",\"TSHcy\":\"Ћ\",\"tshcy\":\"ћ\",\"Tstrok\":\"Ŧ\",\"tstrok\":\"ŧ\",\"twixt\":\"≬\",\"twoheadleftarrow\":\"↞\",\"twoheadrightarrow\":\"↠\",\"Uacute\":\"Ú\",\"uacute\":\"ú\",\"uarr\":\"↑\",\"Uarr\":\"↟\",\"uArr\":\"⇑\",\"Uarrocir\":\"⥉\",\"Ubrcy\":\"Ў\",\"ubrcy\":\"ў\",\"Ubreve\":\"Ŭ\",\"ubreve\":\"ŭ\",\"Ucirc\":\"Û\",\"ucirc\":\"û\",\"Ucy\":\"У\",\"ucy\":\"у\",\"udarr\":\"⇅\",\"Udblac\":\"Ű\",\"udblac\":\"ű\",\"udhar\":\"⥮\",\"ufisht\":\"⥾\",\"Ufr\":\"𝔘\",\"ufr\":\"𝔲\",\"Ugrave\":\"Ù\",\"ugrave\":\"ù\",\"uHar\":\"⥣\",\"uharl\":\"↿\",\"uharr\":\"↾\",\"uhblk\":\"▀\",\"ulcorn\":\"⌜\",\"ulcorner\":\"⌜\",\"ulcrop\":\"⌏\",\"ultri\":\"◸\",\"Umacr\":\"Ū\",\"umacr\":\"ū\",\"uml\":\"¨\",\"UnderBar\":\"_\",\"UnderBrace\":\"⏟\",\"UnderBracket\":\"⎵\",\"UnderParenthesis\":\"⏝\",\"Union\":\"⋃\",\"UnionPlus\":\"⊎\",\"Uogon\":\"Ų\",\"uogon\":\"ų\",\"Uopf\":\"𝕌\",\"uopf\":\"𝕦\",\"UpArrowBar\":\"⤒\",\"uparrow\":\"↑\",\"UpArrow\":\"↑\",\"Uparrow\":\"⇑\",\"UpArrowDownArrow\":\"⇅\",\"updownarrow\":\"↕\",\"UpDownArrow\":\"↕\",\"Updownarrow\":\"⇕\",\"UpEquilibrium\":\"⥮\",\"upharpoonleft\":\"↿\",\"upharpoonright\":\"↾\",\"uplus\":\"⊎\",\"UpperLeftArrow\":\"↖\",\"UpperRightArrow\":\"↗\",\"upsi\":\"υ\",\"Upsi\":\"ϒ\",\"upsih\":\"ϒ\",\"Upsilon\":\"Υ\",\"upsilon\":\"υ\",\"UpTeeArrow\":\"↥\",\"UpTee\":\"⊥\",\"upuparrows\":\"⇈\",\"urcorn\":\"⌝\",\"urcorner\":\"⌝\",\"urcrop\":\"⌎\",\"Uring\":\"Ů\",\"uring\":\"ů\",\"urtri\":\"◹\",\"Uscr\":\"𝒰\",\"uscr\":\"𝓊\",\"utdot\":\"⋰\",\"Utilde\":\"Ũ\",\"utilde\":\"ũ\",\"utri\":\"▵\",\"utrif\":\"▴\",\"uuarr\":\"⇈\",\"Uuml\":\"Ü\",\"uuml\":\"ü\",\"uwangle\":\"⦧\",\"vangrt\":\"⦜\",\"varepsilon\":\"ϵ\",\"varkappa\":\"ϰ\",\"varnothing\":\"∅\",\"varphi\":\"ϕ\",\"varpi\":\"ϖ\",\"varpropto\":\"∝\",\"varr\":\"↕\",\"vArr\":\"⇕\",\"varrho\":\"ϱ\",\"varsigma\":\"ς\",\"varsubsetneq\":\"⊊︀\",\"varsubsetneqq\":\"⫋︀\",\"varsupsetneq\":\"⊋︀\",\"varsupsetneqq\":\"⫌︀\",\"vartheta\":\"ϑ\",\"vartriangleleft\":\"⊲\",\"vartriangleright\":\"⊳\",\"vBar\":\"⫨\",\"Vbar\":\"⫫\",\"vBarv\":\"⫩\",\"Vcy\":\"В\",\"vcy\":\"в\",\"vdash\":\"⊢\",\"vDash\":\"⊨\",\"Vdash\":\"⊩\",\"VDash\":\"⊫\",\"Vdashl\":\"⫦\",\"veebar\":\"⊻\",\"vee\":\"∨\",\"Vee\":\"⋁\",\"veeeq\":\"≚\",\"vellip\":\"⋮\",\"verbar\":\"|\",\"Verbar\":\"‖\",\"vert\":\"|\",\"Vert\":\"‖\",\"VerticalBar\":\"∣\",\"VerticalLine\":\"|\",\"VerticalSeparator\":\"❘\",\"VerticalTilde\":\"≀\",\"VeryThinSpace\":\" \",\"Vfr\":\"𝔙\",\"vfr\":\"𝔳\",\"vltri\":\"⊲\",\"vnsub\":\"⊂⃒\",\"vnsup\":\"⊃⃒\",\"Vopf\":\"𝕍\",\"vopf\":\"𝕧\",\"vprop\":\"∝\",\"vrtri\":\"⊳\",\"Vscr\":\"𝒱\",\"vscr\":\"𝓋\",\"vsubnE\":\"⫋︀\",\"vsubne\":\"⊊︀\",\"vsupnE\":\"⫌︀\",\"vsupne\":\"⊋︀\",\"Vvdash\":\"⊪\",\"vzigzag\":\"⦚\",\"Wcirc\":\"Ŵ\",\"wcirc\":\"ŵ\",\"wedbar\":\"⩟\",\"wedge\":\"∧\",\"Wedge\":\"⋀\",\"wedgeq\":\"≙\",\"weierp\":\"℘\",\"Wfr\":\"𝔚\",\"wfr\":\"𝔴\",\"Wopf\":\"𝕎\",\"wopf\":\"𝕨\",\"wp\":\"℘\",\"wr\":\"≀\",\"wreath\":\"≀\",\"Wscr\":\"𝒲\",\"wscr\":\"𝓌\",\"xcap\":\"⋂\",\"xcirc\":\"◯\",\"xcup\":\"⋃\",\"xdtri\":\"▽\",\"Xfr\":\"𝔛\",\"xfr\":\"𝔵\",\"xharr\":\"⟷\",\"xhArr\":\"⟺\",\"Xi\":\"Ξ\",\"xi\":\"ξ\",\"xlarr\":\"⟵\",\"xlArr\":\"⟸\",\"xmap\":\"⟼\",\"xnis\":\"⋻\",\"xodot\":\"⨀\",\"Xopf\":\"𝕏\",\"xopf\":\"𝕩\",\"xoplus\":\"⨁\",\"xotime\":\"⨂\",\"xrarr\":\"⟶\",\"xrArr\":\"⟹\",\"Xscr\":\"𝒳\",\"xscr\":\"𝓍\",\"xsqcup\":\"⨆\",\"xuplus\":\"⨄\",\"xutri\":\"△\",\"xvee\":\"⋁\",\"xwedge\":\"⋀\",\"Yacute\":\"Ý\",\"yacute\":\"ý\",\"YAcy\":\"Я\",\"yacy\":\"я\",\"Ycirc\":\"Ŷ\",\"ycirc\":\"ŷ\",\"Ycy\":\"Ы\",\"ycy\":\"ы\",\"yen\":\"¥\",\"Yfr\":\"𝔜\",\"yfr\":\"𝔶\",\"YIcy\":\"Ї\",\"yicy\":\"ї\",\"Yopf\":\"𝕐\",\"yopf\":\"𝕪\",\"Yscr\":\"𝒴\",\"yscr\":\"𝓎\",\"YUcy\":\"Ю\",\"yucy\":\"ю\",\"yuml\":\"ÿ\",\"Yuml\":\"Ÿ\",\"Zacute\":\"Ź\",\"zacute\":\"ź\",\"Zcaron\":\"Ž\",\"zcaron\":\"ž\",\"Zcy\":\"З\",\"zcy\":\"з\",\"Zdot\":\"Ż\",\"zdot\":\"ż\",\"zeetrf\":\"ℨ\",\"ZeroWidthSpace\":\"​\",\"Zeta\":\"Ζ\",\"zeta\":\"ζ\",\"zfr\":\"𝔷\",\"Zfr\":\"ℨ\",\"ZHcy\":\"Ж\",\"zhcy\":\"ж\",\"zigrarr\":\"⇝\",\"zopf\":\"𝕫\",\"Zopf\":\"ℤ\",\"Zscr\":\"𝒵\",\"zscr\":\"𝓏\",\"zwj\":\"‍\",\"zwnj\":\"‌\"}\n","module.exports=/[!-#%-\\*,-\\/:;\\?@\\[-\\]_\\{\\}\\xA1\\xA7\\xAB\\xB6\\xB7\\xBB\\xBF\\u037E\\u0387\\u055A-\\u055F\\u0589\\u058A\\u05BE\\u05C0\\u05C3\\u05C6\\u05F3\\u05F4\\u0609\\u060A\\u060C\\u060D\\u061B\\u061E\\u061F\\u066A-\\u066D\\u06D4\\u0700-\\u070D\\u07F7-\\u07F9\\u0830-\\u083E\\u085E\\u0964\\u0965\\u0970\\u09FD\\u0A76\\u0AF0\\u0C84\\u0DF4\\u0E4F\\u0E5A\\u0E5B\\u0F04-\\u0F12\\u0F14\\u0F3A-\\u0F3D\\u0F85\\u0FD0-\\u0FD4\\u0FD9\\u0FDA\\u104A-\\u104F\\u10FB\\u1360-\\u1368\\u1400\\u166D\\u166E\\u169B\\u169C\\u16EB-\\u16ED\\u1735\\u1736\\u17D4-\\u17D6\\u17D8-\\u17DA\\u1800-\\u180A\\u1944\\u1945\\u1A1E\\u1A1F\\u1AA0-\\u1AA6\\u1AA8-\\u1AAD\\u1B5A-\\u1B60\\u1BFC-\\u1BFF\\u1C3B-\\u1C3F\\u1C7E\\u1C7F\\u1CC0-\\u1CC7\\u1CD3\\u2010-\\u2027\\u2030-\\u2043\\u2045-\\u2051\\u2053-\\u205E\\u207D\\u207E\\u208D\\u208E\\u2308-\\u230B\\u2329\\u232A\\u2768-\\u2775\\u27C5\\u27C6\\u27E6-\\u27EF\\u2983-\\u2998\\u29D8-\\u29DB\\u29FC\\u29FD\\u2CF9-\\u2CFC\\u2CFE\\u2CFF\\u2D70\\u2E00-\\u2E2E\\u2E30-\\u2E4E\\u3001-\\u3003\\u3008-\\u3011\\u3014-\\u301F\\u3030\\u303D\\u30A0\\u30FB\\uA4FE\\uA4FF\\uA60D-\\uA60F\\uA673\\uA67E\\uA6F2-\\uA6F7\\uA874-\\uA877\\uA8CE\\uA8CF\\uA8F8-\\uA8FA\\uA8FC\\uA92E\\uA92F\\uA95F\\uA9C1-\\uA9CD\\uA9DE\\uA9DF\\uAA5C-\\uAA5F\\uAADE\\uAADF\\uAAF0\\uAAF1\\uABEB\\uFD3E\\uFD3F\\uFE10-\\uFE19\\uFE30-\\uFE52\\uFE54-\\uFE61\\uFE63\\uFE68\\uFE6A\\uFE6B\\uFF01-\\uFF03\\uFF05-\\uFF0A\\uFF0C-\\uFF0F\\uFF1A\\uFF1B\\uFF1F\\uFF20\\uFF3B-\\uFF3D\\uFF3F\\uFF5B\\uFF5D\\uFF5F-\\uFF65]|\\uD800[\\uDD00-\\uDD02\\uDF9F\\uDFD0]|\\uD801\\uDD6F|\\uD802[\\uDC57\\uDD1F\\uDD3F\\uDE50-\\uDE58\\uDE7F\\uDEF0-\\uDEF6\\uDF39-\\uDF3F\\uDF99-\\uDF9C]|\\uD803[\\uDF55-\\uDF59]|\\uD804[\\uDC47-\\uDC4D\\uDCBB\\uDCBC\\uDCBE-\\uDCC1\\uDD40-\\uDD43\\uDD74\\uDD75\\uDDC5-\\uDDC8\\uDDCD\\uDDDB\\uDDDD-\\uDDDF\\uDE38-\\uDE3D\\uDEA9]|\\uD805[\\uDC4B-\\uDC4F\\uDC5B\\uDC5D\\uDCC6\\uDDC1-\\uDDD7\\uDE41-\\uDE43\\uDE60-\\uDE6C\\uDF3C-\\uDF3E]|\\uD806[\\uDC3B\\uDE3F-\\uDE46\\uDE9A-\\uDE9C\\uDE9E-\\uDEA2]|\\uD807[\\uDC41-\\uDC45\\uDC70\\uDC71\\uDEF7\\uDEF8]|\\uD809[\\uDC70-\\uDC74]|\\uD81A[\\uDE6E\\uDE6F\\uDEF5\\uDF37-\\uDF3B\\uDF44]|\\uD81B[\\uDE97-\\uDE9A]|\\uD82F\\uDC9F|\\uD836[\\uDE87-\\uDE8B]|\\uD83A[\\uDD5E\\uDD5F]/","'use strict';\n\n\nmodule.exports.encode = require('./encode');\nmodule.exports.decode = require('./decode');\nmodule.exports.format = require('./format');\nmodule.exports.parse  = require('./parse');\n","\n'use strict';\n\n\nvar encodeCache = {};\n\n\n// Create a lookup array where anything but characters in `chars` string\n// and alphanumeric chars is percent-encoded.\n//\nfunction getEncodeCache(exclude) {\n  var i, ch, cache = encodeCache[exclude];\n  if (cache) { return cache; }\n\n  cache = encodeCache[exclude] = [];\n\n  for (i = 0; i < 128; i++) {\n    ch = String.fromCharCode(i);\n\n    if (/^[0-9a-z]$/i.test(ch)) {\n      // always allow unencoded alphanumeric characters\n      cache.push(ch);\n    } else {\n      cache.push('%' + ('0' + i.toString(16).toUpperCase()).slice(-2));\n    }\n  }\n\n  for (i = 0; i < exclude.length; i++) {\n    cache[exclude.charCodeAt(i)] = exclude[i];\n  }\n\n  return cache;\n}\n\n\n// Encode unsafe characters with percent-encoding, skipping already\n// encoded sequences.\n//\n//  - string       - string to encode\n//  - exclude      - list of characters to ignore (in addition to a-zA-Z0-9)\n//  - keepEscaped  - don't encode '%' in a correct escape sequence (default: true)\n//\nfunction encode(string, exclude, keepEscaped) {\n  var i, l, code, nextCode, cache,\n      result = '';\n\n  if (typeof exclude !== 'string') {\n    // encode(string, keepEscaped)\n    keepEscaped  = exclude;\n    exclude = encode.defaultChars;\n  }\n\n  if (typeof keepEscaped === 'undefined') {\n    keepEscaped = true;\n  }\n\n  cache = getEncodeCache(exclude);\n\n  for (i = 0, l = string.length; i < l; i++) {\n    code = string.charCodeAt(i);\n\n    if (keepEscaped && code === 0x25 /* % */ && i + 2 < l) {\n      if (/^[0-9a-f]{2}$/i.test(string.slice(i + 1, i + 3))) {\n        result += string.slice(i, i + 3);\n        i += 2;\n        continue;\n      }\n    }\n\n    if (code < 128) {\n      result += cache[code];\n      continue;\n    }\n\n    if (code >= 0xD800 && code <= 0xDFFF) {\n      if (code >= 0xD800 && code <= 0xDBFF && i + 1 < l) {\n        nextCode = string.charCodeAt(i + 1);\n        if (nextCode >= 0xDC00 && nextCode <= 0xDFFF) {\n          result += encodeURIComponent(string[i] + string[i + 1]);\n          i++;\n          continue;\n        }\n      }\n      result += '%EF%BF%BD';\n      continue;\n    }\n\n    result += encodeURIComponent(string[i]);\n  }\n\n  return result;\n}\n\nencode.defaultChars   = \";/?:@&=+$,-_.!~*'()#\";\nencode.componentChars = \"-_.!~*'()\";\n\n\nmodule.exports = encode;\n","\n'use strict';\n\n\n/* eslint-disable no-bitwise */\n\nvar decodeCache = {};\n\nfunction getDecodeCache(exclude) {\n  var i, ch, cache = decodeCache[exclude];\n  if (cache) { return cache; }\n\n  cache = decodeCache[exclude] = [];\n\n  for (i = 0; i < 128; i++) {\n    ch = String.fromCharCode(i);\n    cache.push(ch);\n  }\n\n  for (i = 0; i < exclude.length; i++) {\n    ch = exclude.charCodeAt(i);\n    cache[ch] = '%' + ('0' + ch.toString(16).toUpperCase()).slice(-2);\n  }\n\n  return cache;\n}\n\n\n// Decode percent-encoded string.\n//\nfunction decode(string, exclude) {\n  var cache;\n\n  if (typeof exclude !== 'string') {\n    exclude = decode.defaultChars;\n  }\n\n  cache = getDecodeCache(exclude);\n\n  return string.replace(/(%[a-f0-9]{2})+/gi, function(seq) {\n    var i, l, b1, b2, b3, b4, chr,\n        result = '';\n\n    for (i = 0, l = seq.length; i < l; i += 3) {\n      b1 = parseInt(seq.slice(i + 1, i + 3), 16);\n\n      if (b1 < 0x80) {\n        result += cache[b1];\n        continue;\n      }\n\n      if ((b1 & 0xE0) === 0xC0 && (i + 3 < l)) {\n        // 110xxxxx 10xxxxxx\n        b2 = parseInt(seq.slice(i + 4, i + 6), 16);\n\n        if ((b2 & 0xC0) === 0x80) {\n          chr = ((b1 << 6) & 0x7C0) | (b2 & 0x3F);\n\n          if (chr < 0x80) {\n            result += '\\ufffd\\ufffd';\n          } else {\n            result += String.fromCharCode(chr);\n          }\n\n          i += 3;\n          continue;\n        }\n      }\n\n      if ((b1 & 0xF0) === 0xE0 && (i + 6 < l)) {\n        // 1110xxxx 10xxxxxx 10xxxxxx\n        b2 = parseInt(seq.slice(i + 4, i + 6), 16);\n        b3 = parseInt(seq.slice(i + 7, i + 9), 16);\n\n        if ((b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80) {\n          chr = ((b1 << 12) & 0xF000) | ((b2 << 6) & 0xFC0) | (b3 & 0x3F);\n\n          if (chr < 0x800 || (chr >= 0xD800 && chr <= 0xDFFF)) {\n            result += '\\ufffd\\ufffd\\ufffd';\n          } else {\n            result += String.fromCharCode(chr);\n          }\n\n          i += 6;\n          continue;\n        }\n      }\n\n      if ((b1 & 0xF8) === 0xF0 && (i + 9 < l)) {\n        // 111110xx 10xxxxxx 10xxxxxx 10xxxxxx\n        b2 = parseInt(seq.slice(i + 4, i + 6), 16);\n        b3 = parseInt(seq.slice(i + 7, i + 9), 16);\n        b4 = parseInt(seq.slice(i + 10, i + 12), 16);\n\n        if ((b2 & 0xC0) === 0x80 && (b3 & 0xC0) === 0x80 && (b4 & 0xC0) === 0x80) {\n          chr = ((b1 << 18) & 0x1C0000) | ((b2 << 12) & 0x3F000) | ((b3 << 6) & 0xFC0) | (b4 & 0x3F);\n\n          if (chr < 0x10000 || chr > 0x10FFFF) {\n            result += '\\ufffd\\ufffd\\ufffd\\ufffd';\n          } else {\n            chr -= 0x10000;\n            result += String.fromCharCode(0xD800 + (chr >> 10), 0xDC00 + (chr & 0x3FF));\n          }\n\n          i += 9;\n          continue;\n        }\n      }\n\n      result += '\\ufffd';\n    }\n\n    return result;\n  });\n}\n\n\ndecode.defaultChars   = ';/?:@&=+$,#';\ndecode.componentChars = '';\n\n\nmodule.exports = decode;\n","\n'use strict';\n\n\nmodule.exports = function format(url) {\n  var result = '';\n\n  result += url.protocol || '';\n  result += url.slashes ? '//' : '';\n  result += url.auth ? url.auth + '@' : '';\n\n  if (url.hostname && url.hostname.indexOf(':') !== -1) {\n    // ipv6 address\n    result += '[' + url.hostname + ']';\n  } else {\n    result += url.hostname || '';\n  }\n\n  result += url.port ? ':' + url.port : '';\n  result += url.pathname || '';\n  result += url.search || '';\n  result += url.hash || '';\n\n  return result;\n};\n","// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\n'use strict';\n\n//\n// Changes from joyent/node:\n//\n// 1. No leading slash in paths,\n//    e.g. in `url.parse('http://foo?bar')` pathname is ``, not `/`\n//\n// 2. Backslashes are not replaced with slashes,\n//    so `http:\\\\example.org\\` is treated like a relative path\n//\n// 3. Trailing colon is treated like a part of the path,\n//    i.e. in `http://example.org:foo` pathname is `:foo`\n//\n// 4. Nothing is URL-encoded in the resulting object,\n//    (in joyent/node some chars in auth and paths are encoded)\n//\n// 5. `url.parse()` does not have `parseQueryString` argument\n//\n// 6. Removed extraneous result properties: `host`, `path`, `query`, etc.,\n//    which can be constructed using other parts of the url.\n//\n\n\nfunction Url() {\n  this.protocol = null;\n  this.slashes = null;\n  this.auth = null;\n  this.port = null;\n  this.hostname = null;\n  this.hash = null;\n  this.search = null;\n  this.pathname = null;\n}\n\n// Reference: RFC 3986, RFC 1808, RFC 2396\n\n// define these here so at least they only have to be\n// compiled once on the first module load.\nvar protocolPattern = /^([a-z0-9.+-]+:)/i,\n    portPattern = /:[0-9]*$/,\n\n    // Special case for a simple path URL\n    simplePathPattern = /^(\\/\\/?(?!\\/)[^\\?\\s]*)(\\?[^\\s]*)?$/,\n\n    // RFC 2396: characters reserved for delimiting URLs.\n    // We actually just auto-escape these.\n    delims = [ '<', '>', '\"', '`', ' ', '\\r', '\\n', '\\t' ],\n\n    // RFC 2396: characters not allowed for various reasons.\n    unwise = [ '{', '}', '|', '\\\\', '^', '`' ].concat(delims),\n\n    // Allowed by RFCs, but cause of XSS attacks.  Always escape these.\n    autoEscape = [ '\\'' ].concat(unwise),\n    // Characters that are never ever allowed in a hostname.\n    // Note that any invalid chars are also handled, but these\n    // are the ones that are *expected* to be seen, so we fast-path\n    // them.\n    nonHostChars = [ '%', '/', '?', ';', '#' ].concat(autoEscape),\n    hostEndingChars = [ '/', '?', '#' ],\n    hostnameMaxLen = 255,\n    hostnamePartPattern = /^[+a-z0-9A-Z_-]{0,63}$/,\n    hostnamePartStart = /^([+a-z0-9A-Z_-]{0,63})(.*)$/,\n    // protocols that can allow \"unsafe\" and \"unwise\" chars.\n    /* eslint-disable no-script-url */\n    // protocols that never have a hostname.\n    hostlessProtocol = {\n      'javascript': true,\n      'javascript:': true\n    },\n    // protocols that always contain a // bit.\n    slashedProtocol = {\n      'http': true,\n      'https': true,\n      'ftp': true,\n      'gopher': true,\n      'file': true,\n      'http:': true,\n      'https:': true,\n      'ftp:': true,\n      'gopher:': true,\n      'file:': true\n    };\n    /* eslint-enable no-script-url */\n\nfunction urlParse(url, slashesDenoteHost) {\n  if (url && url instanceof Url) { return url; }\n\n  var u = new Url();\n  u.parse(url, slashesDenoteHost);\n  return u;\n}\n\nUrl.prototype.parse = function(url, slashesDenoteHost) {\n  var i, l, lowerProto, hec, slashes,\n      rest = url;\n\n  // trim before proceeding.\n  // This is to support parse stuff like \"  http://foo.com  \\n\"\n  rest = rest.trim();\n\n  if (!slashesDenoteHost && url.split('#').length === 1) {\n    // Try fast path regexp\n    var simplePath = simplePathPattern.exec(rest);\n    if (simplePath) {\n      this.pathname = simplePath[1];\n      if (simplePath[2]) {\n        this.search = simplePath[2];\n      }\n      return this;\n    }\n  }\n\n  var proto = protocolPattern.exec(rest);\n  if (proto) {\n    proto = proto[0];\n    lowerProto = proto.toLowerCase();\n    this.protocol = proto;\n    rest = rest.substr(proto.length);\n  }\n\n  // figure out if it's got a host\n  // user@server is *always* interpreted as a hostname, and url\n  // resolution will treat //foo/bar as host=foo,path=bar because that's\n  // how the browser resolves relative URLs.\n  if (slashesDenoteHost || proto || rest.match(/^\\/\\/[^@\\/]+@[^@\\/]+/)) {\n    slashes = rest.substr(0, 2) === '//';\n    if (slashes && !(proto && hostlessProtocol[proto])) {\n      rest = rest.substr(2);\n      this.slashes = true;\n    }\n  }\n\n  if (!hostlessProtocol[proto] &&\n      (slashes || (proto && !slashedProtocol[proto]))) {\n\n    // there's a hostname.\n    // the first instance of /, ?, ;, or # ends the host.\n    //\n    // If there is an @ in the hostname, then non-host chars *are* allowed\n    // to the left of the last @ sign, unless some host-ending character\n    // comes *before* the @-sign.\n    // URLs are obnoxious.\n    //\n    // ex:\n    // http://a@b@c/ => user:a@b host:c\n    // http://a@b?@c => user:a host:c path:/?@c\n\n    // v0.12 TODO(isaacs): This is not quite how Chrome does things.\n    // Review our test case against browsers more comprehensively.\n\n    // find the first instance of any hostEndingChars\n    var hostEnd = -1;\n    for (i = 0; i < hostEndingChars.length; i++) {\n      hec = rest.indexOf(hostEndingChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd)) {\n        hostEnd = hec;\n      }\n    }\n\n    // at this point, either we have an explicit point where the\n    // auth portion cannot go past, or the last @ char is the decider.\n    var auth, atSign;\n    if (hostEnd === -1) {\n      // atSign can be anywhere.\n      atSign = rest.lastIndexOf('@');\n    } else {\n      // atSign must be in auth portion.\n      // http://a@b/c@d => host:b auth:a path:/c@d\n      atSign = rest.lastIndexOf('@', hostEnd);\n    }\n\n    // Now we have a portion which is definitely the auth.\n    // Pull that off.\n    if (atSign !== -1) {\n      auth = rest.slice(0, atSign);\n      rest = rest.slice(atSign + 1);\n      this.auth = auth;\n    }\n\n    // the host is the remaining to the left of the first non-host char\n    hostEnd = -1;\n    for (i = 0; i < nonHostChars.length; i++) {\n      hec = rest.indexOf(nonHostChars[i]);\n      if (hec !== -1 && (hostEnd === -1 || hec < hostEnd)) {\n        hostEnd = hec;\n      }\n    }\n    // if we still have not hit it, then the entire thing is a host.\n    if (hostEnd === -1) {\n      hostEnd = rest.length;\n    }\n\n    if (rest[hostEnd - 1] === ':') { hostEnd--; }\n    var host = rest.slice(0, hostEnd);\n    rest = rest.slice(hostEnd);\n\n    // pull out port.\n    this.parseHost(host);\n\n    // we've indicated that there is a hostname,\n    // so even if it's empty, it has to be present.\n    this.hostname = this.hostname || '';\n\n    // if hostname begins with [ and ends with ]\n    // assume that it's an IPv6 address.\n    var ipv6Hostname = this.hostname[0] === '[' &&\n        this.hostname[this.hostname.length - 1] === ']';\n\n    // validate a little.\n    if (!ipv6Hostname) {\n      var hostparts = this.hostname.split(/\\./);\n      for (i = 0, l = hostparts.length; i < l; i++) {\n        var part = hostparts[i];\n        if (!part) { continue; }\n        if (!part.match(hostnamePartPattern)) {\n          var newpart = '';\n          for (var j = 0, k = part.length; j < k; j++) {\n            if (part.charCodeAt(j) > 127) {\n              // we replace non-ASCII char with a temporary placeholder\n              // we need this to make sure size of hostname is not\n              // broken by replacing non-ASCII by nothing\n              newpart += 'x';\n            } else {\n              newpart += part[j];\n            }\n          }\n          // we test again with ASCII char only\n          if (!newpart.match(hostnamePartPattern)) {\n            var validParts = hostparts.slice(0, i);\n            var notHost = hostparts.slice(i + 1);\n            var bit = part.match(hostnamePartStart);\n            if (bit) {\n              validParts.push(bit[1]);\n              notHost.unshift(bit[2]);\n            }\n            if (notHost.length) {\n              rest = notHost.join('.') + rest;\n            }\n            this.hostname = validParts.join('.');\n            break;\n          }\n        }\n      }\n    }\n\n    if (this.hostname.length > hostnameMaxLen) {\n      this.hostname = '';\n    }\n\n    // strip [ and ] from the hostname\n    // the host field still retains them, though\n    if (ipv6Hostname) {\n      this.hostname = this.hostname.substr(1, this.hostname.length - 2);\n    }\n  }\n\n  // chop off from the tail first.\n  var hash = rest.indexOf('#');\n  if (hash !== -1) {\n    // got a fragment string.\n    this.hash = rest.substr(hash);\n    rest = rest.slice(0, hash);\n  }\n  var qm = rest.indexOf('?');\n  if (qm !== -1) {\n    this.search = rest.substr(qm);\n    rest = rest.slice(0, qm);\n  }\n  if (rest) { this.pathname = rest; }\n  if (slashedProtocol[lowerProto] &&\n      this.hostname && !this.pathname) {\n    this.pathname = '';\n  }\n\n  return this;\n};\n\nUrl.prototype.parseHost = function(host) {\n  var port = portPattern.exec(host);\n  if (port) {\n    port = port[0];\n    if (port !== ':') {\n      this.port = port.substr(1);\n    }\n    host = host.substr(0, host.length - port.length);\n  }\n  if (host) { this.hostname = host; }\n};\n\nmodule.exports = urlParse;\n","'use strict';\n\nexports.Any = require('./properties/Any/regex');\nexports.Cc  = require('./categories/Cc/regex');\nexports.Cf  = require('./categories/Cf/regex');\nexports.P   = require('./categories/P/regex');\nexports.Z   = require('./categories/Z/regex');\n","module.exports=/[\\0-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF]/","module.exports=/[\\0-\\x1F\\x7F-\\x9F]/","module.exports=/[\\xAD\\u0600-\\u0605\\u061C\\u06DD\\u070F\\u08E2\\u180E\\u200B-\\u200F\\u202A-\\u202E\\u2060-\\u2064\\u2066-\\u206F\\uFEFF\\uFFF9-\\uFFFB]|\\uD804[\\uDCBD\\uDCCD]|\\uD82F[\\uDCA0-\\uDCA3]|\\uD834[\\uDD73-\\uDD7A]|\\uDB40[\\uDC01\\uDC20-\\uDC7F]/","module.exports=/[ \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000]/","// Just a shortcut for bulk export\n'use strict';\n\n\nexports.parseLinkLabel       = require('./parse_link_label');\nexports.parseLinkDestination = require('./parse_link_destination');\nexports.parseLinkTitle       = require('./parse_link_title');\n","// Parse link label\n//\n// this function assumes that first character (\"[\") already matches;\n// returns the end of the label\n//\n'use strict';\n\nmodule.exports = function parseLinkLabel(state, start, disableNested) {\n  var level, found, marker, prevPos,\n      labelEnd = -1,\n      max = state.posMax,\n      oldPos = state.pos;\n\n  state.pos = start + 1;\n  level = 1;\n\n  while (state.pos < max) {\n    marker = state.src.charCodeAt(state.pos);\n    if (marker === 0x5D /* ] */) {\n      level--;\n      if (level === 0) {\n        found = true;\n        break;\n      }\n    }\n\n    prevPos = state.pos;\n    state.md.inline.skipToken(state);\n    if (marker === 0x5B /* [ */) {\n      if (prevPos === state.pos - 1) {\n        // increase level if we find text `[`, which is not a part of any token\n        level++;\n      } else if (disableNested) {\n        state.pos = oldPos;\n        return -1;\n      }\n    }\n  }\n\n  if (found) {\n    labelEnd = state.pos;\n  }\n\n  // restore old state\n  state.pos = oldPos;\n\n  return labelEnd;\n};\n","// Parse link destination\n//\n'use strict';\n\n\nvar unescapeAll = require('../common/utils').unescapeAll;\n\n\nmodule.exports = function parseLinkDestination(str, pos, max) {\n  var code, level,\n      lines = 0,\n      start = pos,\n      result = {\n        ok: false,\n        pos: 0,\n        lines: 0,\n        str: ''\n      };\n\n  if (str.charCodeAt(pos) === 0x3C /* < */) {\n    pos++;\n    while (pos < max) {\n      code = str.charCodeAt(pos);\n      if (code === 0x0A /* \\n */) { return result; }\n      if (code === 0x3C /* < */) { return result; }\n      if (code === 0x3E /* > */) {\n        result.pos = pos + 1;\n        result.str = unescapeAll(str.slice(start + 1, pos));\n        result.ok = true;\n        return result;\n      }\n      if (code === 0x5C /* \\ */ && pos + 1 < max) {\n        pos += 2;\n        continue;\n      }\n\n      pos++;\n    }\n\n    // no closing '>'\n    return result;\n  }\n\n  // this should be ... } else { ... branch\n\n  level = 0;\n  while (pos < max) {\n    code = str.charCodeAt(pos);\n\n    if (code === 0x20) { break; }\n\n    // ascii control characters\n    if (code < 0x20 || code === 0x7F) { break; }\n\n    if (code === 0x5C /* \\ */ && pos + 1 < max) {\n      if (str.charCodeAt(pos + 1) === 0x20) { break; }\n      pos += 2;\n      continue;\n    }\n\n    if (code === 0x28 /* ( */) {\n      level++;\n      if (level > 32) { return result; }\n    }\n\n    if (code === 0x29 /* ) */) {\n      if (level === 0) { break; }\n      level--;\n    }\n\n    pos++;\n  }\n\n  if (start === pos) { return result; }\n  if (level !== 0) { return result; }\n\n  result.str = unescapeAll(str.slice(start, pos));\n  result.lines = lines;\n  result.pos = pos;\n  result.ok = true;\n  return result;\n};\n","// Parse link title\n//\n'use strict';\n\n\nvar unescapeAll = require('../common/utils').unescapeAll;\n\n\nmodule.exports = function parseLinkTitle(str, pos, max) {\n  var code,\n      marker,\n      lines = 0,\n      start = pos,\n      result = {\n        ok: false,\n        pos: 0,\n        lines: 0,\n        str: ''\n      };\n\n  if (pos >= max) { return result; }\n\n  marker = str.charCodeAt(pos);\n\n  if (marker !== 0x22 /* \" */ && marker !== 0x27 /* ' */ && marker !== 0x28 /* ( */) { return result; }\n\n  pos++;\n\n  // if opening marker is \"(\", switch it to closing marker \")\"\n  if (marker === 0x28) { marker = 0x29; }\n\n  while (pos < max) {\n    code = str.charCodeAt(pos);\n    if (code === marker) {\n      result.pos = pos + 1;\n      result.lines = lines;\n      result.str = unescapeAll(str.slice(start + 1, pos));\n      result.ok = true;\n      return result;\n    } else if (code === 0x28 /* ( */ && marker === 0x29 /* ) */) {\n      return result;\n    } else if (code === 0x0A) {\n      lines++;\n    } else if (code === 0x5C /* \\ */ && pos + 1 < max) {\n      pos++;\n      if (str.charCodeAt(pos) === 0x0A) {\n        lines++;\n      }\n    }\n\n    pos++;\n  }\n\n  return result;\n};\n","/**\n * class Renderer\n *\n * Generates HTML from parsed token stream. Each instance has independent\n * copy of rules. Those can be rewritten with ease. Also, you can add new\n * rules if you create plugin and adds new token types.\n **/\n'use strict';\n\n\nvar assign          = require('./common/utils').assign;\nvar unescapeAll     = require('./common/utils').unescapeAll;\nvar escapeHtml      = require('./common/utils').escapeHtml;\n\n\n////////////////////////////////////////////////////////////////////////////////\n\nvar default_rules = {};\n\n\ndefault_rules.code_inline = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  return  '<code' + slf.renderAttrs(token) + '>' +\n          escapeHtml(tokens[idx].content) +\n          '</code>';\n};\n\n\ndefault_rules.code_block = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  return  '<pre' + slf.renderAttrs(token) + '><code>' +\n          escapeHtml(tokens[idx].content) +\n          '</code></pre>\\n';\n};\n\n\ndefault_rules.fence = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx],\n      info = token.info ? unescapeAll(token.info).trim() : '',\n      langName = '',\n      langAttrs = '',\n      highlighted, i, arr, tmpAttrs, tmpToken;\n\n  if (info) {\n    arr = info.split(/(\\s+)/g);\n    langName = arr[0];\n    langAttrs = arr.slice(2).join('');\n  }\n\n  if (options.highlight) {\n    highlighted = options.highlight(token.content, langName, langAttrs) || escapeHtml(token.content);\n  } else {\n    highlighted = escapeHtml(token.content);\n  }\n\n  if (highlighted.indexOf('<pre') === 0) {\n    return highlighted + '\\n';\n  }\n\n  // If language exists, inject class gently, without modifying original token.\n  // May be, one day we will add .deepClone() for token and simplify this part, but\n  // now we prefer to keep things local.\n  if (info) {\n    i        = token.attrIndex('class');\n    tmpAttrs = token.attrs ? token.attrs.slice() : [];\n\n    if (i < 0) {\n      tmpAttrs.push([ 'class', options.langPrefix + langName ]);\n    } else {\n      tmpAttrs[i] = tmpAttrs[i].slice();\n      tmpAttrs[i][1] += ' ' + options.langPrefix + langName;\n    }\n\n    // Fake token just to render attributes\n    tmpToken = {\n      attrs: tmpAttrs\n    };\n\n    return  '<pre><code' + slf.renderAttrs(tmpToken) + '>'\n          + highlighted\n          + '</code></pre>\\n';\n  }\n\n\n  return  '<pre><code' + slf.renderAttrs(token) + '>'\n        + highlighted\n        + '</code></pre>\\n';\n};\n\n\ndefault_rules.image = function (tokens, idx, options, env, slf) {\n  var token = tokens[idx];\n\n  // \"alt\" attr MUST be set, even if empty. Because it's mandatory and\n  // should be placed on proper position for tests.\n  //\n  // Replace content with actual value\n\n  token.attrs[token.attrIndex('alt')][1] =\n    slf.renderInlineAsText(token.children, options, env);\n\n  return slf.renderToken(tokens, idx, options);\n};\n\n\ndefault_rules.hardbreak = function (tokens, idx, options /*, env */) {\n  return options.xhtmlOut ? '<br />\\n' : '<br>\\n';\n};\ndefault_rules.softbreak = function (tokens, idx, options /*, env */) {\n  return options.breaks ? (options.xhtmlOut ? '<br />\\n' : '<br>\\n') : '\\n';\n};\n\n\ndefault_rules.text = function (tokens, idx /*, options, env */) {\n  return escapeHtml(tokens[idx].content);\n};\n\n\ndefault_rules.html_block = function (tokens, idx /*, options, env */) {\n  return tokens[idx].content;\n};\ndefault_rules.html_inline = function (tokens, idx /*, options, env */) {\n  return tokens[idx].content;\n};\n\n\n/**\n * new Renderer()\n *\n * Creates new [[Renderer]] instance and fill [[Renderer#rules]] with defaults.\n **/\nfunction Renderer() {\n\n  /**\n   * Renderer#rules -> Object\n   *\n   * Contains render rules for tokens. Can be updated and extended.\n   *\n   * ##### Example\n   *\n   * ```javascript\n   * var md = require('markdown-it')();\n   *\n   * md.renderer.rules.strong_open  = function () { return '<b>'; };\n   * md.renderer.rules.strong_close = function () { return '</b>'; };\n   *\n   * var result = md.renderInline(...);\n   * ```\n   *\n   * Each rule is called as independent static function with fixed signature:\n   *\n   * ```javascript\n   * function my_token_render(tokens, idx, options, env, renderer) {\n   *   // ...\n   *   return renderedHTML;\n   * }\n   * ```\n   *\n   * See [source code](https://github.com/markdown-it/markdown-it/blob/master/lib/renderer.js)\n   * for more details and examples.\n   **/\n  this.rules = assign({}, default_rules);\n}\n\n\n/**\n * Renderer.renderAttrs(token) -> String\n *\n * Render token attributes to string.\n **/\nRenderer.prototype.renderAttrs = function renderAttrs(token) {\n  var i, l, result;\n\n  if (!token.attrs) { return ''; }\n\n  result = '';\n\n  for (i = 0, l = token.attrs.length; i < l; i++) {\n    result += ' ' + escapeHtml(token.attrs[i][0]) + '=\"' + escapeHtml(token.attrs[i][1]) + '\"';\n  }\n\n  return result;\n};\n\n\n/**\n * Renderer.renderToken(tokens, idx, options) -> String\n * - tokens (Array): list of tokens\n * - idx (Numbed): token index to render\n * - options (Object): params of parser instance\n *\n * Default token renderer. Can be overriden by custom function\n * in [[Renderer#rules]].\n **/\nRenderer.prototype.renderToken = function renderToken(tokens, idx, options) {\n  var nextToken,\n      result = '',\n      needLf = false,\n      token = tokens[idx];\n\n  // Tight list paragraphs\n  if (token.hidden) {\n    return '';\n  }\n\n  // Insert a newline between hidden paragraph and subsequent opening\n  // block-level tag.\n  //\n  // For example, here we should insert a newline before blockquote:\n  //  - a\n  //    >\n  //\n  if (token.block && token.nesting !== -1 && idx && tokens[idx - 1].hidden) {\n    result += '\\n';\n  }\n\n  // Add token name, e.g. `<img`\n  result += (token.nesting === -1 ? '</' : '<') + token.tag;\n\n  // Encode attributes, e.g. `<img src=\"foo\"`\n  result += this.renderAttrs(token);\n\n  // Add a slash for self-closing tags, e.g. `<img src=\"foo\" /`\n  if (token.nesting === 0 && options.xhtmlOut) {\n    result += ' /';\n  }\n\n  // Check if we need to add a newline after this tag\n  if (token.block) {\n    needLf = true;\n\n    if (token.nesting === 1) {\n      if (idx + 1 < tokens.length) {\n        nextToken = tokens[idx + 1];\n\n        if (nextToken.type === 'inline' || nextToken.hidden) {\n          // Block-level tag containing an inline tag.\n          //\n          needLf = false;\n\n        } else if (nextToken.nesting === -1 && nextToken.tag === token.tag) {\n          // Opening tag + closing tag of the same type. E.g. `<li></li>`.\n          //\n          needLf = false;\n        }\n      }\n    }\n  }\n\n  result += needLf ? '>\\n' : '>';\n\n  return result;\n};\n\n\n/**\n * Renderer.renderInline(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to render\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * The same as [[Renderer.render]], but for single token of `inline` type.\n **/\nRenderer.prototype.renderInline = function (tokens, options, env) {\n  var type,\n      result = '',\n      rules = this.rules;\n\n  for (var i = 0, len = tokens.length; i < len; i++) {\n    type = tokens[i].type;\n\n    if (typeof rules[type] !== 'undefined') {\n      result += rules[type](tokens, i, options, env, this);\n    } else {\n      result += this.renderToken(tokens, i, options);\n    }\n  }\n\n  return result;\n};\n\n\n/** internal\n * Renderer.renderInlineAsText(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to render\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * Special kludge for image `alt` attributes to conform CommonMark spec.\n * Don't try to use it! Spec requires to show `alt` content with stripped markup,\n * instead of simple escaping.\n **/\nRenderer.prototype.renderInlineAsText = function (tokens, options, env) {\n  var result = '';\n\n  for (var i = 0, len = tokens.length; i < len; i++) {\n    if (tokens[i].type === 'text') {\n      result += tokens[i].content;\n    } else if (tokens[i].type === 'image') {\n      result += this.renderInlineAsText(tokens[i].children, options, env);\n    } else if (tokens[i].type === 'softbreak') {\n      result += '\\n';\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Renderer.render(tokens, options, env) -> String\n * - tokens (Array): list on block tokens to render\n * - options (Object): params of parser instance\n * - env (Object): additional data from parsed input (references, for example)\n *\n * Takes token stream and generates HTML. Probably, you will never need to call\n * this method directly.\n **/\nRenderer.prototype.render = function (tokens, options, env) {\n  var i, len, type,\n      result = '',\n      rules = this.rules;\n\n  for (i = 0, len = tokens.length; i < len; i++) {\n    type = tokens[i].type;\n\n    if (type === 'inline') {\n      result += this.renderInline(tokens[i].children, options, env);\n    } else if (typeof rules[type] !== 'undefined') {\n      result += rules[tokens[i].type](tokens, i, options, env, this);\n    } else {\n      result += this.renderToken(tokens, i, options, env);\n    }\n  }\n\n  return result;\n};\n\nmodule.exports = Renderer;\n","/** internal\n * class Core\n *\n * Top-level rules executor. Glues block/inline parsers and does intermediate\n * transformations.\n **/\n'use strict';\n\n\nvar Ruler  = require('./ruler');\n\n\nvar _rules = [\n  [ 'normalize',      require('./rules_core/normalize')      ],\n  [ 'block',          require('./rules_core/block')          ],\n  [ 'inline',         require('./rules_core/inline')         ],\n  [ 'linkify',        require('./rules_core/linkify')        ],\n  [ 'replacements',   require('./rules_core/replacements')   ],\n  [ 'smartquotes',    require('./rules_core/smartquotes')    ]\n];\n\n\n/**\n * new Core()\n **/\nfunction Core() {\n  /**\n   * Core#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of core rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (var i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1]);\n  }\n}\n\n\n/**\n * Core.process(state)\n *\n * Executes core chain rules.\n **/\nCore.prototype.process = function (state) {\n  var i, l, rules;\n\n  rules = this.ruler.getRules('');\n\n  for (i = 0, l = rules.length; i < l; i++) {\n    rules[i](state);\n  }\n};\n\nCore.prototype.State = require('./rules_core/state_core');\n\n\nmodule.exports = Core;\n","/**\n * class Ruler\n *\n * Helper class, used by [[MarkdownIt#core]], [[MarkdownIt#block]] and\n * [[MarkdownIt#inline]] to manage sequences of functions (rules):\n *\n * - keep rules in defined order\n * - assign the name to each rule\n * - enable/disable rules\n * - add/replace rules\n * - allow assign rules to additional named chains (in the same)\n * - cacheing lists of active rules\n *\n * You will not need use this class directly until write plugins. For simple\n * rules control use [[MarkdownIt.disable]], [[MarkdownIt.enable]] and\n * [[MarkdownIt.use]].\n **/\n'use strict';\n\n\n/**\n * new Ruler()\n **/\nfunction Ruler() {\n  // List of added rules. Each element is:\n  //\n  // {\n  //   name: XXX,\n  //   enabled: Boolean,\n  //   fn: Function(),\n  //   alt: [ name2, name3 ]\n  // }\n  //\n  this.__rules__ = [];\n\n  // Cached rule chains.\n  //\n  // First level - chain name, '' for default.\n  // Second level - diginal anchor for fast filtering by charcodes.\n  //\n  this.__cache__ = null;\n}\n\n////////////////////////////////////////////////////////////////////////////////\n// Helper methods, should not be used directly\n\n\n// Find rule index by name\n//\nRuler.prototype.__find__ = function (name) {\n  for (var i = 0; i < this.__rules__.length; i++) {\n    if (this.__rules__[i].name === name) {\n      return i;\n    }\n  }\n  return -1;\n};\n\n\n// Build rules lookup cache\n//\nRuler.prototype.__compile__ = function () {\n  var self = this;\n  var chains = [ '' ];\n\n  // collect unique names\n  self.__rules__.forEach(function (rule) {\n    if (!rule.enabled) { return; }\n\n    rule.alt.forEach(function (altName) {\n      if (chains.indexOf(altName) < 0) {\n        chains.push(altName);\n      }\n    });\n  });\n\n  self.__cache__ = {};\n\n  chains.forEach(function (chain) {\n    self.__cache__[chain] = [];\n    self.__rules__.forEach(function (rule) {\n      if (!rule.enabled) { return; }\n\n      if (chain && rule.alt.indexOf(chain) < 0) { return; }\n\n      self.__cache__[chain].push(rule.fn);\n    });\n  });\n};\n\n\n/**\n * Ruler.at(name, fn [, options])\n * - name (String): rule name to replace.\n * - fn (Function): new rule function.\n * - options (Object): new rule options (not mandatory).\n *\n * Replace rule by name with new function & options. Throws error if name not\n * found.\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * Replace existing typographer replacement rule with new one:\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.core.ruler.at('replacements', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.at = function (name, fn, options) {\n  var index = this.__find__(name);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + name); }\n\n  this.__rules__[index].fn = fn;\n  this.__rules__[index].alt = opt.alt || [];\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.before(beforeName, ruleName, fn [, options])\n * - beforeName (String): new rule will be added before this one.\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Add new rule to chain before one with given name. See also\n * [[Ruler.after]], [[Ruler.push]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.block.ruler.before('paragraph', 'my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.before = function (beforeName, ruleName, fn, options) {\n  var index = this.__find__(beforeName);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + beforeName); }\n\n  this.__rules__.splice(index, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.after(afterName, ruleName, fn [, options])\n * - afterName (String): new rule will be added after this one.\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Add new rule to chain after one with given name. See also\n * [[Ruler.before]], [[Ruler.push]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.inline.ruler.after('text', 'my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.after = function (afterName, ruleName, fn, options) {\n  var index = this.__find__(afterName);\n  var opt = options || {};\n\n  if (index === -1) { throw new Error('Parser rule not found: ' + afterName); }\n\n  this.__rules__.splice(index + 1, 0, {\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n/**\n * Ruler.push(ruleName, fn [, options])\n * - ruleName (String): name of added rule.\n * - fn (Function): rule function.\n * - options (Object): rule options (not mandatory).\n *\n * Push new rule to the end of chain. See also\n * [[Ruler.before]], [[Ruler.after]].\n *\n * ##### Options:\n *\n * - __alt__ - array with names of \"alternate\" chains.\n *\n * ##### Example\n *\n * ```javascript\n * var md = require('markdown-it')();\n *\n * md.core.ruler.push('my_rule', function replace(state) {\n *   //...\n * });\n * ```\n **/\nRuler.prototype.push = function (ruleName, fn, options) {\n  var opt = options || {};\n\n  this.__rules__.push({\n    name: ruleName,\n    enabled: true,\n    fn: fn,\n    alt: opt.alt || []\n  });\n\n  this.__cache__ = null;\n};\n\n\n/**\n * Ruler.enable(list [, ignoreInvalid]) -> Array\n * - list (String|Array): list of rule names to enable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable rules with given names. If any rule name not found - throw Error.\n * Errors can be disabled by second param.\n *\n * Returns list of found rule names (if no exception happened).\n *\n * See also [[Ruler.disable]], [[Ruler.enableOnly]].\n **/\nRuler.prototype.enable = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  var result = [];\n\n  // Search by name and enable\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n\n    if (idx < 0) {\n      if (ignoreInvalid) { return; }\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n    this.__rules__[idx].enabled = true;\n    result.push(name);\n  }, this);\n\n  this.__cache__ = null;\n  return result;\n};\n\n\n/**\n * Ruler.enableOnly(list [, ignoreInvalid])\n * - list (String|Array): list of rule names to enable (whitelist).\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Enable rules with given names, and disable everything else. If any rule name\n * not found - throw Error. Errors can be disabled by second param.\n *\n * See also [[Ruler.disable]], [[Ruler.enable]].\n **/\nRuler.prototype.enableOnly = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  this.__rules__.forEach(function (rule) { rule.enabled = false; });\n\n  this.enable(list, ignoreInvalid);\n};\n\n\n/**\n * Ruler.disable(list [, ignoreInvalid]) -> Array\n * - list (String|Array): list of rule names to disable.\n * - ignoreInvalid (Boolean): set `true` to ignore errors when rule not found.\n *\n * Disable rules with given names. If any rule name not found - throw Error.\n * Errors can be disabled by second param.\n *\n * Returns list of found rule names (if no exception happened).\n *\n * See also [[Ruler.enable]], [[Ruler.enableOnly]].\n **/\nRuler.prototype.disable = function (list, ignoreInvalid) {\n  if (!Array.isArray(list)) { list = [ list ]; }\n\n  var result = [];\n\n  // Search by name and disable\n  list.forEach(function (name) {\n    var idx = this.__find__(name);\n\n    if (idx < 0) {\n      if (ignoreInvalid) { return; }\n      throw new Error('Rules manager: invalid rule name ' + name);\n    }\n    this.__rules__[idx].enabled = false;\n    result.push(name);\n  }, this);\n\n  this.__cache__ = null;\n  return result;\n};\n\n\n/**\n * Ruler.getRules(chainName) -> Array\n *\n * Return array of active functions (rules) for given chain name. It analyzes\n * rules configuration, compiles caches if not exists and returns result.\n *\n * Default chain name is `''` (empty string). It can't be skipped. That's\n * done intentionally, to keep signature monomorphic for high speed.\n **/\nRuler.prototype.getRules = function (chainName) {\n  if (this.__cache__ === null) {\n    this.__compile__();\n  }\n\n  // Chain can be empty, if rules disabled. But we still have to return Array.\n  return this.__cache__[chainName] || [];\n};\n\nmodule.exports = Ruler;\n","// Normalize input string\n\n'use strict';\n\n\n// https://spec.commonmark.org/0.29/#line-ending\nvar NEWLINES_RE  = /\\r\\n?|\\n/g;\nvar NULL_RE      = /\\0/g;\n\n\nmodule.exports = function normalize(state) {\n  var str;\n\n  // Normalize newlines\n  str = state.src.replace(NEWLINES_RE, '\\n');\n\n  // Replace NULL characters\n  str = str.replace(NULL_RE, '\\uFFFD');\n\n  state.src = str;\n};\n","'use strict';\n\n\nmodule.exports = function block(state) {\n  var token;\n\n  if (state.inlineMode) {\n    token          = new state.Token('inline', '', 0);\n    token.content  = state.src;\n    token.map      = [ 0, 1 ];\n    token.children = [];\n    state.tokens.push(token);\n  } else {\n    state.md.block.parse(state.src, state.md, state.env, state.tokens);\n  }\n};\n","'use strict';\n\nmodule.exports = function inline(state) {\n  var tokens = state.tokens, tok, i, l;\n\n  // Parse inlines\n  for (i = 0, l = tokens.length; i < l; i++) {\n    tok = tokens[i];\n    if (tok.type === 'inline') {\n      state.md.inline.parse(tok.content, state.md, state.env, tok.children);\n    }\n  }\n};\n","// Replace link-like texts with link nodes.\n//\n// Currently restricted by `md.validateLink()` to http/https/ftp\n//\n'use strict';\n\n\nvar arrayReplaceAt = require('../common/utils').arrayReplaceAt;\n\n\nfunction isLinkOpen(str) {\n  return /^<a[>\\s]/i.test(str);\n}\nfunction isLinkClose(str) {\n  return /^<\\/a\\s*>/i.test(str);\n}\n\n\nmodule.exports = function linkify(state) {\n  var i, j, l, tokens, token, currentToken, nodes, ln, text, pos, lastPos,\n      level, htmlLinkLevel, url, fullUrl, urlText,\n      blockTokens = state.tokens,\n      links;\n\n  if (!state.md.options.linkify) { return; }\n\n  for (j = 0, l = blockTokens.length; j < l; j++) {\n    if (blockTokens[j].type !== 'inline' ||\n        !state.md.linkify.pretest(blockTokens[j].content)) {\n      continue;\n    }\n\n    tokens = blockTokens[j].children;\n\n    htmlLinkLevel = 0;\n\n    // We scan from the end, to keep position when new tags added.\n    // Use reversed logic in links start/end match\n    for (i = tokens.length - 1; i >= 0; i--) {\n      currentToken = tokens[i];\n\n      // Skip content of markdown links\n      if (currentToken.type === 'link_close') {\n        i--;\n        while (tokens[i].level !== currentToken.level && tokens[i].type !== 'link_open') {\n          i--;\n        }\n        continue;\n      }\n\n      // Skip content of html tag links\n      if (currentToken.type === 'html_inline') {\n        if (isLinkOpen(currentToken.content) && htmlLinkLevel > 0) {\n          htmlLinkLevel--;\n        }\n        if (isLinkClose(currentToken.content)) {\n          htmlLinkLevel++;\n        }\n      }\n      if (htmlLinkLevel > 0) { continue; }\n\n      if (currentToken.type === 'text' && state.md.linkify.test(currentToken.content)) {\n\n        text = currentToken.content;\n        links = state.md.linkify.match(text);\n\n        // Now split string to nodes\n        nodes = [];\n        level = currentToken.level;\n        lastPos = 0;\n\n        for (ln = 0; ln < links.length; ln++) {\n\n          url = links[ln].url;\n          fullUrl = state.md.normalizeLink(url);\n          if (!state.md.validateLink(fullUrl)) { continue; }\n\n          urlText = links[ln].text;\n\n          // Linkifier might send raw hostnames like \"example.com\", where url\n          // starts with domain name. So we prepend http:// in those cases,\n          // and remove it afterwards.\n          //\n          if (!links[ln].schema) {\n            urlText = state.md.normalizeLinkText('http://' + urlText).replace(/^http:\\/\\//, '');\n          } else if (links[ln].schema === 'mailto:' && !/^mailto:/i.test(urlText)) {\n            urlText = state.md.normalizeLinkText('mailto:' + urlText).replace(/^mailto:/, '');\n          } else {\n            urlText = state.md.normalizeLinkText(urlText);\n          }\n\n          pos = links[ln].index;\n\n          if (pos > lastPos) {\n            token         = new state.Token('text', '', 0);\n            token.content = text.slice(lastPos, pos);\n            token.level   = level;\n            nodes.push(token);\n          }\n\n          token         = new state.Token('link_open', 'a', 1);\n          token.attrs   = [ [ 'href', fullUrl ] ];\n          token.level   = level++;\n          token.markup  = 'linkify';\n          token.info    = 'auto';\n          nodes.push(token);\n\n          token         = new state.Token('text', '', 0);\n          token.content = urlText;\n          token.level   = level;\n          nodes.push(token);\n\n          token         = new state.Token('link_close', 'a', -1);\n          token.level   = --level;\n          token.markup  = 'linkify';\n          token.info    = 'auto';\n          nodes.push(token);\n\n          lastPos = links[ln].lastIndex;\n        }\n        if (lastPos < text.length) {\n          token         = new state.Token('text', '', 0);\n          token.content = text.slice(lastPos);\n          token.level   = level;\n          nodes.push(token);\n        }\n\n        // replace current node\n        blockTokens[j].children = tokens = arrayReplaceAt(tokens, i, nodes);\n      }\n    }\n  }\n};\n","// Simple typographic replacements\n//\n// (c) (C) → ©\n// (tm) (TM) → ™\n// (r) (R) → ®\n// +- → ±\n// (p) (P) -> §\n// ... → … (also ?.... → ?.., !.... → !..)\n// ???????? → ???, !!!!! → !!!, `,,` → `,`\n// -- → &ndash;, --- → &mdash;\n//\n'use strict';\n\n// TODO:\n// - fractionals 1/2, 1/4, 3/4 -> ½, ¼, ¾\n// - miltiplication 2 x 4 -> 2 × 4\n\nvar RARE_RE = /\\+-|\\.\\.|\\?\\?\\?\\?|!!!!|,,|--/;\n\n// Workaround for phantomjs - need regex without /g flag,\n// or root check will fail every second time\nvar SCOPED_ABBR_TEST_RE = /\\((c|tm|r|p)\\)/i;\n\nvar SCOPED_ABBR_RE = /\\((c|tm|r|p)\\)/ig;\nvar SCOPED_ABBR = {\n  c: '©',\n  r: '®',\n  p: '§',\n  tm: '™'\n};\n\nfunction replaceFn(match, name) {\n  return SCOPED_ABBR[name.toLowerCase()];\n}\n\nfunction replace_scoped(inlineTokens) {\n  var i, token, inside_autolink = 0;\n\n  for (i = inlineTokens.length - 1; i >= 0; i--) {\n    token = inlineTokens[i];\n\n    if (token.type === 'text' && !inside_autolink) {\n      token.content = token.content.replace(SCOPED_ABBR_RE, replaceFn);\n    }\n\n    if (token.type === 'link_open' && token.info === 'auto') {\n      inside_autolink--;\n    }\n\n    if (token.type === 'link_close' && token.info === 'auto') {\n      inside_autolink++;\n    }\n  }\n}\n\nfunction replace_rare(inlineTokens) {\n  var i, token, inside_autolink = 0;\n\n  for (i = inlineTokens.length - 1; i >= 0; i--) {\n    token = inlineTokens[i];\n\n    if (token.type === 'text' && !inside_autolink) {\n      if (RARE_RE.test(token.content)) {\n        token.content = token.content\n          .replace(/\\+-/g, '±')\n          // .., ..., ....... -> …\n          // but ?..... & !..... -> ?.. & !..\n          .replace(/\\.{2,}/g, '…').replace(/([?!])…/g, '$1..')\n          .replace(/([?!]){4,}/g, '$1$1$1').replace(/,{2,}/g, ',')\n          // em-dash\n          .replace(/(^|[^-])---(?=[^-]|$)/mg, '$1\\u2014')\n          // en-dash\n          .replace(/(^|\\s)--(?=\\s|$)/mg, '$1\\u2013')\n          .replace(/(^|[^-\\s])--(?=[^-\\s]|$)/mg, '$1\\u2013');\n      }\n    }\n\n    if (token.type === 'link_open' && token.info === 'auto') {\n      inside_autolink--;\n    }\n\n    if (token.type === 'link_close' && token.info === 'auto') {\n      inside_autolink++;\n    }\n  }\n}\n\n\nmodule.exports = function replace(state) {\n  var blkIdx;\n\n  if (!state.md.options.typographer) { return; }\n\n  for (blkIdx = state.tokens.length - 1; blkIdx >= 0; blkIdx--) {\n\n    if (state.tokens[blkIdx].type !== 'inline') { continue; }\n\n    if (SCOPED_ABBR_TEST_RE.test(state.tokens[blkIdx].content)) {\n      replace_scoped(state.tokens[blkIdx].children);\n    }\n\n    if (RARE_RE.test(state.tokens[blkIdx].content)) {\n      replace_rare(state.tokens[blkIdx].children);\n    }\n\n  }\n};\n","// Convert straight quotation marks to typographic ones\n//\n'use strict';\n\n\nvar isWhiteSpace   = require('../common/utils').isWhiteSpace;\nvar isPunctChar    = require('../common/utils').isPunctChar;\nvar isMdAsciiPunct = require('../common/utils').isMdAsciiPunct;\n\nvar QUOTE_TEST_RE = /['\"]/;\nvar QUOTE_RE = /['\"]/g;\nvar APOSTROPHE = '\\u2019'; /* ’ */\n\n\nfunction replaceAt(str, index, ch) {\n  return str.substr(0, index) + ch + str.substr(index + 1);\n}\n\nfunction process_inlines(tokens, state) {\n  var i, token, text, t, pos, max, thisLevel, item, lastChar, nextChar,\n      isLastPunctChar, isNextPunctChar, isLastWhiteSpace, isNextWhiteSpace,\n      canOpen, canClose, j, isSingle, stack, openQuote, closeQuote;\n\n  stack = [];\n\n  for (i = 0; i < tokens.length; i++) {\n    token = tokens[i];\n\n    thisLevel = tokens[i].level;\n\n    for (j = stack.length - 1; j >= 0; j--) {\n      if (stack[j].level <= thisLevel) { break; }\n    }\n    stack.length = j + 1;\n\n    if (token.type !== 'text') { continue; }\n\n    text = token.content;\n    pos = 0;\n    max = text.length;\n\n    /*eslint no-labels:0,block-scoped-var:0*/\n    OUTER:\n    while (pos < max) {\n      QUOTE_RE.lastIndex = pos;\n      t = QUOTE_RE.exec(text);\n      if (!t) { break; }\n\n      canOpen = canClose = true;\n      pos = t.index + 1;\n      isSingle = (t[0] === \"'\");\n\n      // Find previous character,\n      // default to space if it's the beginning of the line\n      //\n      lastChar = 0x20;\n\n      if (t.index - 1 >= 0) {\n        lastChar = text.charCodeAt(t.index - 1);\n      } else {\n        for (j = i - 1; j >= 0; j--) {\n          if (tokens[j].type === 'softbreak' || tokens[j].type === 'hardbreak') break; // lastChar defaults to 0x20\n          if (!tokens[j].content) continue; // should skip all tokens except 'text', 'html_inline' or 'code_inline'\n\n          lastChar = tokens[j].content.charCodeAt(tokens[j].content.length - 1);\n          break;\n        }\n      }\n\n      // Find next character,\n      // default to space if it's the end of the line\n      //\n      nextChar = 0x20;\n\n      if (pos < max) {\n        nextChar = text.charCodeAt(pos);\n      } else {\n        for (j = i + 1; j < tokens.length; j++) {\n          if (tokens[j].type === 'softbreak' || tokens[j].type === 'hardbreak') break; // nextChar defaults to 0x20\n          if (!tokens[j].content) continue; // should skip all tokens except 'text', 'html_inline' or 'code_inline'\n\n          nextChar = tokens[j].content.charCodeAt(0);\n          break;\n        }\n      }\n\n      isLastPunctChar = isMdAsciiPunct(lastChar) || isPunctChar(String.fromCharCode(lastChar));\n      isNextPunctChar = isMdAsciiPunct(nextChar) || isPunctChar(String.fromCharCode(nextChar));\n\n      isLastWhiteSpace = isWhiteSpace(lastChar);\n      isNextWhiteSpace = isWhiteSpace(nextChar);\n\n      if (isNextWhiteSpace) {\n        canOpen = false;\n      } else if (isNextPunctChar) {\n        if (!(isLastWhiteSpace || isLastPunctChar)) {\n          canOpen = false;\n        }\n      }\n\n      if (isLastWhiteSpace) {\n        canClose = false;\n      } else if (isLastPunctChar) {\n        if (!(isNextWhiteSpace || isNextPunctChar)) {\n          canClose = false;\n        }\n      }\n\n      if (nextChar === 0x22 /* \" */ && t[0] === '\"') {\n        if (lastChar >= 0x30 /* 0 */ && lastChar <= 0x39 /* 9 */) {\n          // special case: 1\"\" - count first quote as an inch\n          canClose = canOpen = false;\n        }\n      }\n\n      if (canOpen && canClose) {\n        // Replace quotes in the middle of punctuation sequence, but not\n        // in the middle of the words, i.e.:\n        //\n        // 1. foo \" bar \" baz - not replaced\n        // 2. foo-\"-bar-\"-baz - replaced\n        // 3. foo\"bar\"baz     - not replaced\n        //\n        canOpen = isLastPunctChar;\n        canClose = isNextPunctChar;\n      }\n\n      if (!canOpen && !canClose) {\n        // middle of word\n        if (isSingle) {\n          token.content = replaceAt(token.content, t.index, APOSTROPHE);\n        }\n        continue;\n      }\n\n      if (canClose) {\n        // this could be a closing quote, rewind the stack to get a match\n        for (j = stack.length - 1; j >= 0; j--) {\n          item = stack[j];\n          if (stack[j].level < thisLevel) { break; }\n          if (item.single === isSingle && stack[j].level === thisLevel) {\n            item = stack[j];\n\n            if (isSingle) {\n              openQuote = state.md.options.quotes[2];\n              closeQuote = state.md.options.quotes[3];\n            } else {\n              openQuote = state.md.options.quotes[0];\n              closeQuote = state.md.options.quotes[1];\n            }\n\n            // replace token.content *before* tokens[item.token].content,\n            // because, if they are pointing at the same token, replaceAt\n            // could mess up indices when quote length != 1\n            token.content = replaceAt(token.content, t.index, closeQuote);\n            tokens[item.token].content = replaceAt(\n              tokens[item.token].content, item.pos, openQuote);\n\n            pos += closeQuote.length - 1;\n            if (item.token === i) { pos += openQuote.length - 1; }\n\n            text = token.content;\n            max = text.length;\n\n            stack.length = j;\n            continue OUTER;\n          }\n        }\n      }\n\n      if (canOpen) {\n        stack.push({\n          token: i,\n          pos: t.index,\n          single: isSingle,\n          level: thisLevel\n        });\n      } else if (canClose && isSingle) {\n        token.content = replaceAt(token.content, t.index, APOSTROPHE);\n      }\n    }\n  }\n}\n\n\nmodule.exports = function smartquotes(state) {\n  /*eslint max-depth:0*/\n  var blkIdx;\n\n  if (!state.md.options.typographer) { return; }\n\n  for (blkIdx = state.tokens.length - 1; blkIdx >= 0; blkIdx--) {\n\n    if (state.tokens[blkIdx].type !== 'inline' ||\n        !QUOTE_TEST_RE.test(state.tokens[blkIdx].content)) {\n      continue;\n    }\n\n    process_inlines(state.tokens[blkIdx].children, state);\n  }\n};\n","// Core state object\n//\n'use strict';\n\nvar Token = require('../token');\n\n\nfunction StateCore(src, md, env) {\n  this.src = src;\n  this.env = env;\n  this.tokens = [];\n  this.inlineMode = false;\n  this.md = md; // link to parser instance\n}\n\n// re-export Token class to use in core rules\nStateCore.prototype.Token = Token;\n\n\nmodule.exports = StateCore;\n","// Token class\n\n'use strict';\n\n\n/**\n * class Token\n **/\n\n/**\n * new Token(type, tag, nesting)\n *\n * Create new token and fill passed properties.\n **/\nfunction Token(type, tag, nesting) {\n  /**\n   * Token#type -> String\n   *\n   * Type of the token (string, e.g. \"paragraph_open\")\n   **/\n  this.type     = type;\n\n  /**\n   * Token#tag -> String\n   *\n   * html tag name, e.g. \"p\"\n   **/\n  this.tag      = tag;\n\n  /**\n   * Token#attrs -> Array\n   *\n   * Html attributes. Format: `[ [ name1, value1 ], [ name2, value2 ] ]`\n   **/\n  this.attrs    = null;\n\n  /**\n   * Token#map -> Array\n   *\n   * Source map info. Format: `[ line_begin, line_end ]`\n   **/\n  this.map      = null;\n\n  /**\n   * Token#nesting -> Number\n   *\n   * Level change (number in {-1, 0, 1} set), where:\n   *\n   * -  `1` means the tag is opening\n   * -  `0` means the tag is self-closing\n   * - `-1` means the tag is closing\n   **/\n  this.nesting  = nesting;\n\n  /**\n   * Token#level -> Number\n   *\n   * nesting level, the same as `state.level`\n   **/\n  this.level    = 0;\n\n  /**\n   * Token#children -> Array\n   *\n   * An array of child nodes (inline and img tokens)\n   **/\n  this.children = null;\n\n  /**\n   * Token#content -> String\n   *\n   * In a case of self-closing tag (code, html, fence, etc.),\n   * it has contents of this tag.\n   **/\n  this.content  = '';\n\n  /**\n   * Token#markup -> String\n   *\n   * '*' or '_' for emphasis, fence string for fence, etc.\n   **/\n  this.markup   = '';\n\n  /**\n   * Token#info -> String\n   *\n   * Additional information:\n   *\n   * - Info string for \"fence\" tokens\n   * - The value \"auto\" for autolink \"link_open\" and \"link_close\" tokens\n   * - The string value of the item marker for ordered-list \"list_item_open\" tokens\n   **/\n  this.info     = '';\n\n  /**\n   * Token#meta -> Object\n   *\n   * A place for plugins to store an arbitrary data\n   **/\n  this.meta     = null;\n\n  /**\n   * Token#block -> Boolean\n   *\n   * True for block-level tokens, false for inline tokens.\n   * Used in renderer to calculate line breaks\n   **/\n  this.block    = false;\n\n  /**\n   * Token#hidden -> Boolean\n   *\n   * If it's true, ignore this element when rendering. Used for tight lists\n   * to hide paragraphs.\n   **/\n  this.hidden   = false;\n}\n\n\n/**\n * Token.attrIndex(name) -> Number\n *\n * Search attribute index by name.\n **/\nToken.prototype.attrIndex = function attrIndex(name) {\n  var attrs, i, len;\n\n  if (!this.attrs) { return -1; }\n\n  attrs = this.attrs;\n\n  for (i = 0, len = attrs.length; i < len; i++) {\n    if (attrs[i][0] === name) { return i; }\n  }\n  return -1;\n};\n\n\n/**\n * Token.attrPush(attrData)\n *\n * Add `[ name, value ]` attribute to list. Init attrs if necessary\n **/\nToken.prototype.attrPush = function attrPush(attrData) {\n  if (this.attrs) {\n    this.attrs.push(attrData);\n  } else {\n    this.attrs = [ attrData ];\n  }\n};\n\n\n/**\n * Token.attrSet(name, value)\n *\n * Set `name` attribute to `value`. Override old value if exists.\n **/\nToken.prototype.attrSet = function attrSet(name, value) {\n  var idx = this.attrIndex(name),\n      attrData = [ name, value ];\n\n  if (idx < 0) {\n    this.attrPush(attrData);\n  } else {\n    this.attrs[idx] = attrData;\n  }\n};\n\n\n/**\n * Token.attrGet(name)\n *\n * Get the value of attribute `name`, or null if it does not exist.\n **/\nToken.prototype.attrGet = function attrGet(name) {\n  var idx = this.attrIndex(name), value = null;\n  if (idx >= 0) {\n    value = this.attrs[idx][1];\n  }\n  return value;\n};\n\n\n/**\n * Token.attrJoin(name, value)\n *\n * Join value to existing attribute via space. Or create new attribute if not\n * exists. Useful to operate with token classes.\n **/\nToken.prototype.attrJoin = function attrJoin(name, value) {\n  var idx = this.attrIndex(name);\n\n  if (idx < 0) {\n    this.attrPush([ name, value ]);\n  } else {\n    this.attrs[idx][1] = this.attrs[idx][1] + ' ' + value;\n  }\n};\n\n\nmodule.exports = Token;\n","/** internal\n * class ParserBlock\n *\n * Block-level tokenizer.\n **/\n'use strict';\n\n\nvar Ruler           = require('./ruler');\n\n\nvar _rules = [\n  // First 2 params - rule name & source. Secondary array - list of rules,\n  // which can be terminated by this one.\n  [ 'table',      require('./rules_block/table'),      [ 'paragraph', 'reference' ] ],\n  [ 'code',       require('./rules_block/code') ],\n  [ 'fence',      require('./rules_block/fence'),      [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'blockquote', require('./rules_block/blockquote'), [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'hr',         require('./rules_block/hr'),         [ 'paragraph', 'reference', 'blockquote', 'list' ] ],\n  [ 'list',       require('./rules_block/list'),       [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'reference',  require('./rules_block/reference') ],\n  [ 'html_block', require('./rules_block/html_block'), [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'heading',    require('./rules_block/heading'),    [ 'paragraph', 'reference', 'blockquote' ] ],\n  [ 'lheading',   require('./rules_block/lheading') ],\n  [ 'paragraph',  require('./rules_block/paragraph') ]\n];\n\n\n/**\n * new ParserBlock()\n **/\nfunction ParserBlock() {\n  /**\n   * ParserBlock#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of block rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (var i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1], { alt: (_rules[i][2] || []).slice() });\n  }\n}\n\n\n// Generate tokens for input range\n//\nParserBlock.prototype.tokenize = function (state, startLine, endLine) {\n  var ok, i,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      line = startLine,\n      hasEmptyLines = false,\n      maxNesting = state.md.options.maxNesting;\n\n  while (line < endLine) {\n    state.line = line = state.skipEmptyLines(line);\n    if (line >= endLine) { break; }\n\n    // Termination condition for nested calls.\n    // Nested calls currently used for blockquotes & lists\n    if (state.sCount[line] < state.blkIndent) { break; }\n\n    // If nesting level exceeded - skip tail to the end. That's not ordinary\n    // situation and we should not care about content.\n    if (state.level >= maxNesting) {\n      state.line = endLine;\n      break;\n    }\n\n    // Try all possible rules.\n    // On success, rule should:\n    //\n    // - update `state.line`\n    // - update `state.tokens`\n    // - return true\n\n    for (i = 0; i < len; i++) {\n      ok = rules[i](state, line, endLine, false);\n      if (ok) { break; }\n    }\n\n    // set state.tight if we had an empty line before current tag\n    // i.e. latest empty line should not count\n    state.tight = !hasEmptyLines;\n\n    // paragraph might \"eat\" one newline after it in nested lists\n    if (state.isEmpty(state.line - 1)) {\n      hasEmptyLines = true;\n    }\n\n    line = state.line;\n\n    if (line < endLine && state.isEmpty(line)) {\n      hasEmptyLines = true;\n      line++;\n      state.line = line;\n    }\n  }\n};\n\n\n/**\n * ParserBlock.parse(str, md, env, outTokens)\n *\n * Process input string and push block tokens into `outTokens`\n **/\nParserBlock.prototype.parse = function (src, md, env, outTokens) {\n  var state;\n\n  if (!src) { return; }\n\n  state = new this.State(src, md, env, outTokens);\n\n  this.tokenize(state, state.line, state.lineMax);\n};\n\n\nParserBlock.prototype.State = require('./rules_block/state_block');\n\n\nmodule.exports = ParserBlock;\n","// GFM table, https://github.github.com/gfm/#tables-extension-\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nfunction getLine(state, line) {\n  var pos = state.bMarks[line] + state.tShift[line],\n      max = state.eMarks[line];\n\n  return state.src.substr(pos, max - pos);\n}\n\nfunction escapedSplit(str) {\n  var result = [],\n      pos = 0,\n      max = str.length,\n      ch,\n      isEscaped = false,\n      lastPos = 0,\n      current = '';\n\n  ch  = str.charCodeAt(pos);\n\n  while (pos < max) {\n    if (ch === 0x7c/* | */) {\n      if (!isEscaped) {\n        // pipe separating cells, '|'\n        result.push(current + str.substring(lastPos, pos));\n        current = '';\n        lastPos = pos + 1;\n      } else {\n        // escaped pipe, '\\|'\n        current += str.substring(lastPos, pos - 1);\n        lastPos = pos;\n      }\n    }\n\n    isEscaped = (ch === 0x5c/* \\ */);\n    pos++;\n\n    ch = str.charCodeAt(pos);\n  }\n\n  result.push(current + str.substring(lastPos));\n\n  return result;\n}\n\n\nmodule.exports = function table(state, startLine, endLine, silent) {\n  var ch, lineText, pos, i, l, nextLine, columns, columnCount, token,\n      aligns, t, tableLines, tbodyLines, oldParentType, terminate,\n      terminatorRules, firstCh, secondCh;\n\n  // should have at least two lines\n  if (startLine + 2 > endLine) { return false; }\n\n  nextLine = startLine + 1;\n\n  if (state.sCount[nextLine] < state.blkIndent) { return false; }\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[nextLine] - state.blkIndent >= 4) { return false; }\n\n  // first character of the second line should be '|', '-', ':',\n  // and no other characters are allowed but spaces;\n  // basically, this is the equivalent of /^[-:|][-:|\\s]*$/ regexp\n\n  pos = state.bMarks[nextLine] + state.tShift[nextLine];\n  if (pos >= state.eMarks[nextLine]) { return false; }\n\n  firstCh = state.src.charCodeAt(pos++);\n  if (firstCh !== 0x7C/* | */ && firstCh !== 0x2D/* - */ && firstCh !== 0x3A/* : */) { return false; }\n\n  if (pos >= state.eMarks[nextLine]) { return false; }\n\n  secondCh = state.src.charCodeAt(pos++);\n  if (secondCh !== 0x7C/* | */ && secondCh !== 0x2D/* - */ && secondCh !== 0x3A/* : */ && !isSpace(secondCh)) {\n    return false;\n  }\n\n  // if first character is '-', then second character must not be a space\n  // (due to parsing ambiguity with list)\n  if (firstCh === 0x2D/* - */ && isSpace(secondCh)) { return false; }\n\n  while (pos < state.eMarks[nextLine]) {\n    ch = state.src.charCodeAt(pos);\n\n    if (ch !== 0x7C/* | */ && ch !== 0x2D/* - */ && ch !== 0x3A/* : */ && !isSpace(ch)) { return false; }\n\n    pos++;\n  }\n\n  lineText = getLine(state, startLine + 1);\n\n  columns = lineText.split('|');\n  aligns = [];\n  for (i = 0; i < columns.length; i++) {\n    t = columns[i].trim();\n    if (!t) {\n      // allow empty columns before and after table, but not in between columns;\n      // e.g. allow ` |---| `, disallow ` ---||--- `\n      if (i === 0 || i === columns.length - 1) {\n        continue;\n      } else {\n        return false;\n      }\n    }\n\n    if (!/^:?-+:?$/.test(t)) { return false; }\n    if (t.charCodeAt(t.length - 1) === 0x3A/* : */) {\n      aligns.push(t.charCodeAt(0) === 0x3A/* : */ ? 'center' : 'right');\n    } else if (t.charCodeAt(0) === 0x3A/* : */) {\n      aligns.push('left');\n    } else {\n      aligns.push('');\n    }\n  }\n\n  lineText = getLine(state, startLine).trim();\n  if (lineText.indexOf('|') === -1) { return false; }\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n  columns = escapedSplit(lineText);\n  if (columns.length && columns[0] === '') columns.shift();\n  if (columns.length && columns[columns.length - 1] === '') columns.pop();\n\n  // header row will define an amount of columns in the entire table,\n  // and align row should be exactly the same (the rest of the rows can differ)\n  columnCount = columns.length;\n  if (columnCount === 0 || columnCount !== aligns.length) { return false; }\n\n  if (silent) { return true; }\n\n  oldParentType = state.parentType;\n  state.parentType = 'table';\n\n  // use 'blockquote' lists for termination because it's\n  // the most similar to tables\n  terminatorRules = state.md.block.ruler.getRules('blockquote');\n\n  token     = state.push('table_open', 'table', 1);\n  token.map = tableLines = [ startLine, 0 ];\n\n  token     = state.push('thead_open', 'thead', 1);\n  token.map = [ startLine, startLine + 1 ];\n\n  token     = state.push('tr_open', 'tr', 1);\n  token.map = [ startLine, startLine + 1 ];\n\n  for (i = 0; i < columns.length; i++) {\n    token          = state.push('th_open', 'th', 1);\n    if (aligns[i]) {\n      token.attrs  = [ [ 'style', 'text-align:' + aligns[i] ] ];\n    }\n\n    token          = state.push('inline', '', 0);\n    token.content  = columns[i].trim();\n    token.children = [];\n\n    token          = state.push('th_close', 'th', -1);\n  }\n\n  token     = state.push('tr_close', 'tr', -1);\n  token     = state.push('thead_close', 'thead', -1);\n\n  for (nextLine = startLine + 2; nextLine < endLine; nextLine++) {\n    if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n\n    if (terminate) { break; }\n    lineText = getLine(state, nextLine).trim();\n    if (!lineText) { break; }\n    if (state.sCount[nextLine] - state.blkIndent >= 4) { break; }\n    columns = escapedSplit(lineText);\n    if (columns.length && columns[0] === '') columns.shift();\n    if (columns.length && columns[columns.length - 1] === '') columns.pop();\n\n    if (nextLine === startLine + 2) {\n      token     = state.push('tbody_open', 'tbody', 1);\n      token.map = tbodyLines = [ startLine + 2, 0 ];\n    }\n\n    token     = state.push('tr_open', 'tr', 1);\n    token.map = [ nextLine, nextLine + 1 ];\n\n    for (i = 0; i < columnCount; i++) {\n      token          = state.push('td_open', 'td', 1);\n      if (aligns[i]) {\n        token.attrs  = [ [ 'style', 'text-align:' + aligns[i] ] ];\n      }\n\n      token          = state.push('inline', '', 0);\n      token.content  = columns[i] ? columns[i].trim() : '';\n      token.children = [];\n\n      token          = state.push('td_close', 'td', -1);\n    }\n    token = state.push('tr_close', 'tr', -1);\n  }\n\n  if (tbodyLines) {\n    token = state.push('tbody_close', 'tbody', -1);\n    tbodyLines[1] = nextLine;\n  }\n\n  token = state.push('table_close', 'table', -1);\n  tableLines[1] = nextLine;\n\n  state.parentType = oldParentType;\n  state.line = nextLine;\n  return true;\n};\n","// Code block (4 spaces padded)\n\n'use strict';\n\n\nmodule.exports = function code(state, startLine, endLine/*, silent*/) {\n  var nextLine, last, token;\n\n  if (state.sCount[startLine] - state.blkIndent < 4) { return false; }\n\n  last = nextLine = startLine + 1;\n\n  while (nextLine < endLine) {\n    if (state.isEmpty(nextLine)) {\n      nextLine++;\n      continue;\n    }\n\n    if (state.sCount[nextLine] - state.blkIndent >= 4) {\n      nextLine++;\n      last = nextLine;\n      continue;\n    }\n    break;\n  }\n\n  state.line = last;\n\n  token         = state.push('code_block', 'code', 0);\n  token.content = state.getLines(startLine, last, 4 + state.blkIndent, false) + '\\n';\n  token.map     = [ startLine, state.line ];\n\n  return true;\n};\n","// fences (``` lang, ~~~ lang)\n\n'use strict';\n\n\nmodule.exports = function fence(state, startLine, endLine, silent) {\n  var marker, len, params, nextLine, mem, token, markup,\n      haveEndMarker = false,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (pos + 3 > max) { return false; }\n\n  marker = state.src.charCodeAt(pos);\n\n  if (marker !== 0x7E/* ~ */ && marker !== 0x60 /* ` */) {\n    return false;\n  }\n\n  // scan marker length\n  mem = pos;\n  pos = state.skipChars(pos, marker);\n\n  len = pos - mem;\n\n  if (len < 3) { return false; }\n\n  markup = state.src.slice(mem, pos);\n  params = state.src.slice(pos, max);\n\n  if (marker === 0x60 /* ` */) {\n    if (params.indexOf(String.fromCharCode(marker)) >= 0) {\n      return false;\n    }\n  }\n\n  // Since start is found, we can report success here in validation mode\n  if (silent) { return true; }\n\n  // search end of block\n  nextLine = startLine;\n\n  for (;;) {\n    nextLine++;\n    if (nextLine >= endLine) {\n      // unclosed block should be autoclosed by end of document.\n      // also block seems to be autoclosed by end of parent\n      break;\n    }\n\n    pos = mem = state.bMarks[nextLine] + state.tShift[nextLine];\n    max = state.eMarks[nextLine];\n\n    if (pos < max && state.sCount[nextLine] < state.blkIndent) {\n      // non-empty line with negative indent should stop the list:\n      // - ```\n      //  test\n      break;\n    }\n\n    if (state.src.charCodeAt(pos) !== marker) { continue; }\n\n    if (state.sCount[nextLine] - state.blkIndent >= 4) {\n      // closing fence should be indented less than 4 spaces\n      continue;\n    }\n\n    pos = state.skipChars(pos, marker);\n\n    // closing code fence must be at least as long as the opening one\n    if (pos - mem < len) { continue; }\n\n    // make sure tail has spaces only\n    pos = state.skipSpaces(pos);\n\n    if (pos < max) { continue; }\n\n    haveEndMarker = true;\n    // found!\n    break;\n  }\n\n  // If a fence has heading spaces, they should be removed from its inner block\n  len = state.sCount[startLine];\n\n  state.line = nextLine + (haveEndMarker ? 1 : 0);\n\n  token         = state.push('fence', 'code', 0);\n  token.info    = params;\n  token.content = state.getLines(startLine + 1, nextLine, len, true);\n  token.markup  = markup;\n  token.map     = [ startLine, state.line ];\n\n  return true;\n};\n","// Block quotes\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function blockquote(state, startLine, endLine, silent) {\n  var adjustTab,\n      ch,\n      i,\n      initial,\n      l,\n      lastLineEmpty,\n      lines,\n      nextLine,\n      offset,\n      oldBMarks,\n      oldBSCount,\n      oldIndent,\n      oldParentType,\n      oldSCount,\n      oldTShift,\n      spaceAfterMarker,\n      terminate,\n      terminatorRules,\n      token,\n      isOutdented,\n      oldLineMax = state.lineMax,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  // check the block quote marker\n  if (state.src.charCodeAt(pos++) !== 0x3E/* > */) { return false; }\n\n  // we know that it's going to be a valid blockquote,\n  // so no point trying to find the end of it in silent mode\n  if (silent) { return true; }\n\n  // set offset past spaces and \">\"\n  initial = offset = state.sCount[startLine] + 1;\n\n  // skip one optional space after '>'\n  if (state.src.charCodeAt(pos) === 0x20 /* space */) {\n    // ' >   test '\n    //     ^ -- position start of line here:\n    pos++;\n    initial++;\n    offset++;\n    adjustTab = false;\n    spaceAfterMarker = true;\n  } else if (state.src.charCodeAt(pos) === 0x09 /* tab */) {\n    spaceAfterMarker = true;\n\n    if ((state.bsCount[startLine] + offset) % 4 === 3) {\n      // '  >\\t  test '\n      //       ^ -- position start of line here (tab has width===1)\n      pos++;\n      initial++;\n      offset++;\n      adjustTab = false;\n    } else {\n      // ' >\\t  test '\n      //    ^ -- position start of line here + shift bsCount slightly\n      //         to make extra space appear\n      adjustTab = true;\n    }\n  } else {\n    spaceAfterMarker = false;\n  }\n\n  oldBMarks = [ state.bMarks[startLine] ];\n  state.bMarks[startLine] = pos;\n\n  while (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (isSpace(ch)) {\n      if (ch === 0x09) {\n        offset += 4 - (offset + state.bsCount[startLine] + (adjustTab ? 1 : 0)) % 4;\n      } else {\n        offset++;\n      }\n    } else {\n      break;\n    }\n\n    pos++;\n  }\n\n  oldBSCount = [ state.bsCount[startLine] ];\n  state.bsCount[startLine] = state.sCount[startLine] + 1 + (spaceAfterMarker ? 1 : 0);\n\n  lastLineEmpty = pos >= max;\n\n  oldSCount = [ state.sCount[startLine] ];\n  state.sCount[startLine] = offset - initial;\n\n  oldTShift = [ state.tShift[startLine] ];\n  state.tShift[startLine] = pos - state.bMarks[startLine];\n\n  terminatorRules = state.md.block.ruler.getRules('blockquote');\n\n  oldParentType = state.parentType;\n  state.parentType = 'blockquote';\n\n  // Search the end of the block\n  //\n  // Block ends with either:\n  //  1. an empty line outside:\n  //     ```\n  //     > test\n  //\n  //     ```\n  //  2. an empty line inside:\n  //     ```\n  //     >\n  //     test\n  //     ```\n  //  3. another tag:\n  //     ```\n  //     > test\n  //      - - -\n  //     ```\n  for (nextLine = startLine + 1; nextLine < endLine; nextLine++) {\n    // check if it's outdented, i.e. it's inside list item and indented\n    // less than said list item:\n    //\n    // ```\n    // 1. anything\n    //    > current blockquote\n    // 2. checking this line\n    // ```\n    isOutdented = state.sCount[nextLine] < state.blkIndent;\n\n    pos = state.bMarks[nextLine] + state.tShift[nextLine];\n    max = state.eMarks[nextLine];\n\n    if (pos >= max) {\n      // Case 1: line is not inside the blockquote, and this line is empty.\n      break;\n    }\n\n    if (state.src.charCodeAt(pos++) === 0x3E/* > */ && !isOutdented) {\n      // This line is inside the blockquote.\n\n      // set offset past spaces and \">\"\n      initial = offset = state.sCount[nextLine] + 1;\n\n      // skip one optional space after '>'\n      if (state.src.charCodeAt(pos) === 0x20 /* space */) {\n        // ' >   test '\n        //     ^ -- position start of line here:\n        pos++;\n        initial++;\n        offset++;\n        adjustTab = false;\n        spaceAfterMarker = true;\n      } else if (state.src.charCodeAt(pos) === 0x09 /* tab */) {\n        spaceAfterMarker = true;\n\n        if ((state.bsCount[nextLine] + offset) % 4 === 3) {\n          // '  >\\t  test '\n          //       ^ -- position start of line here (tab has width===1)\n          pos++;\n          initial++;\n          offset++;\n          adjustTab = false;\n        } else {\n          // ' >\\t  test '\n          //    ^ -- position start of line here + shift bsCount slightly\n          //         to make extra space appear\n          adjustTab = true;\n        }\n      } else {\n        spaceAfterMarker = false;\n      }\n\n      oldBMarks.push(state.bMarks[nextLine]);\n      state.bMarks[nextLine] = pos;\n\n      while (pos < max) {\n        ch = state.src.charCodeAt(pos);\n\n        if (isSpace(ch)) {\n          if (ch === 0x09) {\n            offset += 4 - (offset + state.bsCount[nextLine] + (adjustTab ? 1 : 0)) % 4;\n          } else {\n            offset++;\n          }\n        } else {\n          break;\n        }\n\n        pos++;\n      }\n\n      lastLineEmpty = pos >= max;\n\n      oldBSCount.push(state.bsCount[nextLine]);\n      state.bsCount[nextLine] = state.sCount[nextLine] + 1 + (spaceAfterMarker ? 1 : 0);\n\n      oldSCount.push(state.sCount[nextLine]);\n      state.sCount[nextLine] = offset - initial;\n\n      oldTShift.push(state.tShift[nextLine]);\n      state.tShift[nextLine] = pos - state.bMarks[nextLine];\n      continue;\n    }\n\n    // Case 2: line is not inside the blockquote, and the last line was empty.\n    if (lastLineEmpty) { break; }\n\n    // Case 3: another tag found.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n\n    if (terminate) {\n      // Quirk to enforce \"hard termination mode\" for paragraphs;\n      // normally if you call `tokenize(state, startLine, nextLine)`,\n      // paragraphs will look below nextLine for paragraph continuation,\n      // but if blockquote is terminated by another tag, they shouldn't\n      state.lineMax = nextLine;\n\n      if (state.blkIndent !== 0) {\n        // state.blkIndent was non-zero, we now set it to zero,\n        // so we need to re-calculate all offsets to appear as\n        // if indent wasn't changed\n        oldBMarks.push(state.bMarks[nextLine]);\n        oldBSCount.push(state.bsCount[nextLine]);\n        oldTShift.push(state.tShift[nextLine]);\n        oldSCount.push(state.sCount[nextLine]);\n        state.sCount[nextLine] -= state.blkIndent;\n      }\n\n      break;\n    }\n\n    oldBMarks.push(state.bMarks[nextLine]);\n    oldBSCount.push(state.bsCount[nextLine]);\n    oldTShift.push(state.tShift[nextLine]);\n    oldSCount.push(state.sCount[nextLine]);\n\n    // A negative indentation means that this is a paragraph continuation\n    //\n    state.sCount[nextLine] = -1;\n  }\n\n  oldIndent = state.blkIndent;\n  state.blkIndent = 0;\n\n  token        = state.push('blockquote_open', 'blockquote', 1);\n  token.markup = '>';\n  token.map    = lines = [ startLine, 0 ];\n\n  state.md.block.tokenize(state, startLine, nextLine);\n\n  token        = state.push('blockquote_close', 'blockquote', -1);\n  token.markup = '>';\n\n  state.lineMax = oldLineMax;\n  state.parentType = oldParentType;\n  lines[1] = state.line;\n\n  // Restore original tShift; this might not be necessary since the parser\n  // has already been here, but just to make sure we can do that.\n  for (i = 0; i < oldTShift.length; i++) {\n    state.bMarks[i + startLine] = oldBMarks[i];\n    state.tShift[i + startLine] = oldTShift[i];\n    state.sCount[i + startLine] = oldSCount[i];\n    state.bsCount[i + startLine] = oldBSCount[i];\n  }\n  state.blkIndent = oldIndent;\n\n  return true;\n};\n","// Horizontal rule\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function hr(state, startLine, endLine, silent) {\n  var marker, cnt, ch, token,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  marker = state.src.charCodeAt(pos++);\n\n  // Check hr marker\n  if (marker !== 0x2A/* * */ &&\n      marker !== 0x2D/* - */ &&\n      marker !== 0x5F/* _ */) {\n    return false;\n  }\n\n  // markers can be mixed with spaces, but there should be at least 3 of them\n\n  cnt = 1;\n  while (pos < max) {\n    ch = state.src.charCodeAt(pos++);\n    if (ch !== marker && !isSpace(ch)) { return false; }\n    if (ch === marker) { cnt++; }\n  }\n\n  if (cnt < 3) { return false; }\n\n  if (silent) { return true; }\n\n  state.line = startLine + 1;\n\n  token        = state.push('hr', 'hr', 0);\n  token.map    = [ startLine, state.line ];\n  token.markup = Array(cnt + 1).join(String.fromCharCode(marker));\n\n  return true;\n};\n","// Lists\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\n// Search `[-+*][\\n ]`, returns next pos after marker on success\n// or -1 on fail.\nfunction skipBulletListMarker(state, startLine) {\n  var marker, pos, max, ch;\n\n  pos = state.bMarks[startLine] + state.tShift[startLine];\n  max = state.eMarks[startLine];\n\n  marker = state.src.charCodeAt(pos++);\n  // Check bullet\n  if (marker !== 0x2A/* * */ &&\n      marker !== 0x2D/* - */ &&\n      marker !== 0x2B/* + */) {\n    return -1;\n  }\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (!isSpace(ch)) {\n      // \" -test \" - is not a list item\n      return -1;\n    }\n  }\n\n  return pos;\n}\n\n// Search `\\d+[.)][\\n ]`, returns next pos after marker on success\n// or -1 on fail.\nfunction skipOrderedListMarker(state, startLine) {\n  var ch,\n      start = state.bMarks[startLine] + state.tShift[startLine],\n      pos = start,\n      max = state.eMarks[startLine];\n\n  // List marker should have at least 2 chars (digit + dot)\n  if (pos + 1 >= max) { return -1; }\n\n  ch = state.src.charCodeAt(pos++);\n\n  if (ch < 0x30/* 0 */ || ch > 0x39/* 9 */) { return -1; }\n\n  for (;;) {\n    // EOL -> fail\n    if (pos >= max) { return -1; }\n\n    ch = state.src.charCodeAt(pos++);\n\n    if (ch >= 0x30/* 0 */ && ch <= 0x39/* 9 */) {\n\n      // List marker should have no more than 9 digits\n      // (prevents integer overflow in browsers)\n      if (pos - start >= 10) { return -1; }\n\n      continue;\n    }\n\n    // found valid marker\n    if (ch === 0x29/* ) */ || ch === 0x2e/* . */) {\n      break;\n    }\n\n    return -1;\n  }\n\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (!isSpace(ch)) {\n      // \" 1.test \" - is not a list item\n      return -1;\n    }\n  }\n  return pos;\n}\n\nfunction markTightParagraphs(state, idx) {\n  var i, l,\n      level = state.level + 2;\n\n  for (i = idx + 2, l = state.tokens.length - 2; i < l; i++) {\n    if (state.tokens[i].level === level && state.tokens[i].type === 'paragraph_open') {\n      state.tokens[i + 2].hidden = true;\n      state.tokens[i].hidden = true;\n      i += 2;\n    }\n  }\n}\n\n\nmodule.exports = function list(state, startLine, endLine, silent) {\n  var ch,\n      contentStart,\n      i,\n      indent,\n      indentAfterMarker,\n      initial,\n      isOrdered,\n      itemLines,\n      l,\n      listLines,\n      listTokIdx,\n      markerCharCode,\n      markerValue,\n      max,\n      nextLine,\n      offset,\n      oldListIndent,\n      oldParentType,\n      oldSCount,\n      oldTShift,\n      oldTight,\n      pos,\n      posAfterMarker,\n      prevEmptyEnd,\n      start,\n      terminate,\n      terminatorRules,\n      token,\n      isTerminatingParagraph = false,\n      tight = true;\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  // Special case:\n  //  - item 1\n  //   - item 2\n  //    - item 3\n  //     - item 4\n  //      - this one is a paragraph continuation\n  if (state.listIndent >= 0 &&\n      state.sCount[startLine] - state.listIndent >= 4 &&\n      state.sCount[startLine] < state.blkIndent) {\n    return false;\n  }\n\n  // limit conditions when list can interrupt\n  // a paragraph (validation mode only)\n  if (silent && state.parentType === 'paragraph') {\n    // Next list item should still terminate previous list item;\n    //\n    // This code can fail if plugins use blkIndent as well as lists,\n    // but I hope the spec gets fixed long before that happens.\n    //\n    if (state.sCount[startLine] >= state.blkIndent) {\n      isTerminatingParagraph = true;\n    }\n  }\n\n  // Detect list type and position after marker\n  if ((posAfterMarker = skipOrderedListMarker(state, startLine)) >= 0) {\n    isOrdered = true;\n    start = state.bMarks[startLine] + state.tShift[startLine];\n    markerValue = Number(state.src.slice(start, posAfterMarker - 1));\n\n    // If we're starting a new ordered list right after\n    // a paragraph, it should start with 1.\n    if (isTerminatingParagraph && markerValue !== 1) return false;\n\n  } else if ((posAfterMarker = skipBulletListMarker(state, startLine)) >= 0) {\n    isOrdered = false;\n\n  } else {\n    return false;\n  }\n\n  // If we're starting a new unordered list right after\n  // a paragraph, first line should not be empty.\n  if (isTerminatingParagraph) {\n    if (state.skipSpaces(posAfterMarker) >= state.eMarks[startLine]) return false;\n  }\n\n  // We should terminate list on style change. Remember first one to compare.\n  markerCharCode = state.src.charCodeAt(posAfterMarker - 1);\n\n  // For validation mode we can terminate immediately\n  if (silent) { return true; }\n\n  // Start list\n  listTokIdx = state.tokens.length;\n\n  if (isOrdered) {\n    token       = state.push('ordered_list_open', 'ol', 1);\n    if (markerValue !== 1) {\n      token.attrs = [ [ 'start', markerValue ] ];\n    }\n\n  } else {\n    token       = state.push('bullet_list_open', 'ul', 1);\n  }\n\n  token.map    = listLines = [ startLine, 0 ];\n  token.markup = String.fromCharCode(markerCharCode);\n\n  //\n  // Iterate list items\n  //\n\n  nextLine = startLine;\n  prevEmptyEnd = false;\n  terminatorRules = state.md.block.ruler.getRules('list');\n\n  oldParentType = state.parentType;\n  state.parentType = 'list';\n\n  while (nextLine < endLine) {\n    pos = posAfterMarker;\n    max = state.eMarks[nextLine];\n\n    initial = offset = state.sCount[nextLine] + posAfterMarker - (state.bMarks[startLine] + state.tShift[startLine]);\n\n    while (pos < max) {\n      ch = state.src.charCodeAt(pos);\n\n      if (ch === 0x09) {\n        offset += 4 - (offset + state.bsCount[nextLine]) % 4;\n      } else if (ch === 0x20) {\n        offset++;\n      } else {\n        break;\n      }\n\n      pos++;\n    }\n\n    contentStart = pos;\n\n    if (contentStart >= max) {\n      // trimming space in \"-    \\n  3\" case, indent is 1 here\n      indentAfterMarker = 1;\n    } else {\n      indentAfterMarker = offset - initial;\n    }\n\n    // If we have more than 4 spaces, the indent is 1\n    // (the rest is just indented code block)\n    if (indentAfterMarker > 4) { indentAfterMarker = 1; }\n\n    // \"  -  test\"\n    //  ^^^^^ - calculating total length of this thing\n    indent = initial + indentAfterMarker;\n\n    // Run subparser & write tokens\n    token        = state.push('list_item_open', 'li', 1);\n    token.markup = String.fromCharCode(markerCharCode);\n    token.map    = itemLines = [ startLine, 0 ];\n    if (isOrdered) {\n      token.info = state.src.slice(start, posAfterMarker - 1);\n    }\n\n    // change current state, then restore it after parser subcall\n    oldTight = state.tight;\n    oldTShift = state.tShift[startLine];\n    oldSCount = state.sCount[startLine];\n\n    //  - example list\n    // ^ listIndent position will be here\n    //   ^ blkIndent position will be here\n    //\n    oldListIndent = state.listIndent;\n    state.listIndent = state.blkIndent;\n    state.blkIndent = indent;\n\n    state.tight = true;\n    state.tShift[startLine] = contentStart - state.bMarks[startLine];\n    state.sCount[startLine] = offset;\n\n    if (contentStart >= max && state.isEmpty(startLine + 1)) {\n      // workaround for this case\n      // (list item is empty, list terminates before \"foo\"):\n      // ~~~~~~~~\n      //   -\n      //\n      //     foo\n      // ~~~~~~~~\n      state.line = Math.min(state.line + 2, endLine);\n    } else {\n      state.md.block.tokenize(state, startLine, endLine, true);\n    }\n\n    // If any of list item is tight, mark list as tight\n    if (!state.tight || prevEmptyEnd) {\n      tight = false;\n    }\n    // Item become loose if finish with empty line,\n    // but we should filter last element, because it means list finish\n    prevEmptyEnd = (state.line - startLine) > 1 && state.isEmpty(state.line - 1);\n\n    state.blkIndent = state.listIndent;\n    state.listIndent = oldListIndent;\n    state.tShift[startLine] = oldTShift;\n    state.sCount[startLine] = oldSCount;\n    state.tight = oldTight;\n\n    token        = state.push('list_item_close', 'li', -1);\n    token.markup = String.fromCharCode(markerCharCode);\n\n    nextLine = startLine = state.line;\n    itemLines[1] = nextLine;\n    contentStart = state.bMarks[startLine];\n\n    if (nextLine >= endLine) { break; }\n\n    //\n    // Try to check if list is terminated or continued.\n    //\n    if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n    // if it's indented more than 3 spaces, it should be a code block\n    if (state.sCount[startLine] - state.blkIndent >= 4) { break; }\n\n    // fail if terminating block found\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n\n    // fail if list has another type\n    if (isOrdered) {\n      posAfterMarker = skipOrderedListMarker(state, nextLine);\n      if (posAfterMarker < 0) { break; }\n      start = state.bMarks[nextLine] + state.tShift[nextLine];\n    } else {\n      posAfterMarker = skipBulletListMarker(state, nextLine);\n      if (posAfterMarker < 0) { break; }\n    }\n\n    if (markerCharCode !== state.src.charCodeAt(posAfterMarker - 1)) { break; }\n  }\n\n  // Finalize list\n  if (isOrdered) {\n    token = state.push('ordered_list_close', 'ol', -1);\n  } else {\n    token = state.push('bullet_list_close', 'ul', -1);\n  }\n  token.markup = String.fromCharCode(markerCharCode);\n\n  listLines[1] = nextLine;\n  state.line = nextLine;\n\n  state.parentType = oldParentType;\n\n  // mark paragraphs tight if needed\n  if (tight) {\n    markTightParagraphs(state, listTokIdx);\n  }\n\n  return true;\n};\n","'use strict';\n\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function reference(state, startLine, _endLine, silent) {\n  var ch,\n      destEndPos,\n      destEndLineNo,\n      endLine,\n      href,\n      i,\n      l,\n      label,\n      labelEnd,\n      oldParentType,\n      res,\n      start,\n      str,\n      terminate,\n      terminatorRules,\n      title,\n      lines = 0,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine],\n      nextLine = startLine + 1;\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (state.src.charCodeAt(pos) !== 0x5B/* [ */) { return false; }\n\n  // Simple check to quickly interrupt scan on [link](url) at the start of line.\n  // Can be useful on practice: https://github.com/markdown-it/markdown-it/issues/54\n  while (++pos < max) {\n    if (state.src.charCodeAt(pos) === 0x5D /* ] */ &&\n        state.src.charCodeAt(pos - 1) !== 0x5C/* \\ */) {\n      if (pos + 1 === max) { return false; }\n      if (state.src.charCodeAt(pos + 1) !== 0x3A/* : */) { return false; }\n      break;\n    }\n  }\n\n  endLine = state.lineMax;\n\n  // jump line-by-line until empty one or EOF\n  terminatorRules = state.md.block.ruler.getRules('reference');\n\n  oldParentType = state.parentType;\n  state.parentType = 'reference';\n\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  str = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n  max = str.length;\n\n  for (pos = 1; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x5B /* [ */) {\n      return false;\n    } else if (ch === 0x5D /* ] */) {\n      labelEnd = pos;\n      break;\n    } else if (ch === 0x0A /* \\n */) {\n      lines++;\n    } else if (ch === 0x5C /* \\ */) {\n      pos++;\n      if (pos < max && str.charCodeAt(pos) === 0x0A) {\n        lines++;\n      }\n    }\n  }\n\n  if (labelEnd < 0 || str.charCodeAt(labelEnd + 1) !== 0x3A/* : */) { return false; }\n\n  // [label]:   destination   'title'\n  //         ^^^ skip optional whitespace here\n  for (pos = labelEnd + 2; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x0A) {\n      lines++;\n    } else if (isSpace(ch)) {\n      /*eslint no-empty:0*/\n    } else {\n      break;\n    }\n  }\n\n  // [label]:   destination   'title'\n  //            ^^^^^^^^^^^ parse this\n  res = state.md.helpers.parseLinkDestination(str, pos, max);\n  if (!res.ok) { return false; }\n\n  href = state.md.normalizeLink(res.str);\n  if (!state.md.validateLink(href)) { return false; }\n\n  pos = res.pos;\n  lines += res.lines;\n\n  // save cursor state, we could require to rollback later\n  destEndPos = pos;\n  destEndLineNo = lines;\n\n  // [label]:   destination   'title'\n  //                       ^^^ skipping those spaces\n  start = pos;\n  for (; pos < max; pos++) {\n    ch = str.charCodeAt(pos);\n    if (ch === 0x0A) {\n      lines++;\n    } else if (isSpace(ch)) {\n      /*eslint no-empty:0*/\n    } else {\n      break;\n    }\n  }\n\n  // [label]:   destination   'title'\n  //                          ^^^^^^^ parse this\n  res = state.md.helpers.parseLinkTitle(str, pos, max);\n  if (pos < max && start !== pos && res.ok) {\n    title = res.str;\n    pos = res.pos;\n    lines += res.lines;\n  } else {\n    title = '';\n    pos = destEndPos;\n    lines = destEndLineNo;\n  }\n\n  // skip trailing spaces until the rest of the line\n  while (pos < max) {\n    ch = str.charCodeAt(pos);\n    if (!isSpace(ch)) { break; }\n    pos++;\n  }\n\n  if (pos < max && str.charCodeAt(pos) !== 0x0A) {\n    if (title) {\n      // garbage at the end of the line after title,\n      // but it could still be a valid reference if we roll back\n      title = '';\n      pos = destEndPos;\n      lines = destEndLineNo;\n      while (pos < max) {\n        ch = str.charCodeAt(pos);\n        if (!isSpace(ch)) { break; }\n        pos++;\n      }\n    }\n  }\n\n  if (pos < max && str.charCodeAt(pos) !== 0x0A) {\n    // garbage at the end of the line\n    return false;\n  }\n\n  label = normalizeReference(str.slice(1, labelEnd));\n  if (!label) {\n    // CommonMark 0.20 disallows empty labels\n    return false;\n  }\n\n  // Reference can not terminate anything. This check is for safety only.\n  /*istanbul ignore if*/\n  if (silent) { return true; }\n\n  if (typeof state.env.references === 'undefined') {\n    state.env.references = {};\n  }\n  if (typeof state.env.references[label] === 'undefined') {\n    state.env.references[label] = { title: title, href: href };\n  }\n\n  state.parentType = oldParentType;\n\n  state.line = startLine + lines + 1;\n  return true;\n};\n","// HTML block\n\n'use strict';\n\n\nvar block_names = require('../common/html_blocks');\nvar HTML_OPEN_CLOSE_TAG_RE = require('../common/html_re').HTML_OPEN_CLOSE_TAG_RE;\n\n// An array of opening and corresponding closing sequences for html tags,\n// last argument defines whether it can terminate a paragraph or not\n//\nvar HTML_SEQUENCES = [\n  [ /^<(script|pre|style|textarea)(?=(\\s|>|$))/i, /<\\/(script|pre|style|textarea)>/i, true ],\n  [ /^<!--/,        /-->/,   true ],\n  [ /^<\\?/,         /\\?>/,   true ],\n  [ /^<![A-Z]/,     />/,     true ],\n  [ /^<!\\[CDATA\\[/, /\\]\\]>/, true ],\n  [ new RegExp('^</?(' + block_names.join('|') + ')(?=(\\\\s|/?>|$))', 'i'), /^$/, true ],\n  [ new RegExp(HTML_OPEN_CLOSE_TAG_RE.source + '\\\\s*$'),  /^$/, false ]\n];\n\n\nmodule.exports = function html_block(state, startLine, endLine, silent) {\n  var i, nextLine, token, lineText,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  if (!state.md.options.html) { return false; }\n\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */) { return false; }\n\n  lineText = state.src.slice(pos, max);\n\n  for (i = 0; i < HTML_SEQUENCES.length; i++) {\n    if (HTML_SEQUENCES[i][0].test(lineText)) { break; }\n  }\n\n  if (i === HTML_SEQUENCES.length) { return false; }\n\n  if (silent) {\n    // true if this sequence can be a terminator, false otherwise\n    return HTML_SEQUENCES[i][2];\n  }\n\n  nextLine = startLine + 1;\n\n  // If we are here - we detected HTML block.\n  // Let's roll down till block end.\n  if (!HTML_SEQUENCES[i][1].test(lineText)) {\n    for (; nextLine < endLine; nextLine++) {\n      if (state.sCount[nextLine] < state.blkIndent) { break; }\n\n      pos = state.bMarks[nextLine] + state.tShift[nextLine];\n      max = state.eMarks[nextLine];\n      lineText = state.src.slice(pos, max);\n\n      if (HTML_SEQUENCES[i][1].test(lineText)) {\n        if (lineText.length !== 0) { nextLine++; }\n        break;\n      }\n    }\n  }\n\n  state.line = nextLine;\n\n  token         = state.push('html_block', '', 0);\n  token.map     = [ startLine, nextLine ];\n  token.content = state.getLines(startLine, nextLine, state.blkIndent, true);\n\n  return true;\n};\n","// List of valid html blocks names, accorting to commonmark spec\n// http://jgm.github.io/CommonMark/spec.html#html-blocks\n\n'use strict';\n\n\nmodule.exports = [\n  'address',\n  'article',\n  'aside',\n  'base',\n  'basefont',\n  'blockquote',\n  'body',\n  'caption',\n  'center',\n  'col',\n  'colgroup',\n  'dd',\n  'details',\n  'dialog',\n  'dir',\n  'div',\n  'dl',\n  'dt',\n  'fieldset',\n  'figcaption',\n  'figure',\n  'footer',\n  'form',\n  'frame',\n  'frameset',\n  'h1',\n  'h2',\n  'h3',\n  'h4',\n  'h5',\n  'h6',\n  'head',\n  'header',\n  'hr',\n  'html',\n  'iframe',\n  'legend',\n  'li',\n  'link',\n  'main',\n  'menu',\n  'menuitem',\n  'nav',\n  'noframes',\n  'ol',\n  'optgroup',\n  'option',\n  'p',\n  'param',\n  'section',\n  'source',\n  'summary',\n  'table',\n  'tbody',\n  'td',\n  'tfoot',\n  'th',\n  'thead',\n  'title',\n  'tr',\n  'track',\n  'ul'\n];\n","// Regexps to match html elements\n\n'use strict';\n\nvar attr_name     = '[a-zA-Z_:][a-zA-Z0-9:._-]*';\n\nvar unquoted      = '[^\"\\'=<>`\\\\x00-\\\\x20]+';\nvar single_quoted = \"'[^']*'\";\nvar double_quoted = '\"[^\"]*\"';\n\nvar attr_value  = '(?:' + unquoted + '|' + single_quoted + '|' + double_quoted + ')';\n\nvar attribute   = '(?:\\\\s+' + attr_name + '(?:\\\\s*=\\\\s*' + attr_value + ')?)';\n\nvar open_tag    = '<[A-Za-z][A-Za-z0-9\\\\-]*' + attribute + '*\\\\s*\\\\/?>';\n\nvar close_tag   = '<\\\\/[A-Za-z][A-Za-z0-9\\\\-]*\\\\s*>';\nvar comment     = '<!---->|<!--(?:-?[^>-])(?:-?[^-])*-->';\nvar processing  = '<[?][\\\\s\\\\S]*?[?]>';\nvar declaration = '<![A-Z]+\\\\s+[^>]*>';\nvar cdata       = '<!\\\\[CDATA\\\\[[\\\\s\\\\S]*?\\\\]\\\\]>';\n\nvar HTML_TAG_RE = new RegExp('^(?:' + open_tag + '|' + close_tag + '|' + comment +\n                        '|' + processing + '|' + declaration + '|' + cdata + ')');\nvar HTML_OPEN_CLOSE_TAG_RE = new RegExp('^(?:' + open_tag + '|' + close_tag + ')');\n\nmodule.exports.HTML_TAG_RE = HTML_TAG_RE;\nmodule.exports.HTML_OPEN_CLOSE_TAG_RE = HTML_OPEN_CLOSE_TAG_RE;\n","// heading (#, ##, ...)\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function heading(state, startLine, endLine, silent) {\n  var ch, level, tmp, token,\n      pos = state.bMarks[startLine] + state.tShift[startLine],\n      max = state.eMarks[startLine];\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  ch  = state.src.charCodeAt(pos);\n\n  if (ch !== 0x23/* # */ || pos >= max) { return false; }\n\n  // count heading level\n  level = 1;\n  ch = state.src.charCodeAt(++pos);\n  while (ch === 0x23/* # */ && pos < max && level <= 6) {\n    level++;\n    ch = state.src.charCodeAt(++pos);\n  }\n\n  if (level > 6 || (pos < max && !isSpace(ch))) { return false; }\n\n  if (silent) { return true; }\n\n  // Let's cut tails like '    ###  ' from the end of string\n\n  max = state.skipSpacesBack(max, pos);\n  tmp = state.skipCharsBack(max, 0x23, pos); // #\n  if (tmp > pos && isSpace(state.src.charCodeAt(tmp - 1))) {\n    max = tmp;\n  }\n\n  state.line = startLine + 1;\n\n  token        = state.push('heading_open', 'h' + String(level), 1);\n  token.markup = '########'.slice(0, level);\n  token.map    = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = state.src.slice(pos, max).trim();\n  token.map      = [ startLine, state.line ];\n  token.children = [];\n\n  token        = state.push('heading_close', 'h' + String(level), -1);\n  token.markup = '########'.slice(0, level);\n\n  return true;\n};\n","// lheading (---, ===)\n\n'use strict';\n\n\nmodule.exports = function lheading(state, startLine, endLine/*, silent*/) {\n  var content, terminate, i, l, token, pos, max, level, marker,\n      nextLine = startLine + 1, oldParentType,\n      terminatorRules = state.md.block.ruler.getRules('paragraph');\n\n  // if it's indented more than 3 spaces, it should be a code block\n  if (state.sCount[startLine] - state.blkIndent >= 4) { return false; }\n\n  oldParentType = state.parentType;\n  state.parentType = 'paragraph'; // use paragraph to match terminatorRules\n\n  // jump line-by-line until empty one or EOF\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    //\n    // Check for underline in setext header\n    //\n    if (state.sCount[nextLine] >= state.blkIndent) {\n      pos = state.bMarks[nextLine] + state.tShift[nextLine];\n      max = state.eMarks[nextLine];\n\n      if (pos < max) {\n        marker = state.src.charCodeAt(pos);\n\n        if (marker === 0x2D/* - */ || marker === 0x3D/* = */) {\n          pos = state.skipChars(pos, marker);\n          pos = state.skipSpaces(pos);\n\n          if (pos >= max) {\n            level = (marker === 0x3D/* = */ ? 1 : 2);\n            break;\n          }\n        }\n      }\n    }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  if (!level) {\n    // Didn't find valid underline\n    return false;\n  }\n\n  content = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n\n  state.line = nextLine + 1;\n\n  token          = state.push('heading_open', 'h' + String(level), 1);\n  token.markup   = String.fromCharCode(marker);\n  token.map      = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = content;\n  token.map      = [ startLine, state.line - 1 ];\n  token.children = [];\n\n  token          = state.push('heading_close', 'h' + String(level), -1);\n  token.markup   = String.fromCharCode(marker);\n\n  state.parentType = oldParentType;\n\n  return true;\n};\n","// Paragraph\n\n'use strict';\n\n\nmodule.exports = function paragraph(state, startLine/*, endLine*/) {\n  var content, terminate, i, l, token, oldParentType,\n      nextLine = startLine + 1,\n      terminatorRules = state.md.block.ruler.getRules('paragraph'),\n      endLine = state.lineMax;\n\n  oldParentType = state.parentType;\n  state.parentType = 'paragraph';\n\n  // jump line-by-line until empty one or EOF\n  for (; nextLine < endLine && !state.isEmpty(nextLine); nextLine++) {\n    // this would be a code block normally, but after paragraph\n    // it's considered a lazy continuation regardless of what's there\n    if (state.sCount[nextLine] - state.blkIndent > 3) { continue; }\n\n    // quirk for blockquotes, this line should already be checked by that rule\n    if (state.sCount[nextLine] < 0) { continue; }\n\n    // Some tags can terminate paragraph without empty line.\n    terminate = false;\n    for (i = 0, l = terminatorRules.length; i < l; i++) {\n      if (terminatorRules[i](state, nextLine, endLine, true)) {\n        terminate = true;\n        break;\n      }\n    }\n    if (terminate) { break; }\n  }\n\n  content = state.getLines(startLine, nextLine, state.blkIndent, false).trim();\n\n  state.line = nextLine;\n\n  token          = state.push('paragraph_open', 'p', 1);\n  token.map      = [ startLine, state.line ];\n\n  token          = state.push('inline', '', 0);\n  token.content  = content;\n  token.map      = [ startLine, state.line ];\n  token.children = [];\n\n  token          = state.push('paragraph_close', 'p', -1);\n\n  state.parentType = oldParentType;\n\n  return true;\n};\n","// Parser state class\n\n'use strict';\n\nvar Token = require('../token');\nvar isSpace = require('../common/utils').isSpace;\n\n\nfunction StateBlock(src, md, env, tokens) {\n  var ch, s, start, pos, len, indent, offset, indent_found;\n\n  this.src = src;\n\n  // link to parser instance\n  this.md     = md;\n\n  this.env = env;\n\n  //\n  // Internal state vartiables\n  //\n\n  this.tokens = tokens;\n\n  this.bMarks = [];  // line begin offsets for fast jumps\n  this.eMarks = [];  // line end offsets for fast jumps\n  this.tShift = [];  // offsets of the first non-space characters (tabs not expanded)\n  this.sCount = [];  // indents for each line (tabs expanded)\n\n  // An amount of virtual spaces (tabs expanded) between beginning\n  // of each line (bMarks) and real beginning of that line.\n  //\n  // It exists only as a hack because blockquotes override bMarks\n  // losing information in the process.\n  //\n  // It's used only when expanding tabs, you can think about it as\n  // an initial tab length, e.g. bsCount=21 applied to string `\\t123`\n  // means first tab should be expanded to 4-21%4 === 3 spaces.\n  //\n  this.bsCount = [];\n\n  // block parser variables\n  this.blkIndent  = 0; // required block content indent (for example, if we are\n                       // inside a list, it would be positioned after list marker)\n  this.line       = 0; // line index in src\n  this.lineMax    = 0; // lines count\n  this.tight      = false;  // loose/tight mode for lists\n  this.ddIndent   = -1; // indent of the current dd block (-1 if there isn't any)\n  this.listIndent = -1; // indent of the current list block (-1 if there isn't any)\n\n  // can be 'blockquote', 'list', 'root', 'paragraph' or 'reference'\n  // used in lists to determine if they interrupt a paragraph\n  this.parentType = 'root';\n\n  this.level = 0;\n\n  // renderer\n  this.result = '';\n\n  // Create caches\n  // Generate markers.\n  s = this.src;\n  indent_found = false;\n\n  for (start = pos = indent = offset = 0, len = s.length; pos < len; pos++) {\n    ch = s.charCodeAt(pos);\n\n    if (!indent_found) {\n      if (isSpace(ch)) {\n        indent++;\n\n        if (ch === 0x09) {\n          offset += 4 - offset % 4;\n        } else {\n          offset++;\n        }\n        continue;\n      } else {\n        indent_found = true;\n      }\n    }\n\n    if (ch === 0x0A || pos === len - 1) {\n      if (ch !== 0x0A) { pos++; }\n      this.bMarks.push(start);\n      this.eMarks.push(pos);\n      this.tShift.push(indent);\n      this.sCount.push(offset);\n      this.bsCount.push(0);\n\n      indent_found = false;\n      indent = 0;\n      offset = 0;\n      start = pos + 1;\n    }\n  }\n\n  // Push fake entry to simplify cache bounds checks\n  this.bMarks.push(s.length);\n  this.eMarks.push(s.length);\n  this.tShift.push(0);\n  this.sCount.push(0);\n  this.bsCount.push(0);\n\n  this.lineMax = this.bMarks.length - 1; // don't count last fake line\n}\n\n// Push new token to \"stream\".\n//\nStateBlock.prototype.push = function (type, tag, nesting) {\n  var token = new Token(type, tag, nesting);\n  token.block = true;\n\n  if (nesting < 0) this.level--; // closing tag\n  token.level = this.level;\n  if (nesting > 0) this.level++; // opening tag\n\n  this.tokens.push(token);\n  return token;\n};\n\nStateBlock.prototype.isEmpty = function isEmpty(line) {\n  return this.bMarks[line] + this.tShift[line] >= this.eMarks[line];\n};\n\nStateBlock.prototype.skipEmptyLines = function skipEmptyLines(from) {\n  for (var max = this.lineMax; from < max; from++) {\n    if (this.bMarks[from] + this.tShift[from] < this.eMarks[from]) {\n      break;\n    }\n  }\n  return from;\n};\n\n// Skip spaces from given position.\nStateBlock.prototype.skipSpaces = function skipSpaces(pos) {\n  var ch;\n\n  for (var max = this.src.length; pos < max; pos++) {\n    ch = this.src.charCodeAt(pos);\n    if (!isSpace(ch)) { break; }\n  }\n  return pos;\n};\n\n// Skip spaces from given position in reverse.\nStateBlock.prototype.skipSpacesBack = function skipSpacesBack(pos, min) {\n  if (pos <= min) { return pos; }\n\n  while (pos > min) {\n    if (!isSpace(this.src.charCodeAt(--pos))) { return pos + 1; }\n  }\n  return pos;\n};\n\n// Skip char codes from given position\nStateBlock.prototype.skipChars = function skipChars(pos, code) {\n  for (var max = this.src.length; pos < max; pos++) {\n    if (this.src.charCodeAt(pos) !== code) { break; }\n  }\n  return pos;\n};\n\n// Skip char codes reverse from given position - 1\nStateBlock.prototype.skipCharsBack = function skipCharsBack(pos, code, min) {\n  if (pos <= min) { return pos; }\n\n  while (pos > min) {\n    if (code !== this.src.charCodeAt(--pos)) { return pos + 1; }\n  }\n  return pos;\n};\n\n// cut lines range from source.\nStateBlock.prototype.getLines = function getLines(begin, end, indent, keepLastLF) {\n  var i, lineIndent, ch, first, last, queue, lineStart,\n      line = begin;\n\n  if (begin >= end) {\n    return '';\n  }\n\n  queue = new Array(end - begin);\n\n  for (i = 0; line < end; line++, i++) {\n    lineIndent = 0;\n    lineStart = first = this.bMarks[line];\n\n    if (line + 1 < end || keepLastLF) {\n      // No need for bounds check because we have fake entry on tail.\n      last = this.eMarks[line] + 1;\n    } else {\n      last = this.eMarks[line];\n    }\n\n    while (first < last && lineIndent < indent) {\n      ch = this.src.charCodeAt(first);\n\n      if (isSpace(ch)) {\n        if (ch === 0x09) {\n          lineIndent += 4 - (lineIndent + this.bsCount[line]) % 4;\n        } else {\n          lineIndent++;\n        }\n      } else if (first - lineStart < this.tShift[line]) {\n        // patched tShift masked characters to look like spaces (blockquotes, list markers)\n        lineIndent++;\n      } else {\n        break;\n      }\n\n      first++;\n    }\n\n    if (lineIndent > indent) {\n      // partially expanding tabs in code blocks, e.g '\\t\\tfoobar'\n      // with indent=2 becomes '  \\tfoobar'\n      queue[i] = new Array(lineIndent - indent + 1).join(' ') + this.src.slice(first, last);\n    } else {\n      queue[i] = this.src.slice(first, last);\n    }\n  }\n\n  return queue.join('');\n};\n\n// re-export Token class to use in block rules\nStateBlock.prototype.Token = Token;\n\n\nmodule.exports = StateBlock;\n","/** internal\n * class ParserInline\n *\n * Tokenizes paragraph content.\n **/\n'use strict';\n\n\nvar Ruler           = require('./ruler');\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Parser rules\n\nvar _rules = [\n  [ 'text',            require('./rules_inline/text') ],\n  [ 'newline',         require('./rules_inline/newline') ],\n  [ 'escape',          require('./rules_inline/escape') ],\n  [ 'backticks',       require('./rules_inline/backticks') ],\n  [ 'strikethrough',   require('./rules_inline/strikethrough').tokenize ],\n  [ 'emphasis',        require('./rules_inline/emphasis').tokenize ],\n  [ 'link',            require('./rules_inline/link') ],\n  [ 'image',           require('./rules_inline/image') ],\n  [ 'autolink',        require('./rules_inline/autolink') ],\n  [ 'html_inline',     require('./rules_inline/html_inline') ],\n  [ 'entity',          require('./rules_inline/entity') ]\n];\n\nvar _rules2 = [\n  [ 'balance_pairs',   require('./rules_inline/balance_pairs') ],\n  [ 'strikethrough',   require('./rules_inline/strikethrough').postProcess ],\n  [ 'emphasis',        require('./rules_inline/emphasis').postProcess ],\n  [ 'text_collapse',   require('./rules_inline/text_collapse') ]\n];\n\n\n/**\n * new ParserInline()\n **/\nfunction ParserInline() {\n  var i;\n\n  /**\n   * ParserInline#ruler -> Ruler\n   *\n   * [[Ruler]] instance. Keep configuration of inline rules.\n   **/\n  this.ruler = new Ruler();\n\n  for (i = 0; i < _rules.length; i++) {\n    this.ruler.push(_rules[i][0], _rules[i][1]);\n  }\n\n  /**\n   * ParserInline#ruler2 -> Ruler\n   *\n   * [[Ruler]] instance. Second ruler used for post-processing\n   * (e.g. in emphasis-like rules).\n   **/\n  this.ruler2 = new Ruler();\n\n  for (i = 0; i < _rules2.length; i++) {\n    this.ruler2.push(_rules2[i][0], _rules2[i][1]);\n  }\n}\n\n\n// Skip single token by running all rules in validation mode;\n// returns `true` if any rule reported success\n//\nParserInline.prototype.skipToken = function (state) {\n  var ok, i, pos = state.pos,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      maxNesting = state.md.options.maxNesting,\n      cache = state.cache;\n\n\n  if (typeof cache[pos] !== 'undefined') {\n    state.pos = cache[pos];\n    return;\n  }\n\n  if (state.level < maxNesting) {\n    for (i = 0; i < len; i++) {\n      // Increment state.level and decrement it later to limit recursion.\n      // It's harmless to do here, because no tokens are created. But ideally,\n      // we'd need a separate private state variable for this purpose.\n      //\n      state.level++;\n      ok = rules[i](state, true);\n      state.level--;\n\n      if (ok) { break; }\n    }\n  } else {\n    // Too much nesting, just skip until the end of the paragraph.\n    //\n    // NOTE: this will cause links to behave incorrectly in the following case,\n    //       when an amount of `[` is exactly equal to `maxNesting + 1`:\n    //\n    //       [[[[[[[[[[[[[[[[[[[[[foo]()\n    //\n    // TODO: remove this workaround when CM standard will allow nested links\n    //       (we can replace it by preventing links from being parsed in\n    //       validation mode)\n    //\n    state.pos = state.posMax;\n  }\n\n  if (!ok) { state.pos++; }\n  cache[pos] = state.pos;\n};\n\n\n// Generate tokens for input range\n//\nParserInline.prototype.tokenize = function (state) {\n  var ok, i,\n      rules = this.ruler.getRules(''),\n      len = rules.length,\n      end = state.posMax,\n      maxNesting = state.md.options.maxNesting;\n\n  while (state.pos < end) {\n    // Try all possible rules.\n    // On success, rule should:\n    //\n    // - update `state.pos`\n    // - update `state.tokens`\n    // - return true\n\n    if (state.level < maxNesting) {\n      for (i = 0; i < len; i++) {\n        ok = rules[i](state, false);\n        if (ok) { break; }\n      }\n    }\n\n    if (ok) {\n      if (state.pos >= end) { break; }\n      continue;\n    }\n\n    state.pending += state.src[state.pos++];\n  }\n\n  if (state.pending) {\n    state.pushPending();\n  }\n};\n\n\n/**\n * ParserInline.parse(str, md, env, outTokens)\n *\n * Process input string and push inline tokens into `outTokens`\n **/\nParserInline.prototype.parse = function (str, md, env, outTokens) {\n  var i, rules, len;\n  var state = new this.State(str, md, env, outTokens);\n\n  this.tokenize(state);\n\n  rules = this.ruler2.getRules('');\n  len = rules.length;\n\n  for (i = 0; i < len; i++) {\n    rules[i](state);\n  }\n};\n\n\nParserInline.prototype.State = require('./rules_inline/state_inline');\n\n\nmodule.exports = ParserInline;\n","// Skip text characters for text token, place those to pending buffer\n// and increment current pos\n\n'use strict';\n\n\n// Rule to skip pure text\n// '{}$%@~+=:' reserved for extentions\n\n// !, \", #, $, %, &, ', (, ), *, +, ,, -, ., /, :, ;, <, =, >, ?, @, [, \\, ], ^, _, `, {, |, }, or ~\n\n// !!!! Don't confuse with \"Markdown ASCII Punctuation\" chars\n// http://spec.commonmark.org/0.15/#ascii-punctuation-character\nfunction isTerminatorChar(ch) {\n  switch (ch) {\n    case 0x0A/* \\n */:\n    case 0x21/* ! */:\n    case 0x23/* # */:\n    case 0x24/* $ */:\n    case 0x25/* % */:\n    case 0x26/* & */:\n    case 0x2A/* * */:\n    case 0x2B/* + */:\n    case 0x2D/* - */:\n    case 0x3A/* : */:\n    case 0x3C/* < */:\n    case 0x3D/* = */:\n    case 0x3E/* > */:\n    case 0x40/* @ */:\n    case 0x5B/* [ */:\n    case 0x5C/* \\ */:\n    case 0x5D/* ] */:\n    case 0x5E/* ^ */:\n    case 0x5F/* _ */:\n    case 0x60/* ` */:\n    case 0x7B/* { */:\n    case 0x7D/* } */:\n    case 0x7E/* ~ */:\n      return true;\n    default:\n      return false;\n  }\n}\n\nmodule.exports = function text(state, silent) {\n  var pos = state.pos;\n\n  while (pos < state.posMax && !isTerminatorChar(state.src.charCodeAt(pos))) {\n    pos++;\n  }\n\n  if (pos === state.pos) { return false; }\n\n  if (!silent) { state.pending += state.src.slice(state.pos, pos); }\n\n  state.pos = pos;\n\n  return true;\n};\n\n// Alternative implementation, for memory.\n//\n// It costs 10% of performance, but allows extend terminators list, if place it\n// to `ParcerInline` property. Probably, will switch to it sometime, such\n// flexibility required.\n\n/*\nvar TERMINATOR_RE = /[\\n!#$%&*+\\-:<=>@[\\\\\\]^_`{}~]/;\n\nmodule.exports = function text(state, silent) {\n  var pos = state.pos,\n      idx = state.src.slice(pos).search(TERMINATOR_RE);\n\n  // first char is terminator -> empty text\n  if (idx === 0) { return false; }\n\n  // no terminator -> text till end of string\n  if (idx < 0) {\n    if (!silent) { state.pending += state.src.slice(pos); }\n    state.pos = state.src.length;\n    return true;\n  }\n\n  if (!silent) { state.pending += state.src.slice(pos, pos + idx); }\n\n  state.pos += idx;\n\n  return true;\n};*/\n","// Proceess '\\n'\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\n\nmodule.exports = function newline(state, silent) {\n  var pmax, max, ws, pos = state.pos;\n\n  if (state.src.charCodeAt(pos) !== 0x0A/* \\n */) { return false; }\n\n  pmax = state.pending.length - 1;\n  max = state.posMax;\n\n  // '  \\n' -> hardbreak\n  // Lookup in pending chars is bad practice! Don't copy to other rules!\n  // Pending string is stored in concat mode, indexed lookups will cause\n  // convertion to flat mode.\n  if (!silent) {\n    if (pmax >= 0 && state.pending.charCodeAt(pmax) === 0x20) {\n      if (pmax >= 1 && state.pending.charCodeAt(pmax - 1) === 0x20) {\n        // Find whitespaces tail of pending chars.\n        ws = pmax - 1;\n        while (ws >= 1 && state.pending.charCodeAt(ws - 1) === 0x20) ws--;\n\n        state.pending = state.pending.slice(0, ws);\n        state.push('hardbreak', 'br', 0);\n      } else {\n        state.pending = state.pending.slice(0, -1);\n        state.push('softbreak', 'br', 0);\n      }\n\n    } else {\n      state.push('softbreak', 'br', 0);\n    }\n  }\n\n  pos++;\n\n  // skip heading spaces for next line\n  while (pos < max && isSpace(state.src.charCodeAt(pos))) { pos++; }\n\n  state.pos = pos;\n  return true;\n};\n","// Process escaped chars and hardbreaks\n\n'use strict';\n\nvar isSpace = require('../common/utils').isSpace;\n\nvar ESCAPED = [];\n\nfor (var i = 0; i < 256; i++) { ESCAPED.push(0); }\n\n'\\\\!\"#$%&\\'()*+,./:;<=>?@[]^_`{|}~-'\n  .split('').forEach(function (ch) { ESCAPED[ch.charCodeAt(0)] = 1; });\n\n\nmodule.exports = function escape(state, silent) {\n  var ch, pos = state.pos, max = state.posMax;\n\n  if (state.src.charCodeAt(pos) !== 0x5C/* \\ */) { return false; }\n\n  pos++;\n\n  if (pos < max) {\n    ch = state.src.charCodeAt(pos);\n\n    if (ch < 256 && ESCAPED[ch] !== 0) {\n      if (!silent) { state.pending += state.src[pos]; }\n      state.pos += 2;\n      return true;\n    }\n\n    if (ch === 0x0A) {\n      if (!silent) {\n        state.push('hardbreak', 'br', 0);\n      }\n\n      pos++;\n      // skip leading whitespaces from next line\n      while (pos < max) {\n        ch = state.src.charCodeAt(pos);\n        if (!isSpace(ch)) { break; }\n        pos++;\n      }\n\n      state.pos = pos;\n      return true;\n    }\n  }\n\n  if (!silent) { state.pending += '\\\\'; }\n  state.pos++;\n  return true;\n};\n","// Parse backticks\n\n'use strict';\n\n\nmodule.exports = function backtick(state, silent) {\n  var start, max, marker, token, matchStart, matchEnd, openerLength, closerLength,\n      pos = state.pos,\n      ch = state.src.charCodeAt(pos);\n\n  if (ch !== 0x60/* ` */) { return false; }\n\n  start = pos;\n  pos++;\n  max = state.posMax;\n\n  // scan marker length\n  while (pos < max && state.src.charCodeAt(pos) === 0x60/* ` */) { pos++; }\n\n  marker = state.src.slice(start, pos);\n  openerLength = marker.length;\n\n  if (state.backticksScanned && (state.backticks[openerLength] || 0) <= start) {\n    if (!silent) state.pending += marker;\n    state.pos += openerLength;\n    return true;\n  }\n\n  matchStart = matchEnd = pos;\n\n  // Nothing found in the cache, scan until the end of the line (or until marker is found)\n  while ((matchStart = state.src.indexOf('`', matchEnd)) !== -1) {\n    matchEnd = matchStart + 1;\n\n    // scan marker length\n    while (matchEnd < max && state.src.charCodeAt(matchEnd) === 0x60/* ` */) { matchEnd++; }\n\n    closerLength = matchEnd - matchStart;\n\n    if (closerLength === openerLength) {\n      // Found matching closer length.\n      if (!silent) {\n        token     = state.push('code_inline', 'code', 0);\n        token.markup  = marker;\n        token.content = state.src.slice(pos, matchStart)\n          .replace(/\\n/g, ' ')\n          .replace(/^ (.+) $/, '$1');\n      }\n      state.pos = matchEnd;\n      return true;\n    }\n\n    // Some different length found, put it in cache as upper limit of where closer can be found\n    state.backticks[closerLength] = matchStart;\n  }\n\n  // Scanned through the end, didn't find anything\n  state.backticksScanned = true;\n\n  if (!silent) state.pending += marker;\n  state.pos += openerLength;\n  return true;\n};\n","// ~~strike through~~\n//\n'use strict';\n\n\n// Insert each marker as a separate text token, and add it to delimiter list\n//\nmodule.exports.tokenize = function strikethrough(state, silent) {\n  var i, scanned, token, len, ch,\n      start = state.pos,\n      marker = state.src.charCodeAt(start);\n\n  if (silent) { return false; }\n\n  if (marker !== 0x7E/* ~ */) { return false; }\n\n  scanned = state.scanDelims(state.pos, true);\n  len = scanned.length;\n  ch = String.fromCharCode(marker);\n\n  if (len < 2) { return false; }\n\n  if (len % 2) {\n    token         = state.push('text', '', 0);\n    token.content = ch;\n    len--;\n  }\n\n  for (i = 0; i < len; i += 2) {\n    token         = state.push('text', '', 0);\n    token.content = ch + ch;\n\n    state.delimiters.push({\n      marker: marker,\n      length: 0,     // disable \"rule of 3\" length checks meant for emphasis\n      token:  state.tokens.length - 1,\n      end:    -1,\n      open:   scanned.can_open,\n      close:  scanned.can_close\n    });\n  }\n\n  state.pos += scanned.length;\n\n  return true;\n};\n\n\nfunction postProcess(state, delimiters) {\n  var i, j,\n      startDelim,\n      endDelim,\n      token,\n      loneMarkers = [],\n      max = delimiters.length;\n\n  for (i = 0; i < max; i++) {\n    startDelim = delimiters[i];\n\n    if (startDelim.marker !== 0x7E/* ~ */) {\n      continue;\n    }\n\n    if (startDelim.end === -1) {\n      continue;\n    }\n\n    endDelim = delimiters[startDelim.end];\n\n    token         = state.tokens[startDelim.token];\n    token.type    = 's_open';\n    token.tag     = 's';\n    token.nesting = 1;\n    token.markup  = '~~';\n    token.content = '';\n\n    token         = state.tokens[endDelim.token];\n    token.type    = 's_close';\n    token.tag     = 's';\n    token.nesting = -1;\n    token.markup  = '~~';\n    token.content = '';\n\n    if (state.tokens[endDelim.token - 1].type === 'text' &&\n        state.tokens[endDelim.token - 1].content === '~') {\n\n      loneMarkers.push(endDelim.token - 1);\n    }\n  }\n\n  // If a marker sequence has an odd number of characters, it's splitted\n  // like this: `~~~~~` -> `~` + `~~` + `~~`, leaving one marker at the\n  // start of the sequence.\n  //\n  // So, we have to move all those markers after subsequent s_close tags.\n  //\n  while (loneMarkers.length) {\n    i = loneMarkers.pop();\n    j = i + 1;\n\n    while (j < state.tokens.length && state.tokens[j].type === 's_close') {\n      j++;\n    }\n\n    j--;\n\n    if (i !== j) {\n      token = state.tokens[j];\n      state.tokens[j] = state.tokens[i];\n      state.tokens[i] = token;\n    }\n  }\n}\n\n\n// Walk through delimiter list and replace text tokens with tags\n//\nmodule.exports.postProcess = function strikethrough(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  postProcess(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      postProcess(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","// Process *this* and _that_\n//\n'use strict';\n\n\n// Insert each marker as a separate text token, and add it to delimiter list\n//\nmodule.exports.tokenize = function emphasis(state, silent) {\n  var i, scanned, token,\n      start = state.pos,\n      marker = state.src.charCodeAt(start);\n\n  if (silent) { return false; }\n\n  if (marker !== 0x5F /* _ */ && marker !== 0x2A /* * */) { return false; }\n\n  scanned = state.scanDelims(state.pos, marker === 0x2A);\n\n  for (i = 0; i < scanned.length; i++) {\n    token         = state.push('text', '', 0);\n    token.content = String.fromCharCode(marker);\n\n    state.delimiters.push({\n      // Char code of the starting marker (number).\n      //\n      marker: marker,\n\n      // Total length of these series of delimiters.\n      //\n      length: scanned.length,\n\n      // A position of the token this delimiter corresponds to.\n      //\n      token:  state.tokens.length - 1,\n\n      // If this delimiter is matched as a valid opener, `end` will be\n      // equal to its position, otherwise it's `-1`.\n      //\n      end:    -1,\n\n      // Boolean flags that determine if this delimiter could open or close\n      // an emphasis.\n      //\n      open:   scanned.can_open,\n      close:  scanned.can_close\n    });\n  }\n\n  state.pos += scanned.length;\n\n  return true;\n};\n\n\nfunction postProcess(state, delimiters) {\n  var i,\n      startDelim,\n      endDelim,\n      token,\n      ch,\n      isStrong,\n      max = delimiters.length;\n\n  for (i = max - 1; i >= 0; i--) {\n    startDelim = delimiters[i];\n\n    if (startDelim.marker !== 0x5F/* _ */ && startDelim.marker !== 0x2A/* * */) {\n      continue;\n    }\n\n    // Process only opening markers\n    if (startDelim.end === -1) {\n      continue;\n    }\n\n    endDelim = delimiters[startDelim.end];\n\n    // If the previous delimiter has the same marker and is adjacent to this one,\n    // merge those into one strong delimiter.\n    //\n    // `<em><em>whatever</em></em>` -> `<strong>whatever</strong>`\n    //\n    isStrong = i > 0 &&\n               delimiters[i - 1].end === startDelim.end + 1 &&\n               // check that first two markers match and adjacent\n               delimiters[i - 1].marker === startDelim.marker &&\n               delimiters[i - 1].token === startDelim.token - 1 &&\n               // check that last two markers are adjacent (we can safely assume they match)\n               delimiters[startDelim.end + 1].token === endDelim.token + 1;\n\n    ch = String.fromCharCode(startDelim.marker);\n\n    token         = state.tokens[startDelim.token];\n    token.type    = isStrong ? 'strong_open' : 'em_open';\n    token.tag     = isStrong ? 'strong' : 'em';\n    token.nesting = 1;\n    token.markup  = isStrong ? ch + ch : ch;\n    token.content = '';\n\n    token         = state.tokens[endDelim.token];\n    token.type    = isStrong ? 'strong_close' : 'em_close';\n    token.tag     = isStrong ? 'strong' : 'em';\n    token.nesting = -1;\n    token.markup  = isStrong ? ch + ch : ch;\n    token.content = '';\n\n    if (isStrong) {\n      state.tokens[delimiters[i - 1].token].content = '';\n      state.tokens[delimiters[startDelim.end + 1].token].content = '';\n      i--;\n    }\n  }\n}\n\n\n// Walk through delimiter list and replace text tokens with tags\n//\nmodule.exports.postProcess = function emphasis(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  postProcess(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      postProcess(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","// Process [link](<to> \"stuff\")\n\n'use strict';\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function link(state, silent) {\n  var attrs,\n      code,\n      label,\n      labelEnd,\n      labelStart,\n      pos,\n      res,\n      ref,\n      token,\n      href = '',\n      title = '',\n      oldPos = state.pos,\n      max = state.posMax,\n      start = state.pos,\n      parseReference = true;\n\n  if (state.src.charCodeAt(state.pos) !== 0x5B/* [ */) { return false; }\n\n  labelStart = state.pos + 1;\n  labelEnd = state.md.helpers.parseLinkLabel(state, state.pos, true);\n\n  // parser failed to find ']', so it's not a valid link\n  if (labelEnd < 0) { return false; }\n\n  pos = labelEnd + 1;\n  if (pos < max && state.src.charCodeAt(pos) === 0x28/* ( */) {\n    //\n    // Inline link\n    //\n\n    // might have found a valid shortcut link, disable reference parsing\n    parseReference = false;\n\n    // [link](  <href>  \"title\"  )\n    //        ^^ skipping these spaces\n    pos++;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n    if (pos >= max) { return false; }\n\n    // [link](  <href>  \"title\"  )\n    //          ^^^^^^ parsing link destination\n    start = pos;\n    res = state.md.helpers.parseLinkDestination(state.src, pos, state.posMax);\n    if (res.ok) {\n      href = state.md.normalizeLink(res.str);\n      if (state.md.validateLink(href)) {\n        pos = res.pos;\n      } else {\n        href = '';\n      }\n\n      // [link](  <href>  \"title\"  )\n      //                ^^ skipping these spaces\n      start = pos;\n      for (; pos < max; pos++) {\n        code = state.src.charCodeAt(pos);\n        if (!isSpace(code) && code !== 0x0A) { break; }\n      }\n\n      // [link](  <href>  \"title\"  )\n      //                  ^^^^^^^ parsing link title\n      res = state.md.helpers.parseLinkTitle(state.src, pos, state.posMax);\n      if (pos < max && start !== pos && res.ok) {\n        title = res.str;\n        pos = res.pos;\n\n        // [link](  <href>  \"title\"  )\n        //                         ^^ skipping these spaces\n        for (; pos < max; pos++) {\n          code = state.src.charCodeAt(pos);\n          if (!isSpace(code) && code !== 0x0A) { break; }\n        }\n      }\n    }\n\n    if (pos >= max || state.src.charCodeAt(pos) !== 0x29/* ) */) {\n      // parsing a valid shortcut link failed, fallback to reference\n      parseReference = true;\n    }\n    pos++;\n  }\n\n  if (parseReference) {\n    //\n    // Link reference\n    //\n    if (typeof state.env.references === 'undefined') { return false; }\n\n    if (pos < max && state.src.charCodeAt(pos) === 0x5B/* [ */) {\n      start = pos + 1;\n      pos = state.md.helpers.parseLinkLabel(state, pos);\n      if (pos >= 0) {\n        label = state.src.slice(start, pos++);\n      } else {\n        pos = labelEnd + 1;\n      }\n    } else {\n      pos = labelEnd + 1;\n    }\n\n    // covers label === '' and label === undefined\n    // (collapsed reference link and shortcut reference link respectively)\n    if (!label) { label = state.src.slice(labelStart, labelEnd); }\n\n    ref = state.env.references[normalizeReference(label)];\n    if (!ref) {\n      state.pos = oldPos;\n      return false;\n    }\n    href = ref.href;\n    title = ref.title;\n  }\n\n  //\n  // We found the end of the link, and know for a fact it's a valid link;\n  // so all that's left to do is to call tokenizer.\n  //\n  if (!silent) {\n    state.pos = labelStart;\n    state.posMax = labelEnd;\n\n    token        = state.push('link_open', 'a', 1);\n    token.attrs  = attrs = [ [ 'href', href ] ];\n    if (title) {\n      attrs.push([ 'title', title ]);\n    }\n\n    state.md.inline.tokenize(state);\n\n    token        = state.push('link_close', 'a', -1);\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n  return true;\n};\n","// Process ![image](<src> \"title\")\n\n'use strict';\n\nvar normalizeReference   = require('../common/utils').normalizeReference;\nvar isSpace              = require('../common/utils').isSpace;\n\n\nmodule.exports = function image(state, silent) {\n  var attrs,\n      code,\n      content,\n      label,\n      labelEnd,\n      labelStart,\n      pos,\n      ref,\n      res,\n      title,\n      token,\n      tokens,\n      start,\n      href = '',\n      oldPos = state.pos,\n      max = state.posMax;\n\n  if (state.src.charCodeAt(state.pos) !== 0x21/* ! */) { return false; }\n  if (state.src.charCodeAt(state.pos + 1) !== 0x5B/* [ */) { return false; }\n\n  labelStart = state.pos + 2;\n  labelEnd = state.md.helpers.parseLinkLabel(state, state.pos + 1, false);\n\n  // parser failed to find ']', so it's not a valid link\n  if (labelEnd < 0) { return false; }\n\n  pos = labelEnd + 1;\n  if (pos < max && state.src.charCodeAt(pos) === 0x28/* ( */) {\n    //\n    // Inline link\n    //\n\n    // [link](  <href>  \"title\"  )\n    //        ^^ skipping these spaces\n    pos++;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n    if (pos >= max) { return false; }\n\n    // [link](  <href>  \"title\"  )\n    //          ^^^^^^ parsing link destination\n    start = pos;\n    res = state.md.helpers.parseLinkDestination(state.src, pos, state.posMax);\n    if (res.ok) {\n      href = state.md.normalizeLink(res.str);\n      if (state.md.validateLink(href)) {\n        pos = res.pos;\n      } else {\n        href = '';\n      }\n    }\n\n    // [link](  <href>  \"title\"  )\n    //                ^^ skipping these spaces\n    start = pos;\n    for (; pos < max; pos++) {\n      code = state.src.charCodeAt(pos);\n      if (!isSpace(code) && code !== 0x0A) { break; }\n    }\n\n    // [link](  <href>  \"title\"  )\n    //                  ^^^^^^^ parsing link title\n    res = state.md.helpers.parseLinkTitle(state.src, pos, state.posMax);\n    if (pos < max && start !== pos && res.ok) {\n      title = res.str;\n      pos = res.pos;\n\n      // [link](  <href>  \"title\"  )\n      //                         ^^ skipping these spaces\n      for (; pos < max; pos++) {\n        code = state.src.charCodeAt(pos);\n        if (!isSpace(code) && code !== 0x0A) { break; }\n      }\n    } else {\n      title = '';\n    }\n\n    if (pos >= max || state.src.charCodeAt(pos) !== 0x29/* ) */) {\n      state.pos = oldPos;\n      return false;\n    }\n    pos++;\n  } else {\n    //\n    // Link reference\n    //\n    if (typeof state.env.references === 'undefined') { return false; }\n\n    if (pos < max && state.src.charCodeAt(pos) === 0x5B/* [ */) {\n      start = pos + 1;\n      pos = state.md.helpers.parseLinkLabel(state, pos);\n      if (pos >= 0) {\n        label = state.src.slice(start, pos++);\n      } else {\n        pos = labelEnd + 1;\n      }\n    } else {\n      pos = labelEnd + 1;\n    }\n\n    // covers label === '' and label === undefined\n    // (collapsed reference link and shortcut reference link respectively)\n    if (!label) { label = state.src.slice(labelStart, labelEnd); }\n\n    ref = state.env.references[normalizeReference(label)];\n    if (!ref) {\n      state.pos = oldPos;\n      return false;\n    }\n    href = ref.href;\n    title = ref.title;\n  }\n\n  //\n  // We found the end of the link, and know for a fact it's a valid link;\n  // so all that's left to do is to call tokenizer.\n  //\n  if (!silent) {\n    content = state.src.slice(labelStart, labelEnd);\n\n    state.md.inline.parse(\n      content,\n      state.md,\n      state.env,\n      tokens = []\n    );\n\n    token          = state.push('image', 'img', 0);\n    token.attrs    = attrs = [ [ 'src', href ], [ 'alt', '' ] ];\n    token.children = tokens;\n    token.content  = content;\n\n    if (title) {\n      attrs.push([ 'title', title ]);\n    }\n  }\n\n  state.pos = pos;\n  state.posMax = max;\n  return true;\n};\n","// Process autolinks '<protocol:...>'\n\n'use strict';\n\n\n/*eslint max-len:0*/\nvar EMAIL_RE    = /^([a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/;\nvar AUTOLINK_RE = /^([a-zA-Z][a-zA-Z0-9+.\\-]{1,31}):([^<>\\x00-\\x20]*)$/;\n\n\nmodule.exports = function autolink(state, silent) {\n  var url, fullUrl, token, ch, start, max,\n      pos = state.pos;\n\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */) { return false; }\n\n  start = state.pos;\n  max = state.posMax;\n\n  for (;;) {\n    if (++pos >= max) return false;\n\n    ch = state.src.charCodeAt(pos);\n\n    if (ch === 0x3C /* < */) return false;\n    if (ch === 0x3E /* > */) break;\n  }\n\n  url = state.src.slice(start + 1, pos);\n\n  if (AUTOLINK_RE.test(url)) {\n    fullUrl = state.md.normalizeLink(url);\n    if (!state.md.validateLink(fullUrl)) { return false; }\n\n    if (!silent) {\n      token         = state.push('link_open', 'a', 1);\n      token.attrs   = [ [ 'href', fullUrl ] ];\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n\n      token         = state.push('text', '', 0);\n      token.content = state.md.normalizeLinkText(url);\n\n      token         = state.push('link_close', 'a', -1);\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n    }\n\n    state.pos += url.length + 2;\n    return true;\n  }\n\n  if (EMAIL_RE.test(url)) {\n    fullUrl = state.md.normalizeLink('mailto:' + url);\n    if (!state.md.validateLink(fullUrl)) { return false; }\n\n    if (!silent) {\n      token         = state.push('link_open', 'a', 1);\n      token.attrs   = [ [ 'href', fullUrl ] ];\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n\n      token         = state.push('text', '', 0);\n      token.content = state.md.normalizeLinkText(url);\n\n      token         = state.push('link_close', 'a', -1);\n      token.markup  = 'autolink';\n      token.info    = 'auto';\n    }\n\n    state.pos += url.length + 2;\n    return true;\n  }\n\n  return false;\n};\n","// Process html tags\n\n'use strict';\n\n\nvar HTML_TAG_RE = require('../common/html_re').HTML_TAG_RE;\n\n\nfunction isLetter(ch) {\n  /*eslint no-bitwise:0*/\n  var lc = ch | 0x20; // to lower case\n  return (lc >= 0x61/* a */) && (lc <= 0x7a/* z */);\n}\n\n\nmodule.exports = function html_inline(state, silent) {\n  var ch, match, max, token,\n      pos = state.pos;\n\n  if (!state.md.options.html) { return false; }\n\n  // Check start\n  max = state.posMax;\n  if (state.src.charCodeAt(pos) !== 0x3C/* < */ ||\n      pos + 2 >= max) {\n    return false;\n  }\n\n  // Quick fail on second char\n  ch = state.src.charCodeAt(pos + 1);\n  if (ch !== 0x21/* ! */ &&\n      ch !== 0x3F/* ? */ &&\n      ch !== 0x2F/* / */ &&\n      !isLetter(ch)) {\n    return false;\n  }\n\n  match = state.src.slice(pos).match(HTML_TAG_RE);\n  if (!match) { return false; }\n\n  if (!silent) {\n    token         = state.push('html_inline', '', 0);\n    token.content = state.src.slice(pos, pos + match[0].length);\n  }\n  state.pos += match[0].length;\n  return true;\n};\n","// Process html entity - &#123;, &#xAF;, &quot;, ...\n\n'use strict';\n\nvar entities          = require('../common/entities');\nvar has               = require('../common/utils').has;\nvar isValidEntityCode = require('../common/utils').isValidEntityCode;\nvar fromCodePoint     = require('../common/utils').fromCodePoint;\n\n\nvar DIGITAL_RE = /^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i;\nvar NAMED_RE   = /^&([a-z][a-z0-9]{1,31});/i;\n\n\nmodule.exports = function entity(state, silent) {\n  var ch, code, match, pos = state.pos, max = state.posMax;\n\n  if (state.src.charCodeAt(pos) !== 0x26/* & */) { return false; }\n\n  if (pos + 1 < max) {\n    ch = state.src.charCodeAt(pos + 1);\n\n    if (ch === 0x23 /* # */) {\n      match = state.src.slice(pos).match(DIGITAL_RE);\n      if (match) {\n        if (!silent) {\n          code = match[1][0].toLowerCase() === 'x' ? parseInt(match[1].slice(1), 16) : parseInt(match[1], 10);\n          state.pending += isValidEntityCode(code) ? fromCodePoint(code) : fromCodePoint(0xFFFD);\n        }\n        state.pos += match[0].length;\n        return true;\n      }\n    } else {\n      match = state.src.slice(pos).match(NAMED_RE);\n      if (match) {\n        if (has(entities, match[1])) {\n          if (!silent) { state.pending += entities[match[1]]; }\n          state.pos += match[0].length;\n          return true;\n        }\n      }\n    }\n  }\n\n  if (!silent) { state.pending += '&'; }\n  state.pos++;\n  return true;\n};\n","// For each opening emphasis-like marker find a matching closing one\n//\n'use strict';\n\n\nfunction processDelimiters(state, delimiters) {\n  var closerIdx, openerIdx, closer, opener, minOpenerIdx, newMinOpenerIdx,\n      isOddMatch, lastJump,\n      openersBottom = {},\n      max = delimiters.length;\n\n  if (!max) return;\n\n  // headerIdx is the first delimiter of the current (where closer is) delimiter run\n  var headerIdx = 0;\n  var lastTokenIdx = -2; // needs any value lower than -1\n  var jumps = [];\n\n  for (closerIdx = 0; closerIdx < max; closerIdx++) {\n    closer = delimiters[closerIdx];\n\n    jumps.push(0);\n\n    // markers belong to same delimiter run if:\n    //  - they have adjacent tokens\n    //  - AND markers are the same\n    //\n    if (delimiters[headerIdx].marker !== closer.marker || lastTokenIdx !== closer.token - 1) {\n      headerIdx = closerIdx;\n    }\n\n    lastTokenIdx = closer.token;\n\n    // Length is only used for emphasis-specific \"rule of 3\",\n    // if it's not defined (in strikethrough or 3rd party plugins),\n    // we can default it to 0 to disable those checks.\n    //\n    closer.length = closer.length || 0;\n\n    if (!closer.close) continue;\n\n    // Previously calculated lower bounds (previous fails)\n    // for each marker, each delimiter length modulo 3,\n    // and for whether this closer can be an opener;\n    // https://github.com/commonmark/cmark/commit/34250e12ccebdc6372b8b49c44fab57c72443460\n    if (!openersBottom.hasOwnProperty(closer.marker)) {\n      openersBottom[closer.marker] = [ -1, -1, -1, -1, -1, -1 ];\n    }\n\n    minOpenerIdx = openersBottom[closer.marker][(closer.open ? 3 : 0) + (closer.length % 3)];\n\n    openerIdx = headerIdx - jumps[headerIdx] - 1;\n\n    newMinOpenerIdx = openerIdx;\n\n    for (; openerIdx > minOpenerIdx; openerIdx -= jumps[openerIdx] + 1) {\n      opener = delimiters[openerIdx];\n\n      if (opener.marker !== closer.marker) continue;\n\n      if (opener.open && opener.end < 0) {\n\n        isOddMatch = false;\n\n        // from spec:\n        //\n        // If one of the delimiters can both open and close emphasis, then the\n        // sum of the lengths of the delimiter runs containing the opening and\n        // closing delimiters must not be a multiple of 3 unless both lengths\n        // are multiples of 3.\n        //\n        if (opener.close || closer.open) {\n          if ((opener.length + closer.length) % 3 === 0) {\n            if (opener.length % 3 !== 0 || closer.length % 3 !== 0) {\n              isOddMatch = true;\n            }\n          }\n        }\n\n        if (!isOddMatch) {\n          // If previous delimiter cannot be an opener, we can safely skip\n          // the entire sequence in future checks. This is required to make\n          // sure algorithm has linear complexity (see *_*_*_*_*_... case).\n          //\n          lastJump = openerIdx > 0 && !delimiters[openerIdx - 1].open ?\n            jumps[openerIdx - 1] + 1 :\n            0;\n\n          jumps[closerIdx] = closerIdx - openerIdx + lastJump;\n          jumps[openerIdx] = lastJump;\n\n          closer.open  = false;\n          opener.end   = closerIdx;\n          opener.close = false;\n          newMinOpenerIdx = -1;\n          // treat next token as start of run,\n          // it optimizes skips in **<...>**a**<...>** pathological case\n          lastTokenIdx = -2;\n          break;\n        }\n      }\n    }\n\n    if (newMinOpenerIdx !== -1) {\n      // If match for this delimiter run failed, we want to set lower bound for\n      // future lookups. This is required to make sure algorithm has linear\n      // complexity.\n      //\n      // See details here:\n      // https://github.com/commonmark/cmark/issues/178#issuecomment-270417442\n      //\n      openersBottom[closer.marker][(closer.open ? 3 : 0) + ((closer.length || 0) % 3)] = newMinOpenerIdx;\n    }\n  }\n}\n\n\nmodule.exports = function link_pairs(state) {\n  var curr,\n      tokens_meta = state.tokens_meta,\n      max = state.tokens_meta.length;\n\n  processDelimiters(state, state.delimiters);\n\n  for (curr = 0; curr < max; curr++) {\n    if (tokens_meta[curr] && tokens_meta[curr].delimiters) {\n      processDelimiters(state, tokens_meta[curr].delimiters);\n    }\n  }\n};\n","// Clean up tokens after emphasis and strikethrough postprocessing:\n// merge adjacent text nodes into one and re-calculate all token levels\n//\n// This is necessary because initially emphasis delimiter markers (*, _, ~)\n// are treated as their own separate text tokens. Then emphasis rule either\n// leaves them as text (needed to merge with adjacent text) or turns them\n// into opening/closing tags (which messes up levels inside).\n//\n'use strict';\n\n\nmodule.exports = function text_collapse(state) {\n  var curr, last,\n      level = 0,\n      tokens = state.tokens,\n      max = state.tokens.length;\n\n  for (curr = last = 0; curr < max; curr++) {\n    // re-calculate levels after emphasis/strikethrough turns some text nodes\n    // into opening/closing tags\n    if (tokens[curr].nesting < 0) level--; // closing tag\n    tokens[curr].level = level;\n    if (tokens[curr].nesting > 0) level++; // opening tag\n\n    if (tokens[curr].type === 'text' &&\n        curr + 1 < max &&\n        tokens[curr + 1].type === 'text') {\n\n      // collapse two adjacent text nodes\n      tokens[curr + 1].content = tokens[curr].content + tokens[curr + 1].content;\n    } else {\n      if (curr !== last) { tokens[last] = tokens[curr]; }\n\n      last++;\n    }\n  }\n\n  if (curr !== last) {\n    tokens.length = last;\n  }\n};\n","// Inline parser state\n\n'use strict';\n\n\nvar Token          = require('../token');\nvar isWhiteSpace   = require('../common/utils').isWhiteSpace;\nvar isPunctChar    = require('../common/utils').isPunctChar;\nvar isMdAsciiPunct = require('../common/utils').isMdAsciiPunct;\n\n\nfunction StateInline(src, md, env, outTokens) {\n  this.src = src;\n  this.env = env;\n  this.md = md;\n  this.tokens = outTokens;\n  this.tokens_meta = Array(outTokens.length);\n\n  this.pos = 0;\n  this.posMax = this.src.length;\n  this.level = 0;\n  this.pending = '';\n  this.pendingLevel = 0;\n\n  // Stores { start: end } pairs. Useful for backtrack\n  // optimization of pairs parse (emphasis, strikes).\n  this.cache = {};\n\n  // List of emphasis-like delimiters for current tag\n  this.delimiters = [];\n\n  // Stack of delimiter lists for upper level tags\n  this._prev_delimiters = [];\n\n  // backtick length => last seen position\n  this.backticks = {};\n  this.backticksScanned = false;\n}\n\n\n// Flush pending text\n//\nStateInline.prototype.pushPending = function () {\n  var token = new Token('text', '', 0);\n  token.content = this.pending;\n  token.level = this.pendingLevel;\n  this.tokens.push(token);\n  this.pending = '';\n  return token;\n};\n\n\n// Push new token to \"stream\".\n// If pending text exists - flush it as text token\n//\nStateInline.prototype.push = function (type, tag, nesting) {\n  if (this.pending) {\n    this.pushPending();\n  }\n\n  var token = new Token(type, tag, nesting);\n  var token_meta = null;\n\n  if (nesting < 0) {\n    // closing tag\n    this.level--;\n    this.delimiters = this._prev_delimiters.pop();\n  }\n\n  token.level = this.level;\n\n  if (nesting > 0) {\n    // opening tag\n    this.level++;\n    this._prev_delimiters.push(this.delimiters);\n    this.delimiters = [];\n    token_meta = { delimiters: this.delimiters };\n  }\n\n  this.pendingLevel = this.level;\n  this.tokens.push(token);\n  this.tokens_meta.push(token_meta);\n  return token;\n};\n\n\n// Scan a sequence of emphasis-like markers, and determine whether\n// it can start an emphasis sequence or end an emphasis sequence.\n//\n//  - start - position to scan from (it should point at a valid marker);\n//  - canSplitWord - determine if these markers can be found inside a word\n//\nStateInline.prototype.scanDelims = function (start, canSplitWord) {\n  var pos = start, lastChar, nextChar, count, can_open, can_close,\n      isLastWhiteSpace, isLastPunctChar,\n      isNextWhiteSpace, isNextPunctChar,\n      left_flanking = true,\n      right_flanking = true,\n      max = this.posMax,\n      marker = this.src.charCodeAt(start);\n\n  // treat beginning of the line as a whitespace\n  lastChar = start > 0 ? this.src.charCodeAt(start - 1) : 0x20;\n\n  while (pos < max && this.src.charCodeAt(pos) === marker) { pos++; }\n\n  count = pos - start;\n\n  // treat end of the line as a whitespace\n  nextChar = pos < max ? this.src.charCodeAt(pos) : 0x20;\n\n  isLastPunctChar = isMdAsciiPunct(lastChar) || isPunctChar(String.fromCharCode(lastChar));\n  isNextPunctChar = isMdAsciiPunct(nextChar) || isPunctChar(String.fromCharCode(nextChar));\n\n  isLastWhiteSpace = isWhiteSpace(lastChar);\n  isNextWhiteSpace = isWhiteSpace(nextChar);\n\n  if (isNextWhiteSpace) {\n    left_flanking = false;\n  } else if (isNextPunctChar) {\n    if (!(isLastWhiteSpace || isLastPunctChar)) {\n      left_flanking = false;\n    }\n  }\n\n  if (isLastWhiteSpace) {\n    right_flanking = false;\n  } else if (isLastPunctChar) {\n    if (!(isNextWhiteSpace || isNextPunctChar)) {\n      right_flanking = false;\n    }\n  }\n\n  if (!canSplitWord) {\n    can_open  = left_flanking  && (!right_flanking || isLastPunctChar);\n    can_close = right_flanking && (!left_flanking  || isNextPunctChar);\n  } else {\n    can_open  = left_flanking;\n    can_close = right_flanking;\n  }\n\n  return {\n    can_open:  can_open,\n    can_close: can_close,\n    length:    count\n  };\n};\n\n\n// re-export Token class to use in block rules\nStateInline.prototype.Token = Token;\n\n\nmodule.exports = StateInline;\n","'use strict';\n\n\n////////////////////////////////////////////////////////////////////////////////\n// Helpers\n\n// Merge objects\n//\nfunction assign(obj /*from1, from2, from3, ...*/) {\n  var sources = Array.prototype.slice.call(arguments, 1);\n\n  sources.forEach(function (source) {\n    if (!source) { return; }\n\n    Object.keys(source).forEach(function (key) {\n      obj[key] = source[key];\n    });\n  });\n\n  return obj;\n}\n\nfunction _class(obj) { return Object.prototype.toString.call(obj); }\nfunction isString(obj) { return _class(obj) === '[object String]'; }\nfunction isObject(obj) { return _class(obj) === '[object Object]'; }\nfunction isRegExp(obj) { return _class(obj) === '[object RegExp]'; }\nfunction isFunction(obj) { return _class(obj) === '[object Function]'; }\n\n\nfunction escapeRE(str) { return str.replace(/[.?*+^$[\\]\\\\(){}|-]/g, '\\\\$&'); }\n\n////////////////////////////////////////////////////////////////////////////////\n\n\nvar defaultOptions = {\n  fuzzyLink: true,\n  fuzzyEmail: true,\n  fuzzyIP: false\n};\n\n\nfunction isOptionsObj(obj) {\n  return Object.keys(obj || {}).reduce(function (acc, k) {\n    return acc || defaultOptions.hasOwnProperty(k);\n  }, false);\n}\n\n\nvar defaultSchemas = {\n  'http:': {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.http) {\n        // compile lazily, because \"host\"-containing variables can change on tlds update.\n        self.re.http =  new RegExp(\n          '^\\\\/\\\\/' + self.re.src_auth + self.re.src_host_port_strict + self.re.src_path, 'i'\n        );\n      }\n      if (self.re.http.test(tail)) {\n        return tail.match(self.re.http)[0].length;\n      }\n      return 0;\n    }\n  },\n  'https:':  'http:',\n  'ftp:':    'http:',\n  '//':      {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.no_http) {\n      // compile lazily, because \"host\"-containing variables can change on tlds update.\n        self.re.no_http =  new RegExp(\n          '^' +\n          self.re.src_auth +\n          // Don't allow single-level domains, because of false positives like '//test'\n          // with code comments\n          '(?:localhost|(?:(?:' + self.re.src_domain + ')\\\\.)+' + self.re.src_domain_root + ')' +\n          self.re.src_port +\n          self.re.src_host_terminator +\n          self.re.src_path,\n\n          'i'\n        );\n      }\n\n      if (self.re.no_http.test(tail)) {\n        // should not be `://` & `///`, that protects from errors in protocol name\n        if (pos >= 3 && text[pos - 3] === ':') { return 0; }\n        if (pos >= 3 && text[pos - 3] === '/') { return 0; }\n        return tail.match(self.re.no_http)[0].length;\n      }\n      return 0;\n    }\n  },\n  'mailto:': {\n    validate: function (text, pos, self) {\n      var tail = text.slice(pos);\n\n      if (!self.re.mailto) {\n        self.re.mailto =  new RegExp(\n          '^' + self.re.src_email_name + '@' + self.re.src_host_strict, 'i'\n        );\n      }\n      if (self.re.mailto.test(tail)) {\n        return tail.match(self.re.mailto)[0].length;\n      }\n      return 0;\n    }\n  }\n};\n\n/*eslint-disable max-len*/\n\n// RE pattern for 2-character tlds (autogenerated by ./support/tlds_2char_gen.js)\nvar tlds_2ch_src_re = 'a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]';\n\n// DON'T try to make PRs with changes. Extend TLDs with LinkifyIt.tlds() instead\nvar tlds_default = 'biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф'.split('|');\n\n/*eslint-enable max-len*/\n\n////////////////////////////////////////////////////////////////////////////////\n\nfunction resetScanCache(self) {\n  self.__index__ = -1;\n  self.__text_cache__   = '';\n}\n\nfunction createValidator(re) {\n  return function (text, pos) {\n    var tail = text.slice(pos);\n\n    if (re.test(tail)) {\n      return tail.match(re)[0].length;\n    }\n    return 0;\n  };\n}\n\nfunction createNormalizer() {\n  return function (match, self) {\n    self.normalize(match);\n  };\n}\n\n// Schemas compiler. Build regexps.\n//\nfunction compile(self) {\n\n  // Load & clone RE patterns.\n  var re = self.re = require('./lib/re')(self.__opts__);\n\n  // Define dynamic patterns\n  var tlds = self.__tlds__.slice();\n\n  self.onCompile();\n\n  if (!self.__tlds_replaced__) {\n    tlds.push(tlds_2ch_src_re);\n  }\n  tlds.push(re.src_xn);\n\n  re.src_tlds = tlds.join('|');\n\n  function untpl(tpl) { return tpl.replace('%TLDS%', re.src_tlds); }\n\n  re.email_fuzzy      = RegExp(untpl(re.tpl_email_fuzzy), 'i');\n  re.link_fuzzy       = RegExp(untpl(re.tpl_link_fuzzy), 'i');\n  re.link_no_ip_fuzzy = RegExp(untpl(re.tpl_link_no_ip_fuzzy), 'i');\n  re.host_fuzzy_test  = RegExp(untpl(re.tpl_host_fuzzy_test), 'i');\n\n  //\n  // Compile each schema\n  //\n\n  var aliases = [];\n\n  self.__compiled__ = {}; // Reset compiled data\n\n  function schemaError(name, val) {\n    throw new Error('(LinkifyIt) Invalid schema \"' + name + '\": ' + val);\n  }\n\n  Object.keys(self.__schemas__).forEach(function (name) {\n    var val = self.__schemas__[name];\n\n    // skip disabled methods\n    if (val === null) { return; }\n\n    var compiled = { validate: null, link: null };\n\n    self.__compiled__[name] = compiled;\n\n    if (isObject(val)) {\n      if (isRegExp(val.validate)) {\n        compiled.validate = createValidator(val.validate);\n      } else if (isFunction(val.validate)) {\n        compiled.validate = val.validate;\n      } else {\n        schemaError(name, val);\n      }\n\n      if (isFunction(val.normalize)) {\n        compiled.normalize = val.normalize;\n      } else if (!val.normalize) {\n        compiled.normalize = createNormalizer();\n      } else {\n        schemaError(name, val);\n      }\n\n      return;\n    }\n\n    if (isString(val)) {\n      aliases.push(name);\n      return;\n    }\n\n    schemaError(name, val);\n  });\n\n  //\n  // Compile postponed aliases\n  //\n\n  aliases.forEach(function (alias) {\n    if (!self.__compiled__[self.__schemas__[alias]]) {\n      // Silently fail on missed schemas to avoid errons on disable.\n      // schemaError(alias, self.__schemas__[alias]);\n      return;\n    }\n\n    self.__compiled__[alias].validate =\n      self.__compiled__[self.__schemas__[alias]].validate;\n    self.__compiled__[alias].normalize =\n      self.__compiled__[self.__schemas__[alias]].normalize;\n  });\n\n  //\n  // Fake record for guessed links\n  //\n  self.__compiled__[''] = { validate: null, normalize: createNormalizer() };\n\n  //\n  // Build schema condition\n  //\n  var slist = Object.keys(self.__compiled__)\n                      .filter(function (name) {\n                        // Filter disabled & fake schemas\n                        return name.length > 0 && self.__compiled__[name];\n                      })\n                      .map(escapeRE)\n                      .join('|');\n  // (?!_) cause 1.5x slowdown\n  self.re.schema_test   = RegExp('(^|(?!_)(?:[><\\uff5c]|' + re.src_ZPCc + '))(' + slist + ')', 'i');\n  self.re.schema_search = RegExp('(^|(?!_)(?:[><\\uff5c]|' + re.src_ZPCc + '))(' + slist + ')', 'ig');\n\n  self.re.pretest = RegExp(\n    '(' + self.re.schema_test.source + ')|(' + self.re.host_fuzzy_test.source + ')|@',\n    'i'\n  );\n\n  //\n  // Cleanup\n  //\n\n  resetScanCache(self);\n}\n\n/**\n * class Match\n *\n * Match result. Single element of array, returned by [[LinkifyIt#match]]\n **/\nfunction Match(self, shift) {\n  var start = self.__index__,\n      end   = self.__last_index__,\n      text  = self.__text_cache__.slice(start, end);\n\n  /**\n   * Match#schema -> String\n   *\n   * Prefix (protocol) for matched string.\n   **/\n  this.schema    = self.__schema__.toLowerCase();\n  /**\n   * Match#index -> Number\n   *\n   * First position of matched string.\n   **/\n  this.index     = start + shift;\n  /**\n   * Match#lastIndex -> Number\n   *\n   * Next position after matched string.\n   **/\n  this.lastIndex = end + shift;\n  /**\n   * Match#raw -> String\n   *\n   * Matched string.\n   **/\n  this.raw       = text;\n  /**\n   * Match#text -> String\n   *\n   * Notmalized text of matched string.\n   **/\n  this.text      = text;\n  /**\n   * Match#url -> String\n   *\n   * Normalized url of matched string.\n   **/\n  this.url       = text;\n}\n\nfunction createMatch(self, shift) {\n  var match = new Match(self, shift);\n\n  self.__compiled__[match.schema].normalize(match, self);\n\n  return match;\n}\n\n\n/**\n * class LinkifyIt\n **/\n\n/**\n * new LinkifyIt(schemas, options)\n * - schemas (Object): Optional. Additional schemas to validate (prefix/validator)\n * - options (Object): { fuzzyLink|fuzzyEmail|fuzzyIP: true|false }\n *\n * Creates new linkifier instance with optional additional schemas.\n * Can be called without `new` keyword for convenience.\n *\n * By default understands:\n *\n * - `http(s)://...` , `ftp://...`, `mailto:...` & `//...` links\n * - \"fuzzy\" links and emails (example.com, foo@bar.com).\n *\n * `schemas` is an object, where each key/value describes protocol/rule:\n *\n * - __key__ - link prefix (usually, protocol name with `:` at the end, `skype:`\n *   for example). `linkify-it` makes shure that prefix is not preceeded with\n *   alphanumeric char and symbols. Only whitespaces and punctuation allowed.\n * - __value__ - rule to check tail after link prefix\n *   - _String_ - just alias to existing rule\n *   - _Object_\n *     - _validate_ - validator function (should return matched length on success),\n *       or `RegExp`.\n *     - _normalize_ - optional function to normalize text & url of matched result\n *       (for example, for @twitter mentions).\n *\n * `options`:\n *\n * - __fuzzyLink__ - recognige URL-s without `http(s):` prefix. Default `true`.\n * - __fuzzyIP__ - allow IPs in fuzzy links above. Can conflict with some texts\n *   like version numbers. Default `false`.\n * - __fuzzyEmail__ - recognize emails without `mailto:` prefix.\n *\n **/\nfunction LinkifyIt(schemas, options) {\n  if (!(this instanceof LinkifyIt)) {\n    return new LinkifyIt(schemas, options);\n  }\n\n  if (!options) {\n    if (isOptionsObj(schemas)) {\n      options = schemas;\n      schemas = {};\n    }\n  }\n\n  this.__opts__           = assign({}, defaultOptions, options);\n\n  // Cache last tested result. Used to skip repeating steps on next `match` call.\n  this.__index__          = -1;\n  this.__last_index__     = -1; // Next scan position\n  this.__schema__         = '';\n  this.__text_cache__     = '';\n\n  this.__schemas__        = assign({}, defaultSchemas, schemas);\n  this.__compiled__       = {};\n\n  this.__tlds__           = tlds_default;\n  this.__tlds_replaced__  = false;\n\n  this.re = {};\n\n  compile(this);\n}\n\n\n/** chainable\n * LinkifyIt#add(schema, definition)\n * - schema (String): rule name (fixed pattern prefix)\n * - definition (String|RegExp|Object): schema definition\n *\n * Add new rule definition. See constructor description for details.\n **/\nLinkifyIt.prototype.add = function add(schema, definition) {\n  this.__schemas__[schema] = definition;\n  compile(this);\n  return this;\n};\n\n\n/** chainable\n * LinkifyIt#set(options)\n * - options (Object): { fuzzyLink|fuzzyEmail|fuzzyIP: true|false }\n *\n * Set recognition options for links without schema.\n **/\nLinkifyIt.prototype.set = function set(options) {\n  this.__opts__ = assign(this.__opts__, options);\n  return this;\n};\n\n\n/**\n * LinkifyIt#test(text) -> Boolean\n *\n * Searches linkifiable pattern and returns `true` on success or `false` on fail.\n **/\nLinkifyIt.prototype.test = function test(text) {\n  // Reset scan cache\n  this.__text_cache__ = text;\n  this.__index__      = -1;\n\n  if (!text.length) { return false; }\n\n  var m, ml, me, len, shift, next, re, tld_pos, at_pos;\n\n  // try to scan for link with schema - that's the most simple rule\n  if (this.re.schema_test.test(text)) {\n    re = this.re.schema_search;\n    re.lastIndex = 0;\n    while ((m = re.exec(text)) !== null) {\n      len = this.testSchemaAt(text, m[2], re.lastIndex);\n      if (len) {\n        this.__schema__     = m[2];\n        this.__index__      = m.index + m[1].length;\n        this.__last_index__ = m.index + m[0].length + len;\n        break;\n      }\n    }\n  }\n\n  if (this.__opts__.fuzzyLink && this.__compiled__['http:']) {\n    // guess schemaless links\n    tld_pos = text.search(this.re.host_fuzzy_test);\n    if (tld_pos >= 0) {\n      // if tld is located after found link - no need to check fuzzy pattern\n      if (this.__index__ < 0 || tld_pos < this.__index__) {\n        if ((ml = text.match(this.__opts__.fuzzyIP ? this.re.link_fuzzy : this.re.link_no_ip_fuzzy)) !== null) {\n\n          shift = ml.index + ml[1].length;\n\n          if (this.__index__ < 0 || shift < this.__index__) {\n            this.__schema__     = '';\n            this.__index__      = shift;\n            this.__last_index__ = ml.index + ml[0].length;\n          }\n        }\n      }\n    }\n  }\n\n  if (this.__opts__.fuzzyEmail && this.__compiled__['mailto:']) {\n    // guess schemaless emails\n    at_pos = text.indexOf('@');\n    if (at_pos >= 0) {\n      // We can't skip this check, because this cases are possible:\n      // 192.168.1.1@gmail.com, my.in@example.com\n      if ((me = text.match(this.re.email_fuzzy)) !== null) {\n\n        shift = me.index + me[1].length;\n        next  = me.index + me[0].length;\n\n        if (this.__index__ < 0 || shift < this.__index__ ||\n            (shift === this.__index__ && next > this.__last_index__)) {\n          this.__schema__     = 'mailto:';\n          this.__index__      = shift;\n          this.__last_index__ = next;\n        }\n      }\n    }\n  }\n\n  return this.__index__ >= 0;\n};\n\n\n/**\n * LinkifyIt#pretest(text) -> Boolean\n *\n * Very quick check, that can give false positives. Returns true if link MAY BE\n * can exists. Can be used for speed optimization, when you need to check that\n * link NOT exists.\n **/\nLinkifyIt.prototype.pretest = function pretest(text) {\n  return this.re.pretest.test(text);\n};\n\n\n/**\n * LinkifyIt#testSchemaAt(text, name, position) -> Number\n * - text (String): text to scan\n * - name (String): rule (schema) name\n * - position (Number): text offset to check from\n *\n * Similar to [[LinkifyIt#test]] but checks only specific protocol tail exactly\n * at given position. Returns length of found pattern (0 on fail).\n **/\nLinkifyIt.prototype.testSchemaAt = function testSchemaAt(text, schema, pos) {\n  // If not supported schema check requested - terminate\n  if (!this.__compiled__[schema.toLowerCase()]) {\n    return 0;\n  }\n  return this.__compiled__[schema.toLowerCase()].validate(text, pos, this);\n};\n\n\n/**\n * LinkifyIt#match(text) -> Array|null\n *\n * Returns array of found link descriptions or `null` on fail. We strongly\n * recommend to use [[LinkifyIt#test]] first, for best speed.\n *\n * ##### Result match description\n *\n * - __schema__ - link schema, can be empty for fuzzy links, or `//` for\n *   protocol-neutral  links.\n * - __index__ - offset of matched text\n * - __lastIndex__ - index of next char after mathch end\n * - __raw__ - matched text\n * - __text__ - normalized text\n * - __url__ - link, generated from matched text\n **/\nLinkifyIt.prototype.match = function match(text) {\n  var shift = 0, result = [];\n\n  // Try to take previous element from cache, if .test() called before\n  if (this.__index__ >= 0 && this.__text_cache__ === text) {\n    result.push(createMatch(this, shift));\n    shift = this.__last_index__;\n  }\n\n  // Cut head if cache was used\n  var tail = shift ? text.slice(shift) : text;\n\n  // Scan string until end reached\n  while (this.test(tail)) {\n    result.push(createMatch(this, shift));\n\n    tail = tail.slice(this.__last_index__);\n    shift += this.__last_index__;\n  }\n\n  if (result.length) {\n    return result;\n  }\n\n  return null;\n};\n\n\n/** chainable\n * LinkifyIt#tlds(list [, keepOld]) -> this\n * - list (Array): list of tlds\n * - keepOld (Boolean): merge with current list if `true` (`false` by default)\n *\n * Load (or merge) new tlds list. Those are user for fuzzy links (without prefix)\n * to avoid false positives. By default this algorythm used:\n *\n * - hostname with any 2-letter root zones are ok.\n * - biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|рф\n *   are ok.\n * - encoded (`xn--...`) root zones are ok.\n *\n * If list is replaced, then exact match for 2-chars root zones will be checked.\n **/\nLinkifyIt.prototype.tlds = function tlds(list, keepOld) {\n  list = Array.isArray(list) ? list : [ list ];\n\n  if (!keepOld) {\n    this.__tlds__ = list.slice();\n    this.__tlds_replaced__ = true;\n    compile(this);\n    return this;\n  }\n\n  this.__tlds__ = this.__tlds__.concat(list)\n                                  .sort()\n                                  .filter(function (el, idx, arr) {\n                                    return el !== arr[idx - 1];\n                                  })\n                                  .reverse();\n\n  compile(this);\n  return this;\n};\n\n/**\n * LinkifyIt#normalize(match)\n *\n * Default normalizer (if schema does not define it's own).\n **/\nLinkifyIt.prototype.normalize = function normalize(match) {\n\n  // Do minimal possible changes by default. Need to collect feedback prior\n  // to move forward https://github.com/markdown-it/linkify-it/issues/1\n\n  if (!match.schema) { match.url = 'http://' + match.url; }\n\n  if (match.schema === 'mailto:' && !/^mailto:/i.test(match.url)) {\n    match.url = 'mailto:' + match.url;\n  }\n};\n\n\n/**\n * LinkifyIt#onCompile()\n *\n * Override to modify basic RegExp-s.\n **/\nLinkifyIt.prototype.onCompile = function onCompile() {\n};\n\n\nmodule.exports = LinkifyIt;\n","'use strict';\n\n\nmodule.exports = function (opts) {\n  var re = {};\n\n  // Use direct extract instead of `regenerate` to reduse browserified size\n  re.src_Any = require('uc.micro/properties/Any/regex').source;\n  re.src_Cc  = require('uc.micro/categories/Cc/regex').source;\n  re.src_Z   = require('uc.micro/categories/Z/regex').source;\n  re.src_P   = require('uc.micro/categories/P/regex').source;\n\n  // \\p{\\Z\\P\\Cc\\CF} (white spaces + control + format + punctuation)\n  re.src_ZPCc = [ re.src_Z, re.src_P, re.src_Cc ].join('|');\n\n  // \\p{\\Z\\Cc} (white spaces + control)\n  re.src_ZCc = [ re.src_Z, re.src_Cc ].join('|');\n\n  // Experimental. List of chars, completely prohibited in links\n  // because can separate it from other part of text\n  var text_separators = '[><\\uff5c]';\n\n  // All possible word characters (everything without punctuation, spaces & controls)\n  // Defined via punctuation & spaces to save space\n  // Should be something like \\p{\\L\\N\\S\\M} (\\w but without `_`)\n  re.src_pseudo_letter       = '(?:(?!' + text_separators + '|' + re.src_ZPCc + ')' + re.src_Any + ')';\n  // The same as abothe but without [0-9]\n  // var src_pseudo_letter_non_d = '(?:(?![0-9]|' + src_ZPCc + ')' + src_Any + ')';\n\n  ////////////////////////////////////////////////////////////////////////////////\n\n  re.src_ip4 =\n\n    '(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)';\n\n  // Prohibit any of \"@/[]()\" in user/pass to avoid wrong domain fetch.\n  re.src_auth    = '(?:(?:(?!' + re.src_ZCc + '|[@/\\\\[\\\\]()]).)+@)?';\n\n  re.src_port =\n\n    '(?::(?:6(?:[0-4]\\\\d{3}|5(?:[0-4]\\\\d{2}|5(?:[0-2]\\\\d|3[0-5])))|[1-5]?\\\\d{1,4}))?';\n\n  re.src_host_terminator =\n\n    '(?=$|' + text_separators + '|' + re.src_ZPCc + ')(?!-|_|:\\\\d|\\\\.-|\\\\.(?!$|' + re.src_ZPCc + '))';\n\n  re.src_path =\n\n    '(?:' +\n      '[/?#]' +\n        '(?:' +\n          '(?!' + re.src_ZCc + '|' + text_separators + '|[()[\\\\]{}.,\"\\'?!\\\\-;]).|' +\n          '\\\\[(?:(?!' + re.src_ZCc + '|\\\\]).)*\\\\]|' +\n          '\\\\((?:(?!' + re.src_ZCc + '|[)]).)*\\\\)|' +\n          '\\\\{(?:(?!' + re.src_ZCc + '|[}]).)*\\\\}|' +\n          '\\\\\"(?:(?!' + re.src_ZCc + '|[\"]).)+\\\\\"|' +\n          \"\\\\'(?:(?!\" + re.src_ZCc + \"|[']).)+\\\\'|\" +\n          \"\\\\'(?=\" + re.src_pseudo_letter + '|[-]).|' +  // allow `I'm_king` if no pair found\n          '\\\\.{2,}[a-zA-Z0-9%/&]|' + // google has many dots in \"google search\" links (#66, #81).\n                                     // github has ... in commit range links,\n                                     // Restrict to\n                                     // - english\n                                     // - percent-encoded\n                                     // - parts of file path\n                                     // - params separator\n                                     // until more examples found.\n          '\\\\.(?!' + re.src_ZCc + '|[.]).|' +\n          (opts && opts['---'] ?\n            '\\\\-(?!--(?:[^-]|$))(?:-*)|' // `---` => long dash, terminate\n            :\n            '\\\\-+|'\n          ) +\n          ',(?!' + re.src_ZCc + ').|' +       // allow `,,,` in paths\n          ';(?!' + re.src_ZCc + ').|' +       // allow `;` if not followed by space-like char\n          '\\\\!+(?!' + re.src_ZCc + '|[!]).|' +  // allow `!!!` in paths, but not at the end\n          '\\\\?(?!' + re.src_ZCc + '|[?]).' +\n        ')+' +\n      '|\\\\/' +\n    ')?';\n\n  // Allow anything in markdown spec, forbid quote (\") at the first position\n  // because emails enclosed in quotes are far more common\n  re.src_email_name =\n\n    '[\\\\-;:&=\\\\+\\\\$,\\\\.a-zA-Z0-9_][\\\\-;:&=\\\\+\\\\$,\\\\\"\\\\.a-zA-Z0-9_]*';\n\n  re.src_xn =\n\n    'xn--[a-z0-9\\\\-]{1,59}';\n\n  // More to read about domain names\n  // http://serverfault.com/questions/638260/\n\n  re.src_domain_root =\n\n    // Allow letters & digits (http://test1)\n    '(?:' +\n      re.src_xn +\n      '|' +\n      re.src_pseudo_letter + '{1,63}' +\n    ')';\n\n  re.src_domain =\n\n    '(?:' +\n      re.src_xn +\n      '|' +\n      '(?:' + re.src_pseudo_letter + ')' +\n      '|' +\n      '(?:' + re.src_pseudo_letter + '(?:-|' + re.src_pseudo_letter + '){0,61}' + re.src_pseudo_letter + ')' +\n    ')';\n\n  re.src_host =\n\n    '(?:' +\n    // Don't need IP check, because digits are already allowed in normal domain names\n    //   src_ip4 +\n    // '|' +\n      '(?:(?:(?:' + re.src_domain + ')\\\\.)*' + re.src_domain/*_root*/ + ')' +\n    ')';\n\n  re.tpl_host_fuzzy =\n\n    '(?:' +\n      re.src_ip4 +\n    '|' +\n      '(?:(?:(?:' + re.src_domain + ')\\\\.)+(?:%TLDS%))' +\n    ')';\n\n  re.tpl_host_no_ip_fuzzy =\n\n    '(?:(?:(?:' + re.src_domain + ')\\\\.)+(?:%TLDS%))';\n\n  re.src_host_strict =\n\n    re.src_host + re.src_host_terminator;\n\n  re.tpl_host_fuzzy_strict =\n\n    re.tpl_host_fuzzy + re.src_host_terminator;\n\n  re.src_host_port_strict =\n\n    re.src_host + re.src_port + re.src_host_terminator;\n\n  re.tpl_host_port_fuzzy_strict =\n\n    re.tpl_host_fuzzy + re.src_port + re.src_host_terminator;\n\n  re.tpl_host_port_no_ip_fuzzy_strict =\n\n    re.tpl_host_no_ip_fuzzy + re.src_port + re.src_host_terminator;\n\n\n  ////////////////////////////////////////////////////////////////////////////////\n  // Main rules\n\n  // Rude test fuzzy links by host, for quick deny\n  re.tpl_host_fuzzy_test =\n\n    'localhost|www\\\\.|\\\\.\\\\d{1,3}\\\\.|(?:\\\\.(?:%TLDS%)(?:' + re.src_ZPCc + '|>|$))';\n\n  re.tpl_email_fuzzy =\n\n      '(^|' + text_separators + '|\"|\\\\(|' + re.src_ZCc + ')' +\n      '(' + re.src_email_name + '@' + re.tpl_host_fuzzy_strict + ')';\n\n  re.tpl_link_fuzzy =\n      // Fuzzy link can't be prepended with .:/\\- and non punctuation.\n      // but can start with > (markdown blockquote)\n      '(^|(?![.:/\\\\-_@])(?:[$+<=>^`|\\uff5c]|' + re.src_ZPCc + '))' +\n      '((?![$+<=>^`|\\uff5c])' + re.tpl_host_port_fuzzy_strict + re.src_path + ')';\n\n  re.tpl_link_no_ip_fuzzy =\n      // Fuzzy link can't be prepended with .:/\\- and non punctuation.\n      // but can start with > (markdown blockquote)\n      '(^|(?![.:/\\\\-_@])(?:[$+<=>^`|\\uff5c]|' + re.src_ZPCc + '))' +\n      '((?![$+<=>^`|\\uff5c])' + re.tpl_host_port_no_ip_fuzzy_strict + re.src_path + ')';\n\n  return re;\n};\n","'use strict';\n\n/** Highest positive signed 32-bit float value */\nconst maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\n\n/** Bootstring parameters */\nconst base = 36;\nconst tMin = 1;\nconst tMax = 26;\nconst skew = 38;\nconst damp = 700;\nconst initialBias = 72;\nconst initialN = 128; // 0x80\nconst delimiter = '-'; // '\\x2D'\n\n/** Regular expressions */\nconst regexPunycode = /^xn--/;\nconst regexNonASCII = /[^\\0-\\x7E]/; // non-ASCII chars\nconst regexSeparators = /[\\x2E\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\n\n/** Error messages */\nconst errors = {\n\t'overflow': 'Overflow: input needs wider integers to process',\n\t'not-basic': 'Illegal input >= 0x80 (not a basic code point)',\n\t'invalid-input': 'Invalid input'\n};\n\n/** Convenience shortcuts */\nconst baseMinusTMin = base - tMin;\nconst floor = Math.floor;\nconst stringFromCharCode = String.fromCharCode;\n\n/*--------------------------------------------------------------------------*/\n\n/**\n * A generic error utility function.\n * @private\n * @param {String} type The error type.\n * @returns {Error} Throws a `RangeError` with the applicable error message.\n */\nfunction error(type) {\n\tthrow new RangeError(errors[type]);\n}\n\n/**\n * A generic `Array#map` utility function.\n * @private\n * @param {Array} array The array to iterate over.\n * @param {Function} callback The function that gets called for every array\n * item.\n * @returns {Array} A new array of values returned by the callback function.\n */\nfunction map(array, fn) {\n\tconst result = [];\n\tlet length = array.length;\n\twhile (length--) {\n\t\tresult[length] = fn(array[length]);\n\t}\n\treturn result;\n}\n\n/**\n * A simple `Array#map`-like wrapper to work with domain name strings or email\n * addresses.\n * @private\n * @param {String} domain The domain name or email address.\n * @param {Function} callback The function that gets called for every\n * character.\n * @returns {Array} A new string of characters returned by the callback\n * function.\n */\nfunction mapDomain(string, fn) {\n\tconst parts = string.split('@');\n\tlet result = '';\n\tif (parts.length > 1) {\n\t\t// In email addresses, only the domain name should be punycoded. Leave\n\t\t// the local part (i.e. everything up to `@`) intact.\n\t\tresult = parts[0] + '@';\n\t\tstring = parts[1];\n\t}\n\t// Avoid `split(regex)` for IE8 compatibility. See #17.\n\tstring = string.replace(regexSeparators, '\\x2E');\n\tconst labels = string.split('.');\n\tconst encoded = map(labels, fn).join('.');\n\treturn result + encoded;\n}\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n * @see `punycode.ucs2.encode`\n * @see <https://mathiasbynens.be/notes/javascript-encoding>\n * @memberOf punycode.ucs2\n * @name decode\n * @param {String} string The Unicode input string (UCS-2).\n * @returns {Array} The new array of code points.\n */\nfunction ucs2decode(string) {\n\tconst output = [];\n\tlet counter = 0;\n\tconst length = string.length;\n\twhile (counter < length) {\n\t\tconst value = string.charCodeAt(counter++);\n\t\tif (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n\t\t\t// It's a high surrogate, and there is a next character.\n\t\t\tconst extra = string.charCodeAt(counter++);\n\t\t\tif ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n\t\t\t\toutput.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n\t\t\t} else {\n\t\t\t\t// It's an unmatched surrogate; only append this code unit, in case the\n\t\t\t\t// next code unit is the high surrogate of a surrogate pair.\n\t\t\t\toutput.push(value);\n\t\t\t\tcounter--;\n\t\t\t}\n\t\t} else {\n\t\t\toutput.push(value);\n\t\t}\n\t}\n\treturn output;\n}\n\n/**\n * Creates a string based on an array of numeric code points.\n * @see `punycode.ucs2.decode`\n * @memberOf punycode.ucs2\n * @name encode\n * @param {Array} codePoints The array of numeric code points.\n * @returns {String} The new Unicode string (UCS-2).\n */\nconst ucs2encode = array => String.fromCodePoint(...array);\n\n/**\n * Converts a basic code point into a digit/integer.\n * @see `digitToBasic()`\n * @private\n * @param {Number} codePoint The basic numeric code point value.\n * @returns {Number} The numeric value of a basic code point (for use in\n * representing integers) in the range `0` to `base - 1`, or `base` if\n * the code point does not represent a value.\n */\nconst basicToDigit = function(codePoint) {\n\tif (codePoint - 0x30 < 0x0A) {\n\t\treturn codePoint - 0x16;\n\t}\n\tif (codePoint - 0x41 < 0x1A) {\n\t\treturn codePoint - 0x41;\n\t}\n\tif (codePoint - 0x61 < 0x1A) {\n\t\treturn codePoint - 0x61;\n\t}\n\treturn base;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n * @see `basicToDigit()`\n * @private\n * @param {Number} digit The numeric value of a basic code point.\n * @returns {Number} The basic code point whose value (when used for\n * representing integers) is `digit`, which needs to be in the range\n * `0` to `base - 1`. If `flag` is non-zero, the uppercase form is\n * used; else, the lowercase form is used. The behavior is undefined\n * if `flag` is non-zero and `digit` has no uppercase form.\n */\nconst digitToBasic = function(digit, flag) {\n\t//  0..25 map to ASCII a..z or A..Z\n\t// 26..35 map to ASCII 0..9\n\treturn digit + 22 + 75 * (digit < 26) - ((flag != 0) << 5);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n * @private\n */\nconst adapt = function(delta, numPoints, firstTime) {\n\tlet k = 0;\n\tdelta = firstTime ? floor(delta / damp) : delta >> 1;\n\tdelta += floor(delta / numPoints);\n\tfor (/* no initialization */; delta > baseMinusTMin * tMax >> 1; k += base) {\n\t\tdelta = floor(delta / baseMinusTMin);\n\t}\n\treturn floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a Punycode string of ASCII-only symbols to a string of Unicode\n * symbols.\n * @memberOf punycode\n * @param {String} input The Punycode string of ASCII-only symbols.\n * @returns {String} The resulting string of Unicode symbols.\n */\nconst decode = function(input) {\n\t// Don't use UCS-2.\n\tconst output = [];\n\tconst inputLength = input.length;\n\tlet i = 0;\n\tlet n = initialN;\n\tlet bias = initialBias;\n\n\t// Handle the basic code points: let `basic` be the number of input code\n\t// points before the last delimiter, or `0` if there is none, then copy\n\t// the first basic code points to the output.\n\n\tlet basic = input.lastIndexOf(delimiter);\n\tif (basic < 0) {\n\t\tbasic = 0;\n\t}\n\n\tfor (let j = 0; j < basic; ++j) {\n\t\t// if it's not a basic code point\n\t\tif (input.charCodeAt(j) >= 0x80) {\n\t\t\terror('not-basic');\n\t\t}\n\t\toutput.push(input.charCodeAt(j));\n\t}\n\n\t// Main decoding loop: start just after the last delimiter if any basic code\n\t// points were copied; start at the beginning otherwise.\n\n\tfor (let index = basic > 0 ? basic + 1 : 0; index < inputLength; /* no final expression */) {\n\n\t\t// `index` is the index of the next character to be consumed.\n\t\t// Decode a generalized variable-length integer into `delta`,\n\t\t// which gets added to `i`. The overflow checking is easier\n\t\t// if we increase `i` as we go, then subtract off its starting\n\t\t// value at the end to obtain `delta`.\n\t\tlet oldi = i;\n\t\tfor (let w = 1, k = base; /* no condition */; k += base) {\n\n\t\t\tif (index >= inputLength) {\n\t\t\t\terror('invalid-input');\n\t\t\t}\n\n\t\t\tconst digit = basicToDigit(input.charCodeAt(index++));\n\n\t\t\tif (digit >= base || digit > floor((maxInt - i) / w)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\ti += digit * w;\n\t\t\tconst t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\n\t\t\tif (digit < t) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst baseMinusT = base - t;\n\t\t\tif (w > floor(maxInt / baseMinusT)) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\n\t\t\tw *= baseMinusT;\n\n\t\t}\n\n\t\tconst out = output.length + 1;\n\t\tbias = adapt(i - oldi, out, oldi == 0);\n\n\t\t// `i` was supposed to wrap around from `out` to `0`,\n\t\t// incrementing `n` each time, so we'll fix that now:\n\t\tif (floor(i / out) > maxInt - n) {\n\t\t\terror('overflow');\n\t\t}\n\n\t\tn += floor(i / out);\n\t\ti %= out;\n\n\t\t// Insert `n` at position `i` of the output.\n\t\toutput.splice(i++, 0, n);\n\n\t}\n\n\treturn String.fromCodePoint(...output);\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n * @memberOf punycode\n * @param {String} input The string of Unicode symbols.\n * @returns {String} The resulting Punycode string of ASCII-only symbols.\n */\nconst encode = function(input) {\n\tconst output = [];\n\n\t// Convert the input in UCS-2 to an array of Unicode code points.\n\tinput = ucs2decode(input);\n\n\t// Cache the length.\n\tlet inputLength = input.length;\n\n\t// Initialize the state.\n\tlet n = initialN;\n\tlet delta = 0;\n\tlet bias = initialBias;\n\n\t// Handle the basic code points.\n\tfor (const currentValue of input) {\n\t\tif (currentValue < 0x80) {\n\t\t\toutput.push(stringFromCharCode(currentValue));\n\t\t}\n\t}\n\n\tlet basicLength = output.length;\n\tlet handledCPCount = basicLength;\n\n\t// `handledCPCount` is the number of code points that have been handled;\n\t// `basicLength` is the number of basic code points.\n\n\t// Finish the basic string with a delimiter unless it's empty.\n\tif (basicLength) {\n\t\toutput.push(delimiter);\n\t}\n\n\t// Main encoding loop:\n\twhile (handledCPCount < inputLength) {\n\n\t\t// All non-basic code points < n have been handled already. Find the next\n\t\t// larger one:\n\t\tlet m = maxInt;\n\t\tfor (const currentValue of input) {\n\t\t\tif (currentValue >= n && currentValue < m) {\n\t\t\t\tm = currentValue;\n\t\t\t}\n\t\t}\n\n\t\t// Increase `delta` enough to advance the decoder's <n,i> state to <m,0>,\n\t\t// but guard against overflow.\n\t\tconst handledCPCountPlusOne = handledCPCount + 1;\n\t\tif (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n\t\t\terror('overflow');\n\t\t}\n\n\t\tdelta += (m - n) * handledCPCountPlusOne;\n\t\tn = m;\n\n\t\tfor (const currentValue of input) {\n\t\t\tif (currentValue < n && ++delta > maxInt) {\n\t\t\t\terror('overflow');\n\t\t\t}\n\t\t\tif (currentValue == n) {\n\t\t\t\t// Represent delta as a generalized variable-length integer.\n\t\t\t\tlet q = delta;\n\t\t\t\tfor (let k = base; /* no condition */; k += base) {\n\t\t\t\t\tconst t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n\t\t\t\t\tif (q < t) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tconst qMinusT = q - t;\n\t\t\t\t\tconst baseMinusT = base - t;\n\t\t\t\t\toutput.push(\n\t\t\t\t\t\tstringFromCharCode(digitToBasic(t + qMinusT % baseMinusT, 0))\n\t\t\t\t\t);\n\t\t\t\t\tq = floor(qMinusT / baseMinusT);\n\t\t\t\t}\n\n\t\t\t\toutput.push(stringFromCharCode(digitToBasic(q, 0)));\n\t\t\t\tbias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n\t\t\t\tdelta = 0;\n\t\t\t\t++handledCPCount;\n\t\t\t}\n\t\t}\n\n\t\t++delta;\n\t\t++n;\n\n\t}\n\treturn output.join('');\n};\n\n/**\n * Converts a Punycode string representing a domain name or an email address\n * to Unicode. Only the Punycoded parts of the input will be converted, i.e.\n * it doesn't matter if you call it on a string that has already been\n * converted to Unicode.\n * @memberOf punycode\n * @param {String} input The Punycoded domain name or email address to\n * convert to Unicode.\n * @returns {String} The Unicode representation of the given Punycode\n * string.\n */\nconst toUnicode = function(input) {\n\treturn mapDomain(input, function(string) {\n\t\treturn regexPunycode.test(string)\n\t\t\t? decode(string.slice(4).toLowerCase())\n\t\t\t: string;\n\t});\n};\n\n/**\n * Converts a Unicode string representing a domain name or an email address to\n * Punycode. Only the non-ASCII parts of the domain name will be converted,\n * i.e. it doesn't matter if you call it with a domain that's already in\n * ASCII.\n * @memberOf punycode\n * @param {String} input The domain name or email address to convert, as a\n * Unicode string.\n * @returns {String} The Punycode representation of the given domain name or\n * email address.\n */\nconst toASCII = function(input) {\n\treturn mapDomain(input, function(string) {\n\t\treturn regexNonASCII.test(string)\n\t\t\t? 'xn--' + encode(string)\n\t\t\t: string;\n\t});\n};\n\n/*--------------------------------------------------------------------------*/\n\n/** Define the public API */\nconst punycode = {\n\t/**\n\t * A string representing the current Punycode.js version number.\n\t * @memberOf punycode\n\t * @type String\n\t */\n\t'version': '2.1.0',\n\t/**\n\t * An object of methods to convert from JavaScript's internal character\n\t * representation (UCS-2) to Unicode code points, and back.\n\t * @see <https://mathiasbynens.be/notes/javascript-encoding>\n\t * @memberOf punycode\n\t * @type Object\n\t */\n\t'ucs2': {\n\t\t'decode': ucs2decode,\n\t\t'encode': ucs2encode\n\t},\n\t'decode': decode,\n\t'encode': encode,\n\t'toASCII': toASCII,\n\t'toUnicode': toUnicode\n};\n\nexport { ucs2decode, ucs2encode, decode, encode, toASCII, toUnicode };\nexport default punycode;\n","// markdown-it default options\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         false,        // Enable HTML tags in source\n    xhtmlOut:     false,        // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   100            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {},\n    block: {},\n    inline: {}\n  }\n};\n","// \"Zero\" preset, with nothing enabled. Useful for manual configuring of simple\n// modes. For example, to parse bold/italic only.\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         false,        // Enable HTML tags in source\n    xhtmlOut:     false,        // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   20            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {\n      rules: [\n        'normalize',\n        'block',\n        'inline'\n      ]\n    },\n\n    block: {\n      rules: [\n        'paragraph'\n      ]\n    },\n\n    inline: {\n      rules: [\n        'text'\n      ],\n      rules2: [\n        'balance_pairs',\n        'text_collapse'\n      ]\n    }\n  }\n};\n","// Commonmark default options\n\n'use strict';\n\n\nmodule.exports = {\n  options: {\n    html:         true,         // Enable HTML tags in source\n    xhtmlOut:     true,         // Use '/' to close single tags (<br />)\n    breaks:       false,        // Convert '\\n' in paragraphs into <br>\n    langPrefix:   'language-',  // CSS language prefix for fenced blocks\n    linkify:      false,        // autoconvert URL-like texts to links\n\n    // Enable some language-neutral replacements + quotes beautification\n    typographer:  false,\n\n    // Double + single quotes replacement pairs, when typographer enabled,\n    // and smartquotes on. Could be either a String or an Array.\n    //\n    // For example, you can use '«»„“' for Russian, '„“‚‘' for German,\n    // and ['«\\xA0', '\\xA0»', '‹\\xA0', '\\xA0›'] for French (including nbsp).\n    quotes: '\\u201c\\u201d\\u2018\\u2019', /* “”‘’ */\n\n    // Highlighter function. Should return escaped HTML,\n    // or '' if the source string is not changed and should be escaped externaly.\n    // If result starts with <pre... internal wrapper is skipped.\n    //\n    // function (/*str, lang*/) { return ''; }\n    //\n    highlight: null,\n\n    maxNesting:   20            // Internal protection, recursion limit\n  },\n\n  components: {\n\n    core: {\n      rules: [\n        'normalize',\n        'block',\n        'inline'\n      ]\n    },\n\n    block: {\n      rules: [\n        'blockquote',\n        'code',\n        'fence',\n        'heading',\n        'hr',\n        'html_block',\n        'lheading',\n        'list',\n        'reference',\n        'paragraph'\n      ]\n    },\n\n    inline: {\n      rules: [\n        'autolink',\n        'backticks',\n        'emphasis',\n        'entity',\n        'escape',\n        'html_inline',\n        'image',\n        'link',\n        'newline',\n        'text'\n      ],\n      rules2: [\n        'balance_pairs',\n        'emphasis',\n        'text_collapse'\n      ]\n    }\n  }\n};\n","export function findDiffStart(a, b, pos) {\n  for (let i = 0;; i++) {\n    if (i == a.childCount || i == b.childCount)\n      return a.childCount == b.childCount ? null : pos\n\n    let childA = a.child(i), childB = b.child(i)\n    if (childA == childB) { pos += childA.nodeSize; continue }\n\n    if (!childA.sameMarkup(childB)) return pos\n\n    if (childA.isText && childA.text != childB.text) {\n      for (let j = 0; childA.text[j] == childB.text[j]; j++)\n        pos++\n      return pos\n    }\n    if (childA.content.size || childB.content.size) {\n      let inner = findDiffStart(childA.content, childB.content, pos + 1)\n      if (inner != null) return inner\n    }\n    pos += childA.nodeSize\n  }\n}\n\nexport function findDiffEnd(a, b, posA, posB) {\n  for (let iA = a.childCount, iB = b.childCount;;) {\n    if (iA == 0 || iB == 0)\n      return iA == iB ? null : {a: posA, b: posB}\n\n    let childA = a.child(--iA), childB = b.child(--iB), size = childA.nodeSize\n    if (childA == childB) {\n      posA -= size; posB -= size\n      continue\n    }\n\n    if (!childA.sameMarkup(childB)) return {a: posA, b: posB}\n\n    if (childA.isText && childA.text != childB.text) {\n      let same = 0, minSize = Math.min(childA.text.length, childB.text.length)\n      while (same < minSize && childA.text[childA.text.length - same - 1] == childB.text[childB.text.length - same - 1]) {\n        same++; posA--; posB--\n      }\n      return {a: posA, b: posB}\n    }\n    if (childA.content.size || childB.content.size) {\n      let inner = findDiffEnd(childA.content, childB.content, posA - 1, posB - 1)\n      if (inner) return inner\n    }\n    posA -= size; posB -= size\n  }\n}\n","import {findDiffStart, findDiffEnd} from \"./diff\"\n\n// ::- A fragment represents a node's collection of child nodes.\n//\n// Like nodes, fragments are persistent data structures, and you\n// should not mutate them or their content. Rather, you create new\n// instances whenever needed. The API tries to make this easy.\nexport class Fragment {\n  constructor(content, size) {\n    this.content = content\n    // :: number\n    // The size of the fragment, which is the total of the size of its\n    // content nodes.\n    this.size = size || 0\n    if (size == null) for (let i = 0; i < content.length; i++)\n      this.size += content[i].nodeSize\n  }\n\n  // :: (number, number, (node: Node, start: number, parent: Node, index: number) → ?bool, ?number)\n  // Invoke a callback for all descendant nodes between the given two\n  // positions (relative to start of this fragment). Doesn't descend\n  // into a node when the callback returns `false`.\n  nodesBetween(from, to, f, nodeStart = 0, parent) {\n    for (let i = 0, pos = 0; pos < to; i++) {\n      let child = this.content[i], end = pos + child.nodeSize\n      if (end > from && f(child, nodeStart + pos, parent, i) !== false && child.content.size) {\n        let start = pos + 1\n        child.nodesBetween(Math.max(0, from - start),\n                           Math.min(child.content.size, to - start),\n                           f, nodeStart + start)\n      }\n      pos = end\n    }\n  }\n\n  // :: ((node: Node, pos: number, parent: Node) → ?bool)\n  // Call the given callback for every descendant node. The callback\n  // may return `false` to prevent traversal of a given node's children.\n  descendants(f) {\n    this.nodesBetween(0, this.size, f)\n  }\n\n  // :: (number, number, ?string, ?union<string, (leafNode: Node) → string>) → string\n  // Extract the text between `from` and `to`. See the same method on\n  // [`Node`](#model.Node.textBetween).\n  textBetween(from, to, blockSeparator, leafText) {\n    let text = \"\", separated = true\n    this.nodesBetween(from, to, (node, pos) => {\n      if (node.isText) {\n        text += node.text.slice(Math.max(from, pos) - pos, to - pos)\n        separated = !blockSeparator\n      } else if (node.isLeaf && leafText) {\n        text += typeof leafText === 'function' ? leafText(node): leafText\n        separated = !blockSeparator\n      } else if (!separated && node.isBlock) {\n        text += blockSeparator\n        separated = true\n      }\n    }, 0)\n    return text\n  }\n\n  // :: (Fragment) → Fragment\n  // Create a new fragment containing the combined content of this\n  // fragment and the other.\n  append(other) {\n    if (!other.size) return this\n    if (!this.size) return other\n    let last = this.lastChild, first = other.firstChild, content = this.content.slice(), i = 0\n    if (last.isText && last.sameMarkup(first)) {\n      content[content.length - 1] = last.withText(last.text + first.text)\n      i = 1\n    }\n    for (; i < other.content.length; i++) content.push(other.content[i])\n    return new Fragment(content, this.size + other.size)\n  }\n\n  // :: (number, ?number) → Fragment\n  // Cut out the sub-fragment between the two given positions.\n  cut(from, to) {\n    if (to == null) to = this.size\n    if (from == 0 && to == this.size) return this\n    let result = [], size = 0\n    if (to > from) for (let i = 0, pos = 0; pos < to; i++) {\n      let child = this.content[i], end = pos + child.nodeSize\n      if (end > from) {\n        if (pos < from || end > to) {\n          if (child.isText)\n            child = child.cut(Math.max(0, from - pos), Math.min(child.text.length, to - pos))\n          else\n            child = child.cut(Math.max(0, from - pos - 1), Math.min(child.content.size, to - pos - 1))\n        }\n        result.push(child)\n        size += child.nodeSize\n      }\n      pos = end\n    }\n    return new Fragment(result, size)\n  }\n\n  cutByIndex(from, to) {\n    if (from == to) return Fragment.empty\n    if (from == 0 && to == this.content.length) return this\n    return new Fragment(this.content.slice(from, to))\n  }\n\n  // :: (number, Node) → Fragment\n  // Create a new fragment in which the node at the given index is\n  // replaced by the given node.\n  replaceChild(index, node) {\n    let current = this.content[index]\n    if (current == node) return this\n    let copy = this.content.slice()\n    let size = this.size + node.nodeSize - current.nodeSize\n    copy[index] = node\n    return new Fragment(copy, size)\n  }\n\n  // : (Node) → Fragment\n  // Create a new fragment by prepending the given node to this\n  // fragment.\n  addToStart(node) {\n    return new Fragment([node].concat(this.content), this.size + node.nodeSize)\n  }\n\n  // : (Node) → Fragment\n  // Create a new fragment by appending the given node to this\n  // fragment.\n  addToEnd(node) {\n    return new Fragment(this.content.concat(node), this.size + node.nodeSize)\n  }\n\n  // :: (Fragment) → bool\n  // Compare this fragment to another one.\n  eq(other) {\n    if (this.content.length != other.content.length) return false\n    for (let i = 0; i < this.content.length; i++)\n      if (!this.content[i].eq(other.content[i])) return false\n    return true\n  }\n\n  // :: ?Node\n  // The first child of the fragment, or `null` if it is empty.\n  get firstChild() { return this.content.length ? this.content[0] : null }\n\n  // :: ?Node\n  // The last child of the fragment, or `null` if it is empty.\n  get lastChild() { return this.content.length ? this.content[this.content.length - 1] : null }\n\n  // :: number\n  // The number of child nodes in this fragment.\n  get childCount() { return this.content.length }\n\n  // :: (number) → Node\n  // Get the child node at the given index. Raise an error when the\n  // index is out of range.\n  child(index) {\n    let found = this.content[index]\n    if (!found) throw new RangeError(\"Index \" + index + \" out of range for \" + this)\n    return found\n  }\n\n  // :: (number) → ?Node\n  // Get the child node at the given index, if it exists.\n  maybeChild(index) {\n    return this.content[index]\n  }\n\n  // :: ((node: Node, offset: number, index: number))\n  // Call `f` for every child node, passing the node, its offset\n  // into this parent node, and its index.\n  forEach(f) {\n    for (let i = 0, p = 0; i < this.content.length; i++) {\n      let child = this.content[i]\n      f(child, p, i)\n      p += child.nodeSize\n    }\n  }\n\n  // :: (Fragment) → ?number\n  // Find the first position at which this fragment and another\n  // fragment differ, or `null` if they are the same.\n  findDiffStart(other, pos = 0) {\n    return findDiffStart(this, other, pos)\n  }\n\n  // :: (Fragment) → ?{a: number, b: number}\n  // Find the first position, searching from the end, at which this\n  // fragment and the given fragment differ, or `null` if they are the\n  // same. Since this position will not be the same in both nodes, an\n  // object with two separate positions is returned.\n  findDiffEnd(other, pos = this.size, otherPos = other.size) {\n    return findDiffEnd(this, other, pos, otherPos)\n  }\n\n  // : (number, ?number) → {index: number, offset: number}\n  // Find the index and inner offset corresponding to a given relative\n  // position in this fragment. The result object will be reused\n  // (overwritten) the next time the function is called. (Not public.)\n  findIndex(pos, round = -1) {\n    if (pos == 0) return retIndex(0, pos)\n    if (pos == this.size) return retIndex(this.content.length, pos)\n    if (pos > this.size || pos < 0) throw new RangeError(`Position ${pos} outside of fragment (${this})`)\n    for (let i = 0, curPos = 0;; i++) {\n      let cur = this.child(i), end = curPos + cur.nodeSize\n      if (end >= pos) {\n        if (end == pos || round > 0) return retIndex(i + 1, end)\n        return retIndex(i, curPos)\n      }\n      curPos = end\n    }\n  }\n\n  // :: () → string\n  // Return a debugging string that describes this fragment.\n  toString() { return \"<\" + this.toStringInner() + \">\" }\n\n  toStringInner() { return this.content.join(\", \") }\n\n  // :: () → ?Object\n  // Create a JSON-serializeable representation of this fragment.\n  toJSON() {\n    return this.content.length ? this.content.map(n => n.toJSON()) : null\n  }\n\n  // :: (Schema, ?Object) → Fragment\n  // Deserialize a fragment from its JSON representation.\n  static fromJSON(schema, value) {\n    if (!value) return Fragment.empty\n    if (!Array.isArray(value)) throw new RangeError(\"Invalid input for Fragment.fromJSON\")\n    return new Fragment(value.map(schema.nodeFromJSON))\n  }\n\n  // :: ([Node]) → Fragment\n  // Build a fragment from an array of nodes. Ensures that adjacent\n  // text nodes with the same marks are joined together.\n  static fromArray(array) {\n    if (!array.length) return Fragment.empty\n    let joined, size = 0\n    for (let i = 0; i < array.length; i++) {\n      let node = array[i]\n      size += node.nodeSize\n      if (i && node.isText && array[i - 1].sameMarkup(node)) {\n        if (!joined) joined = array.slice(0, i)\n        joined[joined.length - 1] = node.withText(joined[joined.length - 1].text + node.text)\n      } else if (joined) {\n        joined.push(node)\n      }\n    }\n    return new Fragment(joined || array, size)\n  }\n\n  // :: (?union<Fragment, Node, [Node]>) → Fragment\n  // Create a fragment from something that can be interpreted as a set\n  // of nodes. For `null`, it returns the empty fragment. For a\n  // fragment, the fragment itself. For a node or array of nodes, a\n  // fragment containing those nodes.\n  static from(nodes) {\n    if (!nodes) return Fragment.empty\n    if (nodes instanceof Fragment) return nodes\n    if (Array.isArray(nodes)) return this.fromArray(nodes)\n    if (nodes.attrs) return new Fragment([nodes], nodes.nodeSize)\n    throw new RangeError(\"Can not convert \" + nodes + \" to a Fragment\" +\n                         (nodes.nodesBetween ? \" (looks like multiple versions of prosemirror-model were loaded)\" : \"\"))\n  }\n}\n\nconst found = {index: 0, offset: 0}\nfunction retIndex(index, offset) {\n  found.index = index\n  found.offset = offset\n  return found\n}\n\n// :: Fragment\n// An empty fragment. Intended to be reused whenever a node doesn't\n// contain anything (rather than allocating a new empty fragment for\n// each leaf node).\nFragment.empty = new Fragment([], 0)\n","export function compareDeep(a, b) {\n  if (a === b) return true\n  if (!(a && typeof a == \"object\") ||\n      !(b && typeof b == \"object\")) return false\n  let array = Array.isArray(a)\n  if (Array.isArray(b) != array) return false\n  if (array) {\n    if (a.length != b.length) return false\n    for (let i = 0; i < a.length; i++) if (!compareDeep(a[i], b[i])) return false\n  } else {\n    for (let p in a) if (!(p in b) || !compareDeep(a[p], b[p])) return false\n    for (let p in b) if (!(p in a)) return false\n  }\n  return true\n}\n","import {compareDeep} from \"./comparedeep\"\n\n// ::- A mark is a piece of information that can be attached to a node,\n// such as it being emphasized, in code font, or a link. It has a type\n// and optionally a set of attributes that provide further information\n// (such as the target of the link). Marks are created through a\n// `Schema`, which controls which types exist and which\n// attributes they have.\nexport class Mark {\n  constructor(type, attrs) {\n    // :: MarkType\n    // The type of this mark.\n    this.type = type\n    // :: Object\n    // The attributes associated with this mark.\n    this.attrs = attrs\n  }\n\n  // :: ([Mark]) → [Mark]\n  // Given a set of marks, create a new set which contains this one as\n  // well, in the right position. If this mark is already in the set,\n  // the set itself is returned. If any marks that are set to be\n  // [exclusive](#model.MarkSpec.excludes) with this mark are present,\n  // those are replaced by this one.\n  addToSet(set) {\n    let copy, placed = false\n    for (let i = 0; i < set.length; i++) {\n      let other = set[i]\n      if (this.eq(other)) return set\n      if (this.type.excludes(other.type)) {\n        if (!copy) copy = set.slice(0, i)\n      } else if (other.type.excludes(this.type)) {\n        return set\n      } else {\n        if (!placed && other.type.rank > this.type.rank) {\n          if (!copy) copy = set.slice(0, i)\n          copy.push(this)\n          placed = true\n        }\n        if (copy) copy.push(other)\n      }\n    }\n    if (!copy) copy = set.slice()\n    if (!placed) copy.push(this)\n    return copy\n  }\n\n  // :: ([Mark]) → [Mark]\n  // Remove this mark from the given set, returning a new set. If this\n  // mark is not in the set, the set itself is returned.\n  removeFromSet(set) {\n    for (let i = 0; i < set.length; i++)\n      if (this.eq(set[i]))\n        return set.slice(0, i).concat(set.slice(i + 1))\n    return set\n  }\n\n  // :: ([Mark]) → bool\n  // Test whether this mark is in the given set of marks.\n  isInSet(set) {\n    for (let i = 0; i < set.length; i++)\n      if (this.eq(set[i])) return true\n    return false\n  }\n\n  // :: (Mark) → bool\n  // Test whether this mark has the same type and attributes as\n  // another mark.\n  eq(other) {\n    return this == other ||\n      (this.type == other.type && compareDeep(this.attrs, other.attrs))\n  }\n\n  // :: () → Object\n  // Convert this mark to a JSON-serializeable representation.\n  toJSON() {\n    let obj = {type: this.type.name}\n    for (let _ in this.attrs) {\n      obj.attrs = this.attrs\n      break\n    }\n    return obj\n  }\n\n  // :: (Schema, Object) → Mark\n  static fromJSON(schema, json) {\n    if (!json) throw new RangeError(\"Invalid input for Mark.fromJSON\")\n    let type = schema.marks[json.type]\n    if (!type) throw new RangeError(`There is no mark type ${json.type} in this schema`)\n    return type.create(json.attrs)\n  }\n\n  // :: ([Mark], [Mark]) → bool\n  // Test whether two sets of marks are identical.\n  static sameSet(a, b) {\n    if (a == b) return true\n    if (a.length != b.length) return false\n    for (let i = 0; i < a.length; i++)\n      if (!a[i].eq(b[i])) return false\n    return true\n  }\n\n  // :: (?union<Mark, [Mark]>) → [Mark]\n  // Create a properly sorted mark set from null, a single mark, or an\n  // unsorted array of marks.\n  static setFrom(marks) {\n    if (!marks || marks.length == 0) return Mark.none\n    if (marks instanceof Mark) return [marks]\n    let copy = marks.slice()\n    copy.sort((a, b) => a.type.rank - b.type.rank)\n    return copy\n  }\n}\n\n// :: [Mark] The empty set of marks.\nMark.none = []\n","import {Fragment} from \"./fragment\"\n\n// ReplaceError:: class extends Error\n// Error type raised by [`Node.replace`](#model.Node.replace) when\n// given an invalid replacement.\n\nexport function ReplaceError(message) {\n  let err = Error.call(this, message)\n  err.__proto__ = ReplaceError.prototype\n  return err\n}\n\nReplaceError.prototype = Object.create(Error.prototype)\nReplaceError.prototype.constructor = ReplaceError\nReplaceError.prototype.name = \"ReplaceError\"\n\n// ::- A slice represents a piece cut out of a larger document. It\n// stores not only a fragment, but also the depth up to which nodes on\n// both side are ‘open’ (cut through).\nexport class Slice {\n  // :: (Fragment, number, number)\n  // Create a slice. When specifying a non-zero open depth, you must\n  // make sure that there are nodes of at least that depth at the\n  // appropriate side of the fragment—i.e. if the fragment is an empty\n  // paragraph node, `openStart` and `openEnd` can't be greater than 1.\n  //\n  // It is not necessary for the content of open nodes to conform to\n  // the schema's content constraints, though it should be a valid\n  // start/end/middle for such a node, depending on which sides are\n  // open.\n  constructor(content, openStart, openEnd) {\n    // :: Fragment The slice's content.\n    this.content = content\n    // :: number The open depth at the start.\n    this.openStart = openStart\n    // :: number The open depth at the end.\n    this.openEnd = openEnd\n  }\n\n  // :: number\n  // The size this slice would add when inserted into a document.\n  get size() {\n    return this.content.size - this.openStart - this.openEnd\n  }\n\n  insertAt(pos, fragment) {\n    let content = insertInto(this.content, pos + this.openStart, fragment, null)\n    return content && new Slice(content, this.openStart, this.openEnd)\n  }\n\n  removeBetween(from, to) {\n    return new Slice(removeRange(this.content, from + this.openStart, to + this.openStart), this.openStart, this.openEnd)\n  }\n\n  // :: (Slice) → bool\n  // Tests whether this slice is equal to another slice.\n  eq(other) {\n    return this.content.eq(other.content) && this.openStart == other.openStart && this.openEnd == other.openEnd\n  }\n\n  toString() {\n    return this.content + \"(\" + this.openStart + \",\" + this.openEnd + \")\"\n  }\n\n  // :: () → ?Object\n  // Convert a slice to a JSON-serializable representation.\n  toJSON() {\n    if (!this.content.size) return null\n    let json = {content: this.content.toJSON()}\n    if (this.openStart > 0) json.openStart = this.openStart\n    if (this.openEnd > 0) json.openEnd = this.openEnd\n    return json\n  }\n\n  // :: (Schema, ?Object) → Slice\n  // Deserialize a slice from its JSON representation.\n  static fromJSON(schema, json) {\n    if (!json) return Slice.empty\n    let openStart = json.openStart || 0, openEnd = json.openEnd || 0\n    if (typeof openStart != \"number\" || typeof openEnd != \"number\")\n      throw new RangeError(\"Invalid input for Slice.fromJSON\")\n    return new Slice(Fragment.fromJSON(schema, json.content), openStart, openEnd)\n  }\n\n  // :: (Fragment, ?bool) → Slice\n  // Create a slice from a fragment by taking the maximum possible\n  // open value on both side of the fragment.\n  static maxOpen(fragment, openIsolating=true) {\n    let openStart = 0, openEnd = 0\n    for (let n = fragment.firstChild; n && !n.isLeaf && (openIsolating || !n.type.spec.isolating); n = n.firstChild) openStart++\n    for (let n = fragment.lastChild; n && !n.isLeaf && (openIsolating || !n.type.spec.isolating); n = n.lastChild) openEnd++\n    return new Slice(fragment, openStart, openEnd)\n  }\n}\n\nfunction removeRange(content, from, to) {\n  let {index, offset} = content.findIndex(from), child = content.maybeChild(index)\n  let {index: indexTo, offset: offsetTo} = content.findIndex(to)\n  if (offset == from || child.isText) {\n    if (offsetTo != to && !content.child(indexTo).isText) throw new RangeError(\"Removing non-flat range\")\n    return content.cut(0, from).append(content.cut(to))\n  }\n  if (index != indexTo) throw new RangeError(\"Removing non-flat range\")\n  return content.replaceChild(index, child.copy(removeRange(child.content, from - offset - 1, to - offset - 1)))\n}\n\nfunction insertInto(content, dist, insert, parent) {\n  let {index, offset} = content.findIndex(dist), child = content.maybeChild(index)\n  if (offset == dist || child.isText) {\n    if (parent && !parent.canReplace(index, index, insert)) return null\n    return content.cut(0, dist).append(insert).append(content.cut(dist))\n  }\n  let inner = insertInto(child.content, dist - offset - 1, insert)\n  return inner && content.replaceChild(index, child.copy(inner))\n}\n\n// :: Slice\n// The empty slice.\nSlice.empty = new Slice(Fragment.empty, 0, 0)\n\nexport function replace($from, $to, slice) {\n  if (slice.openStart > $from.depth)\n    throw new ReplaceError(\"Inserted content deeper than insertion position\")\n  if ($from.depth - slice.openStart != $to.depth - slice.openEnd)\n    throw new ReplaceError(\"Inconsistent open depths\")\n  return replaceOuter($from, $to, slice, 0)\n}\n\nfunction replaceOuter($from, $to, slice, depth) {\n  let index = $from.index(depth), node = $from.node(depth)\n  if (index == $to.index(depth) && depth < $from.depth - slice.openStart) {\n    let inner = replaceOuter($from, $to, slice, depth + 1)\n    return node.copy(node.content.replaceChild(index, inner))\n  } else if (!slice.content.size) {\n    return close(node, replaceTwoWay($from, $to, depth))\n  } else if (!slice.openStart && !slice.openEnd && $from.depth == depth && $to.depth == depth) { // Simple, flat case\n    let parent = $from.parent, content = parent.content\n    return close(parent, content.cut(0, $from.parentOffset).append(slice.content).append(content.cut($to.parentOffset)))\n  } else {\n    let {start, end} = prepareSliceForReplace(slice, $from)\n    return close(node, replaceThreeWay($from, start, end, $to, depth))\n  }\n}\n\nfunction checkJoin(main, sub) {\n  if (!sub.type.compatibleContent(main.type))\n    throw new ReplaceError(\"Cannot join \" + sub.type.name + \" onto \" + main.type.name)\n}\n\nfunction joinable($before, $after, depth) {\n  let node = $before.node(depth)\n  checkJoin(node, $after.node(depth))\n  return node\n}\n\nfunction addNode(child, target) {\n  let last = target.length - 1\n  if (last >= 0 && child.isText && child.sameMarkup(target[last]))\n    target[last] = child.withText(target[last].text + child.text)\n  else\n    target.push(child)\n}\n\nfunction addRange($start, $end, depth, target) {\n  let node = ($end || $start).node(depth)\n  let startIndex = 0, endIndex = $end ? $end.index(depth) : node.childCount\n  if ($start) {\n    startIndex = $start.index(depth)\n    if ($start.depth > depth) {\n      startIndex++\n    } else if ($start.textOffset) {\n      addNode($start.nodeAfter, target)\n      startIndex++\n    }\n  }\n  for (let i = startIndex; i < endIndex; i++) addNode(node.child(i), target)\n  if ($end && $end.depth == depth && $end.textOffset)\n    addNode($end.nodeBefore, target)\n}\n\nfunction close(node, content) {\n  if (!node.type.validContent(content))\n    throw new ReplaceError(\"Invalid content for node \" + node.type.name)\n  return node.copy(content)\n}\n\nfunction replaceThreeWay($from, $start, $end, $to, depth) {\n  let openStart = $from.depth > depth && joinable($from, $start, depth + 1)\n  let openEnd = $to.depth > depth && joinable($end, $to, depth + 1)\n\n  let content = []\n  addRange(null, $from, depth, content)\n  if (openStart && openEnd && $start.index(depth) == $end.index(depth)) {\n    checkJoin(openStart, openEnd)\n    addNode(close(openStart, replaceThreeWay($from, $start, $end, $to, depth + 1)), content)\n  } else {\n    if (openStart)\n      addNode(close(openStart, replaceTwoWay($from, $start, depth + 1)), content)\n    addRange($start, $end, depth, content)\n    if (openEnd)\n      addNode(close(openEnd, replaceTwoWay($end, $to, depth + 1)), content)\n  }\n  addRange($to, null, depth, content)\n  return new Fragment(content)\n}\n\nfunction replaceTwoWay($from, $to, depth) {\n  let content = []\n  addRange(null, $from, depth, content)\n  if ($from.depth > depth) {\n    let type = joinable($from, $to, depth + 1)\n    addNode(close(type, replaceTwoWay($from, $to, depth + 1)), content)\n  }\n  addRange($to, null, depth, content)\n  return new Fragment(content)\n}\n\nfunction prepareSliceForReplace(slice, $along) {\n  let extra = $along.depth - slice.openStart, parent = $along.node(extra)\n  let node = parent.copy(slice.content)\n  for (let i = extra - 1; i >= 0; i--)\n    node = $along.node(i).copy(Fragment.from(node))\n  return {start: node.resolveNoCache(slice.openStart + extra),\n          end: node.resolveNoCache(node.content.size - slice.openEnd - extra)}\n}\n","import {Mark} from \"./mark\"\n\n// ::- You can [_resolve_](#model.Node.resolve) a position to get more\n// information about it. Objects of this class represent such a\n// resolved position, providing various pieces of context information,\n// and some helper methods.\n//\n// Throughout this interface, methods that take an optional `depth`\n// parameter will interpret undefined as `this.depth` and negative\n// numbers as `this.depth + value`.\nexport class ResolvedPos {\n  constructor(pos, path, parentOffset) {\n    // :: number The position that was resolved.\n    this.pos = pos\n    this.path = path\n    // :: number\n    // The number of levels the parent node is from the root. If this\n    // position points directly into the root node, it is 0. If it\n    // points into a top-level paragraph, 1, and so on.\n    this.depth = path.length / 3 - 1\n    // :: number The offset this position has into its parent node.\n    this.parentOffset = parentOffset\n  }\n\n  resolveDepth(val) {\n    if (val == null) return this.depth\n    if (val < 0) return this.depth + val\n    return val\n  }\n\n  // :: Node\n  // The parent node that the position points into. Note that even if\n  // a position points into a text node, that node is not considered\n  // the parent—text nodes are ‘flat’ in this model, and have no content.\n  get parent() { return this.node(this.depth) }\n\n  // :: Node\n  // The root node in which the position was resolved.\n  get doc() { return this.node(0) }\n\n  // :: (?number) → Node\n  // The ancestor node at the given level. `p.node(p.depth)` is the\n  // same as `p.parent`.\n  node(depth) { return this.path[this.resolveDepth(depth) * 3] }\n\n  // :: (?number) → number\n  // The index into the ancestor at the given level. If this points at\n  // the 3rd node in the 2nd paragraph on the top level, for example,\n  // `p.index(0)` is 1 and `p.index(1)` is 2.\n  index(depth) { return this.path[this.resolveDepth(depth) * 3 + 1] }\n\n  // :: (?number) → number\n  // The index pointing after this position into the ancestor at the\n  // given level.\n  indexAfter(depth) {\n    depth = this.resolveDepth(depth)\n    return this.index(depth) + (depth == this.depth && !this.textOffset ? 0 : 1)\n  }\n\n  // :: (?number) → number\n  // The (absolute) position at the start of the node at the given\n  // level.\n  start(depth) {\n    depth = this.resolveDepth(depth)\n    return depth == 0 ? 0 : this.path[depth * 3 - 1] + 1\n  }\n\n  // :: (?number) → number\n  // The (absolute) position at the end of the node at the given\n  // level.\n  end(depth) {\n    depth = this.resolveDepth(depth)\n    return this.start(depth) + this.node(depth).content.size\n  }\n\n  // :: (?number) → number\n  // The (absolute) position directly before the wrapping node at the\n  // given level, or, when `depth` is `this.depth + 1`, the original\n  // position.\n  before(depth) {\n    depth = this.resolveDepth(depth)\n    if (!depth) throw new RangeError(\"There is no position before the top-level node\")\n    return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1]\n  }\n\n  // :: (?number) → number\n  // The (absolute) position directly after the wrapping node at the\n  // given level, or the original position when `depth` is `this.depth + 1`.\n  after(depth) {\n    depth = this.resolveDepth(depth)\n    if (!depth) throw new RangeError(\"There is no position after the top-level node\")\n    return depth == this.depth + 1 ? this.pos : this.path[depth * 3 - 1] + this.path[depth * 3].nodeSize\n  }\n\n  // :: number\n  // When this position points into a text node, this returns the\n  // distance between the position and the start of the text node.\n  // Will be zero for positions that point between nodes.\n  get textOffset() { return this.pos - this.path[this.path.length - 1] }\n\n  // :: ?Node\n  // Get the node directly after the position, if any. If the position\n  // points into a text node, only the part of that node after the\n  // position is returned.\n  get nodeAfter() {\n    let parent = this.parent, index = this.index(this.depth)\n    if (index == parent.childCount) return null\n    let dOff = this.pos - this.path[this.path.length - 1], child = parent.child(index)\n    return dOff ? parent.child(index).cut(dOff) : child\n  }\n\n  // :: ?Node\n  // Get the node directly before the position, if any. If the\n  // position points into a text node, only the part of that node\n  // before the position is returned.\n  get nodeBefore() {\n    let index = this.index(this.depth)\n    let dOff = this.pos - this.path[this.path.length - 1]\n    if (dOff) return this.parent.child(index).cut(0, dOff)\n    return index == 0 ? null : this.parent.child(index - 1)\n  }\n\n  // :: (number, ?number) → number\n  // Get the position at the given index in the parent node at the\n  // given depth (which defaults to `this.depth`).\n  posAtIndex(index, depth) {\n    depth = this.resolveDepth(depth)\n    let node = this.path[depth * 3], pos = depth == 0 ? 0 : this.path[depth * 3 - 1] + 1\n    for (let i = 0; i < index; i++) pos += node.child(i).nodeSize\n    return pos\n  }\n\n  // :: () → [Mark]\n  // Get the marks at this position, factoring in the surrounding\n  // marks' [`inclusive`](#model.MarkSpec.inclusive) property. If the\n  // position is at the start of a non-empty node, the marks of the\n  // node after it (if any) are returned.\n  marks() {\n    let parent = this.parent, index = this.index()\n\n    // In an empty parent, return the empty array\n    if (parent.content.size == 0) return Mark.none\n\n    // When inside a text node, just return the text node's marks\n    if (this.textOffset) return parent.child(index).marks\n\n    let main = parent.maybeChild(index - 1), other = parent.maybeChild(index)\n    // If the `after` flag is true of there is no node before, make\n    // the node after this position the main reference.\n    if (!main) { let tmp = main; main = other; other = tmp }\n\n    // Use all marks in the main node, except those that have\n    // `inclusive` set to false and are not present in the other node.\n    let marks = main.marks\n    for (var i = 0; i < marks.length; i++)\n      if (marks[i].type.spec.inclusive === false && (!other || !marks[i].isInSet(other.marks)))\n        marks = marks[i--].removeFromSet(marks)\n\n    return marks\n  }\n\n  // :: (ResolvedPos) → ?[Mark]\n  // Get the marks after the current position, if any, except those\n  // that are non-inclusive and not present at position `$end`. This\n  // is mostly useful for getting the set of marks to preserve after a\n  // deletion. Will return `null` if this position is at the end of\n  // its parent node or its parent node isn't a textblock (in which\n  // case no marks should be preserved).\n  marksAcross($end) {\n    let after = this.parent.maybeChild(this.index())\n    if (!after || !after.isInline) return null\n\n    let marks = after.marks, next = $end.parent.maybeChild($end.index())\n    for (var i = 0; i < marks.length; i++)\n      if (marks[i].type.spec.inclusive === false && (!next || !marks[i].isInSet(next.marks)))\n        marks = marks[i--].removeFromSet(marks)\n    return marks\n  }\n\n  // :: (number) → number\n  // The depth up to which this position and the given (non-resolved)\n  // position share the same parent nodes.\n  sharedDepth(pos) {\n    for (let depth = this.depth; depth > 0; depth--)\n      if (this.start(depth) <= pos && this.end(depth) >= pos) return depth\n    return 0\n  }\n\n  // :: (?ResolvedPos, ?(Node) → bool) → ?NodeRange\n  // Returns a range based on the place where this position and the\n  // given position diverge around block content. If both point into\n  // the same textblock, for example, a range around that textblock\n  // will be returned. If they point into different blocks, the range\n  // around those blocks in their shared ancestor is returned. You can\n  // pass in an optional predicate that will be called with a parent\n  // node to see if a range into that parent is acceptable.\n  blockRange(other = this, pred) {\n    if (other.pos < this.pos) return other.blockRange(this)\n    for (let d = this.depth - (this.parent.inlineContent || this.pos == other.pos ? 1 : 0); d >= 0; d--)\n      if (other.pos <= this.end(d) && (!pred || pred(this.node(d))))\n        return new NodeRange(this, other, d)\n  }\n\n  // :: (ResolvedPos) → bool\n  // Query whether the given position shares the same parent node.\n  sameParent(other) {\n    return this.pos - this.parentOffset == other.pos - other.parentOffset\n  }\n\n  // :: (ResolvedPos) → ResolvedPos\n  // Return the greater of this and the given position.\n  max(other) {\n    return other.pos > this.pos ? other : this\n  }\n\n  // :: (ResolvedPos) → ResolvedPos\n  // Return the smaller of this and the given position.\n  min(other) {\n    return other.pos < this.pos ? other : this\n  }\n\n  toString() {\n    let str = \"\"\n    for (let i = 1; i <= this.depth; i++)\n      str += (str ? \"/\" : \"\") + this.node(i).type.name + \"_\" + this.index(i - 1)\n    return str + \":\" + this.parentOffset\n  }\n\n  static resolve(doc, pos) {\n    if (!(pos >= 0 && pos <= doc.content.size)) throw new RangeError(\"Position \" + pos + \" out of range\")\n    let path = []\n    let start = 0, parentOffset = pos\n    for (let node = doc;;) {\n      let {index, offset} = node.content.findIndex(parentOffset)\n      let rem = parentOffset - offset\n      path.push(node, index, start + offset)\n      if (!rem) break\n      node = node.child(index)\n      if (node.isText) break\n      parentOffset = rem - 1\n      start += offset + 1\n    }\n    return new ResolvedPos(pos, path, parentOffset)\n  }\n\n  static resolveCached(doc, pos) {\n    for (let i = 0; i < resolveCache.length; i++) {\n      let cached = resolveCache[i]\n      if (cached.pos == pos && cached.doc == doc) return cached\n    }\n    let result = resolveCache[resolveCachePos] = ResolvedPos.resolve(doc, pos)\n    resolveCachePos = (resolveCachePos + 1) % resolveCacheSize\n    return result\n  }\n}\n\nlet resolveCache = [], resolveCachePos = 0, resolveCacheSize = 12\n\n// ::- Represents a flat range of content, i.e. one that starts and\n// ends in the same node.\nexport class NodeRange {\n  // :: (ResolvedPos, ResolvedPos, number)\n  // Construct a node range. `$from` and `$to` should point into the\n  // same node until at least the given `depth`, since a node range\n  // denotes an adjacent set of nodes in a single parent node.\n  constructor($from, $to, depth) {\n    // :: ResolvedPos A resolved position along the start of the\n    // content. May have a `depth` greater than this object's `depth`\n    // property, since these are the positions that were used to\n    // compute the range, not re-resolved positions directly at its\n    // boundaries.\n    this.$from = $from\n    // :: ResolvedPos A position along the end of the content. See\n    // caveat for [`$from`](#model.NodeRange.$from).\n    this.$to = $to\n    // :: number The depth of the node that this range points into.\n    this.depth = depth\n  }\n\n  // :: number The position at the start of the range.\n  get start() { return this.$from.before(this.depth + 1) }\n  // :: number The position at the end of the range.\n  get end() { return this.$to.after(this.depth + 1) }\n\n  // :: Node The parent node that the range points into.\n  get parent() { return this.$from.node(this.depth) }\n  // :: number The start index of the range in the parent node.\n  get startIndex() { return this.$from.index(this.depth) }\n  // :: number The end index of the range in the parent node.\n  get endIndex() { return this.$to.indexAfter(this.depth) }\n}\n","import {Fragment} from \"./fragment\"\nimport {Mark} from \"./mark\"\nimport {Slice, replace} from \"./replace\"\nimport {ResolvedPos} from \"./resolvedpos\"\nimport {compareDeep} from \"./comparedeep\"\n\nconst emptyAttrs = Object.create(null)\n\n// ::- This class represents a node in the tree that makes up a\n// ProseMirror document. So a document is an instance of `Node`, with\n// children that are also instances of `Node`.\n//\n// Nodes are persistent data structures. Instead of changing them, you\n// create new ones with the content you want. Old ones keep pointing\n// at the old document shape. This is made cheaper by sharing\n// structure between the old and new data as much as possible, which a\n// tree shape like this (without back pointers) makes easy.\n//\n// **Do not** directly mutate the properties of a `Node` object. See\n// [the guide](/docs/guide/#doc) for more information.\nexport class Node {\n  constructor(type, attrs, content, marks) {\n    // :: NodeType\n    // The type of node that this is.\n    this.type = type\n\n    // :: Object\n    // An object mapping attribute names to values. The kind of\n    // attributes allowed and required are\n    // [determined](#model.NodeSpec.attrs) by the node type.\n    this.attrs = attrs\n\n    // :: Fragment\n    // A container holding the node's children.\n    this.content = content || Fragment.empty\n\n    // :: [Mark]\n    // The marks (things like whether it is emphasized or part of a\n    // link) applied to this node.\n    this.marks = marks || Mark.none\n  }\n\n  // text:: ?string\n  // For text nodes, this contains the node's text content.\n\n  // :: number\n  // The size of this node, as defined by the integer-based [indexing\n  // scheme](/docs/guide/#doc.indexing). For text nodes, this is the\n  // amount of characters. For other leaf nodes, it is one. For\n  // non-leaf nodes, it is the size of the content plus two (the start\n  // and end token).\n  get nodeSize() { return this.isLeaf ? 1 : 2 + this.content.size }\n\n  // :: number\n  // The number of children that the node has.\n  get childCount() { return this.content.childCount }\n\n  // :: (number) → Node\n  // Get the child node at the given index. Raises an error when the\n  // index is out of range.\n  child(index) { return this.content.child(index) }\n\n  // :: (number) → ?Node\n  // Get the child node at the given index, if it exists.\n  maybeChild(index) { return this.content.maybeChild(index) }\n\n  // :: ((node: Node, offset: number, index: number))\n  // Call `f` for every child node, passing the node, its offset\n  // into this parent node, and its index.\n  forEach(f) { this.content.forEach(f) }\n\n  // :: (number, number, (node: Node, pos: number, parent: Node, index: number) → ?bool, ?number)\n  // Invoke a callback for all descendant nodes recursively between\n  // the given two positions that are relative to start of this node's\n  // content. The callback is invoked with the node, its\n  // parent-relative position, its parent node, and its child index.\n  // When the callback returns false for a given node, that node's\n  // children will not be recursed over. The last parameter can be\n  // used to specify a starting position to count from.\n  nodesBetween(from, to, f, startPos = 0) {\n    this.content.nodesBetween(from, to, f, startPos, this)\n  }\n\n  // :: ((node: Node, pos: number, parent: Node, index: number) → ?bool)\n  // Call the given callback for every descendant node. Doesn't\n  // descend into a node when the callback returns `false`.\n  descendants(f) {\n    this.nodesBetween(0, this.content.size, f)\n  }\n\n  // :: string\n  // Concatenates all the text nodes found in this fragment and its\n  // children.\n  get textContent() { return this.textBetween(0, this.content.size, \"\") }\n\n  // :: (number, number, ?string, ?union<string, ?(leafNode: Node) -> string>) → string\n  // Get all text between positions `from` and `to`. When\n  // `blockSeparator` is given, it will be inserted to separate text\n  // from different block nodes. When `leafText` is given, it'll be\n  // inserted for every non-text leaf node encountered.\n  textBetween(from, to, blockSeparator, leafText) {\n    return this.content.textBetween(from, to, blockSeparator, leafText)\n  }\n\n  // :: ?Node\n  // Returns this node's first child, or `null` if there are no\n  // children.\n  get firstChild() { return this.content.firstChild }\n\n  // :: ?Node\n  // Returns this node's last child, or `null` if there are no\n  // children.\n  get lastChild() { return this.content.lastChild }\n\n  // :: (Node) → bool\n  // Test whether two nodes represent the same piece of document.\n  eq(other) {\n    return this == other || (this.sameMarkup(other) && this.content.eq(other.content))\n  }\n\n  // :: (Node) → bool\n  // Compare the markup (type, attributes, and marks) of this node to\n  // those of another. Returns `true` if both have the same markup.\n  sameMarkup(other) {\n    return this.hasMarkup(other.type, other.attrs, other.marks)\n  }\n\n  // :: (NodeType, ?Object, ?[Mark]) → bool\n  // Check whether this node's markup correspond to the given type,\n  // attributes, and marks.\n  hasMarkup(type, attrs, marks) {\n    return this.type == type &&\n      compareDeep(this.attrs, attrs || type.defaultAttrs || emptyAttrs) &&\n      Mark.sameSet(this.marks, marks || Mark.none)\n  }\n\n  // :: (?Fragment) → Node\n  // Create a new node with the same markup as this node, containing\n  // the given content (or empty, if no content is given).\n  copy(content = null) {\n    if (content == this.content) return this\n    return new this.constructor(this.type, this.attrs, content, this.marks)\n  }\n\n  // :: ([Mark]) → Node\n  // Create a copy of this node, with the given set of marks instead\n  // of the node's own marks.\n  mark(marks) {\n    return marks == this.marks ? this : new this.constructor(this.type, this.attrs, this.content, marks)\n  }\n\n  // :: (number, ?number) → Node\n  // Create a copy of this node with only the content between the\n  // given positions. If `to` is not given, it defaults to the end of\n  // the node.\n  cut(from, to) {\n    if (from == 0 && to == this.content.size) return this\n    return this.copy(this.content.cut(from, to))\n  }\n\n  // :: (number, ?number) → Slice\n  // Cut out the part of the document between the given positions, and\n  // return it as a `Slice` object.\n  slice(from, to = this.content.size, includeParents = false) {\n    if (from == to) return Slice.empty\n\n    let $from = this.resolve(from), $to = this.resolve(to)\n    let depth = includeParents ? 0 : $from.sharedDepth(to)\n    let start = $from.start(depth), node = $from.node(depth)\n    let content = node.content.cut($from.pos - start, $to.pos - start)\n    return new Slice(content, $from.depth - depth, $to.depth - depth)\n  }\n\n  // :: (number, number, Slice) → Node\n  // Replace the part of the document between the given positions with\n  // the given slice. The slice must 'fit', meaning its open sides\n  // must be able to connect to the surrounding content, and its\n  // content nodes must be valid children for the node they are placed\n  // into. If any of this is violated, an error of type\n  // [`ReplaceError`](#model.ReplaceError) is thrown.\n  replace(from, to, slice) {\n    return replace(this.resolve(from), this.resolve(to), slice)\n  }\n\n  // :: (number) → ?Node\n  // Find the node directly after the given position.\n  nodeAt(pos) {\n    for (let node = this;;) {\n      let {index, offset} = node.content.findIndex(pos)\n      node = node.maybeChild(index)\n      if (!node) return null\n      if (offset == pos || node.isText) return node\n      pos -= offset + 1\n    }\n  }\n\n  // :: (number) → {node: ?Node, index: number, offset: number}\n  // Find the (direct) child node after the given offset, if any,\n  // and return it along with its index and offset relative to this\n  // node.\n  childAfter(pos) {\n    let {index, offset} = this.content.findIndex(pos)\n    return {node: this.content.maybeChild(index), index, offset}\n  }\n\n  // :: (number) → {node: ?Node, index: number, offset: number}\n  // Find the (direct) child node before the given offset, if any,\n  // and return it along with its index and offset relative to this\n  // node.\n  childBefore(pos) {\n    if (pos == 0) return {node: null, index: 0, offset: 0}\n    let {index, offset} = this.content.findIndex(pos)\n    if (offset < pos) return {node: this.content.child(index), index, offset}\n    let node = this.content.child(index - 1)\n    return {node, index: index - 1, offset: offset - node.nodeSize}\n  }\n\n  // :: (number) → ResolvedPos\n  // Resolve the given position in the document, returning an\n  // [object](#model.ResolvedPos) with information about its context.\n  resolve(pos) { return ResolvedPos.resolveCached(this, pos) }\n\n  resolveNoCache(pos) { return ResolvedPos.resolve(this, pos) }\n\n  // :: (number, number, union<Mark, MarkType>) → bool\n  // Test whether a given mark or mark type occurs in this document\n  // between the two given positions.\n  rangeHasMark(from, to, type) {\n    let found = false\n    if (to > from) this.nodesBetween(from, to, node => {\n      if (type.isInSet(node.marks)) found = true\n      return !found\n    })\n    return found\n  }\n\n  // :: bool\n  // True when this is a block (non-inline node)\n  get isBlock() { return this.type.isBlock }\n\n  // :: bool\n  // True when this is a textblock node, a block node with inline\n  // content.\n  get isTextblock() { return this.type.isTextblock }\n\n  // :: bool\n  // True when this node allows inline content.\n  get inlineContent() { return this.type.inlineContent }\n\n  // :: bool\n  // True when this is an inline node (a text node or a node that can\n  // appear among text).\n  get isInline() { return this.type.isInline }\n\n  // :: bool\n  // True when this is a text node.\n  get isText() { return this.type.isText }\n\n  // :: bool\n  // True when this is a leaf node.\n  get isLeaf() { return this.type.isLeaf }\n\n  // :: bool\n  // True when this is an atom, i.e. when it does not have directly\n  // editable content. This is usually the same as `isLeaf`, but can\n  // be configured with the [`atom` property](#model.NodeSpec.atom) on\n  // a node's spec (typically used when the node is displayed as an\n  // uneditable [node view](#view.NodeView)).\n  get isAtom() { return this.type.isAtom }\n\n  // :: () → string\n  // Return a string representation of this node for debugging\n  // purposes.\n  toString() {\n    if (this.type.spec.toDebugString) return this.type.spec.toDebugString(this)\n    let name = this.type.name\n    if (this.content.size)\n      name += \"(\" + this.content.toStringInner() + \")\"\n    return wrapMarks(this.marks, name)\n  }\n\n  // :: (number) → ContentMatch\n  // Get the content match in this node at the given index.\n  contentMatchAt(index) {\n    let match = this.type.contentMatch.matchFragment(this.content, 0, index)\n    if (!match) throw new Error(\"Called contentMatchAt on a node with invalid content\")\n    return match\n  }\n\n  // :: (number, number, ?Fragment, ?number, ?number) → bool\n  // Test whether replacing the range between `from` and `to` (by\n  // child index) with the given replacement fragment (which defaults\n  // to the empty fragment) would leave the node's content valid. You\n  // can optionally pass `start` and `end` indices into the\n  // replacement fragment.\n  canReplace(from, to, replacement = Fragment.empty, start = 0, end = replacement.childCount) {\n    let one = this.contentMatchAt(from).matchFragment(replacement, start, end)\n    let two = one && one.matchFragment(this.content, to)\n    if (!two || !two.validEnd) return false\n    for (let i = start; i < end; i++) if (!this.type.allowsMarks(replacement.child(i).marks)) return false\n    return true\n  }\n\n  // :: (number, number, NodeType, ?[Mark]) → bool\n  // Test whether replacing the range `from` to `to` (by index) with a\n  // node of the given type would leave the node's content valid.\n  canReplaceWith(from, to, type, marks) {\n    if (marks && !this.type.allowsMarks(marks)) return false\n    let start = this.contentMatchAt(from).matchType(type)\n    let end = start && start.matchFragment(this.content, to)\n    return end ? end.validEnd : false\n  }\n\n  // :: (Node) → bool\n  // Test whether the given node's content could be appended to this\n  // node. If that node is empty, this will only return true if there\n  // is at least one node type that can appear in both nodes (to avoid\n  // merging completely incompatible nodes).\n  canAppend(other) {\n    if (other.content.size) return this.canReplace(this.childCount, this.childCount, other.content)\n    else return this.type.compatibleContent(other.type)\n  }\n\n  // :: ()\n  // Check whether this node and its descendants conform to the\n  // schema, and raise error when they do not.\n  check() {\n    if (!this.type.validContent(this.content))\n      throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0, 50)}`)\n    let copy = Mark.none\n    for (let i = 0; i < this.marks.length; i++) copy = this.marks[i].addToSet(copy)\n    if (!Mark.sameSet(copy, this.marks))\n      throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(m => m.type.name)}`)\n    this.content.forEach(node => node.check())\n  }\n\n  // :: () → Object\n  // Return a JSON-serializeable representation of this node.\n  toJSON() {\n    let obj = {type: this.type.name}\n    for (let _ in this.attrs) {\n      obj.attrs = this.attrs\n      break\n    }\n    if (this.content.size)\n      obj.content = this.content.toJSON()\n    if (this.marks.length)\n      obj.marks = this.marks.map(n => n.toJSON())\n    return obj\n  }\n\n  // :: (Schema, Object) → Node\n  // Deserialize a node from its JSON representation.\n  static fromJSON(schema, json) {\n    if (!json) throw new RangeError(\"Invalid input for Node.fromJSON\")\n    let marks = null\n    if (json.marks) {\n      if (!Array.isArray(json.marks)) throw new RangeError(\"Invalid mark data for Node.fromJSON\")\n      marks = json.marks.map(schema.markFromJSON)\n    }\n    if (json.type == \"text\") {\n      if (typeof json.text != \"string\") throw new RangeError(\"Invalid text node in JSON\")\n      return schema.text(json.text, marks)\n    }\n    let content = Fragment.fromJSON(schema, json.content)\n    return schema.nodeType(json.type).create(json.attrs, content, marks)\n  }\n}\n\nexport class TextNode extends Node {\n  constructor(type, attrs, content, marks) {\n    super(type, attrs, null, marks)\n\n    if (!content) throw new RangeError(\"Empty text nodes are not allowed\")\n\n    this.text = content\n  }\n\n  toString() {\n    if (this.type.spec.toDebugString) return this.type.spec.toDebugString(this)\n    return wrapMarks(this.marks, JSON.stringify(this.text))\n  }\n\n  get textContent() { return this.text }\n\n  textBetween(from, to) { return this.text.slice(from, to) }\n\n  get nodeSize() { return this.text.length }\n\n  mark(marks) {\n    return marks == this.marks ? this : new TextNode(this.type, this.attrs, this.text, marks)\n  }\n\n  withText(text) {\n    if (text == this.text) return this\n    return new TextNode(this.type, this.attrs, text, this.marks)\n  }\n\n  cut(from = 0, to = this.text.length) {\n    if (from == 0 && to == this.text.length) return this\n    return this.withText(this.text.slice(from, to))\n  }\n\n  eq(other) {\n    return this.sameMarkup(other) && this.text == other.text\n  }\n\n  toJSON() {\n    let base = super.toJSON()\n    base.text = this.text\n    return base\n  }\n}\n\nfunction wrapMarks(marks, str) {\n  for (let i = marks.length - 1; i >= 0; i--)\n    str = marks[i].type.name + \"(\" + str + \")\"\n  return str\n}\n","import {Fragment} from \"./fragment\"\n\n// ::- Instances of this class represent a match state of a node\n// type's [content expression](#model.NodeSpec.content), and can be\n// used to find out whether further content matches here, and whether\n// a given position is a valid end of the node.\nexport class ContentMatch {\n  constructor(validEnd) {\n    // :: bool\n    // True when this match state represents a valid end of the node.\n    this.validEnd = validEnd\n    this.next = []\n    this.wrapCache = []\n  }\n\n  static parse(string, nodeTypes) {\n    let stream = new TokenStream(string, nodeTypes)\n    if (stream.next == null) return ContentMatch.empty\n    let expr = parseExpr(stream)\n    if (stream.next) stream.err(\"Unexpected trailing text\")\n    let match = dfa(nfa(expr))\n    checkForDeadEnds(match, stream)\n    return match\n  }\n\n  // :: (NodeType) → ?ContentMatch\n  // Match a node type, returning a match after that node if\n  // successful.\n  matchType(type) {\n    for (let i = 0; i < this.next.length; i += 2)\n      if (this.next[i] == type) return this.next[i + 1]\n    return null\n  }\n\n  // :: (Fragment, ?number, ?number) → ?ContentMatch\n  // Try to match a fragment. Returns the resulting match when\n  // successful.\n  matchFragment(frag, start = 0, end = frag.childCount) {\n    let cur = this\n    for (let i = start; cur && i < end; i++)\n      cur = cur.matchType(frag.child(i).type)\n    return cur\n  }\n\n  get inlineContent() {\n    let first = this.next[0]\n    return first ? first.isInline : false\n  }\n\n  // :: ?NodeType\n  // Get the first matching node type at this match position that can\n  // be generated.\n  get defaultType() {\n    for (let i = 0; i < this.next.length; i += 2) {\n      let type = this.next[i]\n      if (!(type.isText || type.hasRequiredAttrs())) return type\n    }\n  }\n\n  compatible(other) {\n    for (let i = 0; i < this.next.length; i += 2)\n      for (let j = 0; j < other.next.length; j += 2)\n        if (this.next[i] == other.next[j]) return true\n    return false\n  }\n\n  // :: (Fragment, bool, ?number) → ?Fragment\n  // Try to match the given fragment, and if that fails, see if it can\n  // be made to match by inserting nodes in front of it. When\n  // successful, return a fragment of inserted nodes (which may be\n  // empty if nothing had to be inserted). When `toEnd` is true, only\n  // return a fragment if the resulting match goes to the end of the\n  // content expression.\n  fillBefore(after, toEnd = false, startIndex = 0) {\n    let seen = [this]\n    function search(match, types) {\n      let finished = match.matchFragment(after, startIndex)\n      if (finished && (!toEnd || finished.validEnd))\n        return Fragment.from(types.map(tp => tp.createAndFill()))\n\n      for (let i = 0; i < match.next.length; i += 2) {\n        let type = match.next[i], next = match.next[i + 1]\n        if (!(type.isText || type.hasRequiredAttrs()) && seen.indexOf(next) == -1) {\n          seen.push(next)\n          let found = search(next, types.concat(type))\n          if (found) return found\n        }\n      }\n    }\n\n    return search(this, [])\n  }\n\n  // :: (NodeType) → ?[NodeType]\n  // Find a set of wrapping node types that would allow a node of the\n  // given type to appear at this position. The result may be empty\n  // (when it fits directly) and will be null when no such wrapping\n  // exists.\n  findWrapping(target) {\n    for (let i = 0; i < this.wrapCache.length; i += 2)\n      if (this.wrapCache[i] == target) return this.wrapCache[i + 1]\n    let computed = this.computeWrapping(target)\n    this.wrapCache.push(target, computed)\n    return computed\n  }\n\n  computeWrapping(target) {\n    let seen = Object.create(null), active = [{match: this, type: null, via: null}]\n    while (active.length) {\n      let current = active.shift(), match = current.match\n      if (match.matchType(target)) {\n        let result = []\n        for (let obj = current; obj.type; obj = obj.via)\n          result.push(obj.type)\n        return result.reverse()\n      }\n      for (let i = 0; i < match.next.length; i += 2) {\n        let type = match.next[i]\n        if (!type.isLeaf && !type.hasRequiredAttrs() && !(type.name in seen) && (!current.type || match.next[i + 1].validEnd)) {\n          active.push({match: type.contentMatch, type, via: current})\n          seen[type.name] = true\n        }\n      }\n    }\n  }\n\n  // :: number\n  // The number of outgoing edges this node has in the finite\n  // automaton that describes the content expression.\n  get edgeCount() {\n    return this.next.length >> 1\n  }\n\n  // :: (number) → {type: NodeType, next: ContentMatch}\n  // Get the _n_​th outgoing edge from this node in the finite\n  // automaton that describes the content expression.\n  edge(n) {\n    let i = n << 1\n    if (i >= this.next.length) throw new RangeError(`There's no ${n}th edge in this content match`)\n    return {type: this.next[i], next: this.next[i + 1]}\n  }\n\n  toString() {\n    let seen = []\n    function scan(m) {\n      seen.push(m)\n      for (let i = 1; i < m.next.length; i += 2)\n        if (seen.indexOf(m.next[i]) == -1) scan(m.next[i])\n    }\n    scan(this)\n    return seen.map((m, i) => {\n      let out = i + (m.validEnd ? \"*\" : \" \") + \" \"\n      for (let i = 0; i < m.next.length; i += 2)\n        out += (i ? \", \" : \"\") + m.next[i].name + \"->\" + seen.indexOf(m.next[i + 1])\n      return out\n    }).join(\"\\n\")\n  }\n}\n\nContentMatch.empty = new ContentMatch(true)\n\nclass TokenStream {\n  constructor(string, nodeTypes) {\n    this.string = string\n    this.nodeTypes = nodeTypes\n    this.inline = null\n    this.pos = 0\n    this.tokens = string.split(/\\s*(?=\\b|\\W|$)/)\n    if (this.tokens[this.tokens.length - 1] == \"\") this.tokens.pop()\n    if (this.tokens[0] == \"\") this.tokens.shift()\n  }\n\n  get next() { return this.tokens[this.pos] }\n\n  eat(tok) { return this.next == tok && (this.pos++ || true) }\n\n  err(str) { throw new SyntaxError(str + \" (in content expression '\" + this.string + \"')\") }\n}\n\nfunction parseExpr(stream) {\n  let exprs = []\n  do { exprs.push(parseExprSeq(stream)) }\n  while (stream.eat(\"|\"))\n  return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs}\n}\n\nfunction parseExprSeq(stream) {\n  let exprs = []\n  do { exprs.push(parseExprSubscript(stream)) }\n  while (stream.next && stream.next != \")\" && stream.next != \"|\")\n  return exprs.length == 1 ? exprs[0] : {type: \"seq\", exprs}\n}\n\nfunction parseExprSubscript(stream) {\n  let expr = parseExprAtom(stream)\n  for (;;) {\n    if (stream.eat(\"+\"))\n      expr = {type: \"plus\", expr}\n    else if (stream.eat(\"*\"))\n      expr = {type: \"star\", expr}\n    else if (stream.eat(\"?\"))\n      expr = {type: \"opt\", expr}\n    else if (stream.eat(\"{\"))\n      expr = parseExprRange(stream, expr)\n    else break\n  }\n  return expr\n}\n\nfunction parseNum(stream) {\n  if (/\\D/.test(stream.next)) stream.err(\"Expected number, got '\" + stream.next + \"'\")\n  let result = Number(stream.next)\n  stream.pos++\n  return result\n}\n\nfunction parseExprRange(stream, expr) {\n  let min = parseNum(stream), max = min\n  if (stream.eat(\",\")) {\n    if (stream.next != \"}\") max = parseNum(stream)\n    else max = -1\n  }\n  if (!stream.eat(\"}\")) stream.err(\"Unclosed braced range\")\n  return {type: \"range\", min, max, expr}\n}\n\nfunction resolveName(stream, name) {\n  let types = stream.nodeTypes, type = types[name]\n  if (type) return [type]\n  let result = []\n  for (let typeName in types) {\n    let type = types[typeName]\n    if (type.groups.indexOf(name) > -1) result.push(type)\n  }\n  if (result.length == 0) stream.err(\"No node type or group '\" + name + \"' found\")\n  return result\n}\n\nfunction parseExprAtom(stream) {\n  if (stream.eat(\"(\")) {\n    let expr = parseExpr(stream)\n    if (!stream.eat(\")\")) stream.err(\"Missing closing paren\")\n    return expr\n  } else if (!/\\W/.test(stream.next)) {\n    let exprs = resolveName(stream, stream.next).map(type => {\n      if (stream.inline == null) stream.inline = type.isInline\n      else if (stream.inline != type.isInline) stream.err(\"Mixing inline and block content\")\n      return {type: \"name\", value: type}\n    })\n    stream.pos++\n    return exprs.length == 1 ? exprs[0] : {type: \"choice\", exprs}\n  } else {\n    stream.err(\"Unexpected token '\" + stream.next + \"'\")\n  }\n}\n\n// The code below helps compile a regular-expression-like language\n// into a deterministic finite automaton. For a good introduction to\n// these concepts, see https://swtch.com/~rsc/regexp/regexp1.html\n\n// : (Object) → [[{term: ?any, to: number}]]\n// Construct an NFA from an expression as returned by the parser. The\n// NFA is represented as an array of states, which are themselves\n// arrays of edges, which are `{term, to}` objects. The first state is\n// the entry state and the last node is the success state.\n//\n// Note that unlike typical NFAs, the edge ordering in this one is\n// significant, in that it is used to contruct filler content when\n// necessary.\nfunction nfa(expr) {\n  let nfa = [[]]\n  connect(compile(expr, 0), node())\n  return nfa\n\n  function node() { return nfa.push([]) - 1 }\n  function edge(from, to, term) {\n    let edge = {term, to}\n    nfa[from].push(edge)\n    return edge\n  }\n  function connect(edges, to) { edges.forEach(edge => edge.to = to) }\n\n  function compile(expr, from) {\n    if (expr.type == \"choice\") {\n      return expr.exprs.reduce((out, expr) => out.concat(compile(expr, from)), [])\n    } else if (expr.type == \"seq\") {\n      for (let i = 0;; i++) {\n        let next = compile(expr.exprs[i], from)\n        if (i == expr.exprs.length - 1) return next\n        connect(next, from = node())\n      }\n    } else if (expr.type == \"star\") {\n      let loop = node()\n      edge(from, loop)\n      connect(compile(expr.expr, loop), loop)\n      return [edge(loop)]\n    } else if (expr.type == \"plus\") {\n      let loop = node()\n      connect(compile(expr.expr, from), loop)\n      connect(compile(expr.expr, loop), loop)\n      return [edge(loop)]\n    } else if (expr.type == \"opt\") {\n      return [edge(from)].concat(compile(expr.expr, from))\n    } else if (expr.type == \"range\") {\n      let cur = from\n      for (let i = 0; i < expr.min; i++) {\n        let next = node()\n        connect(compile(expr.expr, cur), next)\n        cur = next\n      }\n      if (expr.max == -1) {\n        connect(compile(expr.expr, cur), cur)\n      } else {\n        for (let i = expr.min; i < expr.max; i++) {\n          let next = node()\n          edge(cur, next)\n          connect(compile(expr.expr, cur), next)\n          cur = next\n        }\n      }\n      return [edge(cur)]\n    } else if (expr.type == \"name\") {\n      return [edge(from, null, expr.value)]\n    }\n  }\n}\n\nfunction cmp(a, b) { return b - a }\n\n// Get the set of nodes reachable by null edges from `node`. Omit\n// nodes with only a single null-out-edge, since they may lead to\n// needless duplicated nodes.\nfunction nullFrom(nfa, node) {\n  let result = []\n  scan(node)\n  return result.sort(cmp)\n\n  function scan(node) {\n    let edges = nfa[node]\n    if (edges.length == 1 && !edges[0].term) return scan(edges[0].to)\n    result.push(node)\n    for (let i = 0; i < edges.length; i++) {\n      let {term, to} = edges[i]\n      if (!term && result.indexOf(to) == -1) scan(to)\n    }\n  }\n}\n\n// : ([[{term: ?any, to: number}]]) → ContentMatch\n// Compiles an NFA as produced by `nfa` into a DFA, modeled as a set\n// of state objects (`ContentMatch` instances) with transitions\n// between them.\nfunction dfa(nfa) {\n  let labeled = Object.create(null)\n  return explore(nullFrom(nfa, 0))\n\n  function explore(states) {\n    let out = []\n    states.forEach(node => {\n      nfa[node].forEach(({term, to}) => {\n        if (!term) return\n        let known = out.indexOf(term), set = known > -1 && out[known + 1]\n        nullFrom(nfa, to).forEach(node => {\n          if (!set) out.push(term, set = [])\n          if (set.indexOf(node) == -1) set.push(node)\n        })\n      })\n    })\n    let state = labeled[states.join(\",\")] = new ContentMatch(states.indexOf(nfa.length - 1) > -1)\n    for (let i = 0; i < out.length; i += 2) {\n      let states = out[i + 1].sort(cmp)\n      state.next.push(out[i], labeled[states.join(\",\")] || explore(states))\n    }\n    return state\n  }\n}\n\nfunction checkForDeadEnds(match, stream) {\n  for (let i = 0, work = [match]; i < work.length; i++) {\n    let state = work[i], dead = !state.validEnd, nodes = []\n    for (let j = 0; j < state.next.length; j += 2) {\n      let node = state.next[j], next = state.next[j + 1]\n      nodes.push(node.name)\n      if (dead && !(node.isText || node.hasRequiredAttrs())) dead = false\n      if (work.indexOf(next) == -1) work.push(next)\n    }\n    if (dead) stream.err(\"Only non-generatable nodes (\" + nodes.join(\", \") + \") in a required position (see https://prosemirror.net/docs/guide/#generatable)\")\n  }\n}\n","import OrderedMap from \"orderedmap\"\n\nimport {Node, TextNode} from \"./node\"\nimport {Fragment} from \"./fragment\"\nimport {Mark} from \"./mark\"\nimport {ContentMatch} from \"./content\"\n\n// For node types where all attrs have a default value (or which don't\n// have any attributes), build up a single reusable default attribute\n// object, and use it for all nodes that don't specify specific\n// attributes.\nfunction defaultAttrs(attrs) {\n  let defaults = Object.create(null)\n  for (let attrName in attrs) {\n    let attr = attrs[attrName]\n    if (!attr.hasDefault) return null\n    defaults[attrName] = attr.default\n  }\n  return defaults\n}\n\nfunction computeAttrs(attrs, value) {\n  let built = Object.create(null)\n  for (let name in attrs) {\n    let given = value && value[name]\n    if (given === undefined) {\n      let attr = attrs[name]\n      if (attr.hasDefault) given = attr.default\n      else throw new RangeError(\"No value supplied for attribute \" + name)\n    }\n    built[name] = given\n  }\n  return built\n}\n\nfunction initAttrs(attrs) {\n  let result = Object.create(null)\n  if (attrs) for (let name in attrs) result[name] = new Attribute(attrs[name])\n  return result\n}\n\n// ::- Node types are objects allocated once per `Schema` and used to\n// [tag](#model.Node.type) `Node` instances. They contain information\n// about the node type, such as its name and what kind of node it\n// represents.\nexport class NodeType {\n  constructor(name, schema, spec) {\n    // :: string\n    // The name the node type has in this schema.\n    this.name = name\n\n    // :: Schema\n    // A link back to the `Schema` the node type belongs to.\n    this.schema = schema\n\n    // :: NodeSpec\n    // The spec that this type is based on\n    this.spec = spec\n\n    this.groups = spec.group ? spec.group.split(\" \") : []\n    this.attrs = initAttrs(spec.attrs)\n\n    this.defaultAttrs = defaultAttrs(this.attrs)\n\n    // :: ContentMatch\n    // The starting match of the node type's content expression.\n    this.contentMatch = null\n\n    // : ?[MarkType]\n    // The set of marks allowed in this node. `null` means all marks\n    // are allowed.\n    this.markSet = null\n\n    // :: bool\n    // True if this node type has inline content.\n    this.inlineContent = null\n\n    // :: bool\n    // True if this is a block type\n    this.isBlock = !(spec.inline || name == \"text\")\n\n    // :: bool\n    // True if this is the text node type.\n    this.isText = name == \"text\"\n  }\n\n  // :: bool\n  // True if this is an inline type.\n  get isInline() { return !this.isBlock }\n\n  // :: bool\n  // True if this is a textblock type, a block that contains inline\n  // content.\n  get isTextblock() { return this.isBlock && this.inlineContent }\n\n  // :: bool\n  // True for node types that allow no content.\n  get isLeaf() { return this.contentMatch == ContentMatch.empty }\n\n  // :: bool\n  // True when this node is an atom, i.e. when it does not have\n  // directly editable content.\n  get isAtom() { return this.isLeaf || this.spec.atom }\n\n  // :: union<\"pre\", \"normal\">\n  // The node type's [whitespace](#view.NodeSpec.whitespace) option.\n  get whitespace() { return this.spec.whitespace || (this.spec.code ? \"pre\" : \"normal\") }\n\n  // :: () → bool\n  // Tells you whether this node type has any required attributes.\n  hasRequiredAttrs() {\n    for (let n in this.attrs) if (this.attrs[n].isRequired) return true\n    return false\n  }\n\n  compatibleContent(other) {\n    return this == other || this.contentMatch.compatible(other.contentMatch)\n  }\n\n  computeAttrs(attrs) {\n    if (!attrs && this.defaultAttrs) return this.defaultAttrs\n    else return computeAttrs(this.attrs, attrs)\n  }\n\n  // :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n  // Create a `Node` of this type. The given attributes are\n  // checked and defaulted (you can pass `null` to use the type's\n  // defaults entirely, if no required attributes exist). `content`\n  // may be a `Fragment`, a node, an array of nodes, or\n  // `null`. Similarly `marks` may be `null` to default to the empty\n  // set of marks.\n  create(attrs, content, marks) {\n    if (this.isText) throw new Error(\"NodeType.create can't construct text nodes\")\n    return new Node(this, this.computeAttrs(attrs), Fragment.from(content), Mark.setFrom(marks))\n  }\n\n  // :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n  // Like [`create`](#model.NodeType.create), but check the given content\n  // against the node type's content restrictions, and throw an error\n  // if it doesn't match.\n  createChecked(attrs, content, marks) {\n    content = Fragment.from(content)\n    if (!this.validContent(content))\n      throw new RangeError(\"Invalid content for node \" + this.name)\n    return new Node(this, this.computeAttrs(attrs), content, Mark.setFrom(marks))\n  }\n\n  // :: (?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → ?Node\n  // Like [`create`](#model.NodeType.create), but see if it is necessary to\n  // add nodes to the start or end of the given fragment to make it\n  // fit the node. If no fitting wrapping can be found, return null.\n  // Note that, due to the fact that required nodes can always be\n  // created, this will always succeed if you pass null or\n  // `Fragment.empty` as content.\n  createAndFill(attrs, content, marks) {\n    attrs = this.computeAttrs(attrs)\n    content = Fragment.from(content)\n    if (content.size) {\n      let before = this.contentMatch.fillBefore(content)\n      if (!before) return null\n      content = before.append(content)\n    }\n    let after = this.contentMatch.matchFragment(content).fillBefore(Fragment.empty, true)\n    if (!after) return null\n    return new Node(this, attrs, content.append(after), Mark.setFrom(marks))\n  }\n\n  // :: (Fragment) → bool\n  // Returns true if the given fragment is valid content for this node\n  // type with the given attributes.\n  validContent(content) {\n    let result = this.contentMatch.matchFragment(content)\n    if (!result || !result.validEnd) return false\n    for (let i = 0; i < content.childCount; i++)\n      if (!this.allowsMarks(content.child(i).marks)) return false\n    return true\n  }\n\n  // :: (MarkType) → bool\n  // Check whether the given mark type is allowed in this node.\n  allowsMarkType(markType) {\n    return this.markSet == null || this.markSet.indexOf(markType) > -1\n  }\n\n  // :: ([Mark]) → bool\n  // Test whether the given set of marks are allowed in this node.\n  allowsMarks(marks) {\n    if (this.markSet == null) return true\n    for (let i = 0; i < marks.length; i++) if (!this.allowsMarkType(marks[i].type)) return false\n    return true\n  }\n\n  // :: ([Mark]) → [Mark]\n  // Removes the marks that are not allowed in this node from the given set.\n  allowedMarks(marks) {\n    if (this.markSet == null) return marks\n    let copy\n    for (let i = 0; i < marks.length; i++) {\n      if (!this.allowsMarkType(marks[i].type)) {\n        if (!copy) copy = marks.slice(0, i)\n      } else if (copy) {\n        copy.push(marks[i])\n      }\n    }\n    return !copy ? marks : copy.length ? copy : Mark.empty\n  }\n\n  static compile(nodes, schema) {\n    let result = Object.create(null)\n    nodes.forEach((name, spec) => result[name] = new NodeType(name, schema, spec))\n\n    let topType = schema.spec.topNode || \"doc\"\n    if (!result[topType]) throw new RangeError(\"Schema is missing its top node type ('\" + topType + \"')\")\n    if (!result.text) throw new RangeError(\"Every schema needs a 'text' type\")\n    for (let _ in result.text.attrs) throw new RangeError(\"The text node type should not have attributes\")\n\n    return result\n  }\n}\n\n// Attribute descriptors\n\nclass Attribute {\n  constructor(options) {\n    this.hasDefault = Object.prototype.hasOwnProperty.call(options, \"default\")\n    this.default = options.default\n  }\n\n  get isRequired() {\n    return !this.hasDefault\n  }\n}\n\n// Marks\n\n// ::- Like nodes, marks (which are associated with nodes to signify\n// things like emphasis or being part of a link) are\n// [tagged](#model.Mark.type) with type objects, which are\n// instantiated once per `Schema`.\nexport class MarkType {\n  constructor(name, rank, schema, spec) {\n    // :: string\n    // The name of the mark type.\n    this.name = name\n\n    // :: Schema\n    // The schema that this mark type instance is part of.\n    this.schema = schema\n\n    // :: MarkSpec\n    // The spec on which the type is based.\n    this.spec = spec\n\n    this.attrs = initAttrs(spec.attrs)\n\n    this.rank = rank\n    this.excluded = null\n    let defaults = defaultAttrs(this.attrs)\n    this.instance = defaults && new Mark(this, defaults)\n  }\n\n  // :: (?Object) → Mark\n  // Create a mark of this type. `attrs` may be `null` or an object\n  // containing only some of the mark's attributes. The others, if\n  // they have defaults, will be added.\n  create(attrs) {\n    if (!attrs && this.instance) return this.instance\n    return new Mark(this, computeAttrs(this.attrs, attrs))\n  }\n\n  static compile(marks, schema) {\n    let result = Object.create(null), rank = 0\n    marks.forEach((name, spec) => result[name] = new MarkType(name, rank++, schema, spec))\n    return result\n  }\n\n  // :: ([Mark]) → [Mark]\n  // When there is a mark of this type in the given set, a new set\n  // without it is returned. Otherwise, the input set is returned.\n  removeFromSet(set) {\n    for (var i = 0; i < set.length; i++) if (set[i].type == this) {\n      set = set.slice(0, i).concat(set.slice(i + 1))\n      i--\n    }\n    return set\n  }\n\n  // :: ([Mark]) → ?Mark\n  // Tests whether there is a mark of this type in the given set.\n  isInSet(set) {\n    for (let i = 0; i < set.length; i++)\n      if (set[i].type == this) return set[i]\n  }\n\n  // :: (MarkType) → bool\n  // Queries whether a given mark type is\n  // [excluded](#model.MarkSpec.excludes) by this one.\n  excludes(other) {\n    return this.excluded.indexOf(other) > -1\n  }\n}\n\n// SchemaSpec:: interface\n// An object describing a schema, as passed to the [`Schema`](#model.Schema)\n// constructor.\n//\n//   nodes:: union<Object<NodeSpec>, OrderedMap<NodeSpec>>\n//   The node types in this schema. Maps names to\n//   [`NodeSpec`](#model.NodeSpec) objects that describe the node type\n//   associated with that name. Their order is significant—it\n//   determines which [parse rules](#model.NodeSpec.parseDOM) take\n//   precedence by default, and which nodes come first in a given\n//   [group](#model.NodeSpec.group).\n//\n//   marks:: ?union<Object<MarkSpec>, OrderedMap<MarkSpec>>\n//   The mark types that exist in this schema. The order in which they\n//   are provided determines the order in which [mark\n//   sets](#model.Mark.addToSet) are sorted and in which [parse\n//   rules](#model.MarkSpec.parseDOM) are tried.\n//\n//   topNode:: ?string\n//   The name of the default top-level node for the schema. Defaults\n//   to `\"doc\"`.\n\n// NodeSpec:: interface\n//\n//   content:: ?string\n//   The content expression for this node, as described in the [schema\n//   guide](/docs/guide/#schema.content_expressions). When not given,\n//   the node does not allow any content.\n//\n//   marks:: ?string\n//   The marks that are allowed inside of this node. May be a\n//   space-separated string referring to mark names or groups, `\"_\"`\n//   to explicitly allow all marks, or `\"\"` to disallow marks. When\n//   not given, nodes with inline content default to allowing all\n//   marks, other nodes default to not allowing marks.\n//\n//   group:: ?string\n//   The group or space-separated groups to which this node belongs,\n//   which can be referred to in the content expressions for the\n//   schema.\n//\n//   inline:: ?bool\n//   Should be set to true for inline nodes. (Implied for text nodes.)\n//\n//   atom:: ?bool\n//   Can be set to true to indicate that, though this isn't a [leaf\n//   node](#model.NodeType.isLeaf), it doesn't have directly editable\n//   content and should be treated as a single unit in the view.\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that nodes of this type get.\n//\n//   selectable:: ?bool\n//   Controls whether nodes of this type can be selected as a [node\n//   selection](#state.NodeSelection). Defaults to true for non-text\n//   nodes.\n//\n//   draggable:: ?bool\n//   Determines whether nodes of this type can be dragged without\n//   being selected. Defaults to false.\n//\n//   code:: ?bool\n//   Can be used to indicate that this node contains code, which\n//   causes some commands to behave differently.\n//\n//   whitespace:: ?union<\"pre\", \"normal\">\n//   Controls way whitespace in this a node is parsed. The default is\n//   `\"normal\"`, which causes the [DOM parser](#model.DOMParser) to\n//   collapse whitespace in normal mode, and normalize it (replacing\n//   newlines and such with spaces) otherwise. `\"pre\"` causes the\n//   parser to preserve spaces inside the node. When this option isn't\n//   given, but [`code`](#model.NodeSpec.code) is true, `whitespace`\n//   will default to `\"pre\"`. Note that this option doesn't influence\n//   the way the node is rendered—that should be handled by `toDOM`\n//   and/or styling.\n//\n//   defining:: ?bool\n//   Determines whether this node is considered an important parent\n//   node during replace operations (such as paste). Non-defining (the\n//   default) nodes get dropped when their entire content is replaced,\n//   whereas defining nodes persist and wrap the inserted content.\n//   Likewise, in _inserted_ content the defining parents of the\n//   content are preserved when possible. Typically,\n//   non-default-paragraph textblock types, and possibly list items,\n//   are marked as defining.\n//\n//   isolating:: ?bool\n//   When enabled (default is false), the sides of nodes of this type\n//   count as boundaries that regular editing operations, like\n//   backspacing or lifting, won't cross. An example of a node that\n//   should probably have this enabled is a table cell.\n//\n//   toDOM:: ?(node: Node) → DOMOutputSpec\n//   Defines the default way a node of this type should be serialized\n//   to DOM/HTML (as used by\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)).\n//   Should return a DOM node or an [array\n//   structure](#model.DOMOutputSpec) that describes one, with an\n//   optional number zero (“hole”) in it to indicate where the node's\n//   content should be inserted.\n//\n//   For text nodes, the default is to create a text DOM node. Though\n//   it is possible to create a serializer where text is rendered\n//   differently, this is not supported inside the editor, so you\n//   shouldn't override that in your text node spec.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this node, which can be\n//   used by [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) to\n//   automatically derive a parser. The `node` field in the rules is\n//   implied (the name of this node will be filled in automatically).\n//   If you supply your own parser, you do not need to also specify\n//   parsing rules in your schema.\n//\n//   toDebugString:: ?(node: Node) -> string\n//   Defines the default way a node of this type should be serialized\n//   to a string representation for debugging (e.g. in error messages).\n\n// MarkSpec:: interface\n//\n//   attrs:: ?Object<AttributeSpec>\n//   The attributes that marks of this type get.\n//\n//   inclusive:: ?bool\n//   Whether this mark should be active when the cursor is positioned\n//   at its end (or at its start when that is also the start of the\n//   parent node). Defaults to true.\n//\n//   excludes:: ?string\n//   Determines which other marks this mark can coexist with. Should\n//   be a space-separated strings naming other marks or groups of marks.\n//   When a mark is [added](#model.Mark.addToSet) to a set, all marks\n//   that it excludes are removed in the process. If the set contains\n//   any mark that excludes the new mark but is not, itself, excluded\n//   by the new mark, the mark can not be added an the set. You can\n//   use the value `\"_\"` to indicate that the mark excludes all\n//   marks in the schema.\n//\n//   Defaults to only being exclusive with marks of the same type. You\n//   can set it to an empty string (or any string not containing the\n//   mark's own name) to allow multiple marks of a given type to\n//   coexist (as long as they have different attributes).\n//\n//   group:: ?string\n//   The group or space-separated groups to which this mark belongs.\n//\n//   spanning:: ?bool\n//   Determines whether marks of this type can span multiple adjacent\n//   nodes when serialized to DOM/HTML. Defaults to true.\n//\n//   toDOM:: ?(mark: Mark, inline: bool) → DOMOutputSpec\n//   Defines the default way marks of this type should be serialized\n//   to DOM/HTML. When the resulting spec contains a hole, that is\n//   where the marked content is placed. Otherwise, it is appended to\n//   the top node.\n//\n//   parseDOM:: ?[ParseRule]\n//   Associates DOM parser information with this mark (see the\n//   corresponding [node spec field](#model.NodeSpec.parseDOM)). The\n//   `mark` field in the rules is implied.\n\n// AttributeSpec:: interface\n//\n// Used to [define](#model.NodeSpec.attrs) attributes on nodes or\n// marks.\n//\n//   default:: ?any\n//   The default value for this attribute, to use when no explicit\n//   value is provided. Attributes that have no default must be\n//   provided whenever a node or mark of a type that has them is\n//   created.\n\n// ::- A document schema. Holds [node](#model.NodeType) and [mark\n// type](#model.MarkType) objects for the nodes and marks that may\n// occur in conforming documents, and provides functionality for\n// creating and deserializing such documents.\nexport class Schema {\n  // :: (SchemaSpec)\n  // Construct a schema from a schema [specification](#model.SchemaSpec).\n  constructor(spec) {\n    // :: SchemaSpec\n    // The [spec](#model.SchemaSpec) on which the schema is based,\n    // with the added guarantee that its `nodes` and `marks`\n    // properties are\n    // [`OrderedMap`](https://github.com/marijnh/orderedmap) instances\n    // (not raw objects).\n    this.spec = {}\n    for (let prop in spec) this.spec[prop] = spec[prop]\n    this.spec.nodes = OrderedMap.from(spec.nodes)\n    this.spec.marks = OrderedMap.from(spec.marks)\n\n    // :: Object<NodeType>\n    // An object mapping the schema's node names to node type objects.\n    this.nodes = NodeType.compile(this.spec.nodes, this)\n\n    // :: Object<MarkType>\n    // A map from mark names to mark type objects.\n    this.marks = MarkType.compile(this.spec.marks, this)\n\n    let contentExprCache = Object.create(null)\n    for (let prop in this.nodes) {\n      if (prop in this.marks)\n        throw new RangeError(prop + \" can not be both a node and a mark\")\n      let type = this.nodes[prop], contentExpr = type.spec.content || \"\", markExpr = type.spec.marks\n      type.contentMatch = contentExprCache[contentExpr] ||\n        (contentExprCache[contentExpr] = ContentMatch.parse(contentExpr, this.nodes))\n      type.inlineContent = type.contentMatch.inlineContent\n      type.markSet = markExpr == \"_\" ? null :\n        markExpr ? gatherMarks(this, markExpr.split(\" \")) :\n        markExpr == \"\" || !type.inlineContent ? [] : null\n    }\n    for (let prop in this.marks) {\n      let type = this.marks[prop], excl = type.spec.excludes\n      type.excluded = excl == null ? [type] : excl == \"\" ? [] : gatherMarks(this, excl.split(\" \"))\n    }\n\n    this.nodeFromJSON = this.nodeFromJSON.bind(this)\n    this.markFromJSON = this.markFromJSON.bind(this)\n\n    // :: NodeType\n    // The type of the [default top node](#model.SchemaSpec.topNode)\n    // for this schema.\n    this.topNodeType = this.nodes[this.spec.topNode || \"doc\"]\n\n    // :: Object\n    // An object for storing whatever values modules may want to\n    // compute and cache per schema. (If you want to store something\n    // in it, try to use property names unlikely to clash.)\n    this.cached = Object.create(null)\n    this.cached.wrappings = Object.create(null)\n  }\n\n  // :: (union<string, NodeType>, ?Object, ?union<Fragment, Node, [Node]>, ?[Mark]) → Node\n  // Create a node in this schema. The `type` may be a string or a\n  // `NodeType` instance. Attributes will be extended\n  // with defaults, `content` may be a `Fragment`,\n  // `null`, a `Node`, or an array of nodes.\n  node(type, attrs, content, marks) {\n    if (typeof type == \"string\")\n      type = this.nodeType(type)\n    else if (!(type instanceof NodeType))\n      throw new RangeError(\"Invalid node type: \" + type)\n    else if (type.schema != this)\n      throw new RangeError(\"Node type from different schema used (\" + type.name + \")\")\n\n    return type.createChecked(attrs, content, marks)\n  }\n\n  // :: (string, ?[Mark]) → Node\n  // Create a text node in the schema. Empty text nodes are not\n  // allowed.\n  text(text, marks) {\n    let type = this.nodes.text\n    return new TextNode(type, type.defaultAttrs, text, Mark.setFrom(marks))\n  }\n\n  // :: (union<string, MarkType>, ?Object) → Mark\n  // Create a mark with the given type and attributes.\n  mark(type, attrs) {\n    if (typeof type == \"string\") type = this.marks[type]\n    return type.create(attrs)\n  }\n\n  // :: (Object) → Node\n  // Deserialize a node from its JSON representation. This method is\n  // bound.\n  nodeFromJSON(json) {\n    return Node.fromJSON(this, json)\n  }\n\n  // :: (Object) → Mark\n  // Deserialize a mark from its JSON representation. This method is\n  // bound.\n  markFromJSON(json) {\n    return Mark.fromJSON(this, json)\n  }\n\n  nodeType(name) {\n    let found = this.nodes[name]\n    if (!found) throw new RangeError(\"Unknown node type: \" + name)\n    return found\n  }\n}\n\nfunction gatherMarks(schema, marks) {\n  let found = []\n  for (let i = 0; i < marks.length; i++) {\n    let name = marks[i], mark = schema.marks[name], ok = mark\n    if (mark) {\n      found.push(mark)\n    } else {\n      for (let prop in schema.marks) {\n        let mark = schema.marks[prop]\n        if (name == \"_\" || (mark.spec.group && mark.spec.group.split(\" \").indexOf(name) > -1))\n          found.push(ok = mark)\n      }\n    }\n    if (!ok) throw new SyntaxError(\"Unknown mark type: '\" + marks[i] + \"'\")\n  }\n  return found\n}\n","import {Fragment} from \"./fragment\"\nimport {Slice} from \"./replace\"\nimport {Mark} from \"./mark\"\n\n// ParseOptions:: interface\n// These are the options recognized by the\n// [`parse`](#model.DOMParser.parse) and\n// [`parseSlice`](#model.DOMParser.parseSlice) methods.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   By default, whitespace is collapsed as per HTML's rules. Pass\n//   `true` to preserve whitespace, but normalize newlines to\n//   spaces, and `\"full\"` to preserve whitespace entirely.\n//\n//   findPositions:: ?[{node: dom.Node, offset: number}]\n//   When given, the parser will, beside parsing the content,\n//   record the document positions of the given DOM positions. It\n//   will do so by writing to the objects, adding a `pos` property\n//   that holds the document position. DOM positions that are not\n//   in the parsed content will not be written to.\n//\n//   from:: ?number\n//   The child node index to start parsing from.\n//\n//   to:: ?number\n//   The child node index to stop parsing at.\n//\n//   topNode:: ?Node\n//   By default, the content is parsed into the schema's default\n//   [top node type](#model.Schema.topNodeType). You can pass this\n//   option to use the type and attributes from a different node\n//   as the top container.\n//\n//   topMatch:: ?ContentMatch\n//   Provide the starting content match that content parsed into the\n//   top node is matched against.\n//\n//   context:: ?ResolvedPos\n//   A set of additional nodes to count as\n//   [context](#model.ParseRule.context) when parsing, above the\n//   given [top node](#model.ParseOptions.topNode).\n\n// ParseRule:: interface\n// A value that describes how to parse a given DOM node or inline\n// style as a ProseMirror node or mark.\n//\n//   tag:: ?string\n//   A CSS selector describing the kind of DOM elements to match. A\n//   single rule should have _either_ a `tag` or a `style` property.\n//\n//   namespace:: ?string\n//   The namespace to match. This should be used with `tag`.\n//   Nodes are only matched when the namespace matches or this property\n//   is null.\n//\n//   style:: ?string\n//   A CSS property name to match. When given, this rule matches\n//   inline styles that list that property. May also have the form\n//   `\"property=value\"`, in which case the rule only matches if the\n//   property's value exactly matches the given value. (For more\n//   complicated filters, use [`getAttrs`](#model.ParseRule.getAttrs)\n//   and return false to indicate that the match failed.) Rules\n//   matching styles may only produce [marks](#model.ParseRule.mark),\n//   not nodes.\n//\n//   priority:: ?number\n//   Can be used to change the order in which the parse rules in a\n//   schema are tried. Those with higher priority come first. Rules\n//   without a priority are counted as having priority 50. This\n//   property is only meaningful in a schema—when directly\n//   constructing a parser, the order of the rule array is used.\n//\n//   consuming:: ?boolean\n//   By default, when a rule matches an element or style, no further\n//   rules get a chance to match it. By setting this to `false`, you\n//   indicate that even when this rule matches, other rules that come\n//   after it should also run.\n//\n//   context:: ?string\n//   When given, restricts this rule to only match when the current\n//   context—the parent nodes into which the content is being\n//   parsed—matches this expression. Should contain one or more node\n//   names or node group names followed by single or double slashes.\n//   For example `\"paragraph/\"` means the rule only matches when the\n//   parent node is a paragraph, `\"blockquote/paragraph/\"` restricts\n//   it to be in a paragraph that is inside a blockquote, and\n//   `\"section//\"` matches any position inside a section—a double\n//   slash matches any sequence of ancestor nodes. To allow multiple\n//   different contexts, they can be separated by a pipe (`|`)\n//   character, as in `\"blockquote/|list_item/\"`.\n//\n//   node:: ?string\n//   The name of the node type to create when this rule matches. Only\n//   valid for rules with a `tag` property, not for style rules. Each\n//   rule should have one of a `node`, `mark`, or `ignore` property\n//   (except when it appears in a [node](#model.NodeSpec.parseDOM) or\n//   [mark spec](#model.MarkSpec.parseDOM), in which case the `node`\n//   or `mark` property will be derived from its position).\n//\n//   mark:: ?string\n//   The name of the mark type to wrap the matched content in.\n//\n//   ignore:: ?bool\n//   When true, ignore content that matches this rule.\n//\n//   closeParent:: ?bool\n//   When true, finding an element that matches this rule will close\n//   the current node.\n//\n//   skip:: ?bool\n//   When true, ignore the node that matches this rule, but do parse\n//   its content.\n//\n//   attrs:: ?Object\n//   Attributes for the node or mark created by this rule. When\n//   `getAttrs` is provided, it takes precedence.\n//\n//   getAttrs:: ?(union<dom.Node, string>) → ?union<Object, false>\n//   A function used to compute the attributes for the node or mark\n//   created by this rule. Can also be used to describe further\n//   conditions the DOM element or style must match. When it returns\n//   `false`, the rule won't match. When it returns null or undefined,\n//   that is interpreted as an empty/default set of attributes.\n//\n//   Called with a DOM Element for `tag` rules, and with a string (the\n//   style's value) for `style` rules.\n//\n//   contentElement:: ?union<string, (dom.Node) → dom.Node>\n//   For `tag` rules that produce non-leaf nodes or marks, by default\n//   the content of the DOM element is parsed as content of the mark\n//   or node. If the child nodes are in a descendent node, this may be\n//   a CSS selector string that the parser must use to find the actual\n//   content element, or a function that returns the actual content\n//   element to the parser.\n//\n//   getContent:: ?(dom.Node, schema: Schema) → Fragment\n//   Can be used to override the content of a matched node. When\n//   present, instead of parsing the node's child nodes, the result of\n//   this function is used.\n//\n//   preserveWhitespace:: ?union<bool, \"full\">\n//   Controls whether whitespace should be preserved when parsing the\n//   content inside the matched element. `false` means whitespace may\n//   be collapsed, `true` means that whitespace should be preserved\n//   but newlines normalized to spaces, and `\"full\"` means that\n//   newlines should also be preserved.\n\n// ::- A DOM parser represents a strategy for parsing DOM content into\n// a ProseMirror document conforming to a given schema. Its behavior\n// is defined by an array of [rules](#model.ParseRule).\nexport class DOMParser {\n  // :: (Schema, [ParseRule])\n  // Create a parser that targets the given schema, using the given\n  // parsing rules.\n  constructor(schema, rules) {\n    // :: Schema\n    // The schema into which the parser parses.\n    this.schema = schema\n    // :: [ParseRule]\n    // The set of [parse rules](#model.ParseRule) that the parser\n    // uses, in order of precedence.\n    this.rules = rules\n    this.tags = []\n    this.styles = []\n\n    rules.forEach(rule => {\n      if (rule.tag) this.tags.push(rule)\n      else if (rule.style) this.styles.push(rule)\n    })\n\n    // Only normalize list elements when lists in the schema can't directly contain themselves\n    this.normalizeLists = !this.tags.some(r => {\n      if (!/^(ul|ol)\\b/.test(r.tag) || !r.node) return false\n      let node = schema.nodes[r.node]\n      return node.contentMatch.matchType(node)\n    })\n  }\n\n  // :: (dom.Node, ?ParseOptions) → Node\n  // Parse a document from the content of a DOM node.\n  parse(dom, options = {}) {\n    let context = new ParseContext(this, options, false)\n    context.addAll(dom, null, options.from, options.to)\n    return context.finish()\n  }\n\n  // :: (dom.Node, ?ParseOptions) → Slice\n  // Parses the content of the given DOM node, like\n  // [`parse`](#model.DOMParser.parse), and takes the same set of\n  // options. But unlike that method, which produces a whole node,\n  // this one returns a slice that is open at the sides, meaning that\n  // the schema constraints aren't applied to the start of nodes to\n  // the left of the input and the end of nodes at the end.\n  parseSlice(dom, options = {}) {\n    let context = new ParseContext(this, options, true)\n    context.addAll(dom, null, options.from, options.to)\n    return Slice.maxOpen(context.finish())\n  }\n\n  matchTag(dom, context, after) {\n    for (let i = after ? this.tags.indexOf(after) + 1 : 0; i < this.tags.length; i++) {\n      let rule = this.tags[i]\n      if (matches(dom, rule.tag) &&\n          (rule.namespace === undefined || dom.namespaceURI == rule.namespace) &&\n          (!rule.context || context.matchesContext(rule.context))) {\n        if (rule.getAttrs) {\n          let result = rule.getAttrs(dom)\n          if (result === false) continue\n          rule.attrs = result\n        }\n        return rule\n      }\n    }\n  }\n\n  matchStyle(prop, value, context, after) {\n    for (let i = after ? this.styles.indexOf(after) + 1 : 0; i < this.styles.length; i++) {\n      let rule = this.styles[i]\n      if (rule.style.indexOf(prop) != 0 ||\n          rule.context && !context.matchesContext(rule.context) ||\n          // Test that the style string either precisely matches the prop,\n          // or has an '=' sign after the prop, followed by the given\n          // value.\n          rule.style.length > prop.length &&\n          (rule.style.charCodeAt(prop.length) != 61 || rule.style.slice(prop.length + 1) != value))\n        continue\n      if (rule.getAttrs) {\n        let result = rule.getAttrs(value)\n        if (result === false) continue\n        rule.attrs = result\n      }\n      return rule\n    }\n  }\n\n  // : (Schema) → [ParseRule]\n  static schemaRules(schema) {\n    let result = []\n    function insert(rule) {\n      let priority = rule.priority == null ? 50 : rule.priority, i = 0\n      for (; i < result.length; i++) {\n        let next = result[i], nextPriority = next.priority == null ? 50 : next.priority\n        if (nextPriority < priority) break\n      }\n      result.splice(i, 0, rule)\n    }\n\n    for (let name in schema.marks) {\n      let rules = schema.marks[name].spec.parseDOM\n      if (rules) rules.forEach(rule => {\n        insert(rule = copy(rule))\n        rule.mark = name\n      })\n    }\n    for (let name in schema.nodes) {\n      let rules = schema.nodes[name].spec.parseDOM\n      if (rules) rules.forEach(rule => {\n        insert(rule = copy(rule))\n        rule.node = name\n      })\n    }\n    return result\n  }\n\n  // :: (Schema) → DOMParser\n  // Construct a DOM parser using the parsing rules listed in a\n  // schema's [node specs](#model.NodeSpec.parseDOM), reordered by\n  // [priority](#model.ParseRule.priority).\n  static fromSchema(schema) {\n    return schema.cached.domParser ||\n      (schema.cached.domParser = new DOMParser(schema, DOMParser.schemaRules(schema)))\n  }\n}\n\n// : Object<bool> The block-level tags in HTML5\nconst blockTags = {\n  address: true, article: true, aside: true, blockquote: true, canvas: true,\n  dd: true, div: true, dl: true, fieldset: true, figcaption: true, figure: true,\n  footer: true, form: true, h1: true, h2: true, h3: true, h4: true, h5: true,\n  h6: true, header: true, hgroup: true, hr: true, li: true, noscript: true, ol: true,\n  output: true, p: true, pre: true, section: true, table: true, tfoot: true, ul: true\n}\n\n// : Object<bool> The tags that we normally ignore.\nconst ignoreTags = {\n  head: true, noscript: true, object: true, script: true, style: true, title: true\n}\n\n// : Object<bool> List tags.\nconst listTags = {ol: true, ul: true}\n\n// Using a bitfield for node context options\nconst OPT_PRESERVE_WS = 1, OPT_PRESERVE_WS_FULL = 2, OPT_OPEN_LEFT = 4\n\nfunction wsOptionsFor(type, preserveWhitespace, base) {\n  if (preserveWhitespace != null) return (preserveWhitespace ? OPT_PRESERVE_WS : 0) |\n    (preserveWhitespace === \"full\" ? OPT_PRESERVE_WS_FULL : 0)\n  return type && type.whitespace == \"pre\" ? OPT_PRESERVE_WS | OPT_PRESERVE_WS_FULL : base & ~OPT_OPEN_LEFT\n}\n\nclass NodeContext {\n  constructor(type, attrs, marks, pendingMarks, solid, match, options) {\n    this.type = type\n    this.attrs = attrs\n    this.solid = solid\n    this.match = match || (options & OPT_OPEN_LEFT ? null : type.contentMatch)\n    this.options = options\n    this.content = []\n    // Marks applied to this node itself\n    this.marks = marks\n    // Marks applied to its children\n    this.activeMarks = Mark.none\n    // Marks that can't apply here, but will be used in children if possible\n    this.pendingMarks = pendingMarks\n    // Nested Marks with same type\n    this.stashMarks = []\n  }\n\n  findWrapping(node) {\n    if (!this.match) {\n      if (!this.type) return []\n      let fill = this.type.contentMatch.fillBefore(Fragment.from(node))\n      if (fill) {\n        this.match = this.type.contentMatch.matchFragment(fill)\n      } else {\n        let start = this.type.contentMatch, wrap\n        if (wrap = start.findWrapping(node.type)) {\n          this.match = start\n          return wrap\n        } else {\n          return null\n        }\n      }\n    }\n    return this.match.findWrapping(node.type)\n  }\n\n  finish(openEnd) {\n    if (!(this.options & OPT_PRESERVE_WS)) { // Strip trailing whitespace\n      let last = this.content[this.content.length - 1], m\n      if (last && last.isText && (m = /[ \\t\\r\\n\\u000c]+$/.exec(last.text))) {\n        if (last.text.length == m[0].length) this.content.pop()\n        else this.content[this.content.length - 1] = last.withText(last.text.slice(0, last.text.length - m[0].length))\n      }\n    }\n    let content = Fragment.from(this.content)\n    if (!openEnd && this.match)\n      content = content.append(this.match.fillBefore(Fragment.empty, true))\n    return this.type ? this.type.create(this.attrs, content, this.marks) : content\n  }\n\n  popFromStashMark(mark) {\n    for (let i = this.stashMarks.length - 1; i >= 0; i--)\n      if (mark.eq(this.stashMarks[i])) return this.stashMarks.splice(i, 1)[0]\n  }\n\n  applyPending(nextType) {\n    for (let i = 0, pending = this.pendingMarks; i < pending.length; i++) {\n      let mark = pending[i]\n      if ((this.type ? this.type.allowsMarkType(mark.type) : markMayApply(mark.type, nextType)) &&\n          !mark.isInSet(this.activeMarks)) {\n        this.activeMarks = mark.addToSet(this.activeMarks)\n        this.pendingMarks = mark.removeFromSet(this.pendingMarks)\n      }\n    }\n  }\n\n  inlineContext(node) {\n    if (this.type) return this.type.inlineContent\n    if (this.content.length) return this.content[0].isInline\n    return node.parentNode && !blockTags.hasOwnProperty(node.parentNode.nodeName.toLowerCase())\n  }\n}\n\nclass ParseContext {\n  // : (DOMParser, Object)\n  constructor(parser, options, open) {\n    // : DOMParser The parser we are using.\n    this.parser = parser\n    // : Object The options passed to this parse.\n    this.options = options\n    this.isOpen = open\n    let topNode = options.topNode, topContext\n    let topOptions = wsOptionsFor(null, options.preserveWhitespace, 0) | (open ? OPT_OPEN_LEFT : 0)\n    if (topNode)\n      topContext = new NodeContext(topNode.type, topNode.attrs, Mark.none, Mark.none, true,\n                                   options.topMatch || topNode.type.contentMatch, topOptions)\n    else if (open)\n      topContext = new NodeContext(null, null, Mark.none, Mark.none, true, null, topOptions)\n    else\n      topContext = new NodeContext(parser.schema.topNodeType, null, Mark.none, Mark.none, true, null, topOptions)\n    this.nodes = [topContext]\n    // : [Mark] The current set of marks\n    this.open = 0\n    this.find = options.findPositions\n    this.needsBlock = false\n  }\n\n  get top() {\n    return this.nodes[this.open]\n  }\n\n  // : (dom.Node)\n  // Add a DOM node to the content. Text is inserted as text node,\n  // otherwise, the node is passed to `addElement` or, if it has a\n  // `style` attribute, `addElementWithStyles`.\n  addDOM(dom) {\n    if (dom.nodeType == 3) {\n      this.addTextNode(dom)\n    } else if (dom.nodeType == 1) {\n      let style = dom.getAttribute(\"style\")\n      let marks = style ? this.readStyles(parseStyles(style)) : null, top = this.top\n      if (marks != null) for (let i = 0; i < marks.length; i++) this.addPendingMark(marks[i])\n      this.addElement(dom)\n      if (marks != null) for (let i = 0; i < marks.length; i++) this.removePendingMark(marks[i], top)\n    }\n  }\n\n  addTextNode(dom) {\n    let value = dom.nodeValue\n    let top = this.top\n    if (top.options & OPT_PRESERVE_WS_FULL ||\n        top.inlineContext(dom) ||\n        /[^ \\t\\r\\n\\u000c]/.test(value)) {\n      if (!(top.options & OPT_PRESERVE_WS)) {\n        value = value.replace(/[ \\t\\r\\n\\u000c]+/g, \" \")\n        // If this starts with whitespace, and there is no node before it, or\n        // a hard break, or a text node that ends with whitespace, strip the\n        // leading space.\n        if (/^[ \\t\\r\\n\\u000c]/.test(value) && this.open == this.nodes.length - 1) {\n          let nodeBefore = top.content[top.content.length - 1]\n          let domNodeBefore = dom.previousSibling\n          if (!nodeBefore ||\n              (domNodeBefore && domNodeBefore.nodeName == 'BR') ||\n              (nodeBefore.isText && /[ \\t\\r\\n\\u000c]$/.test(nodeBefore.text)))\n            value = value.slice(1)\n        }\n      } else if (!(top.options & OPT_PRESERVE_WS_FULL)) {\n        value = value.replace(/\\r?\\n|\\r/g, \" \")\n      } else {\n        value = value.replace(/\\r\\n?/g, \"\\n\")\n      }\n      if (value) this.insertNode(this.parser.schema.text(value))\n      this.findInText(dom)\n    } else {\n      this.findInside(dom)\n    }\n  }\n\n  // : (dom.Element, ?ParseRule)\n  // Try to find a handler for the given tag and use that to parse. If\n  // none is found, the element's content nodes are added directly.\n  addElement(dom, matchAfter) {\n    let name = dom.nodeName.toLowerCase(), ruleID\n    if (listTags.hasOwnProperty(name) && this.parser.normalizeLists) normalizeList(dom)\n    let rule = (this.options.ruleFromNode && this.options.ruleFromNode(dom)) ||\n        (ruleID = this.parser.matchTag(dom, this, matchAfter))\n    if (rule ? rule.ignore : ignoreTags.hasOwnProperty(name)) {\n      this.findInside(dom)\n      this.ignoreFallback(dom)\n    } else if (!rule || rule.skip || rule.closeParent) {\n      if (rule && rule.closeParent) this.open = Math.max(0, this.open - 1)\n      else if (rule && rule.skip.nodeType) dom = rule.skip\n      let sync, top = this.top, oldNeedsBlock = this.needsBlock\n      if (blockTags.hasOwnProperty(name)) {\n        sync = true\n        if (!top.type) this.needsBlock = true\n      } else if (!dom.firstChild) {\n        this.leafFallback(dom)\n        return\n      }\n      this.addAll(dom)\n      if (sync) this.sync(top)\n      this.needsBlock = oldNeedsBlock\n    } else {\n      this.addElementByRule(dom, rule, rule.consuming === false ? ruleID : null)\n    }\n  }\n\n  // Called for leaf DOM nodes that would otherwise be ignored\n  leafFallback(dom) {\n    if (dom.nodeName == \"BR\" && this.top.type && this.top.type.inlineContent)\n      this.addTextNode(dom.ownerDocument.createTextNode(\"\\n\"))\n  }\n\n  // Called for ignored nodes\n  ignoreFallback(dom) {\n    // Ignored BR nodes should at least create an inline context\n    if (dom.nodeName == \"BR\" && (!this.top.type || !this.top.type.inlineContent))\n      this.findPlace(this.parser.schema.text(\"-\"))\n  }\n\n  // Run any style parser associated with the node's styles. Either\n  // return an array of marks, or null to indicate some of the styles\n  // had a rule with `ignore` set.\n  readStyles(styles) {\n    let marks = Mark.none\n    style: for (let i = 0; i < styles.length; i += 2) {\n      for (let after = null;;) {\n        let rule = this.parser.matchStyle(styles[i], styles[i + 1], this, after)\n        if (!rule) continue style\n        if (rule.ignore) return null\n        marks = this.parser.schema.marks[rule.mark].create(rule.attrs).addToSet(marks)\n        if (rule.consuming === false) after = rule\n        else break\n      }\n    }\n    return marks\n  }\n\n  // : (dom.Element, ParseRule) → bool\n  // Look up a handler for the given node. If none are found, return\n  // false. Otherwise, apply it, use its return value to drive the way\n  // the node's content is wrapped, and return true.\n  addElementByRule(dom, rule, continueAfter) {\n    let sync, nodeType, markType, mark\n    if (rule.node) {\n      nodeType = this.parser.schema.nodes[rule.node]\n      if (!nodeType.isLeaf) {\n        sync = this.enter(nodeType, rule.attrs, rule.preserveWhitespace)\n      } else if (!this.insertNode(nodeType.create(rule.attrs))) {\n        this.leafFallback(dom)\n      }\n    } else {\n      markType = this.parser.schema.marks[rule.mark]\n      mark = markType.create(rule.attrs)\n      this.addPendingMark(mark)\n    }\n    let startIn = this.top\n\n    if (nodeType && nodeType.isLeaf) {\n      this.findInside(dom)\n    } else if (continueAfter) {\n      this.addElement(dom, continueAfter)\n    } else if (rule.getContent) {\n      this.findInside(dom)\n      rule.getContent(dom, this.parser.schema).forEach(node => this.insertNode(node))\n    } else {\n      let contentDOM = rule.contentElement\n      if (typeof contentDOM == \"string\") contentDOM = dom.querySelector(contentDOM)\n      else if (typeof contentDOM == \"function\") contentDOM = contentDOM(dom)\n      if (!contentDOM) contentDOM = dom\n      this.findAround(dom, contentDOM, true)\n      this.addAll(contentDOM, sync)\n    }\n    if (sync) { this.sync(startIn); this.open-- }\n    if (mark) this.removePendingMark(mark, startIn)\n  }\n\n  // : (dom.Node, ?NodeBuilder, ?number, ?number)\n  // Add all child nodes between `startIndex` and `endIndex` (or the\n  // whole node, if not given). If `sync` is passed, use it to\n  // synchronize after every block element.\n  addAll(parent, sync, startIndex, endIndex) {\n    let index = startIndex || 0\n    for (let dom = startIndex ? parent.childNodes[startIndex] : parent.firstChild,\n             end = endIndex == null ? null : parent.childNodes[endIndex];\n         dom != end; dom = dom.nextSibling, ++index) {\n      this.findAtPoint(parent, index)\n      this.addDOM(dom)\n      if (sync && blockTags.hasOwnProperty(dom.nodeName.toLowerCase()))\n        this.sync(sync)\n    }\n    this.findAtPoint(parent, index)\n  }\n\n  // Try to find a way to fit the given node type into the current\n  // context. May add intermediate wrappers and/or leave non-solid\n  // nodes that we're in.\n  findPlace(node) {\n    let route, sync\n    for (let depth = this.open; depth >= 0; depth--) {\n      let cx = this.nodes[depth]\n      let found = cx.findWrapping(node)\n      if (found && (!route || route.length > found.length)) {\n        route = found\n        sync = cx\n        if (!found.length) break\n      }\n      if (cx.solid) break\n    }\n    if (!route) return false\n    this.sync(sync)\n    for (let i = 0; i < route.length; i++)\n      this.enterInner(route[i], null, false)\n    return true\n  }\n\n  // : (Node) → ?Node\n  // Try to insert the given node, adjusting the context when needed.\n  insertNode(node) {\n    if (node.isInline && this.needsBlock && !this.top.type) {\n      let block = this.textblockFromContext()\n      if (block) this.enterInner(block)\n    }\n    if (this.findPlace(node)) {\n      this.closeExtra()\n      let top = this.top\n      top.applyPending(node.type)\n      if (top.match) top.match = top.match.matchType(node.type)\n      let marks = top.activeMarks\n      for (let i = 0; i < node.marks.length; i++)\n        if (!top.type || top.type.allowsMarkType(node.marks[i].type))\n          marks = node.marks[i].addToSet(marks)\n      top.content.push(node.mark(marks))\n      return true\n    }\n    return false\n  }\n\n  // : (NodeType, ?Object) → bool\n  // Try to start a node of the given type, adjusting the context when\n  // necessary.\n  enter(type, attrs, preserveWS) {\n    let ok = this.findPlace(type.create(attrs))\n    if (ok) this.enterInner(type, attrs, true, preserveWS)\n    return ok\n  }\n\n  // Open a node of the given type\n  enterInner(type, attrs, solid, preserveWS) {\n    this.closeExtra()\n    let top = this.top\n    top.applyPending(type)\n    top.match = top.match && top.match.matchType(type, attrs)\n    let options = wsOptionsFor(type, preserveWS, top.options)\n    if ((top.options & OPT_OPEN_LEFT) && top.content.length == 0) options |= OPT_OPEN_LEFT\n    this.nodes.push(new NodeContext(type, attrs, top.activeMarks, top.pendingMarks, solid, null, options))\n    this.open++\n  }\n\n  // Make sure all nodes above this.open are finished and added to\n  // their parents\n  closeExtra(openEnd) {\n    let i = this.nodes.length - 1\n    if (i > this.open) {\n      for (; i > this.open; i--) this.nodes[i - 1].content.push(this.nodes[i].finish(openEnd))\n      this.nodes.length = this.open + 1\n    }\n  }\n\n  finish() {\n    this.open = 0\n    this.closeExtra(this.isOpen)\n    return this.nodes[0].finish(this.isOpen || this.options.topOpen)\n  }\n\n  sync(to) {\n    for (let i = this.open; i >= 0; i--) if (this.nodes[i] == to) {\n      this.open = i\n      return\n    }\n  }\n\n  get currentPos() {\n    this.closeExtra()\n    let pos = 0\n    for (let i = this.open; i >= 0; i--) {\n      let content = this.nodes[i].content\n      for (let j = content.length - 1; j >= 0; j--)\n        pos += content[j].nodeSize\n      if (i) pos++\n    }\n    return pos\n  }\n\n  findAtPoint(parent, offset) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].node == parent && this.find[i].offset == offset)\n        this.find[i].pos = this.currentPos\n    }\n  }\n\n  findInside(parent) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node))\n        this.find[i].pos = this.currentPos\n    }\n  }\n\n  findAround(parent, content, before) {\n    if (parent != content && this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].pos == null && parent.nodeType == 1 && parent.contains(this.find[i].node)) {\n        let pos = content.compareDocumentPosition(this.find[i].node)\n        if (pos & (before ? 2 : 4))\n          this.find[i].pos = this.currentPos\n      }\n    }\n  }\n\n  findInText(textNode) {\n    if (this.find) for (let i = 0; i < this.find.length; i++) {\n      if (this.find[i].node == textNode)\n        this.find[i].pos = this.currentPos - (textNode.nodeValue.length - this.find[i].offset)\n    }\n  }\n\n  // : (string) → bool\n  // Determines whether the given [context\n  // string](#ParseRule.context) matches this context.\n  matchesContext(context) {\n    if (context.indexOf(\"|\") > -1)\n      return context.split(/\\s*\\|\\s*/).some(this.matchesContext, this)\n\n    let parts = context.split(\"/\")\n    let option = this.options.context\n    let useRoot = !this.isOpen && (!option || option.parent.type == this.nodes[0].type)\n    let minDepth = -(option ? option.depth + 1 : 0) + (useRoot ? 0 : 1)\n    let match = (i, depth) => {\n      for (; i >= 0; i--) {\n        let part = parts[i]\n        if (part == \"\") {\n          if (i == parts.length - 1 || i == 0) continue\n          for (; depth >= minDepth; depth--)\n            if (match(i - 1, depth)) return true\n          return false\n        } else {\n          let next = depth > 0 || (depth == 0 && useRoot) ? this.nodes[depth].type\n              : option && depth >= minDepth ? option.node(depth - minDepth).type\n              : null\n          if (!next || (next.name != part && next.groups.indexOf(part) == -1))\n            return false\n          depth--\n        }\n      }\n      return true\n    }\n    return match(parts.length - 1, this.open)\n  }\n\n  textblockFromContext() {\n    let $context = this.options.context\n    if ($context) for (let d = $context.depth; d >= 0; d--) {\n      let deflt = $context.node(d).contentMatchAt($context.indexAfter(d)).defaultType\n      if (deflt && deflt.isTextblock && deflt.defaultAttrs) return deflt\n    }\n    for (let name in this.parser.schema.nodes) {\n      let type = this.parser.schema.nodes[name]\n      if (type.isTextblock && type.defaultAttrs) return type\n    }\n  }\n\n  addPendingMark(mark) {\n    let found = findSameMarkInSet(mark, this.top.pendingMarks)\n    if (found) this.top.stashMarks.push(found)\n    this.top.pendingMarks = mark.addToSet(this.top.pendingMarks)\n  }\n\n  removePendingMark(mark, upto) {\n    for (let depth = this.open; depth >= 0; depth--) {\n      let level = this.nodes[depth]\n      let found = level.pendingMarks.lastIndexOf(mark)\n      if (found > -1) {\n        level.pendingMarks = mark.removeFromSet(level.pendingMarks)\n      } else {\n        level.activeMarks = mark.removeFromSet(level.activeMarks)\n        let stashMark = level.popFromStashMark(mark)\n        if (stashMark && level.type && level.type.allowsMarkType(stashMark.type))\n          level.activeMarks = stashMark.addToSet(level.activeMarks)\n      }\n      if (level == upto) break\n    }\n  }\n}\n\n// Kludge to work around directly nested list nodes produced by some\n// tools and allowed by browsers to mean that the nested list is\n// actually part of the list item above it.\nfunction normalizeList(dom) {\n  for (let child = dom.firstChild, prevItem = null; child; child = child.nextSibling) {\n    let name = child.nodeType == 1 ? child.nodeName.toLowerCase() : null\n    if (name && listTags.hasOwnProperty(name) && prevItem) {\n      prevItem.appendChild(child)\n      child = prevItem\n    } else if (name == \"li\") {\n      prevItem = child\n    } else if (name) {\n      prevItem = null\n    }\n  }\n}\n\n// Apply a CSS selector.\nfunction matches(dom, selector) {\n  return (dom.matches || dom.msMatchesSelector || dom.webkitMatchesSelector || dom.mozMatchesSelector).call(dom, selector)\n}\n\n// : (string) → [string]\n// Tokenize a style attribute into property/value pairs.\nfunction parseStyles(style) {\n  let re = /\\s*([\\w-]+)\\s*:\\s*([^;]+)/g, m, result = []\n  while (m = re.exec(style)) result.push(m[1], m[2].trim())\n  return result\n}\n\nfunction copy(obj) {\n  let copy = {}\n  for (let prop in obj) copy[prop] = obj[prop]\n  return copy\n}\n\n// Used when finding a mark at the top level of a fragment parse.\n// Checks whether it would be reasonable to apply a given mark type to\n// a given node, by looking at the way the mark occurs in the schema.\nfunction markMayApply(markType, nodeType) {\n  let nodes = nodeType.schema.nodes\n  for (let name in nodes) {\n    let parent = nodes[name]\n    if (!parent.allowsMarkType(markType)) continue\n    let seen = [], scan = match => {\n      seen.push(match)\n      for (let i = 0; i < match.edgeCount; i++) {\n        let {type, next} = match.edge(i)\n        if (type == nodeType) return true\n        if (seen.indexOf(next) < 0 && scan(next)) return true\n      }\n    }\n    if (scan(parent.contentMatch)) return true\n  }\n}\n\nfunction findSameMarkInSet(mark, set) {\n  for (let i = 0; i < set.length; i++) {\n    if (mark.eq(set[i])) return set[i]\n  }\n}\n","// DOMOutputSpec:: interface\n// A description of a DOM structure. Can be either a string, which is\n// interpreted as a text node, a DOM node, which is interpreted as\n// itself, a `{dom: Node, contentDOM: ?Node}` object, or an array.\n//\n// An array describes a DOM element. The first value in the array\n// should be a string—the name of the DOM element, optionally prefixed\n// by a namespace URL and a space. If the second element is plain\n// object, it is interpreted as a set of attributes for the element.\n// Any elements after that (including the 2nd if it's not an attribute\n// object) are interpreted as children of the DOM elements, and must\n// either be valid `DOMOutputSpec` values, or the number zero.\n//\n// The number zero (pronounced “hole”) is used to indicate the place\n// where a node's child nodes should be inserted. If it occurs in an\n// output spec, it should be the only child element in its parent\n// node.\n\n// ::- A DOM serializer knows how to convert ProseMirror nodes and\n// marks of various types to DOM nodes.\nexport class DOMSerializer {\n  // :: (Object<(node: Node) → DOMOutputSpec>, Object<?(mark: Mark, inline: bool) → DOMOutputSpec>)\n  // Create a serializer. `nodes` should map node names to functions\n  // that take a node and return a description of the corresponding\n  // DOM. `marks` does the same for mark names, but also gets an\n  // argument that tells it whether the mark's content is block or\n  // inline content (for typical use, it'll always be inline). A mark\n  // serializer may be `null` to indicate that marks of that type\n  // should not be serialized.\n  constructor(nodes, marks) {\n    // :: Object<(node: Node) → DOMOutputSpec>\n    // The node serialization functions.\n    this.nodes = nodes || {}\n    // :: Object<?(mark: Mark, inline: bool) → DOMOutputSpec>\n    // The mark serialization functions.\n    this.marks = marks || {}\n  }\n\n  // :: (Fragment, ?Object) → dom.DocumentFragment\n  // Serialize the content of this fragment to a DOM fragment. When\n  // not in the browser, the `document` option, containing a DOM\n  // document, should be passed so that the serializer can create\n  // nodes.\n  serializeFragment(fragment, options = {}, target) {\n    if (!target) target = doc(options).createDocumentFragment()\n\n    let top = target, active = null\n    fragment.forEach(node => {\n      if (active || node.marks.length) {\n        if (!active) active = []\n        let keep = 0, rendered = 0\n        while (keep < active.length && rendered < node.marks.length) {\n          let next = node.marks[rendered]\n          if (!this.marks[next.type.name]) { rendered++; continue }\n          if (!next.eq(active[keep]) || next.type.spec.spanning === false) break\n          keep += 2; rendered++\n        }\n        while (keep < active.length) {\n          top = active.pop()\n          active.pop()\n        }\n        while (rendered < node.marks.length) {\n          let add = node.marks[rendered++]\n          let markDOM = this.serializeMark(add, node.isInline, options)\n          if (markDOM) {\n            active.push(add, top)\n            top.appendChild(markDOM.dom)\n            top = markDOM.contentDOM || markDOM.dom\n          }\n        }\n      }\n      top.appendChild(this.serializeNodeInner(node, options))\n    })\n\n    return target\n  }\n\n  serializeNodeInner(node, options = {}) {\n    let {dom, contentDOM} =\n        DOMSerializer.renderSpec(doc(options), this.nodes[node.type.name](node))\n    if (contentDOM) {\n      if (node.isLeaf)\n        throw new RangeError(\"Content hole not allowed in a leaf node spec\")\n      if (options.onContent)\n        options.onContent(node, contentDOM, options)\n      else\n        this.serializeFragment(node.content, options, contentDOM)\n    }\n    return dom\n  }\n\n  // :: (Node, ?Object) → dom.Node\n  // Serialize this node to a DOM node. This can be useful when you\n  // need to serialize a part of a document, as opposed to the whole\n  // document. To serialize a whole document, use\n  // [`serializeFragment`](#model.DOMSerializer.serializeFragment) on\n  // its [content](#model.Node.content).\n  serializeNode(node, options = {}) {\n    let dom = this.serializeNodeInner(node, options)\n    for (let i = node.marks.length - 1; i >= 0; i--) {\n      let wrap = this.serializeMark(node.marks[i], node.isInline, options)\n      if (wrap) {\n        ;(wrap.contentDOM || wrap.dom).appendChild(dom)\n        dom = wrap.dom\n      }\n    }\n    return dom\n  }\n\n  serializeMark(mark, inline, options = {}) {\n    let toDOM = this.marks[mark.type.name]\n    return toDOM && DOMSerializer.renderSpec(doc(options), toDOM(mark, inline))\n  }\n\n  // :: (dom.Document, DOMOutputSpec) → {dom: dom.Node, contentDOM: ?dom.Node}\n  // Render an [output spec](#model.DOMOutputSpec) to a DOM node. If\n  // the spec has a hole (zero) in it, `contentDOM` will point at the\n  // node with the hole.\n  static renderSpec(doc, structure, xmlNS = null) {\n    if (typeof structure == \"string\")\n      return {dom: doc.createTextNode(structure)}\n    if (structure.nodeType != null)\n      return {dom: structure}\n    if (structure.dom && structure.dom.nodeType != null)\n      return structure\n    let tagName = structure[0], space = tagName.indexOf(\" \")\n    if (space > 0) {\n      xmlNS = tagName.slice(0, space)\n      tagName = tagName.slice(space + 1)\n    }\n    let contentDOM = null, dom = xmlNS ? doc.createElementNS(xmlNS, tagName) : doc.createElement(tagName)\n    let attrs = structure[1], start = 1\n    if (attrs && typeof attrs == \"object\" && attrs.nodeType == null && !Array.isArray(attrs)) {\n      start = 2\n      for (let name in attrs) if (attrs[name] != null) {\n        let space = name.indexOf(\" \")\n        if (space > 0) dom.setAttributeNS(name.slice(0, space), name.slice(space + 1), attrs[name])\n        else dom.setAttribute(name, attrs[name])\n      }\n    }\n    for (let i = start; i < structure.length; i++) {\n      let child = structure[i]\n      if (child === 0) {\n        if (i < structure.length - 1 || i > start)\n          throw new RangeError(\"Content hole must be the only child of its parent node\")\n        return {dom, contentDOM: dom}\n      } else {\n        let {dom: inner, contentDOM: innerContent} = DOMSerializer.renderSpec(doc, child, xmlNS)\n        dom.appendChild(inner)\n        if (innerContent) {\n          if (contentDOM) throw new RangeError(\"Multiple content holes\")\n          contentDOM = innerContent\n        }\n      }\n    }\n    return {dom, contentDOM}\n  }\n\n  // :: (Schema) → DOMSerializer\n  // Build a serializer using the [`toDOM`](#model.NodeSpec.toDOM)\n  // properties in a schema's node and mark specs.\n  static fromSchema(schema) {\n    return schema.cached.domSerializer ||\n      (schema.cached.domSerializer = new DOMSerializer(this.nodesFromSchema(schema), this.marksFromSchema(schema)))\n  }\n\n  // : (Schema) → Object<(node: Node) → DOMOutputSpec>\n  // Gather the serializers in a schema's node specs into an object.\n  // This can be useful as a base to build a custom serializer from.\n  static nodesFromSchema(schema) {\n    let result = gatherToDOM(schema.nodes)\n    if (!result.text) result.text = node => node.text\n    return result\n  }\n\n  // : (Schema) → Object<(mark: Mark) → DOMOutputSpec>\n  // Gather the serializers in a schema's mark specs into an object.\n  static marksFromSchema(schema) {\n    return gatherToDOM(schema.marks)\n  }\n}\n\nfunction gatherToDOM(obj) {\n  let result = {}\n  for (let name in obj) {\n    let toDOM = obj[name].spec.toDOM\n    if (toDOM) result[name] = toDOM\n  }\n  return result\n}\n\nfunction doc(options) {\n  // declare global: window\n  return options.document || window.document\n}\n","// Mappable:: interface\n// There are several things that positions can be mapped through.\n// Such objects conform to this interface.\n//\n//   map:: (pos: number, assoc: ?number) → number\n//   Map a position through this object. When given, `assoc` (should\n//   be -1 or 1, defaults to 1) determines with which side the\n//   position is associated, which determines in which direction to\n//   move when a chunk of content is inserted at the mapped position.\n//\n//   mapResult:: (pos: number, assoc: ?number) → MapResult\n//   Map a position, and return an object containing additional\n//   information about the mapping. The result's `deleted` field tells\n//   you whether the position was deleted (completely enclosed in a\n//   replaced range) during the mapping. When content on only one side\n//   is deleted, the position itself is only considered deleted when\n//   `assoc` points in the direction of the deleted content.\n\n// Recovery values encode a range index and an offset. They are\n// represented as numbers, because tons of them will be created when\n// mapping, for example, a large number of decorations. The number's\n// lower 16 bits provide the index, the remaining bits the offset.\n//\n// Note: We intentionally don't use bit shift operators to en- and\n// decode these, since those clip to 32 bits, which we might in rare\n// cases want to overflow. A 64-bit float can represent 48-bit\n// integers precisely.\n\nconst lower16 = 0xffff\nconst factor16 = Math.pow(2, 16)\n\nfunction makeRecover(index, offset) { return index + offset * factor16 }\nfunction recoverIndex(value) { return value & lower16 }\nfunction recoverOffset(value) { return (value - (value & lower16)) / factor16 }\n\n// ::- An object representing a mapped position with extra\n// information.\nexport class MapResult {\n  constructor(pos, deleted = false, recover = null) {\n    // :: number The mapped version of the position.\n    this.pos = pos\n    // :: bool Tells you whether the position was deleted, that is,\n    // whether the step removed its surroundings from the document.\n    this.deleted = deleted\n    this.recover = recover\n  }\n}\n\n// :: class extends Mappable\n// A map describing the deletions and insertions made by a step, which\n// can be used to find the correspondence between positions in the\n// pre-step version of a document and the same position in the\n// post-step version.\nexport class StepMap {\n  // :: ([number])\n  // Create a position map. The modifications to the document are\n  // represented as an array of numbers, in which each group of three\n  // represents a modified chunk as `[start, oldSize, newSize]`.\n  constructor(ranges, inverted = false) {\n    this.ranges = ranges\n    this.inverted = inverted\n  }\n\n  recover(value) {\n    let diff = 0, index = recoverIndex(value)\n    if (!this.inverted) for (let i = 0; i < index; i++)\n      diff += this.ranges[i * 3 + 2] - this.ranges[i * 3 + 1]\n    return this.ranges[index * 3] + diff + recoverOffset(value)\n  }\n\n  // : (number, ?number) → MapResult\n  mapResult(pos, assoc = 1) { return this._map(pos, assoc, false) }\n\n  // : (number, ?number) → number\n  map(pos, assoc = 1) { return this._map(pos, assoc, true) }\n\n  _map(pos, assoc, simple) {\n    let diff = 0, oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i] - (this.inverted ? diff : 0)\n      if (start > pos) break\n      let oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex], end = start + oldSize\n      if (pos <= end) {\n        let side = !oldSize ? assoc : pos == start ? -1 : pos == end ? 1 : assoc\n        let result = start + diff + (side < 0 ? 0 : newSize)\n        if (simple) return result\n        let recover = pos == (assoc < 0 ? start : end) ? null : makeRecover(i / 3, pos - start)\n        return new MapResult(result, assoc < 0 ? pos != start : pos != end, recover)\n      }\n      diff += newSize - oldSize\n    }\n    return simple ? pos + diff : new MapResult(pos + diff)\n  }\n\n  touches(pos, recover) {\n    let diff = 0, index = recoverIndex(recover)\n    let oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i] - (this.inverted ? diff : 0)\n      if (start > pos) break\n      let oldSize = this.ranges[i + oldIndex], end = start + oldSize\n      if (pos <= end && i == index * 3) return true\n      diff += this.ranges[i + newIndex] - oldSize\n    }\n    return false\n  }\n\n  // :: ((oldStart: number, oldEnd: number, newStart: number, newEnd: number))\n  // Calls the given function on each of the changed ranges included in\n  // this map.\n  forEach(f) {\n    let oldIndex = this.inverted ? 2 : 1, newIndex = this.inverted ? 1 : 2\n    for (let i = 0, diff = 0; i < this.ranges.length; i += 3) {\n      let start = this.ranges[i], oldStart = start - (this.inverted ? diff : 0), newStart = start + (this.inverted ? 0 : diff)\n      let oldSize = this.ranges[i + oldIndex], newSize = this.ranges[i + newIndex]\n      f(oldStart, oldStart + oldSize, newStart, newStart + newSize)\n      diff += newSize - oldSize\n    }\n  }\n\n  // :: () → StepMap\n  // Create an inverted version of this map. The result can be used to\n  // map positions in the post-step document to the pre-step document.\n  invert() {\n    return new StepMap(this.ranges, !this.inverted)\n  }\n\n  toString() {\n    return (this.inverted ? \"-\" : \"\") + JSON.stringify(this.ranges)\n  }\n\n  // :: (n: number) → StepMap\n  // Create a map that moves all positions by offset `n` (which may be\n  // negative). This can be useful when applying steps meant for a\n  // sub-document to a larger document, or vice-versa.\n  static offset(n) {\n    return n == 0 ? StepMap.empty : new StepMap(n < 0 ? [0, -n, 0] : [0, 0, n])\n  }\n}\n\nStepMap.empty = new StepMap([])\n\n// :: class extends Mappable\n// A mapping represents a pipeline of zero or more [step\n// maps](#transform.StepMap). It has special provisions for losslessly\n// handling mapping positions through a series of steps in which some\n// steps are inverted versions of earlier steps. (This comes up when\n// ‘[rebasing](/docs/guide/#transform.rebasing)’ steps for\n// collaboration or history management.)\nexport class Mapping {\n  // :: (?[StepMap])\n  // Create a new mapping with the given position maps.\n  constructor(maps, mirror, from, to) {\n    // :: [StepMap]\n    // The step maps in this mapping.\n    this.maps = maps || []\n    // :: number\n    // The starting position in the `maps` array, used when `map` or\n    // `mapResult` is called.\n    this.from = from || 0\n    // :: number\n    // The end position in the `maps` array.\n    this.to = to == null ? this.maps.length : to\n    this.mirror = mirror\n  }\n\n  // :: (?number, ?number) → Mapping\n  // Create a mapping that maps only through a part of this one.\n  slice(from = 0, to = this.maps.length) {\n    return new Mapping(this.maps, this.mirror, from, to)\n  }\n\n  copy() {\n    return new Mapping(this.maps.slice(), this.mirror && this.mirror.slice(), this.from, this.to)\n  }\n\n  // :: (StepMap, ?number)\n  // Add a step map to the end of this mapping. If `mirrors` is\n  // given, it should be the index of the step map that is the mirror\n  // image of this one.\n  appendMap(map, mirrors) {\n    this.to = this.maps.push(map)\n    if (mirrors != null) this.setMirror(this.maps.length - 1, mirrors)\n  }\n\n  // :: (Mapping)\n  // Add all the step maps in a given mapping to this one (preserving\n  // mirroring information).\n  appendMapping(mapping) {\n    for (let i = 0, startSize = this.maps.length; i < mapping.maps.length; i++) {\n      let mirr = mapping.getMirror(i)\n      this.appendMap(mapping.maps[i], mirr != null && mirr < i ? startSize + mirr : null)\n    }\n  }\n\n  // :: (number) → ?number\n  // Finds the offset of the step map that mirrors the map at the\n  // given offset, in this mapping (as per the second argument to\n  // `appendMap`).\n  getMirror(n) {\n    if (this.mirror) for (let i = 0; i < this.mirror.length; i++)\n      if (this.mirror[i] == n) return this.mirror[i + (i % 2 ? -1 : 1)]\n  }\n\n  setMirror(n, m) {\n    if (!this.mirror) this.mirror = []\n    this.mirror.push(n, m)\n  }\n\n  // :: (Mapping)\n  // Append the inverse of the given mapping to this one.\n  appendMappingInverted(mapping) {\n    for (let i = mapping.maps.length - 1, totalSize = this.maps.length + mapping.maps.length; i >= 0; i--) {\n      let mirr = mapping.getMirror(i)\n      this.appendMap(mapping.maps[i].invert(), mirr != null && mirr > i ? totalSize - mirr - 1 : null)\n    }\n  }\n\n  // :: () → Mapping\n  // Create an inverted version of this mapping.\n  invert() {\n    let inverse = new Mapping\n    inverse.appendMappingInverted(this)\n    return inverse\n  }\n\n  // : (number, ?number) → number\n  // Map a position through this mapping.\n  map(pos, assoc = 1) {\n    if (this.mirror) return this._map(pos, assoc, true)\n    for (let i = this.from; i < this.to; i++)\n      pos = this.maps[i].map(pos, assoc)\n    return pos\n  }\n\n  // : (number, ?number) → MapResult\n  // Map a position through this mapping, returning a mapping\n  // result.\n  mapResult(pos, assoc = 1) { return this._map(pos, assoc, false) }\n\n  _map(pos, assoc, simple) {\n    let deleted = false\n\n    for (let i = this.from; i < this.to; i++) {\n      let map = this.maps[i], result = map.mapResult(pos, assoc)\n      if (result.recover != null) {\n        let corr = this.getMirror(i)\n        if (corr != null && corr > i && corr < this.to) {\n          i = corr\n          pos = this.maps[corr].recover(result.recover)\n          continue\n        }\n      }\n\n      if (result.deleted) deleted = true\n      pos = result.pos\n    }\n\n    return simple ? pos : new MapResult(pos, deleted)\n  }\n}\n","import {Mapping} from \"./map\"\n\nexport function TransformError(message) {\n  let err = Error.call(this, message)\n  err.__proto__ = TransformError.prototype\n  return err\n}\n\nTransformError.prototype = Object.create(Error.prototype)\nTransformError.prototype.constructor = TransformError\nTransformError.prototype.name = \"TransformError\"\n\n// ::- Abstraction to build up and track an array of\n// [steps](#transform.Step) representing a document transformation.\n//\n// Most transforming methods return the `Transform` object itself, so\n// that they can be chained.\nexport class Transform {\n  // :: (Node)\n  // Create a transform that starts with the given document.\n  constructor(doc) {\n    // :: Node\n    // The current document (the result of applying the steps in the\n    // transform).\n    this.doc = doc\n    // :: [Step]\n    // The steps in this transform.\n    this.steps = []\n    // :: [Node]\n    // The documents before each of the steps.\n    this.docs = []\n    // :: Mapping\n    // A mapping with the maps for each of the steps in this transform.\n    this.mapping = new Mapping\n  }\n\n  // :: Node The starting document.\n  get before() { return this.docs.length ? this.docs[0] : this.doc }\n\n  // :: (step: Step) → this\n  // Apply a new step in this transform, saving the result. Throws an\n  // error when the step fails.\n  step(object) {\n    let result = this.maybeStep(object)\n    if (result.failed) throw new TransformError(result.failed)\n    return this\n  }\n\n  // :: (Step) → StepResult\n  // Try to apply a step in this transformation, ignoring it if it\n  // fails. Returns the step result.\n  maybeStep(step) {\n    let result = step.apply(this.doc)\n    if (!result.failed) this.addStep(step, result.doc)\n    return result\n  }\n\n  // :: bool\n  // True when the document has been changed (when there are any\n  // steps).\n  get docChanged() {\n    return this.steps.length > 0\n  }\n\n  addStep(step, doc) {\n    this.docs.push(this.doc)\n    this.steps.push(step)\n    this.mapping.appendMap(step.getMap())\n    this.doc = doc\n  }\n}\n","import {ReplaceError} from \"prosemirror-model\"\n\nimport {StepMap} from \"./map\"\n\nfunction mustOverride() { throw new Error(\"Override me\") }\n\nconst stepsByID = Object.create(null)\n\n// ::- A step object represents an atomic change. It generally applies\n// only to the document it was created for, since the positions\n// stored in it will only make sense for that document.\n//\n// New steps are defined by creating classes that extend `Step`,\n// overriding the `apply`, `invert`, `map`, `getMap` and `fromJSON`\n// methods, and registering your class with a unique\n// JSON-serialization identifier using\n// [`Step.jsonID`](#transform.Step^jsonID).\nexport class Step {\n  // :: (doc: Node) → StepResult\n  // Applies this step to the given document, returning a result\n  // object that either indicates failure, if the step can not be\n  // applied to this document, or indicates success by containing a\n  // transformed document.\n  apply(_doc) { return mustOverride() }\n\n  // :: () → StepMap\n  // Get the step map that represents the changes made by this step,\n  // and which can be used to transform between positions in the old\n  // and the new document.\n  getMap() { return StepMap.empty }\n\n  // :: (doc: Node) → Step\n  // Create an inverted version of this step. Needs the document as it\n  // was before the step as argument.\n  invert(_doc) { return mustOverride() }\n\n  // :: (mapping: Mappable) → ?Step\n  // Map this step through a mappable thing, returning either a\n  // version of that step with its positions adjusted, or `null` if\n  // the step was entirely deleted by the mapping.\n  map(_mapping) { return mustOverride() }\n\n  // :: (other: Step) → ?Step\n  // Try to merge this step with another one, to be applied directly\n  // after it. Returns the merged step when possible, null if the\n  // steps can't be merged.\n  merge(_other) { return null }\n\n  // :: () → Object\n  // Create a JSON-serializeable representation of this step. When\n  // defining this for a custom subclass, make sure the result object\n  // includes the step type's [JSON id](#transform.Step^jsonID) under\n  // the `stepType` property.\n  toJSON() { return mustOverride() }\n\n  // :: (Schema, Object) → Step\n  // Deserialize a step from its JSON representation. Will call\n  // through to the step class' own implementation of this method.\n  static fromJSON(schema, json) {\n    if (!json || !json.stepType) throw new RangeError(\"Invalid input for Step.fromJSON\")\n    let type = stepsByID[json.stepType]\n    if (!type) throw new RangeError(`No step type ${json.stepType} defined`)\n    return type.fromJSON(schema, json)\n  }\n\n  // :: (string, constructor<Step>)\n  // To be able to serialize steps to JSON, each step needs a string\n  // ID to attach to its JSON representation. Use this method to\n  // register an ID for your step classes. Try to pick something\n  // that's unlikely to clash with steps from other modules.\n  static jsonID(id, stepClass) {\n    if (id in stepsByID) throw new RangeError(\"Duplicate use of step JSON ID \" + id)\n    stepsByID[id] = stepClass\n    stepClass.prototype.jsonID = id\n    return stepClass\n  }\n}\n\n// ::- The result of [applying](#transform.Step.apply) a step. Contains either a\n// new document or a failure value.\nexport class StepResult {\n  // : (?Node, ?string)\n  constructor(doc, failed) {\n    // :: ?Node The transformed document.\n    this.doc = doc\n    // :: ?string Text providing information about a failed step.\n    this.failed = failed\n  }\n\n  // :: (Node) → StepResult\n  // Create a successful step result.\n  static ok(doc) { return new StepResult(doc, null) }\n\n  // :: (string) → StepResult\n  // Create a failed step result.\n  static fail(message) { return new StepResult(null, message) }\n\n  // :: (Node, number, number, Slice) → StepResult\n  // Call [`Node.replace`](#model.Node.replace) with the given\n  // arguments. Create a successful result if it succeeds, and a\n  // failed one if it throws a `ReplaceError`.\n  static fromReplace(doc, from, to, slice) {\n    try {\n      return StepResult.ok(doc.replace(from, to, slice))\n    } catch (e) {\n      if (e instanceof ReplaceError) return StepResult.fail(e.message)\n      throw e\n    }\n  }\n}\n","import {Slice} from \"prosemirror-model\"\n\nimport {Step, StepResult} from \"./step\"\nimport {StepMap} from \"./map\"\n\n// ::- Replace a part of the document with a slice of new content.\nexport class ReplaceStep extends Step {\n  // :: (number, number, Slice, ?bool)\n  // The given `slice` should fit the 'gap' between `from` and\n  // `to`—the depths must line up, and the surrounding nodes must be\n  // able to be joined with the open sides of the slice. When\n  // `structure` is true, the step will fail if the content between\n  // from and to is not just a sequence of closing and then opening\n  // tokens (this is to guard against rebased replace steps\n  // overwriting something they weren't supposed to).\n  constructor(from, to, slice, structure) {\n    super()\n    this.from = from\n    this.to = to\n    this.slice = slice\n    this.structure = !!structure\n  }\n\n  apply(doc) {\n    if (this.structure && contentBetween(doc, this.from, this.to))\n      return StepResult.fail(\"Structure replace would overwrite content\")\n    return StepResult.fromReplace(doc, this.from, this.to, this.slice)\n  }\n\n  getMap() {\n    return new StepMap([this.from, this.to - this.from, this.slice.size])\n  }\n\n  invert(doc) {\n    return new ReplaceStep(this.from, this.from + this.slice.size, doc.slice(this.from, this.to))\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted) return null\n    return new ReplaceStep(from.pos, Math.max(from.pos, to.pos), this.slice)\n  }\n\n  merge(other) {\n    if (!(other instanceof ReplaceStep) || other.structure != this.structure) return null\n\n    if (this.from + this.slice.size == other.from && !this.slice.openEnd && !other.slice.openStart) {\n      let slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(this.slice.content.append(other.slice.content), this.slice.openStart, other.slice.openEnd)\n      return new ReplaceStep(this.from, this.to + (other.to - other.from), slice, this.structure)\n    } else if (other.to == this.from && !this.slice.openStart && !other.slice.openEnd) {\n      let slice = this.slice.size + other.slice.size == 0 ? Slice.empty\n          : new Slice(other.slice.content.append(this.slice.content), other.slice.openStart, this.slice.openEnd)\n      return new ReplaceStep(other.from, this.to, slice, this.structure)\n    } else {\n      return null\n    }\n  }\n\n  toJSON() {\n    let json = {stepType: \"replace\", from: this.from, to: this.to}\n    if (this.slice.size) json.slice = this.slice.toJSON()\n    if (this.structure) json.structure = true\n    return json\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for ReplaceStep.fromJSON\")\n    return new ReplaceStep(json.from, json.to, Slice.fromJSON(schema, json.slice), !!json.structure)\n  }\n}\n\nStep.jsonID(\"replace\", ReplaceStep)\n\n// ::- Replace a part of the document with a slice of content, but\n// preserve a range of the replaced content by moving it into the\n// slice.\nexport class ReplaceAroundStep extends Step {\n  // :: (number, number, number, number, Slice, number, ?bool)\n  // Create a replace-around step with the given range and gap.\n  // `insert` should be the point in the slice into which the content\n  // of the gap should be moved. `structure` has the same meaning as\n  // it has in the [`ReplaceStep`](#transform.ReplaceStep) class.\n  constructor(from, to, gapFrom, gapTo, slice, insert, structure) {\n    super()\n    this.from = from\n    this.to = to\n    this.gapFrom = gapFrom\n    this.gapTo = gapTo\n    this.slice = slice\n    this.insert = insert\n    this.structure = !!structure\n  }\n\n  apply(doc) {\n    if (this.structure && (contentBetween(doc, this.from, this.gapFrom) ||\n                           contentBetween(doc, this.gapTo, this.to)))\n      return StepResult.fail(\"Structure gap-replace would overwrite content\")\n\n    let gap = doc.slice(this.gapFrom, this.gapTo)\n    if (gap.openStart || gap.openEnd)\n      return StepResult.fail(\"Gap is not a flat range\")\n    let inserted = this.slice.insertAt(this.insert, gap.content)\n    if (!inserted) return StepResult.fail(\"Content does not fit in gap\")\n    return StepResult.fromReplace(doc, this.from, this.to, inserted)\n  }\n\n  getMap() {\n    return new StepMap([this.from, this.gapFrom - this.from, this.insert,\n                        this.gapTo, this.to - this.gapTo, this.slice.size - this.insert])\n  }\n\n  invert(doc) {\n    let gap = this.gapTo - this.gapFrom\n    return new ReplaceAroundStep(this.from, this.from + this.slice.size + gap,\n                                 this.from + this.insert, this.from + this.insert + gap,\n                                 doc.slice(this.from, this.to).removeBetween(this.gapFrom - this.from, this.gapTo - this.from),\n                                 this.gapFrom - this.from, this.structure)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    let gapFrom = mapping.map(this.gapFrom, -1), gapTo = mapping.map(this.gapTo, 1)\n    if ((from.deleted && to.deleted) || gapFrom < from.pos || gapTo > to.pos) return null\n    return new ReplaceAroundStep(from.pos, to.pos, gapFrom, gapTo, this.slice, this.insert, this.structure)\n  }\n\n  toJSON() {\n    let json = {stepType: \"replaceAround\", from: this.from, to: this.to,\n                gapFrom: this.gapFrom, gapTo: this.gapTo, insert: this.insert}\n    if (this.slice.size) json.slice = this.slice.toJSON()\n    if (this.structure) json.structure = true\n    return json\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\" ||\n        typeof json.gapFrom != \"number\" || typeof json.gapTo != \"number\" || typeof json.insert != \"number\")\n      throw new RangeError(\"Invalid input for ReplaceAroundStep.fromJSON\")\n    return new ReplaceAroundStep(json.from, json.to, json.gapFrom, json.gapTo,\n                                 Slice.fromJSON(schema, json.slice), json.insert, !!json.structure)\n  }\n}\n\nStep.jsonID(\"replaceAround\", ReplaceAroundStep)\n\nfunction contentBetween(doc, from, to) {\n  let $from = doc.resolve(from), dist = to - from, depth = $from.depth\n  while (dist > 0 && depth > 0 && $from.indexAfter(depth) == $from.node(depth).childCount) {\n    depth--\n    dist--\n  }\n  if (dist > 0) {\n    let next = $from.node(depth).maybeChild($from.indexAfter(depth))\n    while (dist > 0) {\n      if (!next || next.isLeaf) return true\n      next = next.firstChild\n      dist--\n    }\n  }\n  return false\n}\n","import {Slice, Fragment} from \"prosemirror-model\"\n\nimport {Transform} from \"./transform\"\nimport {ReplaceStep, ReplaceAroundStep} from \"./replace_step\"\n\nfunction canCut(node, start, end) {\n  return (start == 0 || node.canReplace(start, node.childCount)) &&\n    (end == node.childCount || node.canReplace(0, end))\n}\n\n// :: (NodeRange) → ?number\n// Try to find a target depth to which the content in the given range\n// can be lifted. Will not go across\n// [isolating](#model.NodeSpec.isolating) parent nodes.\nexport function liftTarget(range) {\n  let parent = range.parent\n  let content = parent.content.cutByIndex(range.startIndex, range.endIndex)\n  for (let depth = range.depth;; --depth) {\n    let node = range.$from.node(depth)\n    let index = range.$from.index(depth), endIndex = range.$to.indexAfter(depth)\n    if (depth < range.depth && node.canReplace(index, endIndex, content))\n      return depth\n    if (depth == 0 || node.type.spec.isolating || !canCut(node, index, endIndex)) break\n  }\n}\n\n// :: (NodeRange, number) → this\n// Split the content in the given range off from its parent, if there\n// is sibling content before or after it, and move it up the tree to\n// the depth specified by `target`. You'll probably want to use\n// [`liftTarget`](#transform.liftTarget) to compute `target`, to make\n// sure the lift is valid.\nTransform.prototype.lift = function(range, target) {\n  let {$from, $to, depth} = range\n\n  let gapStart = $from.before(depth + 1), gapEnd = $to.after(depth + 1)\n  let start = gapStart, end = gapEnd\n\n  let before = Fragment.empty, openStart = 0\n  for (let d = depth, splitting = false; d > target; d--)\n    if (splitting || $from.index(d) > 0) {\n      splitting = true\n      before = Fragment.from($from.node(d).copy(before))\n      openStart++\n    } else {\n      start--\n    }\n  let after = Fragment.empty, openEnd = 0\n  for (let d = depth, splitting = false; d > target; d--)\n    if (splitting || $to.after(d + 1) < $to.end(d)) {\n      splitting = true\n      after = Fragment.from($to.node(d).copy(after))\n      openEnd++\n    } else {\n      end++\n    }\n\n  return this.step(new ReplaceAroundStep(start, end, gapStart, gapEnd,\n                                         new Slice(before.append(after), openStart, openEnd),\n                                         before.size - openStart, true))\n}\n\n// :: (NodeRange, NodeType, ?Object, ?NodeRange) → ?[{type: NodeType, attrs: ?Object}]\n// Try to find a valid way to wrap the content in the given range in a\n// node of the given type. May introduce extra nodes around and inside\n// the wrapper node, if necessary. Returns null if no valid wrapping\n// could be found. When `innerRange` is given, that range's content is\n// used as the content to fit into the wrapping, instead of the\n// content of `range`.\nexport function findWrapping(range, nodeType, attrs, innerRange = range) {\n  let around = findWrappingOutside(range, nodeType)\n  let inner = around && findWrappingInside(innerRange, nodeType)\n  if (!inner) return null\n  return around.map(withAttrs).concat({type: nodeType, attrs}).concat(inner.map(withAttrs))\n}\n\nfunction withAttrs(type) { return {type, attrs: null} }\n\nfunction findWrappingOutside(range, type) {\n  let {parent, startIndex, endIndex} = range\n  let around = parent.contentMatchAt(startIndex).findWrapping(type)\n  if (!around) return null\n  let outer = around.length ? around[0] : type\n  return parent.canReplaceWith(startIndex, endIndex, outer) ? around : null\n}\n\nfunction findWrappingInside(range, type) {\n  let {parent, startIndex, endIndex} = range\n  let inner = parent.child(startIndex)\n  let inside = type.contentMatch.findWrapping(inner.type)\n  if (!inside) return null\n  let lastType = inside.length ? inside[inside.length - 1] : type\n  let innerMatch = lastType.contentMatch\n  for (let i = startIndex; innerMatch && i < endIndex; i++)\n    innerMatch = innerMatch.matchType(parent.child(i).type)\n  if (!innerMatch || !innerMatch.validEnd) return null\n  return inside\n}\n\n// :: (NodeRange, [{type: NodeType, attrs: ?Object}]) → this\n// Wrap the given [range](#model.NodeRange) in the given set of wrappers.\n// The wrappers are assumed to be valid in this position, and should\n// probably be computed with [`findWrapping`](#transform.findWrapping).\nTransform.prototype.wrap = function(range, wrappers) {\n  let content = Fragment.empty\n  for (let i = wrappers.length - 1; i >= 0; i--)\n    content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content))\n\n  let start = range.start, end = range.end\n  return this.step(new ReplaceAroundStep(start, end, start, end, new Slice(content, 0, 0), wrappers.length, true))\n}\n\n// :: (number, ?number, NodeType, ?Object) → this\n// Set the type of all textblocks (partly) between `from` and `to` to\n// the given node type with the given attributes.\nTransform.prototype.setBlockType = function(from, to = from, type, attrs) {\n  if (!type.isTextblock) throw new RangeError(\"Type given to setBlockType should be a textblock\")\n  let mapFrom = this.steps.length\n  this.doc.nodesBetween(from, to, (node, pos) => {\n    if (node.isTextblock && !node.hasMarkup(type, attrs) && canChangeType(this.doc, this.mapping.slice(mapFrom).map(pos), type)) {\n      // Ensure all markup that isn't allowed in the new node type is cleared\n      this.clearIncompatible(this.mapping.slice(mapFrom).map(pos, 1), type)\n      let mapping = this.mapping.slice(mapFrom)\n      let startM = mapping.map(pos, 1), endM = mapping.map(pos + node.nodeSize, 1)\n      this.step(new ReplaceAroundStep(startM, endM, startM + 1, endM - 1,\n                                      new Slice(Fragment.from(type.create(attrs, null, node.marks)), 0, 0), 1, true))\n      return false\n    }\n  })\n  return this\n}\n\nfunction canChangeType(doc, pos, type) {\n  let $pos = doc.resolve(pos), index = $pos.index()\n  return $pos.parent.canReplaceWith(index, index + 1, type)\n}\n\n// :: (number, ?NodeType, ?Object, ?[Mark]) → this\n// Change the type, attributes, and/or marks of the node at `pos`.\n// When `type` isn't given, the existing node type is preserved,\nTransform.prototype.setNodeMarkup = function(pos, type, attrs, marks) {\n  let node = this.doc.nodeAt(pos)\n  if (!node) throw new RangeError(\"No node at given position\")\n  if (!type) type = node.type\n  let newNode = type.create(attrs, null, marks || node.marks)\n  if (node.isLeaf)\n    return this.replaceWith(pos, pos + node.nodeSize, newNode)\n\n  if (!type.validContent(node.content))\n    throw new RangeError(\"Invalid content for node type \" + type.name)\n\n  return this.step(new ReplaceAroundStep(pos, pos + node.nodeSize, pos + 1, pos + node.nodeSize - 1,\n                                         new Slice(Fragment.from(newNode), 0, 0), 1, true))\n}\n\n// :: (Node, number, number, ?[?{type: NodeType, attrs: ?Object}]) → bool\n// Check whether splitting at the given position is allowed.\nexport function canSplit(doc, pos, depth = 1, typesAfter) {\n  let $pos = doc.resolve(pos), base = $pos.depth - depth\n  let innerType = (typesAfter && typesAfter[typesAfter.length - 1]) || $pos.parent\n  if (base < 0 || $pos.parent.type.spec.isolating ||\n      !$pos.parent.canReplace($pos.index(), $pos.parent.childCount) ||\n      !innerType.type.validContent($pos.parent.content.cutByIndex($pos.index(), $pos.parent.childCount)))\n    return false\n  for (let d = $pos.depth - 1, i = depth - 2; d > base; d--, i--) {\n    let node = $pos.node(d), index = $pos.index(d)\n    if (node.type.spec.isolating) return false\n    let rest = node.content.cutByIndex(index, node.childCount)\n    let after = (typesAfter && typesAfter[i]) || node\n    if (after != node) rest = rest.replaceChild(0, after.type.create(after.attrs))\n    if (!node.canReplace(index + 1, node.childCount) || !after.type.validContent(rest))\n      return false\n  }\n  let index = $pos.indexAfter(base)\n  let baseType = typesAfter && typesAfter[0]\n  return $pos.node(base).canReplaceWith(index, index, baseType ? baseType.type : $pos.node(base + 1).type)\n}\n\n// :: (number, ?number, ?[?{type: NodeType, attrs: ?Object}]) → this\n// Split the node at the given position, and optionally, if `depth` is\n// greater than one, any number of nodes above that. By default, the\n// parts split off will inherit the node type of the original node.\n// This can be changed by passing an array of types and attributes to\n// use after the split.\nTransform.prototype.split = function(pos, depth = 1, typesAfter) {\n  let $pos = this.doc.resolve(pos), before = Fragment.empty, after = Fragment.empty\n  for (let d = $pos.depth, e = $pos.depth - depth, i = depth - 1; d > e; d--, i--) {\n    before = Fragment.from($pos.node(d).copy(before))\n    let typeAfter = typesAfter && typesAfter[i]\n    after = Fragment.from(typeAfter ? typeAfter.type.create(typeAfter.attrs, after) : $pos.node(d).copy(after))\n  }\n  return this.step(new ReplaceStep(pos, pos, new Slice(before.append(after), depth, depth), true))\n}\n\n// :: (Node, number) → bool\n// Test whether the blocks before and after a given position can be\n// joined.\nexport function canJoin(doc, pos) {\n  let $pos = doc.resolve(pos), index = $pos.index()\n  return joinable($pos.nodeBefore, $pos.nodeAfter) &&\n    $pos.parent.canReplace(index, index + 1)\n}\n\nfunction joinable(a, b) {\n  return a && b && !a.isLeaf && a.canAppend(b)\n}\n\n// :: (Node, number, ?number) → ?number\n// Find an ancestor of the given position that can be joined to the\n// block before (or after if `dir` is positive). Returns the joinable\n// point, if any.\nexport function joinPoint(doc, pos, dir = -1) {\n  let $pos = doc.resolve(pos)\n  for (let d = $pos.depth;; d--) {\n    let before, after, index = $pos.index(d)\n    if (d == $pos.depth) {\n      before = $pos.nodeBefore\n      after = $pos.nodeAfter\n    } else if (dir > 0) {\n      before = $pos.node(d + 1)\n      index++\n      after = $pos.node(d).maybeChild(index)\n    } else {\n      before = $pos.node(d).maybeChild(index - 1)\n      after = $pos.node(d + 1)\n    }\n    if (before && !before.isTextblock && joinable(before, after) &&\n        $pos.node(d).canReplace(index, index + 1)) return pos\n    if (d == 0) break\n    pos = dir < 0 ? $pos.before(d) : $pos.after(d)\n  }\n}\n\n// :: (number, ?number) → this\n// Join the blocks around the given position. If depth is 2, their\n// last and first siblings are also joined, and so on.\nTransform.prototype.join = function(pos, depth = 1) {\n  let step = new ReplaceStep(pos - depth, pos + depth, Slice.empty, true)\n  return this.step(step)\n}\n\n// :: (Node, number, NodeType) → ?number\n// Try to find a point where a node of the given type can be inserted\n// near `pos`, by searching up the node hierarchy when `pos` itself\n// isn't a valid place but is at the start or end of a node. Return\n// null if no position was found.\nexport function insertPoint(doc, pos, nodeType) {\n  let $pos = doc.resolve(pos)\n  if ($pos.parent.canReplaceWith($pos.index(), $pos.index(), nodeType)) return pos\n\n  if ($pos.parentOffset == 0)\n    for (let d = $pos.depth - 1; d >= 0; d--) {\n      let index = $pos.index(d)\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) return $pos.before(d + 1)\n      if (index > 0) return null\n    }\n  if ($pos.parentOffset == $pos.parent.content.size)\n    for (let d = $pos.depth - 1; d >= 0; d--) {\n      let index = $pos.indexAfter(d)\n      if ($pos.node(d).canReplaceWith(index, index, nodeType)) return $pos.after(d + 1)\n      if (index < $pos.node(d).childCount) return null\n    }\n}\n\n// :: (Node, number, Slice) → ?number\n// Finds a position at or around the given position where the given\n// slice can be inserted. Will look at parent nodes' nearest boundary\n// and try there, even if the original position wasn't directly at the\n// start or end of that node. Returns null when no position was found.\nexport function dropPoint(doc, pos, slice) {\n  let $pos = doc.resolve(pos)\n  if (!slice.content.size) return pos\n  let content = slice.content\n  for (let i = 0; i < slice.openStart; i++) content = content.firstChild.content\n  for (let pass = 1; pass <= (slice.openStart == 0 && slice.size ? 2 : 1); pass++) {\n    for (let d = $pos.depth; d >= 0; d--) {\n      let bias = d == $pos.depth ? 0 : $pos.pos <= ($pos.start(d + 1) + $pos.end(d + 1)) / 2 ? -1 : 1\n      let insertPos = $pos.index(d) + (bias > 0 ? 1 : 0)\n      if (pass == 1\n          ? $pos.node(d).canReplace(insertPos, insertPos, content)\n          : $pos.node(d).contentMatchAt(insertPos).findWrapping(content.firstChild.type))\n        return bias == 0 ? $pos.pos : bias < 0 ? $pos.before(d + 1) : $pos.after(d + 1)\n    }\n  }\n  return null\n}\n","import {Fragment, Slice} from \"prosemirror-model\"\nimport {Step, StepResult} from \"./step\"\n\nfunction mapFragment(fragment, f, parent) {\n  let mapped = []\n  for (let i = 0; i < fragment.childCount; i++) {\n    let child = fragment.child(i)\n    if (child.content.size) child = child.copy(mapFragment(child.content, f, child))\n    if (child.isInline) child = f(child, parent, i)\n    mapped.push(child)\n  }\n  return Fragment.fromArray(mapped)\n}\n\n// ::- Add a mark to all inline content between two positions.\nexport class AddMarkStep extends Step {\n  // :: (number, number, Mark)\n  constructor(from, to, mark) {\n    super()\n    this.from = from\n    this.to = to\n    this.mark = mark\n  }\n\n  apply(doc) {\n    let oldSlice = doc.slice(this.from, this.to), $from = doc.resolve(this.from)\n    let parent = $from.node($from.sharedDepth(this.to))\n    let slice = new Slice(mapFragment(oldSlice.content, (node, parent) => {\n      if (!parent.type.allowsMarkType(this.mark.type)) return node\n      return node.mark(this.mark.addToSet(node.marks))\n    }, parent), oldSlice.openStart, oldSlice.openEnd)\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  }\n\n  invert() {\n    return new RemoveMarkStep(this.from, this.to, this.mark)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted || from.pos >= to.pos) return null\n    return new AddMarkStep(from.pos, to.pos, this.mark)\n  }\n\n  merge(other) {\n    if (other instanceof AddMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      return new AddMarkStep(Math.min(this.from, other.from),\n                             Math.max(this.to, other.to), this.mark)\n  }\n\n  toJSON() {\n    return {stepType: \"addMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for AddMarkStep.fromJSON\")\n    return new AddMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  }\n}\n\nStep.jsonID(\"addMark\", AddMarkStep)\n\n// ::- Remove a mark from all inline content between two positions.\nexport class RemoveMarkStep extends Step {\n  // :: (number, number, Mark)\n  constructor(from, to, mark) {\n    super()\n    this.from = from\n    this.to = to\n    this.mark = mark\n  }\n\n  apply(doc) {\n    let oldSlice = doc.slice(this.from, this.to)\n    let slice = new Slice(mapFragment(oldSlice.content, node => {\n      return node.mark(this.mark.removeFromSet(node.marks))\n    }), oldSlice.openStart, oldSlice.openEnd)\n    return StepResult.fromReplace(doc, this.from, this.to, slice)\n  }\n\n  invert() {\n    return new AddMarkStep(this.from, this.to, this.mark)\n  }\n\n  map(mapping) {\n    let from = mapping.mapResult(this.from, 1), to = mapping.mapResult(this.to, -1)\n    if (from.deleted && to.deleted || from.pos >= to.pos) return null\n    return new RemoveMarkStep(from.pos, to.pos, this.mark)\n  }\n\n  merge(other) {\n    if (other instanceof RemoveMarkStep &&\n        other.mark.eq(this.mark) &&\n        this.from <= other.to && this.to >= other.from)\n      return new RemoveMarkStep(Math.min(this.from, other.from),\n                                Math.max(this.to, other.to), this.mark)\n  }\n\n  toJSON() {\n    return {stepType: \"removeMark\", mark: this.mark.toJSON(),\n            from: this.from, to: this.to}\n  }\n\n  static fromJSON(schema, json) {\n    if (typeof json.from != \"number\" || typeof json.to != \"number\")\n      throw new RangeError(\"Invalid input for RemoveMarkStep.fromJSON\")\n    return new RemoveMarkStep(json.from, json.to, schema.markFromJSON(json.mark))\n  }\n}\n\nStep.jsonID(\"removeMark\", RemoveMarkStep)\n","import {Fragment, Slice} from \"prosemirror-model\"\n\nimport {ReplaceStep, ReplaceAroundStep} from \"./replace_step\"\nimport {Transform} from \"./transform\"\nimport {insertPoint} from \"./structure\"\n\n// :: (Node, number, ?number, ?Slice) → ?Step\n// ‘Fit’ a slice into a given position in the document, producing a\n// [step](#transform.Step) that inserts it. Will return null if\n// there's no meaningful way to insert the slice here, or inserting it\n// would be a no-op (an empty slice over an empty range).\nexport function replaceStep(doc, from, to = from, slice = Slice.empty) {\n  if (from == to && !slice.size) return null\n\n  let $from = doc.resolve(from), $to = doc.resolve(to)\n  // Optimization -- avoid work if it's obvious that it's not needed.\n  if (fitsTrivially($from, $to, slice)) return new ReplaceStep(from, to, slice)\n  return new Fitter($from, $to, slice).fit()\n}\n\n// :: (number, ?number, ?Slice) → this\n// Replace the part of the document between `from` and `to` with the\n// given `slice`.\nTransform.prototype.replace = function(from, to = from, slice = Slice.empty) {\n  let step = replaceStep(this.doc, from, to, slice)\n  if (step) this.step(step)\n  return this\n}\n\n// :: (number, number, union<Fragment, Node, [Node]>) → this\n// Replace the given range with the given content, which may be a\n// fragment, node, or array of nodes.\nTransform.prototype.replaceWith = function(from, to, content) {\n  return this.replace(from, to, new Slice(Fragment.from(content), 0, 0))\n}\n\n// :: (number, number) → this\n// Delete the content between the given positions.\nTransform.prototype.delete = function(from, to) {\n  return this.replace(from, to, Slice.empty)\n}\n\n// :: (number, union<Fragment, Node, [Node]>) → this\n// Insert the given content at the given position.\nTransform.prototype.insert = function(pos, content) {\n  return this.replaceWith(pos, pos, content)\n}\n\nfunction fitsTrivially($from, $to, slice) {\n  return !slice.openStart && !slice.openEnd && $from.start() == $to.start() &&\n    $from.parent.canReplace($from.index(), $to.index(), slice.content)\n}\n\n// Algorithm for 'placing' the elements of a slice into a gap:\n//\n// We consider the content of each node that is open to the left to be\n// independently placeable. I.e. in <p(\"foo\"), p(\"bar\")>, when the\n// paragraph on the left is open, \"foo\" can be placed (somewhere on\n// the left side of the replacement gap) independently from p(\"bar\").\n//\n// This class tracks the state of the placement progress in the\n// following properties:\n//\n//  - `frontier` holds a stack of `{type, match}` objects that\n//    represent the open side of the replacement. It starts at\n//    `$from`, then moves forward as content is placed, and is finally\n//    reconciled with `$to`.\n//\n//  - `unplaced` is a slice that represents the content that hasn't\n//    been placed yet.\n//\n//  - `placed` is a fragment of placed content. Its open-start value\n//    is implicit in `$from`, and its open-end value in `frontier`.\nclass Fitter {\n  constructor($from, $to, slice) {\n    this.$to = $to\n    this.$from = $from\n    this.unplaced = slice\n\n    this.frontier = []\n    for (let i = 0; i <= $from.depth; i++) {\n      let node = $from.node(i)\n      this.frontier.push({\n        type: node.type,\n        match: node.contentMatchAt($from.indexAfter(i))\n      })\n    }\n\n    this.placed = Fragment.empty\n    for (let i = $from.depth; i > 0; i--)\n      this.placed = Fragment.from($from.node(i).copy(this.placed))\n  }\n\n  get depth() { return this.frontier.length - 1 }\n\n  fit() {\n    // As long as there's unplaced content, try to place some of it.\n    // If that fails, either increase the open score of the unplaced\n    // slice, or drop nodes from it, and then try again.\n    while (this.unplaced.size) {\n      let fit = this.findFittable()\n      if (fit) this.placeNodes(fit)\n      else this.openMore() || this.dropNode()\n    }\n    // When there's inline content directly after the frontier _and_\n    // directly after `this.$to`, we must generate a `ReplaceAround`\n    // step that pulls that content into the node after the frontier.\n    // That means the fitting must be done to the end of the textblock\n    // node after `this.$to`, not `this.$to` itself.\n    let moveInline = this.mustMoveInline(), placedSize = this.placed.size - this.depth - this.$from.depth\n    let $from = this.$from, $to = this.close(moveInline < 0 ? this.$to : $from.doc.resolve(moveInline))\n    if (!$to) return null\n\n    // If closing to `$to` succeeded, create a step\n    let content = this.placed, openStart = $from.depth, openEnd = $to.depth\n    while (openStart && openEnd && content.childCount == 1) { // Normalize by dropping open parent nodes\n      content = content.firstChild.content\n      openStart--; openEnd--\n    }\n    let slice = new Slice(content, openStart, openEnd)\n    if (moveInline > -1)\n      return new ReplaceAroundStep($from.pos, moveInline, this.$to.pos, this.$to.end(), slice, placedSize)\n    if (slice.size || $from.pos != this.$to.pos) // Don't generate no-op steps\n      return new ReplaceStep($from.pos, $to.pos, slice)\n  }\n\n  // Find a position on the start spine of `this.unplaced` that has\n  // content that can be moved somewhere on the frontier. Returns two\n  // depths, one for the slice and one for the frontier.\n  findFittable() {\n    // Only try wrapping nodes (pass 2) after finding a place without\n    // wrapping failed.\n    for (let pass = 1; pass <= 2; pass++) {\n      for (let sliceDepth = this.unplaced.openStart; sliceDepth >= 0; sliceDepth--) {\n        let fragment, parent\n        if (sliceDepth) {\n          parent = contentAt(this.unplaced.content, sliceDepth - 1).firstChild\n          fragment = parent.content\n        } else {\n          fragment = this.unplaced.content\n        }\n        let first = fragment.firstChild\n        for (let frontierDepth = this.depth; frontierDepth >= 0; frontierDepth--) {\n          let {type, match} = this.frontier[frontierDepth], wrap, inject\n          // In pass 1, if the next node matches, or there is no next\n          // node but the parents look compatible, we've found a\n          // place.\n          if (pass == 1 && (first ? match.matchType(first.type) || (inject = match.fillBefore(Fragment.from(first), false))\n                            : type.compatibleContent(parent.type)))\n            return {sliceDepth, frontierDepth, parent, inject}\n          // In pass 2, look for a set of wrapping nodes that make\n          // `first` fit here.\n          else if (pass == 2 && first && (wrap = match.findWrapping(first.type)))\n            return {sliceDepth, frontierDepth, parent, wrap}\n          // Don't continue looking further up if the parent node\n          // would fit here.\n          if (parent && match.matchType(parent.type)) break\n        }\n      }\n    }\n  }\n\n  openMore() {\n    let {content, openStart, openEnd} = this.unplaced\n    let inner = contentAt(content, openStart)\n    if (!inner.childCount || inner.firstChild.isLeaf) return false\n    this.unplaced = new Slice(content, openStart + 1,\n                              Math.max(openEnd, inner.size + openStart >= content.size - openEnd ? openStart + 1 : 0))\n    return true\n  }\n\n  dropNode() {\n    let {content, openStart, openEnd} = this.unplaced\n    let inner = contentAt(content, openStart)\n    if (inner.childCount <= 1 && openStart > 0) {\n      let openAtEnd = content.size - openStart <= openStart + inner.size\n      this.unplaced = new Slice(dropFromFragment(content, openStart - 1, 1), openStart - 1,\n                                openAtEnd ? openStart - 1 : openEnd)\n    } else {\n      this.unplaced = new Slice(dropFromFragment(content, openStart, 1), openStart, openEnd)\n    }\n  }\n\n  // : ({sliceDepth: number, frontierDepth: number, parent: ?Node, wrap: ?[NodeType], inject: ?Fragment})\n  // Move content from the unplaced slice at `sliceDepth` to the\n  // frontier node at `frontierDepth`. Close that frontier node when\n  // applicable.\n  placeNodes({sliceDepth, frontierDepth, parent, inject, wrap}) {\n    while (this.depth > frontierDepth) this.closeFrontierNode()\n    if (wrap) for (let i = 0; i < wrap.length; i++) this.openFrontierNode(wrap[i])\n\n    let slice = this.unplaced, fragment = parent ? parent.content : slice.content\n    let openStart = slice.openStart - sliceDepth\n    let taken = 0, add = []\n    let {match, type} = this.frontier[frontierDepth]\n    if (inject) {\n      for (let i = 0; i < inject.childCount; i++) add.push(inject.child(i))\n      match = match.matchFragment(inject)\n    }\n    // Computes the amount of (end) open nodes at the end of the\n    // fragment. When 0, the parent is open, but no more. When\n    // negative, nothing is open.\n    let openEndCount = (fragment.size + sliceDepth) - (slice.content.size - slice.openEnd)\n    // Scan over the fragment, fitting as many child nodes as\n    // possible.\n    while (taken < fragment.childCount) {\n      let next = fragment.child(taken), matches = match.matchType(next.type)\n      if (!matches) break\n      taken++\n      if (taken > 1 || openStart == 0 || next.content.size) { // Drop empty open nodes\n        match = matches\n        add.push(closeNodeStart(next.mark(type.allowedMarks(next.marks)), taken == 1 ? openStart : 0,\n                                taken == fragment.childCount ? openEndCount : -1))\n      }\n    }\n    let toEnd = taken == fragment.childCount\n    if (!toEnd) openEndCount = -1\n\n    this.placed = addToFragment(this.placed, frontierDepth, Fragment.from(add))\n    this.frontier[frontierDepth].match = match\n\n    // If the parent types match, and the entire node was moved, and\n    // it's not open, close this frontier node right away.\n    if (toEnd && openEndCount < 0 && parent && parent.type == this.frontier[this.depth].type && this.frontier.length > 1)\n      this.closeFrontierNode()\n\n    // Add new frontier nodes for any open nodes at the end.\n    for (let i = 0, cur = fragment; i < openEndCount; i++) {\n      let node = cur.lastChild\n      this.frontier.push({type: node.type, match: node.contentMatchAt(node.childCount)})\n      cur = node.content\n    }\n\n    // Update `this.unplaced`. Drop the entire node from which we\n    // placed it we got to its end, otherwise just drop the placed\n    // nodes.\n    this.unplaced = !toEnd ? new Slice(dropFromFragment(slice.content, sliceDepth, taken), slice.openStart, slice.openEnd)\n      : sliceDepth == 0 ? Slice.empty\n      : new Slice(dropFromFragment(slice.content, sliceDepth - 1, 1),\n                  sliceDepth - 1, openEndCount < 0 ? slice.openEnd : sliceDepth - 1)\n  }\n\n  mustMoveInline() {\n    if (!this.$to.parent.isTextblock || this.$to.end() == this.$to.pos) return -1\n    let top = this.frontier[this.depth], level\n    if (!top.type.isTextblock || !contentAfterFits(this.$to, this.$to.depth, top.type, top.match, false) ||\n        (this.$to.depth == this.depth && (level = this.findCloseLevel(this.$to)) && level.depth == this.depth)) return -1\n\n    let {depth} = this.$to, after = this.$to.after(depth)\n    while (depth > 1 && after == this.$to.end(--depth)) ++after\n    return after\n  }\n\n  findCloseLevel($to) {\n    scan: for (let i = Math.min(this.depth, $to.depth); i >= 0; i--) {\n      let {match, type} = this.frontier[i]\n      let dropInner = i < $to.depth && $to.end(i + 1) == $to.pos + ($to.depth - (i + 1))\n      let fit = contentAfterFits($to, i, type, match, dropInner)\n      if (!fit) continue\n      for (let d = i - 1; d >= 0; d--) {\n        let {match, type} = this.frontier[d]\n        let matches = contentAfterFits($to, d, type, match, true)\n        if (!matches || matches.childCount) continue scan\n      }\n      return {depth: i, fit, move: dropInner ? $to.doc.resolve($to.after(i + 1)) : $to}\n    }\n  }\n\n  close($to) {\n    let close = this.findCloseLevel($to)\n    if (!close) return null\n\n    while (this.depth > close.depth) this.closeFrontierNode()\n    if (close.fit.childCount) this.placed = addToFragment(this.placed, close.depth, close.fit)\n    $to = close.move\n    for (let d = close.depth + 1; d <= $to.depth; d++) {\n      let node = $to.node(d), add = node.type.contentMatch.fillBefore(node.content, true, $to.index(d))\n      this.openFrontierNode(node.type, node.attrs, add)\n    }\n    return $to\n  }\n\n  openFrontierNode(type, attrs, content) {\n    let top = this.frontier[this.depth]\n    top.match = top.match.matchType(type)\n    this.placed = addToFragment(this.placed, this.depth, Fragment.from(type.create(attrs, content)))\n    this.frontier.push({type, match: type.contentMatch})\n  }\n\n  closeFrontierNode() {\n    let open = this.frontier.pop()\n    let add = open.match.fillBefore(Fragment.empty, true)\n    if (add.childCount) this.placed = addToFragment(this.placed, this.frontier.length, add)\n  }\n}\n\nfunction dropFromFragment(fragment, depth, count) {\n  if (depth == 0) return fragment.cutByIndex(count)\n  return fragment.replaceChild(0, fragment.firstChild.copy(dropFromFragment(fragment.firstChild.content, depth - 1, count)))\n}\n\nfunction addToFragment(fragment, depth, content) {\n  if (depth == 0) return fragment.append(content)\n  return fragment.replaceChild(fragment.childCount - 1,\n                               fragment.lastChild.copy(addToFragment(fragment.lastChild.content, depth - 1, content)))\n}\n\nfunction contentAt(fragment, depth) {\n  for (let i = 0; i < depth; i++) fragment = fragment.firstChild.content\n  return fragment\n}\n\nfunction closeNodeStart(node, openStart, openEnd) {\n  if (openStart <= 0) return node\n  let frag = node.content\n  if (openStart > 1)\n    frag = frag.replaceChild(0, closeNodeStart(frag.firstChild, openStart - 1, frag.childCount == 1 ? openEnd - 1 : 0))\n  if (openStart > 0) {\n    frag = node.type.contentMatch.fillBefore(frag).append(frag)\n    if (openEnd <= 0) frag = frag.append(node.type.contentMatch.matchFragment(frag).fillBefore(Fragment.empty, true))\n  }\n  return node.copy(frag)\n}\n\nfunction contentAfterFits($to, depth, type, match, open) {\n  let node = $to.node(depth), index = open ? $to.indexAfter(depth) : $to.index(depth)\n  if (index == node.childCount && !type.compatibleContent(node.type)) return null\n  let fit = match.fillBefore(node.content, true, index)\n  return fit && !invalidMarks(type, node.content, index) ? fit : null\n}\n\nfunction invalidMarks(type, fragment, start) {\n  for (let i = start; i < fragment.childCount; i++)\n    if (!type.allowsMarks(fragment.child(i).marks)) return true\n  return false\n}\n\n// :: (number, number, Slice) → this\n// Replace a range of the document with a given slice, using `from`,\n// `to`, and the slice's [`openStart`](#model.Slice.openStart) property\n// as hints, rather than fixed start and end points. This method may\n// grow the replaced area or close open nodes in the slice in order to\n// get a fit that is more in line with WYSIWYG expectations, by\n// dropping fully covered parent nodes of the replaced region when\n// they are marked [non-defining](#model.NodeSpec.defining), or\n// including an open parent node from the slice that _is_ marked as\n// [defining](#model.NodeSpec.defining).\n//\n// This is the method, for example, to handle paste. The similar\n// [`replace`](#transform.Transform.replace) method is a more\n// primitive tool which will _not_ move the start and end of its given\n// range, and is useful in situations where you need more precise\n// control over what happens.\nTransform.prototype.replaceRange = function(from, to, slice) {\n  if (!slice.size) return this.deleteRange(from, to)\n\n  let $from = this.doc.resolve(from), $to = this.doc.resolve(to)\n  if (fitsTrivially($from, $to, slice))\n    return this.step(new ReplaceStep(from, to, slice))\n\n  let targetDepths = coveredDepths($from, this.doc.resolve(to))\n  // Can't replace the whole document, so remove 0 if it's present\n  if (targetDepths[targetDepths.length - 1] == 0) targetDepths.pop()\n  // Negative numbers represent not expansion over the whole node at\n  // that depth, but replacing from $from.before(-D) to $to.pos.\n  let preferredTarget = -($from.depth + 1)\n  targetDepths.unshift(preferredTarget)\n  // This loop picks a preferred target depth, if one of the covering\n  // depths is not outside of a defining node, and adds negative\n  // depths for any depth that has $from at its start and does not\n  // cross a defining node.\n  for (let d = $from.depth, pos = $from.pos - 1; d > 0; d--, pos--) {\n    let spec = $from.node(d).type.spec\n    if (spec.defining || spec.isolating) break\n    if (targetDepths.indexOf(d) > -1) preferredTarget = d\n    else if ($from.before(d) == pos) targetDepths.splice(1, 0, -d)\n  }\n  // Try to fit each possible depth of the slice into each possible\n  // target depth, starting with the preferred depths.\n  let preferredTargetIndex = targetDepths.indexOf(preferredTarget)\n\n  let leftNodes = [], preferredDepth = slice.openStart\n  for (let content = slice.content, i = 0;; i++) {\n    let node = content.firstChild\n    leftNodes.push(node)\n    if (i == slice.openStart) break\n    content = node.content\n  }\n  // Back up if the node directly above openStart, or the node above\n  // that separated only by a non-defining textblock node, is defining.\n  if (preferredDepth > 0 && leftNodes[preferredDepth - 1].type.spec.defining &&\n      $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 1].type)\n    preferredDepth -= 1\n  else if (preferredDepth >= 2 && leftNodes[preferredDepth - 1].isTextblock && leftNodes[preferredDepth - 2].type.spec.defining &&\n           $from.node(preferredTargetIndex).type != leftNodes[preferredDepth - 2].type)\n    preferredDepth -= 2\n\n  for (let j = slice.openStart; j >= 0; j--) {\n    let openDepth = (j + preferredDepth + 1) % (slice.openStart + 1)\n    let insert = leftNodes[openDepth]\n    if (!insert) continue\n    for (let i = 0; i < targetDepths.length; i++) {\n      // Loop over possible expansion levels, starting with the\n      // preferred one\n      let targetDepth = targetDepths[(i + preferredTargetIndex) % targetDepths.length], expand = true\n      if (targetDepth < 0) { expand = false; targetDepth = -targetDepth }\n      let parent = $from.node(targetDepth - 1), index = $from.index(targetDepth - 1)\n      if (parent.canReplaceWith(index, index, insert.type, insert.marks))\n        return this.replace($from.before(targetDepth), expand ? $to.after(targetDepth) : to,\n                            new Slice(closeFragment(slice.content, 0, slice.openStart, openDepth),\n                                      openDepth, slice.openEnd))\n    }\n  }\n\n  let startSteps = this.steps.length\n  for (let i = targetDepths.length - 1; i >= 0; i--) {\n    this.replace(from, to, slice)\n    if (this.steps.length > startSteps) break\n    let depth = targetDepths[i]\n    if (i < 0) continue\n    from = $from.before(depth); to = $to.after(depth)\n  }\n  return this\n}\n\nfunction closeFragment(fragment, depth, oldOpen, newOpen, parent) {\n  if (depth < oldOpen) {\n    let first = fragment.firstChild\n    fragment = fragment.replaceChild(0, first.copy(closeFragment(first.content, depth + 1, oldOpen, newOpen, first)))\n  }\n  if (depth > newOpen) {\n    let match = parent.contentMatchAt(0)\n    let start = match.fillBefore(fragment).append(fragment)\n    fragment = start.append(match.matchFragment(start).fillBefore(Fragment.empty, true))\n  }\n  return fragment\n}\n\n// :: (number, number, Node) → this\n// Replace the given range with a node, but use `from` and `to` as\n// hints, rather than precise positions. When from and to are the same\n// and are at the start or end of a parent node in which the given\n// node doesn't fit, this method may _move_ them out towards a parent\n// that does allow the given node to be placed. When the given range\n// completely covers a parent node, this method may completely replace\n// that parent node.\nTransform.prototype.replaceRangeWith = function(from, to, node) {\n  if (!node.isInline && from == to && this.doc.resolve(from).parent.content.size) {\n    let point = insertPoint(this.doc, from, node.type)\n    if (point != null) from = to = point\n  }\n  return this.replaceRange(from, to, new Slice(Fragment.from(node), 0, 0))\n}\n\n// :: (number, number) → this\n// Delete the given range, expanding it to cover fully covered\n// parent nodes until a valid replace is found.\nTransform.prototype.deleteRange = function(from, to) {\n  let $from = this.doc.resolve(from), $to = this.doc.resolve(to)\n  let covered = coveredDepths($from, $to)\n  for (let i = 0; i < covered.length; i++) {\n    let depth = covered[i], last = i == covered.length - 1\n    if ((last && depth == 0) || $from.node(depth).type.contentMatch.validEnd)\n      return this.delete($from.start(depth), $to.end(depth))\n    if (depth > 0 && (last || $from.node(depth - 1).canReplace($from.index(depth - 1), $to.indexAfter(depth - 1))))\n      return this.delete($from.before(depth), $to.after(depth))\n  }\n  for (let d = 1; d <= $from.depth && d <= $to.depth; d++) {\n    if (from - $from.start(d) == $from.depth - d && to > $from.end(d) && $to.end(d) - to != $to.depth - d)\n      return this.delete($from.before(d), to)\n  }\n  return this.delete(from, to)\n}\n\n// : (ResolvedPos, ResolvedPos) → [number]\n// Returns an array of all depths for which $from - $to spans the\n// whole content of the nodes at that depth.\nfunction coveredDepths($from, $to) {\n  let result = [], minDepth = Math.min($from.depth, $to.depth)\n  for (let d = minDepth; d >= 0; d--) {\n    let start = $from.start(d)\n    if (start < $from.pos - ($from.depth - d) ||\n        $to.end(d) > $to.pos + ($to.depth - d) ||\n        $from.node(d).type.spec.isolating ||\n        $to.node(d).type.spec.isolating) break\n    if (start == $to.start(d)) result.push(d)\n  }\n  return result\n}\n","import {MarkType, Slice, Fragment} from \"prosemirror-model\"\n\nimport {Transform} from \"./transform\"\nimport {AddMarkStep, RemoveMarkStep} from \"./mark_step\"\nimport {ReplaceStep} from \"./replace_step\"\n\n// :: (number, number, Mark) → this\n// Add the given mark to the inline content between `from` and `to`.\nTransform.prototype.addMark = function(from, to, mark) {\n  let removed = [], added = [], removing = null, adding = null\n  this.doc.nodesBetween(from, to, (node, pos, parent) => {\n    if (!node.isInline) return\n    let marks = node.marks\n    if (!mark.isInSet(marks) && parent.type.allowsMarkType(mark.type)) {\n      let start = Math.max(pos, from), end = Math.min(pos + node.nodeSize, to)\n      let newSet = mark.addToSet(marks)\n\n      for (let i = 0; i < marks.length; i++) {\n        if (!marks[i].isInSet(newSet)) {\n          if (removing && removing.to == start && removing.mark.eq(marks[i]))\n            removing.to = end\n          else\n            removed.push(removing = new RemoveMarkStep(start, end, marks[i]))\n        }\n      }\n\n      if (adding && adding.to == start)\n        adding.to = end\n      else\n        added.push(adding = new AddMarkStep(start, end, mark))\n    }\n  })\n\n  removed.forEach(s => this.step(s))\n  added.forEach(s => this.step(s))\n  return this\n}\n\n// :: (number, number, ?union<Mark, MarkType>) → this\n// Remove marks from inline nodes between `from` and `to`. When `mark`\n// is a single mark, remove precisely that mark. When it is a mark type,\n// remove all marks of that type. When it is null, remove all marks of\n// any type.\nTransform.prototype.removeMark = function(from, to, mark = null) {\n  let matched = [], step = 0\n  this.doc.nodesBetween(from, to, (node, pos) => {\n    if (!node.isInline) return\n    step++\n    let toRemove = null\n    if (mark instanceof MarkType) {\n      let found = mark.isInSet(node.marks)\n      if (found) toRemove = [found]\n    } else if (mark) {\n      if (mark.isInSet(node.marks)) toRemove = [mark]\n    } else {\n      toRemove = node.marks\n    }\n    if (toRemove && toRemove.length) {\n      let end = Math.min(pos + node.nodeSize, to)\n      for (let i = 0; i < toRemove.length; i++) {\n        let style = toRemove[i], found\n        for (let j = 0; j < matched.length; j++) {\n          let m = matched[j]\n          if (m.step == step - 1 && style.eq(matched[j].style)) found = m\n        }\n        if (found) {\n          found.to = end\n          found.step = step\n        } else {\n          matched.push({style, from: Math.max(pos, from), to: end, step})\n        }\n      }\n    }\n  })\n  matched.forEach(m => this.step(new RemoveMarkStep(m.from, m.to, m.style)))\n  return this\n}\n\n// :: (number, NodeType, ?ContentMatch) → this\n// Removes all marks and nodes from the content of the node at `pos`\n// that don't match the given new parent node type. Accepts an\n// optional starting [content match](#model.ContentMatch) as third\n// argument.\nTransform.prototype.clearIncompatible = function(pos, parentType, match = parentType.contentMatch) {\n  let node = this.doc.nodeAt(pos)\n  let delSteps = [], cur = pos + 1\n  for (let i = 0; i < node.childCount; i++) {\n    let child = node.child(i), end = cur + child.nodeSize\n    let allowed = match.matchType(child.type, child.attrs)\n    if (!allowed) {\n      delSteps.push(new ReplaceStep(cur, end, Slice.empty))\n    } else {\n      match = allowed\n      for (let j = 0; j < child.marks.length; j++) if (!parentType.allowsMarkType(child.marks[j].type))\n        this.step(new RemoveMarkStep(cur, end, child.marks[j]))\n    }\n    cur = end\n  }\n  if (!match.validEnd) {\n    let fill = match.fillBefore(Fragment.empty, true)\n    this.replace(cur, cur, new Slice(fill, 0, 0))\n  }\n  for (let i = delSteps.length - 1; i >= 0; i--) this.step(delSteps[i])\n  return this\n}\n","import {Slice, Fragment} from \"prosemirror-model\"\nimport {ReplaceStep, ReplaceAroundStep} from \"prosemirror-transform\"\n\nconst classesById = Object.create(null)\n\n// ::- Superclass for editor selections. Every selection type should\n// extend this. Should not be instantiated directly.\nexport class Selection {\n  // :: (ResolvedPos, ResolvedPos, ?[SelectionRange])\n  // Initialize a selection with the head and anchor and ranges. If no\n  // ranges are given, constructs a single range across `$anchor` and\n  // `$head`.\n  constructor($anchor, $head, ranges) {\n    // :: [SelectionRange]\n    // The ranges covered by the selection.\n    this.ranges = ranges || [new SelectionRange($anchor.min($head), $anchor.max($head))]\n    // :: ResolvedPos\n    // The resolved anchor of the selection (the side that stays in\n    // place when the selection is modified).\n    this.$anchor = $anchor\n    // :: ResolvedPos\n    // The resolved head of the selection (the side that moves when\n    // the selection is modified).\n    this.$head = $head\n  }\n\n  // :: number\n  // The selection's anchor, as an unresolved position.\n  get anchor() { return this.$anchor.pos }\n\n  // :: number\n  // The selection's head.\n  get head() { return this.$head.pos }\n\n  // :: number\n  // The lower bound of the selection's main range.\n  get from() { return this.$from.pos }\n\n  // :: number\n  // The upper bound of the selection's main range.\n  get to() { return this.$to.pos }\n\n  // :: ResolvedPos\n  // The resolved lower  bound of the selection's main range.\n  get $from() {\n    return this.ranges[0].$from\n  }\n\n  // :: ResolvedPos\n  // The resolved upper bound of the selection's main range.\n  get $to() {\n    return this.ranges[0].$to\n  }\n\n  // :: bool\n  // Indicates whether the selection contains any content.\n  get empty() {\n    let ranges = this.ranges\n    for (let i = 0; i < ranges.length; i++)\n      if (ranges[i].$from.pos != ranges[i].$to.pos) return false\n    return true\n  }\n\n  // eq:: (Selection) → bool\n  // Test whether the selection is the same as another selection.\n\n  // map:: (doc: Node, mapping: Mappable) → Selection\n  // Map this selection through a [mappable](#transform.Mappable) thing. `doc`\n  // should be the new document to which we are mapping.\n\n  // :: () → Slice\n  // Get the content of this selection as a slice.\n  content() {\n    return this.$from.node(0).slice(this.from, this.to, true)\n  }\n\n  // :: (Transaction, ?Slice)\n  // Replace the selection with a slice or, if no slice is given,\n  // delete the selection. Will append to the given transaction.\n  replace(tr, content = Slice.empty) {\n    // Put the new selection at the position after the inserted\n    // content. When that ended in an inline node, search backwards,\n    // to get the position after that node. If not, search forward.\n    let lastNode = content.content.lastChild, lastParent = null\n    for (let i = 0; i < content.openEnd; i++) {\n      lastParent = lastNode\n      lastNode = lastNode.lastChild\n    }\n\n    let mapFrom = tr.steps.length, ranges = this.ranges\n    for (let i = 0; i < ranges.length; i++) {\n      let {$from, $to} = ranges[i], mapping = tr.mapping.slice(mapFrom)\n      tr.replaceRange(mapping.map($from.pos), mapping.map($to.pos), i ? Slice.empty : content)\n      if (i == 0)\n        selectionToInsertionEnd(tr, mapFrom, (lastNode ? lastNode.isInline : lastParent && lastParent.isTextblock) ? -1 : 1)\n    }\n  }\n\n  // :: (Transaction, Node)\n  // Replace the selection with the given node, appending the changes\n  // to the given transaction.\n  replaceWith(tr, node) {\n    let mapFrom = tr.steps.length, ranges = this.ranges\n    for (let i = 0; i < ranges.length; i++) {\n      let {$from, $to} = ranges[i], mapping = tr.mapping.slice(mapFrom)\n      let from = mapping.map($from.pos), to = mapping.map($to.pos)\n      if (i) {\n        tr.deleteRange(from, to)\n      } else {\n        tr.replaceRangeWith(from, to, node)\n        selectionToInsertionEnd(tr, mapFrom, node.isInline ? -1 : 1)\n      }\n    }\n  }\n\n  // toJSON:: () → Object\n  // Convert the selection to a JSON representation. When implementing\n  // this for a custom selection class, make sure to give the object a\n  // `type` property whose value matches the ID under which you\n  // [registered](#state.Selection^jsonID) your class.\n\n  // :: (ResolvedPos, number, ?bool) → ?Selection\n  // Find a valid cursor or leaf node selection starting at the given\n  // position and searching back if `dir` is negative, and forward if\n  // positive. When `textOnly` is true, only consider cursor\n  // selections. Will return null when no valid selection position is\n  // found.\n  static findFrom($pos, dir, textOnly) {\n    let inner = $pos.parent.inlineContent ? new TextSelection($pos)\n        : findSelectionIn($pos.node(0), $pos.parent, $pos.pos, $pos.index(), dir, textOnly)\n    if (inner) return inner\n\n    for (let depth = $pos.depth - 1; depth >= 0; depth--) {\n      let found = dir < 0\n          ? findSelectionIn($pos.node(0), $pos.node(depth), $pos.before(depth + 1), $pos.index(depth), dir, textOnly)\n          : findSelectionIn($pos.node(0), $pos.node(depth), $pos.after(depth + 1), $pos.index(depth) + 1, dir, textOnly)\n      if (found) return found\n    }\n  }\n\n  // :: (ResolvedPos, ?number) → Selection\n  // Find a valid cursor or leaf node selection near the given\n  // position. Searches forward first by default, but if `bias` is\n  // negative, it will search backwards first.\n  static near($pos, bias = 1) {\n    return this.findFrom($pos, bias) || this.findFrom($pos, -bias) || new AllSelection($pos.node(0))\n  }\n\n  // :: (Node) → Selection\n  // Find the cursor or leaf node selection closest to the start of\n  // the given document. Will return an\n  // [`AllSelection`](#state.AllSelection) if no valid position\n  // exists.\n  static atStart(doc) {\n    return findSelectionIn(doc, doc, 0, 0, 1) || new AllSelection(doc)\n  }\n\n  // :: (Node) → Selection\n  // Find the cursor or leaf node selection closest to the end of the\n  // given document.\n  static atEnd(doc) {\n    return findSelectionIn(doc, doc, doc.content.size, doc.childCount, -1) || new AllSelection(doc)\n  }\n\n  // :: (Node, Object) → Selection\n  // Deserialize the JSON representation of a selection. Must be\n  // implemented for custom classes (as a static class method).\n  static fromJSON(doc, json) {\n    if (!json || !json.type) throw new RangeError(\"Invalid input for Selection.fromJSON\")\n    let cls = classesById[json.type]\n    if (!cls) throw new RangeError(`No selection type ${json.type} defined`)\n    return cls.fromJSON(doc, json)\n  }\n\n  // :: (string, constructor<Selection>)\n  // To be able to deserialize selections from JSON, custom selection\n  // classes must register themselves with an ID string, so that they\n  // can be disambiguated. Try to pick something that's unlikely to\n  // clash with classes from other modules.\n  static jsonID(id, selectionClass) {\n    if (id in classesById) throw new RangeError(\"Duplicate use of selection JSON ID \" + id)\n    classesById[id] = selectionClass\n    selectionClass.prototype.jsonID = id\n    return selectionClass\n  }\n\n  // :: () → SelectionBookmark\n  // Get a [bookmark](#state.SelectionBookmark) for this selection,\n  // which is a value that can be mapped without having access to a\n  // current document, and later resolved to a real selection for a\n  // given document again. (This is used mostly by the history to\n  // track and restore old selections.) The default implementation of\n  // this method just converts the selection to a text selection and\n  // returns the bookmark for that.\n  getBookmark() {\n    return TextSelection.between(this.$anchor, this.$head).getBookmark()\n  }\n}\n\n// :: bool\n// Controls whether, when a selection of this type is active in the\n// browser, the selected range should be visible to the user. Defaults\n// to `true`.\nSelection.prototype.visible = true\n\n// SelectionBookmark:: interface\n// A lightweight, document-independent representation of a selection.\n// You can define a custom bookmark type for a custom selection class\n// to make the history handle it well.\n//\n//   map:: (mapping: Mapping) → SelectionBookmark\n//   Map the bookmark through a set of changes.\n//\n//   resolve:: (doc: Node) → Selection\n//   Resolve the bookmark to a real selection again. This may need to\n//   do some error checking and may fall back to a default (usually\n//   [`TextSelection.between`](#state.TextSelection^between)) if\n//   mapping made the bookmark invalid.\n\n// ::- Represents a selected range in a document.\nexport class SelectionRange {\n  // :: (ResolvedPos, ResolvedPos)\n  constructor($from, $to) {\n    // :: ResolvedPos\n    // The lower bound of the range.\n    this.$from = $from\n    // :: ResolvedPos\n    // The upper bound of the range.\n    this.$to = $to\n  }\n}\n\n// ::- A text selection represents a classical editor selection, with\n// a head (the moving side) and anchor (immobile side), both of which\n// point into textblock nodes. It can be empty (a regular cursor\n// position).\nexport class TextSelection extends Selection {\n  // :: (ResolvedPos, ?ResolvedPos)\n  // Construct a text selection between the given points.\n  constructor($anchor, $head = $anchor) {\n    super($anchor, $head)\n  }\n\n  // :: ?ResolvedPos\n  // Returns a resolved position if this is a cursor selection (an\n  // empty text selection), and null otherwise.\n  get $cursor() { return this.$anchor.pos == this.$head.pos ? this.$head : null }\n\n  map(doc, mapping) {\n    let $head = doc.resolve(mapping.map(this.head))\n    if (!$head.parent.inlineContent) return Selection.near($head)\n    let $anchor = doc.resolve(mapping.map(this.anchor))\n    return new TextSelection($anchor.parent.inlineContent ? $anchor : $head, $head)\n  }\n\n  replace(tr, content = Slice.empty) {\n    super.replace(tr, content)\n    if (content == Slice.empty) {\n      let marks = this.$from.marksAcross(this.$to)\n      if (marks) tr.ensureMarks(marks)\n    }\n  }\n\n  eq(other) {\n    return other instanceof TextSelection && other.anchor == this.anchor && other.head == this.head\n  }\n\n  getBookmark() {\n    return new TextBookmark(this.anchor, this.head)\n  }\n\n  toJSON() {\n    return {type: \"text\", anchor: this.anchor, head: this.head}\n  }\n\n  static fromJSON(doc, json) {\n    if (typeof json.anchor != \"number\" || typeof json.head != \"number\")\n      throw new RangeError(\"Invalid input for TextSelection.fromJSON\")\n    return new TextSelection(doc.resolve(json.anchor), doc.resolve(json.head))\n  }\n\n  // :: (Node, number, ?number) → TextSelection\n  // Create a text selection from non-resolved positions.\n  static create(doc, anchor, head = anchor) {\n    let $anchor = doc.resolve(anchor)\n    return new this($anchor, head == anchor ? $anchor : doc.resolve(head))\n  }\n\n  // :: (ResolvedPos, ResolvedPos, ?number) → Selection\n  // Return a text selection that spans the given positions or, if\n  // they aren't text positions, find a text selection near them.\n  // `bias` determines whether the method searches forward (default)\n  // or backwards (negative number) first. Will fall back to calling\n  // [`Selection.near`](#state.Selection^near) when the document\n  // doesn't contain a valid text position.\n  static between($anchor, $head, bias) {\n    let dPos = $anchor.pos - $head.pos\n    if (!bias || dPos) bias = dPos >= 0 ? 1 : -1\n    if (!$head.parent.inlineContent) {\n      let found = Selection.findFrom($head, bias, true) || Selection.findFrom($head, -bias, true)\n      if (found) $head = found.$head\n      else return Selection.near($head, bias)\n    }\n    if (!$anchor.parent.inlineContent) {\n      if (dPos == 0) {\n        $anchor = $head\n      } else {\n        $anchor = (Selection.findFrom($anchor, -bias, true) || Selection.findFrom($anchor, bias, true)).$anchor\n        if (($anchor.pos < $head.pos) != (dPos < 0)) $anchor = $head\n      }\n    }\n    return new TextSelection($anchor, $head)\n  }\n}\n\nSelection.jsonID(\"text\", TextSelection)\n\nclass TextBookmark {\n  constructor(anchor, head) {\n    this.anchor = anchor\n    this.head = head\n  }\n  map(mapping) {\n    return new TextBookmark(mapping.map(this.anchor), mapping.map(this.head))\n  }\n  resolve(doc) {\n    return TextSelection.between(doc.resolve(this.anchor), doc.resolve(this.head))\n  }\n}\n\n// ::- A node selection is a selection that points at a single node.\n// All nodes marked [selectable](#model.NodeSpec.selectable) can be\n// the target of a node selection. In such a selection, `from` and\n// `to` point directly before and after the selected node, `anchor`\n// equals `from`, and `head` equals `to`..\nexport class NodeSelection extends Selection {\n  // :: (ResolvedPos)\n  // Create a node selection. Does not verify the validity of its\n  // argument.\n  constructor($pos) {\n    let node = $pos.nodeAfter\n    let $end = $pos.node(0).resolve($pos.pos + node.nodeSize)\n    super($pos, $end)\n    // :: Node The selected node.\n    this.node = node\n  }\n\n  map(doc, mapping) {\n    let {deleted, pos} = mapping.mapResult(this.anchor)\n    let $pos = doc.resolve(pos)\n    if (deleted) return Selection.near($pos)\n    return new NodeSelection($pos)\n  }\n\n  content() {\n    return new Slice(Fragment.from(this.node), 0, 0)\n  }\n\n  eq(other) {\n    return other instanceof NodeSelection && other.anchor == this.anchor\n  }\n\n  toJSON() {\n    return {type: \"node\", anchor: this.anchor}\n  }\n\n  getBookmark() { return new NodeBookmark(this.anchor) }\n\n  static fromJSON(doc, json) {\n    if (typeof json.anchor != \"number\")\n      throw new RangeError(\"Invalid input for NodeSelection.fromJSON\")\n    return new NodeSelection(doc.resolve(json.anchor))\n  }\n\n  // :: (Node, number) → NodeSelection\n  // Create a node selection from non-resolved positions.\n  static create(doc, from) {\n    return new this(doc.resolve(from))\n  }\n\n  // :: (Node) → bool\n  // Determines whether the given node may be selected as a node\n  // selection.\n  static isSelectable(node) {\n    return !node.isText && node.type.spec.selectable !== false\n  }\n}\n\nNodeSelection.prototype.visible = false\n\nSelection.jsonID(\"node\", NodeSelection)\n\nclass NodeBookmark {\n  constructor(anchor) {\n    this.anchor = anchor\n  }\n  map(mapping) {\n    let {deleted, pos} = mapping.mapResult(this.anchor)\n    return deleted ? new TextBookmark(pos, pos) : new NodeBookmark(pos)\n  }\n  resolve(doc) {\n    let $pos = doc.resolve(this.anchor), node = $pos.nodeAfter\n    if (node && NodeSelection.isSelectable(node)) return new NodeSelection($pos)\n    return Selection.near($pos)\n  }\n}\n\n// ::- A selection type that represents selecting the whole document\n// (which can not necessarily be expressed with a text selection, when\n// there are for example leaf block nodes at the start or end of the\n// document).\nexport class AllSelection extends Selection {\n  // :: (Node)\n  // Create an all-selection over the given document.\n  constructor(doc) {\n    super(doc.resolve(0), doc.resolve(doc.content.size))\n  }\n\n  replace(tr, content = Slice.empty) {\n    if (content == Slice.empty) {\n      tr.delete(0, tr.doc.content.size)\n      let sel = Selection.atStart(tr.doc)\n      if (!sel.eq(tr.selection)) tr.setSelection(sel)\n    } else {\n      super.replace(tr, content)\n    }\n  }\n\n  toJSON() { return {type: \"all\"} }\n\n  static fromJSON(doc) { return new AllSelection(doc) }\n\n  map(doc) { return new AllSelection(doc) }\n\n  eq(other) { return other instanceof AllSelection }\n\n  getBookmark() { return AllBookmark }\n}\n\nSelection.jsonID(\"all\", AllSelection)\n\nconst AllBookmark = {\n  map() { return this },\n  resolve(doc) { return new AllSelection(doc) }\n}\n\n// FIXME we'll need some awareness of text direction when scanning for selections\n\n// Try to find a selection inside the given node. `pos` points at the\n// position where the search starts. When `text` is true, only return\n// text selections.\nfunction findSelectionIn(doc, node, pos, index, dir, text) {\n  if (node.inlineContent) return TextSelection.create(doc, pos)\n  for (let i = index - (dir > 0 ? 0 : 1); dir > 0 ? i < node.childCount : i >= 0; i += dir) {\n    let child = node.child(i)\n    if (!child.isAtom) {\n      let inner = findSelectionIn(doc, child, pos + dir, dir < 0 ? child.childCount : 0, dir, text)\n      if (inner) return inner\n    } else if (!text && NodeSelection.isSelectable(child)) {\n      return NodeSelection.create(doc, pos - (dir < 0 ? child.nodeSize : 0))\n    }\n    pos += child.nodeSize * dir\n  }\n}\n\nfunction selectionToInsertionEnd(tr, startLen, bias) {\n  let last = tr.steps.length - 1\n  if (last < startLen) return\n  let step = tr.steps[last]\n  if (!(step instanceof ReplaceStep || step instanceof ReplaceAroundStep)) return\n  let map = tr.mapping.maps[last], end\n  map.forEach((_from, _to, _newFrom, newTo) => { if (end == null) end = newTo })\n  tr.setSelection(Selection.near(tr.doc.resolve(end), bias))\n}\n","import {Transform} from \"prosemirror-transform\"\nimport {Mark} from \"prosemirror-model\"\nimport {Selection} from \"./selection\"\n\nconst UPDATED_SEL = 1, UPDATED_MARKS = 2, UPDATED_SCROLL = 4\n\n// ::- An editor state transaction, which can be applied to a state to\n// create an updated state. Use\n// [`EditorState.tr`](#state.EditorState.tr) to create an instance.\n//\n// Transactions track changes to the document (they are a subclass of\n// [`Transform`](#transform.Transform)), but also other state changes,\n// like selection updates and adjustments of the set of [stored\n// marks](#state.EditorState.storedMarks). In addition, you can store\n// metadata properties in a transaction, which are extra pieces of\n// information that client code or plugins can use to describe what a\n// transacion represents, so that they can update their [own\n// state](#state.StateField) accordingly.\n//\n// The [editor view](#view.EditorView) uses a few metadata properties:\n// it will attach a property `\"pointer\"` with the value `true` to\n// selection transactions directly caused by mouse or touch input, and\n// a `\"uiEvent\"` property of that may be `\"paste\"`, `\"cut\"`, or `\"drop\"`.\nexport class Transaction extends Transform {\n  constructor(state) {\n    super(state.doc)\n    // :: number\n    // The timestamp associated with this transaction, in the same\n    // format as `Date.now()`.\n    this.time = Date.now()\n    this.curSelection = state.selection\n    // The step count for which the current selection is valid.\n    this.curSelectionFor = 0\n    // :: ?[Mark]\n    // The stored marks set by this transaction, if any.\n    this.storedMarks = state.storedMarks\n    // Bitfield to track which aspects of the state were updated by\n    // this transaction.\n    this.updated = 0\n    // Object used to store metadata properties for the transaction.\n    this.meta = Object.create(null)\n  }\n\n  // :: Selection\n  // The transaction's current selection. This defaults to the editor\n  // selection [mapped](#state.Selection.map) through the steps in the\n  // transaction, but can be overwritten with\n  // [`setSelection`](#state.Transaction.setSelection).\n  get selection() {\n    if (this.curSelectionFor < this.steps.length) {\n      this.curSelection = this.curSelection.map(this.doc, this.mapping.slice(this.curSelectionFor))\n      this.curSelectionFor = this.steps.length\n    }\n    return this.curSelection\n  }\n\n  // :: (Selection) → Transaction\n  // Update the transaction's current selection. Will determine the\n  // selection that the editor gets when the transaction is applied.\n  setSelection(selection) {\n    if (selection.$from.doc != this.doc)\n      throw new RangeError(\"Selection passed to setSelection must point at the current document\")\n    this.curSelection = selection\n    this.curSelectionFor = this.steps.length\n    this.updated = (this.updated | UPDATED_SEL) & ~UPDATED_MARKS\n    this.storedMarks = null\n    return this\n  }\n\n  // :: bool\n  // Whether the selection was explicitly updated by this transaction.\n  get selectionSet() {\n    return (this.updated & UPDATED_SEL) > 0\n  }\n\n  // :: (?[Mark]) → Transaction\n  // Set the current stored marks.\n  setStoredMarks(marks) {\n    this.storedMarks = marks\n    this.updated |= UPDATED_MARKS\n    return this\n  }\n\n  // :: ([Mark]) → Transaction\n  // Make sure the current stored marks or, if that is null, the marks\n  // at the selection, match the given set of marks. Does nothing if\n  // this is already the case.\n  ensureMarks(marks) {\n    if (!Mark.sameSet(this.storedMarks || this.selection.$from.marks(), marks))\n      this.setStoredMarks(marks)\n    return this\n  }\n\n  // :: (Mark) → Transaction\n  // Add a mark to the set of stored marks.\n  addStoredMark(mark) {\n    return this.ensureMarks(mark.addToSet(this.storedMarks || this.selection.$head.marks()))\n  }\n\n  // :: (union<Mark, MarkType>) → Transaction\n  // Remove a mark or mark type from the set of stored marks.\n  removeStoredMark(mark) {\n    return this.ensureMarks(mark.removeFromSet(this.storedMarks || this.selection.$head.marks()))\n  }\n\n  // :: bool\n  // Whether the stored marks were explicitly set for this transaction.\n  get storedMarksSet() {\n    return (this.updated & UPDATED_MARKS) > 0\n  }\n\n  addStep(step, doc) {\n    super.addStep(step, doc)\n    this.updated = this.updated & ~UPDATED_MARKS\n    this.storedMarks = null\n  }\n\n  // :: (number) → Transaction\n  // Update the timestamp for the transaction.\n  setTime(time) {\n    this.time = time\n    return this\n  }\n\n  // :: (Slice) → Transaction\n  // Replace the current selection with the given slice.\n  replaceSelection(slice) {\n    this.selection.replace(this, slice)\n    return this\n  }\n\n  // :: (Node, ?bool) → Transaction\n  // Replace the selection with the given node. When `inheritMarks` is\n  // true and the content is inline, it inherits the marks from the\n  // place where it is inserted.\n  replaceSelectionWith(node, inheritMarks) {\n    let selection = this.selection\n    if (inheritMarks !== false)\n      node = node.mark(this.storedMarks || (selection.empty ? selection.$from.marks() : (selection.$from.marksAcross(selection.$to) || Mark.none)))\n    selection.replaceWith(this, node)\n    return this\n  }\n\n  // :: () → Transaction\n  // Delete the selection.\n  deleteSelection() {\n    this.selection.replace(this)\n    return this\n  }\n\n  // :: (string, from: ?number, to: ?number) → Transaction\n  // Replace the given range, or the selection if no range is given,\n  // with a text node containing the given string.\n  insertText(text, from, to = from) {\n    let schema = this.doc.type.schema\n    if (from == null) {\n      if (!text) return this.deleteSelection()\n      return this.replaceSelectionWith(schema.text(text), true)\n    } else {\n      if (!text) return this.deleteRange(from, to)\n      let marks = this.storedMarks\n      if (!marks) {\n        let $from = this.doc.resolve(from)\n        marks = to == from ? $from.marks() : $from.marksAcross(this.doc.resolve(to))\n      }\n      this.replaceRangeWith(from, to, schema.text(text, marks))\n      if (!this.selection.empty) this.setSelection(Selection.near(this.selection.$to))\n      return this\n    }\n  }\n\n  // :: (union<string, Plugin, PluginKey>, any) → Transaction\n  // Store a metadata property in this transaction, keyed either by\n  // name or by plugin.\n  setMeta(key, value) {\n    this.meta[typeof key == \"string\" ? key : key.key] = value\n    return this\n  }\n\n  // :: (union<string, Plugin, PluginKey>) → any\n  // Retrieve a metadata property for a given name or plugin.\n  getMeta(key) {\n    return this.meta[typeof key == \"string\" ? key : key.key]\n  }\n\n  // :: bool\n  // Returns true if this transaction doesn't contain any metadata,\n  // and can thus safely be extended.\n  get isGeneric() {\n    for (let _ in this.meta) return false\n    return true\n  }\n\n  // :: () → Transaction\n  // Indicate that the editor should scroll the selection into view\n  // when updated to the state produced by this transaction.\n  scrollIntoView() {\n    this.updated |= UPDATED_SCROLL\n    return this\n  }\n\n  get scrolledIntoView() {\n    return (this.updated & UPDATED_SCROLL) > 0\n  }\n}\n","import {Node} from \"prosemirror-model\"\n\nimport {Selection} from \"./selection\"\nimport {Transaction} from \"./transaction\"\n\nfunction bind(f, self) {\n  return !self || !f ? f : f.bind(self)\n}\n\nclass FieldDesc {\n  constructor(name, desc, self) {\n    this.name = name\n    this.init = bind(desc.init, self)\n    this.apply = bind(desc.apply, self)\n  }\n}\n\nconst baseFields = [\n  new FieldDesc(\"doc\", {\n    init(config) { return config.doc || config.schema.topNodeType.createAndFill() },\n    apply(tr) { return tr.doc }\n  }),\n\n  new FieldDesc(\"selection\", {\n    init(config, instance) { return config.selection || Selection.atStart(instance.doc) },\n    apply(tr) { return tr.selection }\n  }),\n\n  new FieldDesc(\"storedMarks\", {\n    init(config) { return config.storedMarks || null },\n    apply(tr, _marks, _old, state) { return state.selection.$cursor ? tr.storedMarks : null }\n  }),\n\n  new FieldDesc(\"scrollToSelection\", {\n    init() { return 0 },\n    apply(tr, prev) { return tr.scrolledIntoView ? prev + 1 : prev }\n  })\n]\n\n// Object wrapping the part of a state object that stays the same\n// across transactions. Stored in the state's `config` property.\nclass Configuration {\n  constructor(schema, plugins) {\n    this.schema = schema\n    this.fields = baseFields.concat()\n    this.plugins = []\n    this.pluginsByKey = Object.create(null)\n    if (plugins) plugins.forEach(plugin => {\n      if (this.pluginsByKey[plugin.key])\n        throw new RangeError(\"Adding different instances of a keyed plugin (\" + plugin.key + \")\")\n      this.plugins.push(plugin)\n      this.pluginsByKey[plugin.key] = plugin\n      if (plugin.spec.state)\n        this.fields.push(new FieldDesc(plugin.key, plugin.spec.state, plugin))\n    })\n  }\n}\n\n// ::- The state of a ProseMirror editor is represented by an object\n// of this type. A state is a persistent data structure—it isn't\n// updated, but rather a new state value is computed from an old one\n// using the [`apply`](#state.EditorState.apply) method.\n//\n// A state holds a number of built-in fields, and plugins can\n// [define](#state.PluginSpec.state) additional fields.\nexport class EditorState {\n  constructor(config) {\n    this.config = config\n  }\n\n  // doc:: Node\n  // The current document.\n\n  // selection:: Selection\n  // The selection.\n\n  // storedMarks:: ?[Mark]\n  // A set of marks to apply to the next input. Will be null when\n  // no explicit marks have been set.\n\n  // :: Schema\n  // The schema of the state's document.\n  get schema() {\n    return this.config.schema\n  }\n\n  // :: [Plugin]\n  // The plugins that are active in this state.\n  get plugins() {\n    return this.config.plugins\n  }\n\n  // :: (Transaction) → EditorState\n  // Apply the given transaction to produce a new state.\n  apply(tr) {\n    return this.applyTransaction(tr).state\n  }\n\n  // : (Transaction) → bool\n  filterTransaction(tr, ignore = -1) {\n    for (let i = 0; i < this.config.plugins.length; i++) if (i != ignore) {\n      let plugin = this.config.plugins[i]\n      if (plugin.spec.filterTransaction && !plugin.spec.filterTransaction.call(plugin, tr, this))\n        return false\n    }\n    return true\n  }\n\n  // :: (Transaction) → {state: EditorState, transactions: [Transaction]}\n  // Verbose variant of [`apply`](#state.EditorState.apply) that\n  // returns the precise transactions that were applied (which might\n  // be influenced by the [transaction\n  // hooks](#state.PluginSpec.filterTransaction) of\n  // plugins) along with the new state.\n  applyTransaction(rootTr) {\n    if (!this.filterTransaction(rootTr)) return {state: this, transactions: []}\n\n    let trs = [rootTr], newState = this.applyInner(rootTr), seen = null\n    // This loop repeatedly gives plugins a chance to respond to\n    // transactions as new transactions are added, making sure to only\n    // pass the transactions the plugin did not see before.\n    outer: for (;;) {\n      let haveNew = false\n      for (let i = 0; i < this.config.plugins.length; i++) {\n        let plugin = this.config.plugins[i]\n        if (plugin.spec.appendTransaction) {\n          let n = seen ? seen[i].n : 0, oldState = seen ? seen[i].state : this\n          let tr = n < trs.length &&\n              plugin.spec.appendTransaction.call(plugin, n ? trs.slice(n) : trs, oldState, newState)\n          if (tr && newState.filterTransaction(tr, i)) {\n            tr.setMeta(\"appendedTransaction\", rootTr)\n            if (!seen) {\n              seen = []\n              for (let j = 0; j < this.config.plugins.length; j++)\n                seen.push(j < i ? {state: newState, n: trs.length} : {state: this, n: 0})\n            }\n            trs.push(tr)\n            newState = newState.applyInner(tr)\n            haveNew = true\n          }\n          if (seen) seen[i] = {state: newState, n: trs.length}\n        }\n      }\n      if (!haveNew) return {state: newState, transactions: trs}\n    }\n  }\n\n  // : (Transaction) → EditorState\n  applyInner(tr) {\n    if (!tr.before.eq(this.doc)) throw new RangeError(\"Applying a mismatched transaction\")\n    let newInstance = new EditorState(this.config), fields = this.config.fields\n    for (let i = 0; i < fields.length; i++) {\n      let field = fields[i]\n      newInstance[field.name] = field.apply(tr, this[field.name], this, newInstance)\n    }\n    for (let i = 0; i < applyListeners.length; i++) applyListeners[i](this, tr, newInstance)\n    return newInstance\n  }\n\n  // :: Transaction\n  // Start a [transaction](#state.Transaction) from this state.\n  get tr() { return new Transaction(this) }\n\n  // :: (Object) → EditorState\n  // Create a new state.\n  //\n  //   config::- Configuration options. Must contain `schema` or `doc` (or both).\n  //\n  //      schema:: ?Schema\n  //      The schema to use (only relevant if no `doc` is specified).\n  //\n  //      doc:: ?Node\n  //      The starting document.\n  //\n  //      selection:: ?Selection\n  //      A valid selection in the document.\n  //\n  //      storedMarks:: ?[Mark]\n  //      The initial set of [stored marks](#state.EditorState.storedMarks).\n  //\n  //      plugins:: ?[Plugin]\n  //      The plugins that should be active in this state.\n  static create(config) {\n    let $config = new Configuration(config.doc ? config.doc.type.schema : config.schema, config.plugins)\n    let instance = new EditorState($config)\n    for (let i = 0; i < $config.fields.length; i++)\n      instance[$config.fields[i].name] = $config.fields[i].init(config, instance)\n    return instance\n  }\n\n  // :: (Object) → EditorState\n  // Create a new state based on this one, but with an adjusted set of\n  // active plugins. State fields that exist in both sets of plugins\n  // are kept unchanged. Those that no longer exist are dropped, and\n  // those that are new are initialized using their\n  // [`init`](#state.StateField.init) method, passing in the new\n  // configuration object..\n  //\n  //   config::- configuration options\n  //\n  //     plugins:: [Plugin]\n  //     New set of active plugins.\n  reconfigure(config) {\n    let $config = new Configuration(this.schema, config.plugins)\n    let fields = $config.fields, instance = new EditorState($config)\n    for (let i = 0; i < fields.length; i++) {\n      let name = fields[i].name\n      instance[name] = this.hasOwnProperty(name) ? this[name] : fields[i].init(config, instance)\n    }\n    return instance\n  }\n\n  // :: (?union<Object<Plugin>, string, number>) → Object\n  // Serialize this state to JSON. If you want to serialize the state\n  // of plugins, pass an object mapping property names to use in the\n  // resulting JSON object to plugin objects. The argument may also be\n  // a string or number, in which case it is ignored, to support the\n  // way `JSON.stringify` calls `toString` methods.\n  toJSON(pluginFields) {\n    let result = {doc: this.doc.toJSON(), selection: this.selection.toJSON()}\n    if (this.storedMarks) result.storedMarks = this.storedMarks.map(m => m.toJSON())\n    if (pluginFields && typeof pluginFields == 'object') for (let prop in pluginFields) {\n      if (prop == \"doc\" || prop == \"selection\")\n        throw new RangeError(\"The JSON fields `doc` and `selection` are reserved\")\n      let plugin = pluginFields[prop], state = plugin.spec.state\n      if (state && state.toJSON) result[prop] = state.toJSON.call(plugin, this[plugin.key])\n    }\n    return result\n  }\n\n  // :: (Object, Object, ?Object<Plugin>) → EditorState\n  // Deserialize a JSON representation of a state. `config` should\n  // have at least a `schema` field, and should contain array of\n  // plugins to initialize the state with. `pluginFields` can be used\n  // to deserialize the state of plugins, by associating plugin\n  // instances with the property names they use in the JSON object.\n  //\n  //   config::- configuration options\n  //\n  //     schema:: Schema\n  //     The schema to use.\n  //\n  //     plugins:: ?[Plugin]\n  //     The set of active plugins.\n  static fromJSON(config, json, pluginFields) {\n    if (!json) throw new RangeError(\"Invalid input for EditorState.fromJSON\")\n    if (!config.schema) throw new RangeError(\"Required config field 'schema' missing\")\n    let $config = new Configuration(config.schema, config.plugins)\n    let instance = new EditorState($config)\n    $config.fields.forEach(field => {\n      if (field.name == \"doc\") {\n        instance.doc = Node.fromJSON(config.schema, json.doc)\n      } else if (field.name == \"selection\") {\n        instance.selection = Selection.fromJSON(instance.doc, json.selection)\n      } else if (field.name == \"storedMarks\") {\n        if (json.storedMarks) instance.storedMarks = json.storedMarks.map(config.schema.markFromJSON)\n      } else {\n        if (pluginFields) for (let prop in pluginFields) {\n          let plugin = pluginFields[prop], state = plugin.spec.state\n          if (plugin.key == field.name && state && state.fromJSON &&\n              Object.prototype.hasOwnProperty.call(json, prop)) {\n            // This field belongs to a plugin mapped to a JSON field, read it from there.\n            instance[field.name] = state.fromJSON.call(plugin, config, json[prop], instance)\n            return\n          }\n        }\n        instance[field.name] = field.init(config, instance)\n      }\n    })\n    return instance\n  }\n\n  // Kludge to allow the view to track mappings between different\n  // instances of a state.\n  //\n  // FIXME this is no longer needed as of prosemirror-view 1.9.0,\n  // though due to backwards-compat we should probably keep it around\n  // for a while (if only as a no-op)\n  static addApplyListener(f) {\n    applyListeners.push(f)\n  }\n  static removeApplyListener(f) {\n    let found = applyListeners.indexOf(f)\n    if (found > -1) applyListeners.splice(found, 1)\n  }\n}\n\nconst applyListeners = []\n","// PluginSpec:: interface\n//\n// This is the type passed to the [`Plugin`](#state.Plugin)\n// constructor. It provides a definition for a plugin.\n//\n//   props:: ?EditorProps\n//   The [view props](#view.EditorProps) added by this plugin. Props\n//   that are functions will be bound to have the plugin instance as\n//   their `this` binding.\n//\n//   state:: ?StateField<any>\n//   Allows a plugin to define a [state field](#state.StateField), an\n//   extra slot in the state object in which it can keep its own data.\n//\n//   key:: ?PluginKey\n//   Can be used to make this a keyed plugin. You can have only one\n//   plugin with a given key in a given state, but it is possible to\n//   access the plugin's configuration and state through the key,\n//   without having access to the plugin instance object.\n//\n//   view:: ?(EditorView) → Object\n//   When the plugin needs to interact with the editor view, or\n//   set something up in the DOM, use this field. The function\n//   will be called when the plugin's state is associated with an\n//   editor view.\n//\n//     return::-\n//     Should return an object with the following optional\n//     properties:\n//\n//       update:: ?(view: EditorView, prevState: EditorState)\n//       Called whenever the view's state is updated.\n//\n//       destroy:: ?()\n//       Called when the view is destroyed or receives a state\n//       with different plugins.\n//\n//   filterTransaction:: ?(Transaction, EditorState) → bool\n//   When present, this will be called before a transaction is\n//   applied by the state, allowing the plugin to cancel it (by\n//   returning false).\n//\n//   appendTransaction:: ?(transactions: [Transaction], oldState: EditorState, newState: EditorState) → ?Transaction\n//   Allows the plugin to append another transaction to be applied\n//   after the given array of transactions. When another plugin\n//   appends a transaction after this was called, it is called again\n//   with the new state and new transactions—but only the new\n//   transactions, i.e. it won't be passed transactions that it\n//   already saw.\n\nfunction bindProps(obj, self, target) {\n  for (let prop in obj) {\n    let val = obj[prop]\n    if (val instanceof Function) val = val.bind(self)\n    else if (prop == \"handleDOMEvents\") val = bindProps(val, self, {})\n    target[prop] = val\n  }\n  return target\n}\n\n// ::- Plugins bundle functionality that can be added to an editor.\n// They are part of the [editor state](#state.EditorState) and\n// may influence that state and the view that contains it.\nexport class Plugin {\n  // :: (PluginSpec)\n  // Create a plugin.\n  constructor(spec) {\n    // :: EditorProps\n    // The [props](#view.EditorProps) exported by this plugin.\n    this.props = {}\n    if (spec.props) bindProps(spec.props, this, this.props)\n    // :: Object\n    // The plugin's [spec object](#state.PluginSpec).\n    this.spec = spec\n    this.key = spec.key ? spec.key.key : createKey(\"plugin\")\n  }\n\n  // :: (EditorState) → any\n  // Extract the plugin's state field from an editor state.\n  getState(state) { return state[this.key] }\n}\n\n// StateField:: interface<T>\n// A plugin spec may provide a state field (under its\n// [`state`](#state.PluginSpec.state) property) of this type, which\n// describes the state it wants to keep. Functions provided here are\n// always called with the plugin instance as their `this` binding.\n//\n//   init:: (config: Object, instance: EditorState) → T\n//   Initialize the value of the field. `config` will be the object\n//   passed to [`EditorState.create`](#state.EditorState^create). Note\n//   that `instance` is a half-initialized state instance, and will\n//   not have values for plugin fields initialized after this one.\n//\n//   apply:: (tr: Transaction, value: T, oldState: EditorState, newState: EditorState) → T\n//   Apply the given transaction to this state field, producing a new\n//   field value. Note that the `newState` argument is again a partially\n//   constructed state does not yet contain the state from plugins\n//   coming after this one.\n//\n//   toJSON:: ?(value: T) → *\n//   Convert this field to JSON. Optional, can be left off to disable\n//   JSON serialization for the field.\n//\n//   fromJSON:: ?(config: Object, value: *, state: EditorState) → T\n//   Deserialize the JSON representation of this field. Note that the\n//   `state` argument is again a half-initialized state.\n\nconst keys = Object.create(null)\n\nfunction createKey(name) {\n  if (name in keys) return name + \"$\" + ++keys[name]\n  keys[name] = 0\n  return name + \"$\"\n}\n\n// ::- A key is used to [tag](#state.PluginSpec.key)\n// plugins in a way that makes it possible to find them, given an\n// editor state. Assigning a key does mean only one plugin of that\n// type can be active in a state.\nexport class PluginKey {\n  // :: (?string)\n  // Create a plugin key.\n  constructor(name = \"key\") { this.key = createKey(name) }\n\n  // :: (EditorState) → ?Plugin\n  // Get the active plugin with this key, if any, from an editor\n  // state.\n  get(state) { return state.config.pluginsByKey[this.key] }\n\n  // :: (EditorState) → ?any\n  // Get the plugin's state from an editor state.\n  getState(state) { return state[this.key] }\n}\n","const result = {}\nexport default result\n\nif (typeof navigator != \"undefined\" && typeof document != \"undefined\") {\n  const ie_edge = /Edge\\/(\\d+)/.exec(navigator.userAgent)\n  const ie_upto10 = /MSIE \\d/.test(navigator.userAgent)\n  const ie_11up = /Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\n\n  let ie = result.ie = !!(ie_upto10 || ie_11up || ie_edge)\n  result.ie_version = ie_upto10 ? document.documentMode || 6 : ie_11up ? +ie_11up[1] : ie_edge ? +ie_edge[1] : null\n  result.gecko = !ie && /gecko\\/(\\d+)/i.test(navigator.userAgent)\n  result.gecko_version = result.gecko && +(/Firefox\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1]\n  let chrome = !ie && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\n  result.chrome = !!chrome\n  result.chrome_version = chrome && +chrome[1]\n  // Is true for both iOS and iPadOS for convenience\n  result.safari = !ie && /Apple Computer/.test(navigator.vendor)\n  result.ios = result.safari && (/Mobile\\/\\w+/.test(navigator.userAgent) || navigator.maxTouchPoints > 2)\n  result.mac = result.ios || /Mac/.test(navigator.platform)\n  result.android = /Android \\d/.test(navigator.userAgent)\n  result.webkit = \"webkitFontSmoothing\" in document.documentElement.style\n  result.webkit_version = result.webkit && +(/\\bAppleWebKit\\/(\\d+)/.exec(navigator.userAgent) || [0, 0])[1]\n}\n","import browser from \"./browser\"\n\nexport const domIndex = function(node) {\n  for (var index = 0;; index++) {\n    node = node.previousSibling\n    if (!node) return index\n  }\n}\n\nexport const parentNode = function(node) {\n  let parent = node.assignedSlot || node.parentNode\n  return parent && parent.nodeType == 11 ? parent.host : parent\n}\n\nlet reusedRange = null\n\n// Note that this will always return the same range, because DOM range\n// objects are every expensive, and keep slowing down subsequent DOM\n// updates, for some reason.\nexport const textRange = function(node, from, to) {\n  let range = reusedRange || (reusedRange = document.createRange())\n  range.setEnd(node, to == null ? node.nodeValue.length : to)\n  range.setStart(node, from || 0)\n  return range\n}\n\n// Scans forward and backward through DOM positions equivalent to the\n// given one to see if the two are in the same place (i.e. after a\n// text node vs at the end of that text node)\nexport const isEquivalentPosition = function(node, off, targetNode, targetOff) {\n  return targetNode && (scanFor(node, off, targetNode, targetOff, -1) ||\n                        scanFor(node, off, targetNode, targetOff, 1))\n}\n\nconst atomElements = /^(img|br|input|textarea|hr)$/i\n\nfunction scanFor(node, off, targetNode, targetOff, dir) {\n  for (;;) {\n    if (node == targetNode && off == targetOff) return true\n    if (off == (dir < 0 ? 0 : nodeSize(node))) {\n      let parent = node.parentNode\n      if (!parent || parent.nodeType != 1 || hasBlockDesc(node) || atomElements.test(node.nodeName) ||\n          node.contentEditable == \"false\")\n        return false\n      off = domIndex(node) + (dir < 0 ? 0 : 1)\n      node = parent\n    } else if (node.nodeType == 1) {\n      node = node.childNodes[off + (dir < 0 ? -1 : 0)]\n      if (node.contentEditable == \"false\") return false\n      off = dir < 0 ? nodeSize(node) : 0\n    } else {\n      return false\n    }\n  }\n}\n\nexport function nodeSize(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nexport function isOnEdge(node, offset, parent) {\n  for (let atStart = offset == 0, atEnd = offset == nodeSize(node); atStart || atEnd;) {\n    if (node == parent) return true\n    let index = domIndex(node)\n    node = node.parentNode\n    if (!node) return false\n    atStart = atStart && index == 0\n    atEnd = atEnd && index == nodeSize(node)\n  }\n}\n\nfunction hasBlockDesc(dom) {\n  let desc\n  for (let cur = dom; cur; cur = cur.parentNode) if (desc = cur.pmViewDesc) break\n  return desc && desc.node && desc.node.isBlock && (desc.dom == dom || desc.contentDOM == dom)\n}\n\n// Work around Chrome issue https://bugs.chromium.org/p/chromium/issues/detail?id=447523\n// (isCollapsed inappropriately returns true in shadow dom)\nexport const selectionCollapsed = function(domSel) {\n  let collapsed = domSel.isCollapsed\n  if (collapsed && browser.chrome && domSel.rangeCount && !domSel.getRangeAt(0).collapsed)\n    collapsed = false\n  return collapsed\n}\n\nexport function keyEvent(keyCode, key) {\n  let event = document.createEvent(\"Event\")\n  event.initEvent(\"keydown\", true, true)\n  event.keyCode = keyCode\n  event.key = event.code = key\n  return event\n}\n","import {nodeSize, textRange, parentNode} from \"./dom\"\nimport browser from \"./browser\"\n\nfunction windowRect(doc) {\n  return {left: 0, right: doc.documentElement.clientWidth,\n          top: 0, bottom: doc.documentElement.clientHeight}\n}\n\nfunction getSide(value, side) {\n  return typeof value == \"number\" ? value : value[side]\n}\n\nfunction clientRect(node) {\n  let rect = node.getBoundingClientRect()\n  // Adjust for elements with style \"transform: scale()\"\n  let scaleX = (rect.width / node.offsetWidth) || 1\n  let scaleY = (rect.height / node.offsetHeight) || 1\n  // Make sure scrollbar width isn't included in the rectangle\n  return {left: rect.left, right: rect.left + node.clientWidth * scaleX,\n          top: rect.top, bottom: rect.top + node.clientHeight * scaleY}\n}\n\nexport function scrollRectIntoView(view, rect, startDOM) {\n  let scrollThreshold = view.someProp(\"scrollThreshold\") || 0, scrollMargin = view.someProp(\"scrollMargin\") || 5\n  let doc = view.dom.ownerDocument\n  for (let parent = startDOM || view.dom;; parent = parentNode(parent)) {\n    if (!parent) break\n    if (parent.nodeType != 1) continue\n    let atTop = parent == doc.body || parent.nodeType != 1\n    let bounding = atTop ? windowRect(doc) : clientRect(parent)\n    let moveX = 0, moveY = 0\n    if (rect.top < bounding.top + getSide(scrollThreshold, \"top\"))\n      moveY = -(bounding.top - rect.top + getSide(scrollMargin, \"top\"))\n    else if (rect.bottom > bounding.bottom - getSide(scrollThreshold, \"bottom\"))\n      moveY = rect.bottom - bounding.bottom + getSide(scrollMargin, \"bottom\")\n    if (rect.left < bounding.left + getSide(scrollThreshold, \"left\"))\n      moveX = -(bounding.left - rect.left + getSide(scrollMargin, \"left\"))\n    else if (rect.right > bounding.right - getSide(scrollThreshold, \"right\"))\n      moveX = rect.right - bounding.right + getSide(scrollMargin, \"right\")\n    if (moveX || moveY) {\n      if (atTop) {\n        doc.defaultView.scrollBy(moveX, moveY)\n      } else {\n        let startX = parent.scrollLeft, startY = parent.scrollTop\n        if (moveY) parent.scrollTop += moveY\n        if (moveX) parent.scrollLeft += moveX\n        let dX = parent.scrollLeft - startX, dY = parent.scrollTop - startY\n        rect = {left: rect.left - dX, top: rect.top - dY, right: rect.right - dX, bottom: rect.bottom - dY}\n      }\n    }\n    if (atTop) break\n  }\n}\n\n// Store the scroll position of the editor's parent nodes, along with\n// the top position of an element near the top of the editor, which\n// will be used to make sure the visible viewport remains stable even\n// when the size of the content above changes.\nexport function storeScrollPos(view) {\n  let rect = view.dom.getBoundingClientRect(), startY = Math.max(0, rect.top)\n  let refDOM, refTop\n  for (let x = (rect.left + rect.right) / 2, y = startY + 1;\n       y < Math.min(innerHeight, rect.bottom); y += 5) {\n    let dom = view.root.elementFromPoint(x, y)\n    if (dom == view.dom || !view.dom.contains(dom)) continue\n    let localRect = dom.getBoundingClientRect()\n    if (localRect.top >= startY - 20) {\n      refDOM = dom\n      refTop = localRect.top\n      break\n    }\n  }\n  return {refDOM, refTop, stack: scrollStack(view.dom)}\n}\n\nfunction scrollStack(dom) {\n  let stack = [], doc = dom.ownerDocument\n  for (; dom; dom = parentNode(dom)) {\n    stack.push({dom, top: dom.scrollTop, left: dom.scrollLeft})\n    if (dom == doc) break\n  }\n  return stack\n}\n\n// Reset the scroll position of the editor's parent nodes to that what\n// it was before, when storeScrollPos was called.\nexport function resetScrollPos({refDOM, refTop, stack}) {\n  let newRefTop = refDOM ? refDOM.getBoundingClientRect().top : 0\n  restoreScrollStack(stack, newRefTop == 0 ? 0 : newRefTop - refTop)\n}\n\nfunction restoreScrollStack(stack, dTop) {\n  for (let i = 0; i < stack.length; i++) {\n    let {dom, top, left} = stack[i]\n    if (dom.scrollTop != top + dTop) dom.scrollTop = top + dTop\n    if (dom.scrollLeft != left) dom.scrollLeft = left\n  }\n}\n\nlet preventScrollSupported = null\n// Feature-detects support for .focus({preventScroll: true}), and uses\n// a fallback kludge when not supported.\nexport function focusPreventScroll(dom) {\n  if (dom.setActive) return dom.setActive() // in IE\n  if (preventScrollSupported) return dom.focus(preventScrollSupported)\n\n  let stored = scrollStack(dom)\n  dom.focus(preventScrollSupported == null ? {\n    get preventScroll() {\n      preventScrollSupported = {preventScroll: true}\n      return true\n    }\n  } : undefined)\n  if (!preventScrollSupported) {\n    preventScrollSupported = false\n    restoreScrollStack(stored, 0)\n  }\n}\n\nfunction findOffsetInNode(node, coords) {\n  let closest, dxClosest = 2e8, coordsClosest, offset = 0\n  let rowBot = coords.top, rowTop = coords.top\n  for (let child = node.firstChild, childIndex = 0; child; child = child.nextSibling, childIndex++) {\n    let rects\n    if (child.nodeType == 1) rects = child.getClientRects()\n    else if (child.nodeType == 3) rects = textRange(child).getClientRects()\n    else continue\n\n    for (let i = 0; i < rects.length; i++) {\n      let rect = rects[i]\n      if (rect.top <= rowBot && rect.bottom >= rowTop) {\n        rowBot = Math.max(rect.bottom, rowBot)\n        rowTop = Math.min(rect.top, rowTop)\n        let dx = rect.left > coords.left ? rect.left - coords.left\n            : rect.right < coords.left ? coords.left - rect.right : 0\n        if (dx < dxClosest) {\n          closest = child\n          dxClosest = dx\n          coordsClosest = dx && closest.nodeType == 3 ? {left: rect.right < coords.left ? rect.right : rect.left, top: coords.top} : coords\n          if (child.nodeType == 1 && dx)\n            offset = childIndex + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)\n          continue\n        }\n      }\n      if (!closest && (coords.left >= rect.right && coords.top >= rect.top ||\n                       coords.left >= rect.left && coords.top >= rect.bottom))\n        offset = childIndex + 1\n    }\n  }\n  if (closest && closest.nodeType == 3) return findOffsetInText(closest, coordsClosest)\n  if (!closest || (dxClosest && closest.nodeType == 1)) return {node, offset}\n  return findOffsetInNode(closest, coordsClosest)\n}\n\nfunction findOffsetInText(node, coords) {\n  let len = node.nodeValue.length\n  let range = document.createRange()\n  for (let i = 0; i < len; i++) {\n    range.setEnd(node, i + 1)\n    range.setStart(node, i)\n    let rect = singleRect(range, 1)\n    if (rect.top == rect.bottom) continue\n    if (inRect(coords, rect))\n      return {node, offset: i + (coords.left >= (rect.left + rect.right) / 2 ? 1 : 0)}\n  }\n  return {node, offset: 0}\n}\n\nfunction inRect(coords, rect) {\n  return coords.left >= rect.left - 1 && coords.left <= rect.right + 1&&\n    coords.top >= rect.top - 1 && coords.top <= rect.bottom + 1\n}\n\nfunction targetKludge(dom, coords) {\n  let parent = dom.parentNode\n  if (parent && /^li$/i.test(parent.nodeName) && coords.left < dom.getBoundingClientRect().left)\n    return parent\n  return dom\n}\n\nfunction posFromElement(view, elt, coords) {\n  let {node, offset} = findOffsetInNode(elt, coords), bias = -1\n  if (node.nodeType == 1 && !node.firstChild) {\n    let rect = node.getBoundingClientRect()\n    bias = rect.left != rect.right && coords.left > (rect.left + rect.right) / 2 ? 1 : -1\n  }\n  return view.docView.posFromDOM(node, offset, bias)\n}\n\nfunction posFromCaret(view, node, offset, coords) {\n  // Browser (in caretPosition/RangeFromPoint) will agressively\n  // normalize towards nearby inline nodes. Since we are interested in\n  // positions between block nodes too, we first walk up the hierarchy\n  // of nodes to see if there are block nodes that the coordinates\n  // fall outside of. If so, we take the position before/after that\n  // block. If not, we call `posFromDOM` on the raw node/offset.\n  let outside = -1\n  for (let cur = node;;) {\n    if (cur == view.dom) break\n    let desc = view.docView.nearestDesc(cur, true)\n    if (!desc) return null\n    if (desc.node.isBlock && desc.parent) {\n      let rect = desc.dom.getBoundingClientRect()\n      if (rect.left > coords.left || rect.top > coords.top) outside = desc.posBefore\n      else if (rect.right < coords.left || rect.bottom < coords.top) outside = desc.posAfter\n      else break\n    }\n    cur = desc.dom.parentNode\n  }\n  return outside > -1 ? outside : view.docView.posFromDOM(node, offset)\n}\n\nfunction elementFromPoint(element, coords, box) {\n  let len = element.childNodes.length\n  if (len && box.top < box.bottom) {\n    for (let startI = Math.max(0, Math.min(len - 1, Math.floor(len * (coords.top - box.top) / (box.bottom - box.top)) - 2)), i = startI;;) {\n      let child = element.childNodes[i]\n      if (child.nodeType == 1) {\n        let rects = child.getClientRects()\n        for (let j = 0; j < rects.length; j++) {\n          let rect = rects[j]\n          if (inRect(coords, rect)) return elementFromPoint(child, coords, rect)\n        }\n      }\n      if ((i = (i + 1) % len) == startI) break\n    }\n  }\n  return element\n}\n\n// Given an x,y position on the editor, get the position in the document.\nexport function posAtCoords(view, coords) {\n  let doc = view.dom.ownerDocument, node, offset\n  if (doc.caretPositionFromPoint) {\n    try { // Firefox throws for this call in hard-to-predict circumstances (#994)\n      let pos = doc.caretPositionFromPoint(coords.left, coords.top)\n      if (pos) ({offsetNode: node, offset} = pos)\n    } catch (_) {}\n  }\n  if (!node && doc.caretRangeFromPoint) {\n    let range = doc.caretRangeFromPoint(coords.left, coords.top)\n    if (range) ({startContainer: node, startOffset: offset} = range)\n  }\n\n  let elt = (view.root.elementFromPoint ? view.root : doc).elementFromPoint(coords.left, coords.top + 1), pos\n  if (!elt || !view.dom.contains(elt.nodeType != 1 ? elt.parentNode : elt)) {\n    let box = view.dom.getBoundingClientRect()\n    if (!inRect(coords, box)) return null\n    elt = elementFromPoint(view.dom, coords, box)\n    if (!elt) return null\n  }\n  // Safari's caretRangeFromPoint returns nonsense when on a draggable element\n  if (browser.safari) {\n    for (let p = elt; node && p; p = parentNode(p))\n      if (p.draggable) node = offset = null\n  }\n  elt = targetKludge(elt, coords)\n  if (node) {\n    if (browser.gecko && node.nodeType == 1) {\n      // Firefox will sometimes return offsets into <input> nodes, which\n      // have no actual children, from caretPositionFromPoint (#953)\n      offset = Math.min(offset, node.childNodes.length)\n      // It'll also move the returned position before image nodes,\n      // even if those are behind it.\n      if (offset < node.childNodes.length) {\n        let next = node.childNodes[offset], box\n        if (next.nodeName == \"IMG\" && (box = next.getBoundingClientRect()).right <= coords.left &&\n            box.bottom > coords.top)\n          offset++\n      }\n    }\n    // Suspiciously specific kludge to work around caret*FromPoint\n    // never returning a position at the end of the document\n    if (node == view.dom && offset == node.childNodes.length - 1 && node.lastChild.nodeType == 1 &&\n        coords.top > node.lastChild.getBoundingClientRect().bottom)\n      pos = view.state.doc.content.size\n    // Ignore positions directly after a BR, since caret*FromPoint\n    // 'round up' positions that would be more accurately placed\n    // before the BR node.\n    else if (offset == 0 || node.nodeType != 1 || node.childNodes[offset - 1].nodeName != \"BR\")\n      pos = posFromCaret(view, node, offset, coords)\n  }\n  if (pos == null) pos = posFromElement(view, elt, coords)\n\n  let desc = view.docView.nearestDesc(elt, true)\n  return {pos, inside: desc ? desc.posAtStart - desc.border : -1}\n}\n\nfunction singleRect(object, bias) {\n  let rects = object.getClientRects()\n  return !rects.length ? object.getBoundingClientRect() : rects[bias < 0 ? 0 : rects.length - 1]\n}\n\nconst BIDI = /[\\u0590-\\u05f4\\u0600-\\u06ff\\u0700-\\u08ac]/\n\n// : (EditorView, number, number) → {left: number, top: number, right: number, bottom: number}\n// Given a position in the document model, get a bounding box of the\n// character at that position, relative to the window.\nexport function coordsAtPos(view, pos, side) {\n  let {node, offset} = view.docView.domFromPos(pos, side < 0 ? -1 : 1)\n\n  let supportEmptyRange = browser.webkit || browser.gecko\n  if (node.nodeType == 3) {\n    // These browsers support querying empty text ranges. Prefer that in\n    // bidi context or when at the end of a node.\n    if (supportEmptyRange && (BIDI.test(node.nodeValue) || (side < 0 ? !offset : offset == node.nodeValue.length))) {\n      let rect = singleRect(textRange(node, offset, offset), side)\n      // Firefox returns bad results (the position before the space)\n      // when querying a position directly after line-broken\n      // whitespace. Detect this situation and and kludge around it\n      if (browser.gecko && offset && /\\s/.test(node.nodeValue[offset - 1]) && offset < node.nodeValue.length) {\n        let rectBefore = singleRect(textRange(node, offset - 1, offset - 1), -1)\n        if (rectBefore.top == rect.top) {\n          let rectAfter = singleRect(textRange(node, offset, offset + 1), -1)\n          if (rectAfter.top != rect.top)\n            return flattenV(rectAfter, rectAfter.left < rectBefore.left)\n        }\n      }\n      return rect\n    } else {\n      let from = offset, to = offset, takeSide = side < 0 ? 1 : -1\n      if (side < 0 && !offset) { to++; takeSide = -1 }\n      else if (side >= 0 && offset == node.nodeValue.length) { from--; takeSide = 1 }\n      else if (side < 0) { from-- }\n      else { to ++ }\n      return flattenV(singleRect(textRange(node, from, to), takeSide), takeSide < 0)\n    }\n  }\n\n  // Return a horizontal line in block context\n  if (!view.state.doc.resolve(pos).parent.inlineContent) {\n    if (offset && (side < 0 || offset == nodeSize(node))) {\n      let before = node.childNodes[offset - 1]\n      if (before.nodeType == 1) return flattenH(before.getBoundingClientRect(), false)\n    }\n    if (offset < nodeSize(node)) {\n      let after = node.childNodes[offset]\n      if (after.nodeType == 1) return flattenH(after.getBoundingClientRect(), true)\n    }\n    return flattenH(node.getBoundingClientRect(), side >= 0)\n  }\n\n  // Inline, not in text node (this is not Bidi-safe)\n  if (offset && (side < 0 || offset == nodeSize(node))) {\n    let before = node.childNodes[offset - 1]\n    let target = before.nodeType == 3 ? textRange(before, nodeSize(before) - (supportEmptyRange ? 0 : 1))\n        // BR nodes tend to only return the rectangle before them.\n        // Only use them if they are the last element in their parent\n        : before.nodeType == 1 && (before.nodeName != \"BR\" || !before.nextSibling) ? before : null\n    if (target) return flattenV(singleRect(target, 1), false)\n  }\n  if (offset < nodeSize(node)) {\n    let after = node.childNodes[offset]\n    while (after.pmViewDesc && after.pmViewDesc.ignoreForCoords) after = after.nextSibling\n    let target = !after ? null : after.nodeType == 3 ? textRange(after, 0, (supportEmptyRange ? 0 : 1))\n        : after.nodeType == 1 ? after : null\n    if (target) return flattenV(singleRect(target, -1), true)\n  }\n  // All else failed, just try to get a rectangle for the target node\n  return flattenV(singleRect(node.nodeType == 3 ? textRange(node) : node, -side), side >= 0)\n}\n\nfunction flattenV(rect, left) {\n  if (rect.width == 0) return rect\n  let x = left ? rect.left : rect.right\n  return {top: rect.top, bottom: rect.bottom, left: x, right: x}\n}\n\nfunction flattenH(rect, top) {\n  if (rect.height == 0) return rect\n  let y = top ? rect.top : rect.bottom\n  return {top: y, bottom: y, left: rect.left, right: rect.right}\n}\n\nfunction withFlushedState(view, state, f) {\n  let viewState = view.state, active = view.root.activeElement\n  if (viewState != state) view.updateState(state)\n  if (active != view.dom) view.focus()\n  try {\n    return f()\n  } finally {\n    if (viewState != state) view.updateState(viewState)\n    if (active != view.dom && active) active.focus()\n  }\n}\n\n// : (EditorView, number, number)\n// Whether vertical position motion in a given direction\n// from a position would leave a text block.\nfunction endOfTextblockVertical(view, state, dir) {\n  let sel = state.selection\n  let $pos = dir == \"up\" ? sel.$from : sel.$to\n  return withFlushedState(view, state, () => {\n    let {node: dom} = view.docView.domFromPos($pos.pos, dir == \"up\" ? -1 : 1)\n    for (;;) {\n      let nearest = view.docView.nearestDesc(dom, true)\n      if (!nearest) break\n      if (nearest.node.isBlock) { dom = nearest.dom; break }\n      dom = nearest.dom.parentNode\n    }\n    let coords = coordsAtPos(view, $pos.pos, 1)\n    for (let child = dom.firstChild; child; child = child.nextSibling) {\n      let boxes\n      if (child.nodeType == 1) boxes = child.getClientRects()\n      else if (child.nodeType == 3) boxes = textRange(child, 0, child.nodeValue.length).getClientRects()\n      else continue\n      for (let i = 0; i < boxes.length; i++) {\n        let box = boxes[i]\n        if (box.bottom > box.top + 1 &&\n            (dir == \"up\" ? coords.top - box.top > (box.bottom - coords.top) * 2\n             : box.bottom - coords.bottom > (coords.bottom - box.top) * 2))\n          return false\n      }\n    }\n    return true\n  })\n}\n\nconst maybeRTL = /[\\u0590-\\u08ac]/\n\nfunction endOfTextblockHorizontal(view, state, dir) {\n  let {$head} = state.selection\n  if (!$head.parent.isTextblock) return false\n  let offset = $head.parentOffset, atStart = !offset, atEnd = offset == $head.parent.content.size\n  let sel = view.root.getSelection()\n  // If the textblock is all LTR, or the browser doesn't support\n  // Selection.modify (Edge), fall back to a primitive approach\n  if (!maybeRTL.test($head.parent.textContent) || !sel.modify)\n    return dir == \"left\" || dir == \"backward\" ? atStart : atEnd\n\n  return withFlushedState(view, state, () => {\n    // This is a huge hack, but appears to be the best we can\n    // currently do: use `Selection.modify` to move the selection by\n    // one character, and see if that moves the cursor out of the\n    // textblock (or doesn't move it at all, when at the start/end of\n    // the document).\n    let oldRange = sel.getRangeAt(0), oldNode = sel.focusNode, oldOff = sel.focusOffset\n    let oldBidiLevel = sel.caretBidiLevel // Only for Firefox\n    sel.modify(\"move\", dir, \"character\")\n    let parentDOM = $head.depth ? view.docView.domAfterPos($head.before()) : view.dom\n    let result = !parentDOM.contains(sel.focusNode.nodeType == 1 ? sel.focusNode : sel.focusNode.parentNode) ||\n        (oldNode == sel.focusNode && oldOff == sel.focusOffset)\n    // Restore the previous selection\n    sel.removeAllRanges()\n    sel.addRange(oldRange)\n    if (oldBidiLevel != null) sel.caretBidiLevel = oldBidiLevel\n    return result\n  })\n}\n\nlet cachedState = null, cachedDir = null, cachedResult = false\nexport function endOfTextblock(view, state, dir) {\n  if (cachedState == state && cachedDir == dir) return cachedResult\n  cachedState = state; cachedDir = dir\n  return cachedResult = dir == \"up\" || dir == \"down\"\n    ? endOfTextblockVertical(view, state, dir)\n    : endOfTextblockHorizontal(view, state, dir)\n}\n","import {DOMSerializer, Fragment, Mark} from \"prosemirror-model\"\nimport {TextSelection} from \"prosemirror-state\"\n\nimport {domIndex, isEquivalentPosition, nodeSize} from \"./dom\"\nimport browser from \"./browser\"\n\n// NodeView:: interface\n//\n// By default, document nodes are rendered using the result of the\n// [`toDOM`](#model.NodeSpec.toDOM) method of their spec, and managed\n// entirely by the editor. For some use cases, such as embedded\n// node-specific editing interfaces, you want more control over\n// the behavior of a node's in-editor representation, and need to\n// [define](#view.EditorProps.nodeViews) a custom node view.\n//\n// Mark views only support `dom` and `contentDOM`, and don't support\n// any of the node view methods.\n//\n// Objects returned as node views must conform to this interface.\n//\n//   dom:: ?dom.Node\n//   The outer DOM node that represents the document node. When not\n//   given, the default strategy is used to create a DOM node.\n//\n//   contentDOM:: ?dom.Node\n//   The DOM node that should hold the node's content. Only meaningful\n//   if the node view also defines a `dom` property and if its node\n//   type is not a leaf node type. When this is present, ProseMirror\n//   will take care of rendering the node's children into it. When it\n//   is not present, the node view itself is responsible for rendering\n//   (or deciding not to render) its child nodes.\n//\n//   update:: ?(node: Node, decorations: [Decoration], innerDecorations: DecorationSource) → bool\n//   When given, this will be called when the view is updating itself.\n//   It will be given a node (possibly of a different type), an array\n//   of active decorations around the node (which are automatically\n//   drawn, and the node view may ignore if it isn't interested in\n//   them), and a [decoration source](#view.DecorationSource) that\n//   represents any decorations that apply to the content of the node\n//   (which again may be ignored). It should return true if it was\n//   able to update to that node, and false otherwise. If the node\n//   view has a `contentDOM` property (or no `dom` property), updating\n//   its child nodes will be handled by ProseMirror.\n//\n//   selectNode:: ?()\n//   Can be used to override the way the node's selected status (as a\n//   node selection) is displayed.\n//\n//   deselectNode:: ?()\n//   When defining a `selectNode` method, you should also provide a\n//   `deselectNode` method to remove the effect again.\n//\n//   setSelection:: ?(anchor: number, head: number, root: dom.Document)\n//   This will be called to handle setting the selection inside the\n//   node. The `anchor` and `head` positions are relative to the start\n//   of the node. By default, a DOM selection will be created between\n//   the DOM positions corresponding to those positions, but if you\n//   override it you can do something else.\n//\n//   stopEvent:: ?(event: dom.Event) → bool\n//   Can be used to prevent the editor view from trying to handle some\n//   or all DOM events that bubble up from the node view. Events for\n//   which this returns true are not handled by the editor.\n//\n//   ignoreMutation:: ?(dom.MutationRecord) → bool\n//   Called when a DOM\n//   [mutation](https://developer.mozilla.org/en-US/docs/Web/API/MutationObserver)\n//   or a selection change happens within the view. When the change is\n//   a selection change, the record will have a `type` property of\n//   `\"selection\"` (which doesn't occur for native mutation records).\n//   Return false if the editor should re-read the selection or\n//   re-parse the range around the mutation, true if it can safely be\n//   ignored.\n//\n//   destroy:: ?()\n//   Called when the node view is removed from the editor or the whole\n//   editor is destroyed. (Not available for marks.)\n\n// View descriptions are data structures that describe the DOM that is\n// used to represent the editor's content. They are used for:\n//\n// - Incremental redrawing when the document changes\n//\n// - Figuring out what part of the document a given DOM position\n//   corresponds to\n//\n// - Wiring in custom implementations of the editing interface for a\n//   given node\n//\n// They form a doubly-linked mutable tree, starting at `view.docView`.\n\nconst NOT_DIRTY = 0, CHILD_DIRTY = 1, CONTENT_DIRTY = 2, NODE_DIRTY = 3\n\n// Superclass for the various kinds of descriptions. Defines their\n// basic structure and shared methods.\nclass ViewDesc {\n  // : (?ViewDesc, [ViewDesc], dom.Node, ?dom.Node)\n  constructor(parent, children, dom, contentDOM) {\n    this.parent = parent\n    this.children = children\n    this.dom = dom\n    // An expando property on the DOM node provides a link back to its\n    // description.\n    dom.pmViewDesc = this\n    // This is the node that holds the child views. It may be null for\n    // descs that don't have children.\n    this.contentDOM = contentDOM\n    this.dirty = NOT_DIRTY\n  }\n\n  // Used to check whether a given description corresponds to a\n  // widget/mark/node.\n  matchesWidget() { return false }\n  matchesMark() { return false }\n  matchesNode() { return false }\n  matchesHack(_nodeName) { return false }\n\n  // : () → ?ParseRule\n  // When parsing in-editor content (in domchange.js), we allow\n  // descriptions to determine the parse rules that should be used to\n  // parse them.\n  parseRule() { return null }\n\n  // : (dom.Event) → bool\n  // Used by the editor's event handler to ignore events that come\n  // from certain descs.\n  stopEvent() { return false }\n\n  // The size of the content represented by this desc.\n  get size() {\n    let size = 0\n    for (let i = 0; i < this.children.length; i++) size += this.children[i].size\n    return size\n  }\n\n  // For block nodes, this represents the space taken up by their\n  // start/end tokens.\n  get border() { return 0 }\n\n  destroy() {\n    this.parent = null\n    if (this.dom.pmViewDesc == this) this.dom.pmViewDesc = null\n    for (let i = 0; i < this.children.length; i++)\n      this.children[i].destroy()\n  }\n\n  posBeforeChild(child) {\n    for (let i = 0, pos = this.posAtStart; i < this.children.length; i++) {\n      let cur = this.children[i]\n      if (cur == child) return pos\n      pos += cur.size\n    }\n  }\n\n  get posBefore() {\n    return this.parent.posBeforeChild(this)\n  }\n\n  get posAtStart() {\n    return this.parent ? this.parent.posBeforeChild(this) + this.border : 0\n  }\n\n  get posAfter() {\n    return this.posBefore + this.size\n  }\n\n  get posAtEnd() {\n    return this.posAtStart + this.size - 2 * this.border\n  }\n\n  // : (dom.Node, number, ?number) → number\n  localPosFromDOM(dom, offset, bias) {\n    // If the DOM position is in the content, use the child desc after\n    // it to figure out a position.\n    if (this.contentDOM && this.contentDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode)) {\n      if (bias < 0) {\n        let domBefore, desc\n        if (dom == this.contentDOM) {\n          domBefore = dom.childNodes[offset - 1]\n        } else {\n          while (dom.parentNode != this.contentDOM) dom = dom.parentNode\n          domBefore = dom.previousSibling\n        }\n        while (domBefore && !((desc = domBefore.pmViewDesc) && desc.parent == this)) domBefore = domBefore.previousSibling\n        return domBefore ? this.posBeforeChild(desc) + desc.size : this.posAtStart\n      } else {\n        let domAfter, desc\n        if (dom == this.contentDOM) {\n          domAfter = dom.childNodes[offset]\n        } else {\n          while (dom.parentNode != this.contentDOM) dom = dom.parentNode\n          domAfter = dom.nextSibling\n        }\n        while (domAfter && !((desc = domAfter.pmViewDesc) && desc.parent == this)) domAfter = domAfter.nextSibling\n        return domAfter ? this.posBeforeChild(desc) : this.posAtEnd\n      }\n    }\n    // Otherwise, use various heuristics, falling back on the bias\n    // parameter, to determine whether to return the position at the\n    // start or at the end of this view desc.\n    let atEnd\n    if (dom == this.dom && this.contentDOM) {\n      atEnd = offset > domIndex(this.contentDOM)\n    } else if (this.contentDOM && this.contentDOM != this.dom && this.dom.contains(this.contentDOM)) {\n      atEnd = dom.compareDocumentPosition(this.contentDOM) & 2\n    } else if (this.dom.firstChild) {\n      if (offset == 0) for (let search = dom;; search = search.parentNode) {\n        if (search == this.dom) { atEnd = false; break }\n        if (search.parentNode.firstChild != search) break\n      }\n      if (atEnd == null && offset == dom.childNodes.length) for (let search = dom;; search = search.parentNode) {\n        if (search == this.dom) { atEnd = true; break }\n        if (search.parentNode.lastChild != search) break\n      }\n    }\n    return (atEnd == null ? bias > 0 : atEnd) ? this.posAtEnd : this.posAtStart\n  }\n\n  // Scan up the dom finding the first desc that is a descendant of\n  // this one.\n  nearestDesc(dom, onlyNodes) {\n    for (let first = true, cur = dom; cur; cur = cur.parentNode) {\n      let desc = this.getDesc(cur)\n      if (desc && (!onlyNodes || desc.node)) {\n        // If dom is outside of this desc's nodeDOM, don't count it.\n        if (first && desc.nodeDOM &&\n            !(desc.nodeDOM.nodeType == 1 ? desc.nodeDOM.contains(dom.nodeType == 1 ? dom : dom.parentNode) : desc.nodeDOM == dom))\n          first = false\n        else\n          return desc\n      }\n    }\n  }\n\n  getDesc(dom) {\n    let desc = dom.pmViewDesc\n    for (let cur = desc; cur; cur = cur.parent) if (cur == this) return desc\n  }\n\n  posFromDOM(dom, offset, bias) {\n    for (let scan = dom; scan; scan = scan.parentNode) {\n      let desc = this.getDesc(scan)\n      if (desc) return desc.localPosFromDOM(dom, offset, bias)\n    }\n    return -1\n  }\n\n  // : (number) → ?NodeViewDesc\n  // Find the desc for the node after the given pos, if any. (When a\n  // parent node overrode rendering, there might not be one.)\n  descAt(pos) {\n    for (let i = 0, offset = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (offset == pos && end != offset) {\n        while (!child.border && child.children.length) child = child.children[0]\n        return child\n      }\n      if (pos < end) return child.descAt(pos - offset - child.border)\n      offset = end\n    }\n  }\n\n  // : (number, number) → {node: dom.Node, offset: number}\n  domFromPos(pos, side) {\n    if (!this.contentDOM) return {node: this.dom, offset: 0}\n    // First find the position in the child array\n    let i = 0, offset = 0\n    for (let curPos = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = curPos + child.size\n      if (end > pos || child instanceof TrailingHackViewDesc) { offset = pos - curPos; break }\n      curPos = end\n    }\n    // If this points into the middle of a child, call through\n    if (offset) return this.children[i].domFromPos(offset - this.children[i].border, side)\n    // Go back if there were any zero-length widgets with side >= 0 before this point\n    for (let prev; i && !(prev = this.children[i - 1]).size && prev instanceof WidgetViewDesc && prev.widget.type.side >= 0; i--) {}\n    // Scan towards the first useable node\n    if (side <= 0) {\n      let prev, enter = true\n      for (;; i--, enter = false) {\n        prev = i ? this.children[i - 1] : null\n        if (!prev || prev.dom.parentNode == this.contentDOM) break\n      }\n      if (prev && side && enter && !prev.border && !prev.domAtom) return prev.domFromPos(prev.size, side)\n      return {node: this.contentDOM, offset: prev ? domIndex(prev.dom) + 1 : 0}\n    } else {\n      let next, enter = true\n      for (;; i++, enter = false) {\n        next = i < this.children.length ? this.children[i] : null\n        if (!next || next.dom.parentNode == this.contentDOM) break\n      }\n      if (next && enter && !next.border && !next.domAtom) return next.domFromPos(0, side)\n      return {node: this.contentDOM, offset: next ? domIndex(next.dom) : this.contentDOM.childNodes.length}\n    }\n  }\n\n  // Used to find a DOM range in a single parent for a given changed\n  // range.\n  parseRange(from, to, base = 0) {\n    if (this.children.length == 0)\n      return {node: this.contentDOM, from, to, fromOffset: 0, toOffset: this.contentDOM.childNodes.length}\n\n    let fromOffset = -1, toOffset = -1\n    for (let offset = base, i = 0;; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (fromOffset == -1 && from <= end) {\n        let childBase = offset + child.border\n        // FIXME maybe descend mark views to parse a narrower range?\n        if (from >= childBase && to <= end - child.border && child.node &&\n            child.contentDOM && this.contentDOM.contains(child.contentDOM))\n          return child.parseRange(from, to, childBase)\n\n        from = offset\n        for (let j = i; j > 0; j--) {\n          let prev = this.children[j - 1]\n          if (prev.size && prev.dom.parentNode == this.contentDOM && !prev.emptyChildAt(1)) {\n            fromOffset = domIndex(prev.dom) + 1\n            break\n          }\n          from -= prev.size\n        }\n        if (fromOffset == -1) fromOffset = 0\n      }\n      if (fromOffset > -1 && (end > to || i == this.children.length - 1)) {\n        to = end\n        for (let j = i + 1; j < this.children.length; j++) {\n          let next = this.children[j]\n          if (next.size && next.dom.parentNode == this.contentDOM && !next.emptyChildAt(-1)) {\n            toOffset = domIndex(next.dom)\n            break\n          }\n          to += next.size\n        }\n        if (toOffset == -1) toOffset = this.contentDOM.childNodes.length\n        break\n      }\n      offset = end\n    }\n    return {node: this.contentDOM, from, to, fromOffset, toOffset}\n  }\n\n  emptyChildAt(side) {\n    if (this.border || !this.contentDOM || !this.children.length) return false\n    let child = this.children[side < 0 ? 0 : this.children.length - 1]\n    return child.size == 0 || child.emptyChildAt(side)\n  }\n\n  // : (number) → dom.Node\n  domAfterPos(pos) {\n    let {node, offset} = this.domFromPos(pos, 0)\n    if (node.nodeType != 1 || offset == node.childNodes.length)\n      throw new RangeError(\"No node after pos \" + pos)\n    return node.childNodes[offset]\n  }\n\n  // : (number, number, dom.Document)\n  // View descs are responsible for setting any selection that falls\n  // entirely inside of them, so that custom implementations can do\n  // custom things with the selection. Note that this falls apart when\n  // a selection starts in such a node and ends in another, in which\n  // case we just use whatever domFromPos produces as a best effort.\n  setSelection(anchor, head, root, force) {\n    // If the selection falls entirely in a child, give it to that child\n    let from = Math.min(anchor, head), to = Math.max(anchor, head)\n    for (let i = 0, offset = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (from > offset && to < end)\n        return child.setSelection(anchor - offset - child.border, head - offset - child.border, root, force)\n      offset = end\n    }\n\n    let anchorDOM = this.domFromPos(anchor, anchor ? -1 : 1)\n    let headDOM = head == anchor ? anchorDOM : this.domFromPos(head, head ? -1 : 1)\n    let domSel = root.getSelection()\n\n    let brKludge = false\n    // On Firefox, using Selection.collapse to put the cursor after a\n    // BR node for some reason doesn't always work (#1073). On Safari,\n    // the cursor sometimes inexplicable visually lags behind its\n    // reported position in such situations (#1092).\n    if ((browser.gecko || browser.safari) && anchor == head) {\n      let {node, offset} = anchorDOM\n      if (node.nodeType == 3) {\n        brKludge = offset && node.nodeValue[offset - 1] == \"\\n\"\n        // Issue #1128\n        if (brKludge && offset == node.nodeValue.length) {\n          for (let scan = node, after; scan; scan = scan.parentNode) {\n            if (after = scan.nextSibling) {\n              if (after.nodeName == \"BR\")\n                anchorDOM = headDOM = {node: after.parentNode, offset: domIndex(after) + 1}\n              break\n            }\n            let desc = scan.pmViewDesc\n            if (desc && desc.node && desc.node.isBlock) break\n          }\n        }\n      } else {\n        let prev = node.childNodes[offset - 1]\n        brKludge = prev && (prev.nodeName == \"BR\" || prev.contentEditable == \"false\")\n      }\n    }\n    // Firefox can act strangely when the selection is in front of an\n    // uneditable node. See #1163 and https://bugzilla.mozilla.org/show_bug.cgi?id=1709536\n    if (browser.gecko && domSel.focusNode && domSel.focusNode != headDOM.node && domSel.focusNode.nodeType == 1) {\n      let after = domSel.focusNode.childNodes[domSel.focusOffset]\n      if (after && after.contentEditable == \"false\") force = true\n    }\n\n    if (!(force || brKludge && browser.safari) &&\n        isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset) &&\n        isEquivalentPosition(headDOM.node, headDOM.offset, domSel.focusNode, domSel.focusOffset))\n      return\n\n    // Selection.extend can be used to create an 'inverted' selection\n    // (one where the focus is before the anchor), but not all\n    // browsers support it yet.\n    let domSelExtended = false\n    if ((domSel.extend || anchor == head) && !brKludge) {\n      domSel.collapse(anchorDOM.node, anchorDOM.offset)\n      try {\n        if (anchor != head) domSel.extend(headDOM.node, headDOM.offset)\n        domSelExtended = true\n      } catch (err) {\n        // In some cases with Chrome the selection is empty after calling\n        // collapse, even when it should be valid. This appears to be a bug, but\n        // it is difficult to isolate. If this happens fallback to the old path\n        // without using extend.\n        if (!(err instanceof DOMException)) throw err\n        // declare global: DOMException\n      }\n    }\n    if (!domSelExtended) {\n      if (anchor > head) { let tmp = anchorDOM; anchorDOM = headDOM; headDOM = tmp }\n      let range = document.createRange()\n      range.setEnd(headDOM.node, headDOM.offset)\n      range.setStart(anchorDOM.node, anchorDOM.offset)\n      domSel.removeAllRanges()\n      domSel.addRange(range)\n    }\n  }\n\n  // : (dom.MutationRecord) → bool\n  ignoreMutation(mutation) {\n    return !this.contentDOM && mutation.type != \"selection\"\n  }\n\n  get contentLost() {\n    return this.contentDOM && this.contentDOM != this.dom && !this.dom.contains(this.contentDOM)\n  }\n\n  // Remove a subtree of the element tree that has been touched\n  // by a DOM change, so that the next update will redraw it.\n  markDirty(from, to) {\n    for (let offset = 0, i = 0; i < this.children.length; i++) {\n      let child = this.children[i], end = offset + child.size\n      if (offset == end ? from <= end && to >= offset : from < end && to > offset) {\n        let startInside = offset + child.border, endInside = end - child.border\n        if (from >= startInside && to <= endInside) {\n          this.dirty = from == offset || to == end ? CONTENT_DIRTY : CHILD_DIRTY\n          if (from == startInside && to == endInside &&\n              (child.contentLost || child.dom.parentNode != this.contentDOM)) child.dirty = NODE_DIRTY\n          else child.markDirty(from - startInside, to - startInside)\n          return\n        } else {\n          child.dirty = child.dom == child.contentDOM && child.dom.parentNode == this.contentDOM && !child.children.length\n            ? CONTENT_DIRTY : NODE_DIRTY\n        }\n      }\n      offset = end\n    }\n    this.dirty = CONTENT_DIRTY\n  }\n\n  markParentsDirty() {\n    let level = 1\n    for (let node = this.parent; node; node = node.parent, level++) {\n      let dirty = level == 1 ? CONTENT_DIRTY : CHILD_DIRTY\n      if (node.dirty < dirty) node.dirty = dirty\n    }\n  }\n\n  get domAtom() { return false }\n\n  get ignoreForCoords() { return false }\n}\n\n// Reused array to avoid allocating fresh arrays for things that will\n// stay empty anyway.\nconst nothing = []\n\n// A widget desc represents a widget decoration, which is a DOM node\n// drawn between the document nodes.\nclass WidgetViewDesc extends ViewDesc {\n  // : (ViewDesc, Decoration)\n  constructor(parent, widget, view, pos) {\n    let self, dom = widget.type.toDOM\n    if (typeof dom == \"function\") dom = dom(view, () => {\n      if (!self) return pos\n      if (self.parent) return self.parent.posBeforeChild(self)\n    })\n    if (!widget.type.spec.raw) {\n      if (dom.nodeType != 1) {\n        let wrap = document.createElement(\"span\")\n        wrap.appendChild(dom)\n        dom = wrap\n      }\n      dom.contentEditable = false\n      dom.classList.add(\"ProseMirror-widget\")\n    }\n    super(parent, nothing, dom, null)\n    this.widget = widget\n    self = this\n  }\n\n  matchesWidget(widget) {\n    return this.dirty == NOT_DIRTY && widget.type.eq(this.widget.type)\n  }\n\n  parseRule() { return {ignore: true} }\n\n  stopEvent(event) {\n    let stop = this.widget.spec.stopEvent\n    return stop ? stop(event) : false\n  }\n\n  ignoreMutation(mutation) {\n    return mutation.type != \"selection\" || this.widget.spec.ignoreSelection\n  }\n\n  destroy() {\n    this.widget.type.destroy(this.dom)\n    super.destroy()\n  }\n\n  get domAtom() { return true }\n}\n\nclass CompositionViewDesc extends ViewDesc {\n  constructor(parent, dom, textDOM, text) {\n    super(parent, nothing, dom, null)\n    this.textDOM = textDOM\n    this.text = text\n  }\n\n  get size() { return this.text.length }\n\n  localPosFromDOM(dom, offset) {\n    if (dom != this.textDOM) return this.posAtStart + (offset ? this.size : 0)\n    return this.posAtStart + offset\n  }\n\n  domFromPos(pos) {\n    return {node: this.textDOM, offset: pos}\n  }\n\n  ignoreMutation(mut) {\n    return mut.type === 'characterData' && mut.target.nodeValue == mut.oldValue\n   }\n}\n\n// A mark desc represents a mark. May have multiple children,\n// depending on how the mark is split. Note that marks are drawn using\n// a fixed nesting order, for simplicity and predictability, so in\n// some cases they will be split more often than would appear\n// necessary.\nclass MarkViewDesc extends ViewDesc {\n  // : (ViewDesc, Mark, dom.Node)\n  constructor(parent, mark, dom, contentDOM) {\n    super(parent, [], dom, contentDOM)\n    this.mark = mark\n  }\n\n  static create(parent, mark, inline, view) {\n    let custom = view.nodeViews[mark.type.name]\n    let spec = custom && custom(mark, view, inline)\n    if (!spec || !spec.dom)\n      spec = DOMSerializer.renderSpec(document, mark.type.spec.toDOM(mark, inline))\n    return new MarkViewDesc(parent, mark, spec.dom, spec.contentDOM || spec.dom)\n  }\n\n  parseRule() {\n    if ((this.dirty & NODE_DIRTY) || this.mark.type.spec.reparseInView) return null\n    return {mark: this.mark.type.name, attrs: this.mark.attrs, contentElement: this.contentDOM}\n  }\n\n  matchesMark(mark) { return this.dirty != NODE_DIRTY && this.mark.eq(mark) }\n\n  markDirty(from, to) {\n    super.markDirty(from, to)\n    // Move dirty info to nearest node view\n    if (this.dirty != NOT_DIRTY) {\n      let parent = this.parent\n      while (!parent.node) parent = parent.parent\n      if (parent.dirty < this.dirty) parent.dirty = this.dirty\n      this.dirty = NOT_DIRTY\n    }\n  }\n\n  slice(from, to, view) {\n    let copy = MarkViewDesc.create(this.parent, this.mark, true, view)\n    let nodes = this.children, size = this.size\n    if (to < size) nodes = replaceNodes(nodes, to, size, view)\n    if (from > 0) nodes = replaceNodes(nodes, 0, from, view)\n    for (let i = 0; i < nodes.length; i++) nodes[i].parent = copy\n    copy.children = nodes\n    return copy\n  }\n}\n\n// Node view descs are the main, most common type of view desc, and\n// correspond to an actual node in the document. Unlike mark descs,\n// they populate their child array themselves.\nclass NodeViewDesc extends ViewDesc {\n  // : (?ViewDesc, Node, [Decoration], DecorationSource, dom.Node, ?dom.Node, EditorView)\n  constructor(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos) {\n    super(parent, node.isLeaf ? nothing : [], dom, contentDOM)\n    this.nodeDOM = nodeDOM\n    this.node = node\n    this.outerDeco = outerDeco\n    this.innerDeco = innerDeco\n    if (contentDOM) this.updateChildren(view, pos)\n  }\n\n  // By default, a node is rendered using the `toDOM` method from the\n  // node type spec. But client code can use the `nodeViews` spec to\n  // supply a custom node view, which can influence various aspects of\n  // the way the node works.\n  //\n  // (Using subclassing for this was intentionally decided against,\n  // since it'd require exposing a whole slew of finicky\n  // implementation details to the user code that they probably will\n  // never need.)\n  static create(parent, node, outerDeco, innerDeco, view, pos) {\n    let custom = view.nodeViews[node.type.name], descObj\n    let spec = custom && custom(node, view, () => {\n      // (This is a function that allows the custom view to find its\n      // own position)\n      if (!descObj) return pos\n      if (descObj.parent) return descObj.parent.posBeforeChild(descObj)\n    }, outerDeco, innerDeco)\n\n    let dom = spec && spec.dom, contentDOM = spec && spec.contentDOM\n    if (node.isText) {\n      if (!dom) dom = document.createTextNode(node.text)\n      else if (dom.nodeType != 3) throw new RangeError(\"Text must be rendered as a DOM text node\")\n    } else if (!dom) {\n      ;({dom, contentDOM} = DOMSerializer.renderSpec(document, node.type.spec.toDOM(node)))\n    }\n    if (!contentDOM && !node.isText && dom.nodeName != \"BR\") { // Chrome gets confused by <br contenteditable=false>\n      if (!dom.hasAttribute(\"contenteditable\")) dom.contentEditable = false\n      if (node.type.spec.draggable) dom.draggable = true\n    }\n\n    let nodeDOM = dom\n    dom = applyOuterDeco(dom, outerDeco, node)\n\n    if (spec)\n      return descObj = new CustomNodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM,\n                                              spec, view, pos + 1)\n    else if (node.isText)\n      return new TextViewDesc(parent, node, outerDeco, innerDeco, dom, nodeDOM, view)\n    else\n      return new NodeViewDesc(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos + 1)\n  }\n\n  parseRule() {\n    // Experimental kludge to allow opt-in re-parsing of nodes\n    if (this.node.type.spec.reparseInView) return null\n    // FIXME the assumption that this can always return the current\n    // attrs means that if the user somehow manages to change the\n    // attrs in the dom, that won't be picked up. Not entirely sure\n    // whether this is a problem\n    let rule = {node: this.node.type.name, attrs: this.node.attrs}\n    if (this.node.type.whitespace == \"pre\") rule.preserveWhitespace = \"full\"\n    if (!this.contentDOM) {\n      rule.getContent = () => this.node.content\n    } else if (!this.contentLost) {\n      rule.contentElement = this.contentDOM\n    } else {\n      // Chrome likes to randomly recreate parent nodes when\n      // backspacing things. When that happens, this tries to find the\n      // new parent.\n      for (let i = this.children.length - 1; i >= 0; i--) {\n        let child = this.children[i]\n        if (this.dom.contains(child.dom.parentNode)) {\n          rule.contentElement = child.dom.parentNode\n          break\n        }\n      }\n      if (!rule.contentElement) rule.getContent = () => Fragment.empty\n    }\n    return rule\n  }\n\n  matchesNode(node, outerDeco, innerDeco) {\n    return this.dirty == NOT_DIRTY && node.eq(this.node) &&\n      sameOuterDeco(outerDeco, this.outerDeco) && innerDeco.eq(this.innerDeco)\n  }\n\n  get size() { return this.node.nodeSize }\n\n  get border() { return this.node.isLeaf ? 0 : 1 }\n\n  // Syncs `this.children` to match `this.node.content` and the local\n  // decorations, possibly introducing nesting for marks. Then, in a\n  // separate step, syncs the DOM inside `this.contentDOM` to\n  // `this.children`.\n  updateChildren(view, pos) {\n    let inline = this.node.inlineContent, off = pos\n    let composition = view.composing && this.localCompositionInfo(view, pos)\n    let localComposition = composition && composition.pos > -1 ? composition : null\n    let compositionInChild = composition && composition.pos < 0\n    let updater = new ViewTreeUpdater(this, localComposition && localComposition.node)\n    iterDeco(this.node, this.innerDeco, (widget, i, insideNode) => {\n      if (widget.spec.marks)\n        updater.syncToMarks(widget.spec.marks, inline, view)\n      else if (widget.type.side >= 0 && !insideNode)\n        updater.syncToMarks(i == this.node.childCount ? Mark.none : this.node.child(i).marks, inline, view)\n      // If the next node is a desc matching this widget, reuse it,\n      // otherwise insert the widget as a new view desc.\n      updater.placeWidget(widget, view, off)\n    }, (child, outerDeco, innerDeco, i) => {\n      // Make sure the wrapping mark descs match the node's marks.\n      updater.syncToMarks(child.marks, inline, view)\n      // Try several strategies for drawing this node\n      let compIndex\n      if (updater.findNodeMatch(child, outerDeco, innerDeco, i)) {\n        // Found precise match with existing node view\n      } else if (compositionInChild && view.state.selection.from > off &&\n                 view.state.selection.to < off + child.nodeSize &&\n                 (compIndex = updater.findIndexWithChild(composition.node)) > -1 &&\n                 updater.updateNodeAt(child, outerDeco, innerDeco, compIndex, view)) {\n        // Updated the specific node that holds the composition\n      } else if (updater.updateNextNode(child, outerDeco, innerDeco, view, i)) {\n        // Could update an existing node to reflect this node\n      } else {\n        // Add it as a new view\n        updater.addNode(child, outerDeco, innerDeco, view, off)\n      }\n      off += child.nodeSize\n    })\n    // Drop all remaining descs after the current position.\n    updater.syncToMarks(nothing, inline, view)\n    if (this.node.isTextblock) updater.addTextblockHacks()\n    updater.destroyRest()\n\n    // Sync the DOM if anything changed\n    if (updater.changed || this.dirty == CONTENT_DIRTY) {\n      // May have to protect focused DOM from being changed if a composition is active\n      if (localComposition) this.protectLocalComposition(view, localComposition)\n      renderDescs(this.contentDOM, this.children, view)\n      if (browser.ios) iosHacks(this.dom)\n    }\n  }\n\n  localCompositionInfo(view, pos) {\n    // Only do something if both the selection and a focused text node\n    // are inside of this node\n    let {from, to} = view.state.selection\n    if (!(view.state.selection instanceof TextSelection) || from < pos || to > pos + this.node.content.size) return\n    let sel = view.root.getSelection()\n    let textNode = nearbyTextNode(sel.focusNode, sel.focusOffset)\n    if (!textNode || !this.dom.contains(textNode.parentNode)) return\n\n    if (this.node.inlineContent) {\n      // Find the text in the focused node in the node, stop if it's not\n      // there (may have been modified through other means, in which\n      // case it should overwritten)\n      let text = textNode.nodeValue\n      let textPos = findTextInFragment(this.node.content, text, from - pos, to - pos)\n      return textPos < 0 ? null : {node: textNode, pos: textPos, text}\n    } else {\n      return {node: textNode, pos: -1}\n    }\n  }\n\n  protectLocalComposition(view, {node, pos, text}) {\n    // The node is already part of a local view desc, leave it there\n    if (this.getDesc(node)) return\n\n    // Create a composition view for the orphaned nodes\n    let topNode = node\n    for (;; topNode = topNode.parentNode) {\n      if (topNode.parentNode == this.contentDOM) break\n      while (topNode.previousSibling) topNode.parentNode.removeChild(topNode.previousSibling)\n      while (topNode.nextSibling) topNode.parentNode.removeChild(topNode.nextSibling)\n      if (topNode.pmViewDesc) topNode.pmViewDesc = null\n    }\n    let desc = new CompositionViewDesc(this, topNode, node, text)\n    view.compositionNodes.push(desc)\n\n    // Patch up this.children to contain the composition view\n    this.children = replaceNodes(this.children, pos, pos + text.length, view, desc)\n  }\n\n  // : (Node, [Decoration], DecorationSource, EditorView) → bool\n  // If this desc be updated to match the given node decoration,\n  // do so and return true.\n  update(node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY ||\n        !node.sameMarkup(this.node)) return false\n    this.updateInner(node, outerDeco, innerDeco, view)\n    return true\n  }\n\n  updateInner(node, outerDeco, innerDeco, view) {\n    this.updateOuterDeco(outerDeco)\n    this.node = node\n    this.innerDeco = innerDeco\n    if (this.contentDOM) this.updateChildren(view, this.posAtStart)\n    this.dirty = NOT_DIRTY\n  }\n\n  updateOuterDeco(outerDeco) {\n    if (sameOuterDeco(outerDeco, this.outerDeco)) return\n    let needsWrap = this.nodeDOM.nodeType != 1\n    let oldDOM = this.dom\n    this.dom = patchOuterDeco(this.dom, this.nodeDOM,\n                              computeOuterDeco(this.outerDeco, this.node, needsWrap),\n                              computeOuterDeco(outerDeco, this.node, needsWrap))\n    if (this.dom != oldDOM) {\n      oldDOM.pmViewDesc = null\n      this.dom.pmViewDesc = this\n    }\n    this.outerDeco = outerDeco\n  }\n\n  // Mark this node as being the selected node.\n  selectNode() {\n    this.nodeDOM.classList.add(\"ProseMirror-selectednode\")\n    if (this.contentDOM || !this.node.type.spec.draggable) this.dom.draggable = true\n  }\n\n  // Remove selected node marking from this node.\n  deselectNode() {\n    this.nodeDOM.classList.remove(\"ProseMirror-selectednode\")\n    if (this.contentDOM || !this.node.type.spec.draggable) this.dom.removeAttribute(\"draggable\")\n  }\n\n  get domAtom() { return this.node.isAtom }\n}\n\n// Create a view desc for the top-level document node, to be exported\n// and used by the view class.\nexport function docViewDesc(doc, outerDeco, innerDeco, dom, view) {\n  applyOuterDeco(dom, outerDeco, doc)\n  return new NodeViewDesc(null, doc, outerDeco, innerDeco, dom, dom, dom, view, 0)\n}\n\nclass TextViewDesc extends NodeViewDesc {\n  constructor(parent, node, outerDeco, innerDeco, dom, nodeDOM, view) {\n    super(parent, node, outerDeco, innerDeco, dom, null, nodeDOM, view)\n  }\n\n  parseRule() {\n    let skip = this.nodeDOM.parentNode\n    while (skip && skip != this.dom && !skip.pmIsDeco) skip = skip.parentNode\n    return {skip: skip || true}\n  }\n\n  update(node, outerDeco, _, view) {\n    if (this.dirty == NODE_DIRTY || (this.dirty != NOT_DIRTY && !this.inParent()) ||\n        !node.sameMarkup(this.node)) return false\n    this.updateOuterDeco(outerDeco)\n    if ((this.dirty != NOT_DIRTY || node.text != this.node.text) && node.text != this.nodeDOM.nodeValue) {\n      this.nodeDOM.nodeValue = node.text\n      if (view.trackWrites == this.nodeDOM) view.trackWrites = null\n    }\n    this.node = node\n    this.dirty = NOT_DIRTY\n    return true\n  }\n\n  inParent() {\n    let parentDOM = this.parent.contentDOM\n    for (let n = this.nodeDOM; n; n = n.parentNode) if (n == parentDOM) return true\n    return false\n  }\n\n  domFromPos(pos) {\n    return {node: this.nodeDOM, offset: pos}\n  }\n\n  localPosFromDOM(dom, offset, bias) {\n    if (dom == this.nodeDOM) return this.posAtStart + Math.min(offset, this.node.text.length)\n    return super.localPosFromDOM(dom, offset, bias)\n  }\n\n  ignoreMutation(mutation) {\n    return mutation.type != \"characterData\" && mutation.type != \"selection\"\n  }\n\n  slice(from, to, view) {\n    let node = this.node.cut(from, to), dom = document.createTextNode(node.text)\n    return new TextViewDesc(this.parent, node, this.outerDeco, this.innerDeco, dom, dom, view)\n  }\n\n  markDirty(from, to) {\n    super.markDirty(from, to)\n    if (this.dom != this.nodeDOM && (from == 0 || to == this.nodeDOM.nodeValue.length))\n      this.dirty = NODE_DIRTY\n  }\n\n  get domAtom() { return false }\n}\n\n// A dummy desc used to tag trailing BR or IMG nodes created to work\n// around contentEditable terribleness.\nclass TrailingHackViewDesc extends ViewDesc {\n  parseRule() { return {ignore: true} }\n  matchesHack(nodeName) { return this.dirty == NOT_DIRTY && this.dom.nodeName == nodeName }\n  get domAtom() { return true }\n  get ignoreForCoords() { return this.dom.nodeName == \"IMG\" }\n}\n\n// A separate subclass is used for customized node views, so that the\n// extra checks only have to be made for nodes that are actually\n// customized.\nclass CustomNodeViewDesc extends NodeViewDesc {\n  // : (?ViewDesc, Node, [Decoration], DecorationSource, dom.Node, ?dom.Node, NodeView, EditorView)\n  constructor(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, spec, view, pos) {\n    super(parent, node, outerDeco, innerDeco, dom, contentDOM, nodeDOM, view, pos)\n    this.spec = spec\n  }\n\n  // A custom `update` method gets to decide whether the update goes\n  // through. If it does, and there's a `contentDOM` node, our logic\n  // updates the children.\n  update(node, outerDeco, innerDeco, view) {\n    if (this.dirty == NODE_DIRTY) return false\n    if (this.spec.update) {\n      let result = this.spec.update(node, outerDeco, innerDeco)\n      if (result) this.updateInner(node, outerDeco, innerDeco, view)\n      return result\n    } else if (!this.contentDOM && !node.isLeaf) {\n      return false\n    } else {\n      return super.update(node, outerDeco, innerDeco, view)\n    }\n  }\n\n  selectNode() {\n    this.spec.selectNode ? this.spec.selectNode() : super.selectNode()\n  }\n\n  deselectNode() {\n    this.spec.deselectNode ? this.spec.deselectNode() : super.deselectNode()\n  }\n\n  setSelection(anchor, head, root, force) {\n    this.spec.setSelection ? this.spec.setSelection(anchor, head, root)\n      : super.setSelection(anchor, head, root, force)\n  }\n\n  destroy() {\n    if (this.spec.destroy) this.spec.destroy()\n    super.destroy()\n  }\n\n  stopEvent(event) {\n    return this.spec.stopEvent ? this.spec.stopEvent(event) : false\n  }\n\n  ignoreMutation(mutation) {\n    return this.spec.ignoreMutation ? this.spec.ignoreMutation(mutation) : super.ignoreMutation(mutation)\n  }\n}\n\n// : (dom.Node, [ViewDesc])\n// Sync the content of the given DOM node with the nodes associated\n// with the given array of view descs, recursing into mark descs\n// because this should sync the subtree for a whole node at a time.\nfunction renderDescs(parentDOM, descs, view) {\n  let dom = parentDOM.firstChild, written = false\n  for (let i = 0; i < descs.length; i++) {\n    let desc = descs[i], childDOM = desc.dom\n    if (childDOM.parentNode == parentDOM) {\n      while (childDOM != dom) { dom = rm(dom); written = true }\n      dom = dom.nextSibling\n    } else {\n      written = true\n      parentDOM.insertBefore(childDOM, dom)\n    }\n    if (desc instanceof MarkViewDesc) {\n      let pos = dom ? dom.previousSibling : parentDOM.lastChild\n      renderDescs(desc.contentDOM, desc.children, view)\n      dom = pos ? pos.nextSibling : parentDOM.firstChild\n    }\n  }\n  while (dom) { dom = rm(dom); written = true }\n  if (written && view.trackWrites == parentDOM) view.trackWrites = null\n}\n\nfunction OuterDecoLevel(nodeName) {\n  if (nodeName) this.nodeName = nodeName\n}\nOuterDecoLevel.prototype = Object.create(null)\n\nconst noDeco = [new OuterDecoLevel]\n\nfunction computeOuterDeco(outerDeco, node, needsWrap) {\n  if (outerDeco.length == 0) return noDeco\n\n  let top = needsWrap ? noDeco[0] : new OuterDecoLevel, result = [top]\n\n  for (let i = 0; i < outerDeco.length; i++) {\n    let attrs = outerDeco[i].type.attrs\n    if (!attrs) continue\n    if (attrs.nodeName)\n      result.push(top = new OuterDecoLevel(attrs.nodeName))\n\n    for (let name in attrs) {\n      let val = attrs[name]\n      if (val == null) continue\n      if (needsWrap && result.length == 1)\n        result.push(top = new OuterDecoLevel(node.isInline ? \"span\" : \"div\"))\n      if (name == \"class\") top.class = (top.class ? top.class + \" \" : \"\") + val\n      else if (name == \"style\") top.style = (top.style ? top.style + \";\" : \"\") + val\n      else if (name != \"nodeName\") top[name] = val\n    }\n  }\n\n  return result\n}\n\nfunction patchOuterDeco(outerDOM, nodeDOM, prevComputed, curComputed) {\n  // Shortcut for trivial case\n  if (prevComputed == noDeco && curComputed == noDeco) return nodeDOM\n\n  let curDOM = nodeDOM\n  for (let i = 0; i < curComputed.length; i++) {\n    let deco = curComputed[i], prev = prevComputed[i]\n    if (i) {\n      let parent\n      if (prev && prev.nodeName == deco.nodeName && curDOM != outerDOM &&\n          (parent = curDOM.parentNode) && parent.tagName.toLowerCase() == deco.nodeName) {\n        curDOM = parent\n      } else {\n        parent = document.createElement(deco.nodeName)\n        parent.pmIsDeco = true\n        parent.appendChild(curDOM)\n        prev = noDeco[0]\n        curDOM = parent\n      }\n    }\n    patchAttributes(curDOM, prev || noDeco[0], deco)\n  }\n  return curDOM\n}\n\nfunction patchAttributes(dom, prev, cur) {\n  for (let name in prev)\n    if (name != \"class\" && name != \"style\" && name != \"nodeName\" && !(name in cur))\n      dom.removeAttribute(name)\n  for (let name in cur)\n    if (name != \"class\" && name != \"style\" && name != \"nodeName\" && cur[name] != prev[name])\n      dom.setAttribute(name, cur[name])\n  if (prev.class != cur.class) {\n    let prevList = prev.class ? prev.class.split(\" \").filter(Boolean) : nothing\n    let curList = cur.class ? cur.class.split(\" \").filter(Boolean) : nothing\n    for (let i = 0; i < prevList.length; i++) if (curList.indexOf(prevList[i]) == -1)\n      dom.classList.remove(prevList[i])\n    for (let i = 0; i < curList.length; i++) if (prevList.indexOf(curList[i]) == -1)\n      dom.classList.add(curList[i])\n    if (dom.classList.length == 0)\n      dom.removeAttribute(\"class\")\n  }\n  if (prev.style != cur.style) {\n    if (prev.style) {\n      let prop = /\\s*([\\w\\-\\xa1-\\uffff]+)\\s*:(?:\"(?:\\\\.|[^\"])*\"|'(?:\\\\.|[^'])*'|\\(.*?\\)|[^;])*/g, m\n      while (m = prop.exec(prev.style))\n        dom.style.removeProperty(m[1])\n    }\n    if (cur.style)\n      dom.style.cssText += cur.style\n  }\n}\n\nfunction applyOuterDeco(dom, deco, node) {\n  return patchOuterDeco(dom, dom, noDeco, computeOuterDeco(deco, node, dom.nodeType != 1))\n}\n\n// : ([Decoration], [Decoration]) → bool\nfunction sameOuterDeco(a, b) {\n  if (a.length != b.length) return false\n  for (let i = 0; i < a.length; i++) if (!a[i].type.eq(b[i].type)) return false\n  return true\n}\n\n// Remove a DOM node and return its next sibling.\nfunction rm(dom) {\n  let next = dom.nextSibling\n  dom.parentNode.removeChild(dom)\n  return next\n}\n\n// Helper class for incrementally updating a tree of mark descs and\n// the widget and node descs inside of them.\nclass ViewTreeUpdater {\n  // : (NodeViewDesc)\n  constructor(top, lockedNode) {\n    this.top = top\n    this.lock = lockedNode\n    // Index into `this.top`'s child array, represents the current\n    // update position.\n    this.index = 0\n    // When entering a mark, the current top and index are pushed\n    // onto this.\n    this.stack = []\n    // Tracks whether anything was changed\n    this.changed = false\n\n    this.preMatch = preMatch(top.node.content, top)\n  }\n\n  // Destroy and remove the children between the given indices in\n  // `this.top`.\n  destroyBetween(start, end) {\n    if (start == end) return\n    for (let i = start; i < end; i++) this.top.children[i].destroy()\n    this.top.children.splice(start, end - start)\n    this.changed = true\n  }\n\n  // Destroy all remaining children in `this.top`.\n  destroyRest() {\n    this.destroyBetween(this.index, this.top.children.length)\n  }\n\n  // : ([Mark], EditorView)\n  // Sync the current stack of mark descs with the given array of\n  // marks, reusing existing mark descs when possible.\n  syncToMarks(marks, inline, view) {\n    let keep = 0, depth = this.stack.length >> 1\n    let maxKeep = Math.min(depth, marks.length)\n    while (keep < maxKeep &&\n           (keep == depth - 1 ? this.top : this.stack[(keep + 1) << 1]).matchesMark(marks[keep]) && marks[keep].type.spec.spanning !== false)\n      keep++\n\n    while (keep < depth) {\n      this.destroyRest()\n      this.top.dirty = NOT_DIRTY\n      this.index = this.stack.pop()\n      this.top = this.stack.pop()\n      depth--\n    }\n    while (depth < marks.length) {\n      this.stack.push(this.top, this.index + 1)\n      let found = -1\n      for (let i = this.index; i < Math.min(this.index + 3, this.top.children.length); i++) {\n        if (this.top.children[i].matchesMark(marks[depth])) { found = i; break }\n      }\n      if (found > -1) {\n        if (found > this.index) {\n          this.changed = true\n          this.destroyBetween(this.index, found)\n        }\n        this.top = this.top.children[this.index]\n      } else {\n        let markDesc = MarkViewDesc.create(this.top, marks[depth], inline, view)\n        this.top.children.splice(this.index, 0, markDesc)\n        this.top = markDesc\n        this.changed = true\n      }\n      this.index = 0\n      depth++\n    }\n  }\n\n  // : (Node, [Decoration], DecorationSource) → bool\n  // Try to find a node desc matching the given data. Skip over it and\n  // return true when successful.\n  findNodeMatch(node, outerDeco, innerDeco, index) {\n    let found = -1, targetDesc\n    if (index >= this.preMatch.index &&\n        (targetDesc = this.preMatch.matches[index - this.preMatch.index]).parent == this.top &&\n        targetDesc.matchesNode(node, outerDeco, innerDeco)) {\n      found = this.top.children.indexOf(targetDesc, this.index)\n    } else {\n      for (let i = this.index, e = Math.min(this.top.children.length, i + 5); i < e; i++) {\n        let child = this.top.children[i]\n        if (child.matchesNode(node, outerDeco, innerDeco) && !this.preMatch.matched.has(child)) {\n          found = i\n          break\n        }\n      }\n    }\n    if (found < 0) return false\n    this.destroyBetween(this.index, found)\n    this.index++\n    return true\n  }\n\n  updateNodeAt(node, outerDeco, innerDeco, index, view) {\n    let child = this.top.children[index]\n    if (!child.update(node, outerDeco, innerDeco, view)) return false\n    this.destroyBetween(this.index, index)\n    this.index = index + 1\n    return true\n  }\n\n  findIndexWithChild(domNode) {\n    for (;;) {\n      let parent = domNode.parentNode\n      if (!parent) return -1\n      if (parent == this.top.contentDOM) {\n        let desc = domNode.pmViewDesc\n        if (desc) for (let i = this.index; i < this.top.children.length; i++) {\n          if (this.top.children[i] == desc) return i\n        }\n        return -1\n      }\n      domNode = parent\n    }\n  }\n\n  // : (Node, [Decoration], DecorationSource, EditorView, Fragment, number) → bool\n  // Try to update the next node, if any, to the given data. Checks\n  // pre-matches to avoid overwriting nodes that could still be used.\n  updateNextNode(node, outerDeco, innerDeco, view, index) {\n    for (let i = this.index; i < this.top.children.length; i++) {\n      let next = this.top.children[i]\n      if (next instanceof NodeViewDesc) {\n        let preMatch = this.preMatch.matched.get(next)\n        if (preMatch != null && preMatch != index) return false\n        let nextDOM = next.dom\n\n        // Can't update if nextDOM is or contains this.lock, except if\n        // it's a text node whose content already matches the new text\n        // and whose decorations match the new ones.\n        let locked = this.lock && (nextDOM == this.lock || nextDOM.nodeType == 1 && nextDOM.contains(this.lock.parentNode)) &&\n            !(node.isText && next.node && next.node.isText && next.nodeDOM.nodeValue == node.text &&\n              next.dirty != NODE_DIRTY && sameOuterDeco(outerDeco, next.outerDeco))\n        if (!locked && next.update(node, outerDeco, innerDeco, view)) {\n          this.destroyBetween(this.index, i)\n          if (next.dom != nextDOM) this.changed = true\n          this.index++\n          return true\n        }\n        break\n      }\n    }\n    return false\n  }\n\n  // : (Node, [Decoration], DecorationSource, EditorView)\n  // Insert the node as a newly created node desc.\n  addNode(node, outerDeco, innerDeco, view, pos) {\n    this.top.children.splice(this.index++, 0, NodeViewDesc.create(this.top, node, outerDeco, innerDeco, view, pos))\n    this.changed = true\n  }\n\n  placeWidget(widget, view, pos) {\n    let next = this.index < this.top.children.length ? this.top.children[this.index] : null\n    if (next && next.matchesWidget(widget) && (widget == next.widget || !next.widget.type.toDOM.parentNode)) {\n      this.index++\n    } else {\n      let desc = new WidgetViewDesc(this.top, widget, view, pos)\n      this.top.children.splice(this.index++, 0, desc)\n      this.changed = true\n    }\n  }\n\n  // Make sure a textblock looks and behaves correctly in\n  // contentEditable.\n  addTextblockHacks() {\n    let lastChild = this.top.children[this.index - 1]\n    while (lastChild instanceof MarkViewDesc) lastChild = lastChild.children[lastChild.children.length - 1]\n\n    if (!lastChild || // Empty textblock\n        !(lastChild instanceof TextViewDesc) ||\n        /\\n$/.test(lastChild.node.text)) {\n      // Avoid bugs in Safari's cursor drawing (#1165) and Chrome's mouse selection (#1152)\n      if ((browser.safari || browser.chrome) && lastChild && lastChild.dom.contentEditable == \"false\")\n        this.addHackNode(\"IMG\")\n      this.addHackNode(\"BR\")\n    }\n  }\n\n  addHackNode(nodeName) {\n    if (this.index < this.top.children.length && this.top.children[this.index].matchesHack(nodeName)) {\n      this.index++\n    } else {\n      let dom = document.createElement(nodeName)\n      if (nodeName == \"IMG\") {\n        dom.className = \"ProseMirror-separator\"\n        dom.alt = \"\"\n      }\n      if (nodeName == \"BR\") dom.className = \"ProseMirror-trailingBreak\"\n      this.top.children.splice(this.index++, 0, new TrailingHackViewDesc(this.top, nothing, dom, null))\n      this.changed = true\n    }\n  }\n}\n\n// : (Fragment, [ViewDesc]) → {index: number, matched: Map<ViewDesc, number>, matches: ViewDesc[]}\n// Iterate from the end of the fragment and array of descs to find\n// directly matching ones, in order to avoid overeagerly reusing those\n// for other nodes. Returns the fragment index of the first node that\n// is part of the sequence of matched nodes at the end of the\n// fragment.\nfunction preMatch(frag, parentDesc) {\n  let curDesc = parentDesc, descI = curDesc.children.length\n  let fI = frag.childCount, matched = new Map, matches = []\n  outer: while (fI > 0) {\n    let desc\n    for (;;) {\n      if (descI) {\n        let next = curDesc.children[descI - 1]\n        if (next instanceof MarkViewDesc) {\n          curDesc = next\n          descI = next.children.length\n        } else {\n          desc = next\n          descI--\n          break\n        }\n      } else if (curDesc == parentDesc) {\n        break outer\n      } else {\n        // FIXME\n        descI = curDesc.parent.children.indexOf(curDesc)\n        curDesc = curDesc.parent\n      }\n    }\n    let node = desc.node\n    if (!node) continue\n    if (node != frag.child(fI - 1)) break\n    --fI\n    matched.set(desc, fI)\n    matches.push(desc)\n  }\n  return {index: fI, matched, matches: matches.reverse()}\n}\n\nfunction compareSide(a, b) { return a.type.side - b.type.side }\n\n// : (ViewDesc, DecorationSource, (Decoration, number), (Node, [Decoration], DecorationSource, number))\n// This function abstracts iterating over the nodes and decorations in\n// a fragment. Calls `onNode` for each node, with its local and child\n// decorations. Splits text nodes when there is a decoration starting\n// or ending inside of them. Calls `onWidget` for each widget.\nfunction iterDeco(parent, deco, onWidget, onNode) {\n  let locals = deco.locals(parent), offset = 0\n  // Simple, cheap variant for when there are no local decorations\n  if (locals.length == 0) {\n    for (let i = 0; i < parent.childCount; i++) {\n      let child = parent.child(i)\n      onNode(child, locals, deco.forChild(offset, child), i)\n      offset += child.nodeSize\n    }\n    return\n  }\n\n  let decoIndex = 0, active = [], restNode = null\n  for (let parentIndex = 0;;) {\n    if (decoIndex < locals.length && locals[decoIndex].to == offset) {\n      let widget = locals[decoIndex++], widgets\n      while (decoIndex < locals.length && locals[decoIndex].to == offset)\n        (widgets || (widgets = [widget])).push(locals[decoIndex++])\n      if (widgets) {\n        widgets.sort(compareSide)\n        for (let i = 0; i < widgets.length; i++) onWidget(widgets[i], parentIndex, !!restNode)\n      } else {\n        onWidget(widget, parentIndex, !!restNode)\n      }\n    }\n\n    let child, index\n    if (restNode) {\n      index = -1\n      child = restNode\n      restNode = null\n    } else if (parentIndex < parent.childCount) {\n      index = parentIndex\n      child = parent.child(parentIndex++)\n    } else {\n      break\n    }\n\n    for (let i = 0; i < active.length; i++) if (active[i].to <= offset) active.splice(i--, 1)\n    while (decoIndex < locals.length && locals[decoIndex].from <= offset && locals[decoIndex].to > offset)\n      active.push(locals[decoIndex++])\n\n    let end = offset + child.nodeSize\n    if (child.isText) {\n      let cutAt = end\n      if (decoIndex < locals.length && locals[decoIndex].from < cutAt) cutAt = locals[decoIndex].from\n      for (let i = 0; i < active.length; i++) if (active[i].to < cutAt) cutAt = active[i].to\n      if (cutAt < end) {\n        restNode = child.cut(cutAt - offset)\n        child = child.cut(0, cutAt - offset)\n        end = cutAt\n        index = -1\n      }\n    }\n\n    let outerDeco = !active.length ? nothing\n        : child.isInline && !child.isLeaf ? active.filter(d => !d.inline)\n        : active.slice()\n    onNode(child, outerDeco, deco.forChild(offset, child), index)\n    offset = end\n  }\n}\n\n// List markers in Mobile Safari will mysteriously disappear\n// sometimes. This works around that.\nfunction iosHacks(dom) {\n  if (dom.nodeName == \"UL\" || dom.nodeName == \"OL\") {\n    let oldCSS = dom.style.cssText\n    dom.style.cssText = oldCSS + \"; list-style: square !important\"\n    window.getComputedStyle(dom).listStyle\n    dom.style.cssText = oldCSS\n  }\n}\n\nfunction nearbyTextNode(node, offset) {\n  for (;;) {\n    if (node.nodeType == 3) return node\n    if (node.nodeType == 1 && offset > 0) {\n      if (node.childNodes.length > offset && node.childNodes[offset].nodeType == 3)\n        return node.childNodes[offset]\n      node = node.childNodes[offset - 1]\n      offset = nodeSize(node)\n    } else if (node.nodeType == 1 && offset < node.childNodes.length) {\n      node = node.childNodes[offset]\n      offset = 0\n    } else {\n      return null\n    }\n  }\n}\n\n// Find a piece of text in an inline fragment, overlapping from-to\nfunction findTextInFragment(frag, text, from, to) {\n  for (let i = 0, pos = 0; i < frag.childCount && pos <= to;) {\n    let child = frag.child(i++), childStart = pos\n    pos += child.nodeSize\n    if (!child.isText) continue\n    let str = child.text\n    while (i < frag.childCount) {\n      let next = frag.child(i++)\n      pos += next.nodeSize\n      if (!next.isText) break\n      str += next.text\n    }\n    if (pos >= from) {\n      let found = childStart < to ? str.lastIndexOf(text, to - childStart - 1) : -1\n      if (found >= 0 && found + text.length + childStart >= from)\n        return childStart + found\n      if (from == to && str.length >= (to + text.length) - childStart &&\n          str.slice(to - childStart, to - childStart + text.length) == text)\n        return to\n    }\n  }\n  return -1\n}\n\n// Replace range from-to in an array of view descs with replacement\n// (may be null to just delete). This goes very much against the grain\n// of the rest of this code, which tends to create nodes with the\n// right shape in one go, rather than messing with them after\n// creation, but is necessary in the composition hack.\nfunction replaceNodes(nodes, from, to, view, replacement) {\n  let result = []\n  for (let i = 0, off = 0; i < nodes.length; i++) {\n    let child = nodes[i], start = off, end = off += child.size\n    if (start >= to || end <= from) {\n      result.push(child)\n    } else {\n      if (start < from) result.push(child.slice(0, from - start, view))\n      if (replacement) {\n        result.push(replacement)\n        replacement = null\n      }\n      if (end > to) result.push(child.slice(to - start, child.size, view))\n    }\n  }\n  return result\n}\n","import {TextSelection, NodeSelection} from \"prosemirror-state\"\n\nimport browser from \"./browser\"\nimport {selectionCollapsed, isEquivalentPosition, domIndex, isOnEdge} from \"./dom\"\n\nexport function selectionFromDOM(view, origin) {\n  let domSel = view.root.getSelection(), doc = view.state.doc\n  if (!domSel.focusNode) return null\n  let nearestDesc = view.docView.nearestDesc(domSel.focusNode), inWidget = nearestDesc && nearestDesc.size == 0\n  let head = view.docView.posFromDOM(domSel.focusNode, domSel.focusOffset)\n  if (head < 0) return null\n  let $head = doc.resolve(head), $anchor, selection\n  if (selectionCollapsed(domSel)) {\n    $anchor = $head\n    while (nearestDesc && !nearestDesc.node) nearestDesc = nearestDesc.parent\n    if (nearestDesc && nearestDesc.node.isAtom && NodeSelection.isSelectable(nearestDesc.node) && nearestDesc.parent\n        && !(nearestDesc.node.isInline && isOnEdge(domSel.focusNode, domSel.focusOffset, nearestDesc.dom))) {\n      let pos = nearestDesc.posBefore\n      selection = new NodeSelection(head == pos ? $head : doc.resolve(pos))\n    }\n  } else {\n    let anchor = view.docView.posFromDOM(domSel.anchorNode, domSel.anchorOffset)\n    if (anchor < 0) return null\n    $anchor = doc.resolve(anchor)\n  }\n\n  if (!selection) {\n    let bias = origin == \"pointer\" || (view.state.selection.head < $head.pos && !inWidget) ? 1 : -1\n    selection = selectionBetween(view, $anchor, $head, bias)\n  }\n  return selection\n}\n\nfunction editorOwnsSelection(view) {\n  return view.editable ? view.hasFocus() :\n    hasSelection(view) && document.activeElement && document.activeElement.contains(view.dom)\n}\n\nexport function selectionToDOM(view, force) {\n  let sel = view.state.selection\n  syncNodeSelection(view, sel)\n\n  if (!editorOwnsSelection(view)) return\n\n  // The delayed drag selection causes issues with Cell Selections\n  // in Safari. And the drag selection delay is to workarond issues\n  // which only present in Chrome.\n  if (!force && view.mouseDown && view.mouseDown.allowDefault && browser.chrome) {\n    let domSel = view.root.getSelection(), curSel = view.domObserver.currentSelection\n    if (domSel.anchorNode && isEquivalentPosition(domSel.anchorNode, domSel.anchorOffset,\n                                                  curSel.anchorNode, curSel.anchorOffset)) {\n      view.mouseDown.delayedSelectionSync = true\n      view.domObserver.setCurSelection()\n      return\n    }\n  }\n\n  view.domObserver.disconnectSelection()\n\n  if (view.cursorWrapper) {\n    selectCursorWrapper(view)\n  } else {\n    let {anchor, head} = sel, resetEditableFrom, resetEditableTo\n    if (brokenSelectBetweenUneditable && !(sel instanceof TextSelection)) {\n      if (!sel.$from.parent.inlineContent)\n        resetEditableFrom = temporarilyEditableNear(view, sel.from)\n      if (!sel.empty && !sel.$from.parent.inlineContent)\n        resetEditableTo = temporarilyEditableNear(view, sel.to)\n    }\n    view.docView.setSelection(anchor, head, view.root, force)\n    if (brokenSelectBetweenUneditable) {\n      if (resetEditableFrom) resetEditable(resetEditableFrom)\n      if (resetEditableTo) resetEditable(resetEditableTo)\n    }\n    if (sel.visible) {\n      view.dom.classList.remove(\"ProseMirror-hideselection\")\n    } else {\n      view.dom.classList.add(\"ProseMirror-hideselection\")\n      if (\"onselectionchange\" in document) removeClassOnSelectionChange(view)\n    }\n  }\n\n  view.domObserver.setCurSelection()\n  view.domObserver.connectSelection()\n}\n\n// Kludge to work around Webkit not allowing a selection to start/end\n// between non-editable block nodes. We briefly make something\n// editable, set the selection, then set it uneditable again.\n\nconst brokenSelectBetweenUneditable = browser.safari || browser.chrome && browser.chrome_version < 63\n\nfunction temporarilyEditableNear(view, pos) {\n  let {node, offset} = view.docView.domFromPos(pos, 0)\n  let after = offset < node.childNodes.length ? node.childNodes[offset] : null\n  let before = offset ? node.childNodes[offset - 1] : null\n  if (browser.safari && after && after.contentEditable == \"false\") return setEditable(after)\n  if ((!after || after.contentEditable == \"false\") && (!before || before.contentEditable == \"false\")) {\n    if (after) return setEditable(after)\n    else if (before) return setEditable(before)\n  }\n}\n\nfunction setEditable(element) {\n  element.contentEditable = \"true\"\n  if (browser.safari && element.draggable) { element.draggable = false; element.wasDraggable = true }\n  return element\n}\n\nfunction resetEditable(element) {\n  element.contentEditable = \"false\"\n  if (element.wasDraggable) { element.draggable = true; element.wasDraggable = null }\n}\n\nfunction removeClassOnSelectionChange(view) {\n  let doc = view.dom.ownerDocument\n  doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard)\n  let domSel = view.root.getSelection()\n  let node = domSel.anchorNode, offset = domSel.anchorOffset\n  doc.addEventListener(\"selectionchange\", view.hideSelectionGuard = () => {\n    if (domSel.anchorNode != node || domSel.anchorOffset != offset) {\n      doc.removeEventListener(\"selectionchange\", view.hideSelectionGuard)\n      setTimeout(() => {\n        if (!editorOwnsSelection(view) || view.state.selection.visible)\n          view.dom.classList.remove(\"ProseMirror-hideselection\")\n      }, 20)\n    }\n  })\n}\n\nfunction selectCursorWrapper(view) {\n  let domSel = view.root.getSelection(), range = document.createRange()\n  let node = view.cursorWrapper.dom, img = node.nodeName == \"IMG\"\n  if (img) range.setEnd(node.parentNode, domIndex(node) + 1)\n  else range.setEnd(node, 0)\n  range.collapse(false)\n  domSel.removeAllRanges()\n  domSel.addRange(range)\n  // Kludge to kill 'control selection' in IE11 when selecting an\n  // invisible cursor wrapper, since that would result in those weird\n  // resize handles and a selection that considers the absolutely\n  // positioned wrapper, rather than the root editable node, the\n  // focused element.\n  if (!img && !view.state.selection.visible && browser.ie && browser.ie_version <= 11) {\n    node.disabled = true\n    node.disabled = false\n  }\n}\n\nexport function syncNodeSelection(view, sel) {\n  if (sel instanceof NodeSelection) {\n    let desc = view.docView.descAt(sel.from)\n    if (desc != view.lastSelectedViewDesc) {\n      clearNodeSelection(view)\n      if (desc) desc.selectNode()\n      view.lastSelectedViewDesc = desc\n    }\n  } else {\n    clearNodeSelection(view)\n  }\n}\n\n// Clear all DOM statefulness of the last node selection.\nfunction clearNodeSelection(view) {\n  if (view.lastSelectedViewDesc) {\n    if (view.lastSelectedViewDesc.parent)\n      view.lastSelectedViewDesc.deselectNode()\n    view.lastSelectedViewDesc = null\n  }\n}\n\nexport function selectionBetween(view, $anchor, $head, bias) {\n  return view.someProp(\"createSelectionBetween\", f => f(view, $anchor, $head))\n    || TextSelection.between($anchor, $head, bias)\n}\n\nexport function hasFocusAndSelection(view) {\n  if (view.editable && view.root.activeElement != view.dom) return false\n  return hasSelection(view)\n}\n\nexport function hasSelection(view) {\n  let sel = view.root.getSelection()\n  if (!sel.anchorNode) return false\n  try {\n    // Firefox will raise 'permission denied' errors when accessing\n    // properties of `sel.anchorNode` when it's in a generated CSS\n    // element.\n    return view.dom.contains(sel.anchorNode.nodeType == 3 ? sel.anchorNode.parentNode : sel.anchorNode) &&\n      (view.editable || view.dom.contains(sel.focusNode.nodeType == 3 ? sel.focusNode.parentNode : sel.focusNode))\n  } catch(_) {\n    return false\n  }\n}\n\nexport function anchorInRightPlace(view) {\n  let anchorDOM = view.docView.domFromPos(view.state.selection.anchor, 0)\n  let domSel = view.root.getSelection()\n  return isEquivalentPosition(anchorDOM.node, anchorDOM.offset, domSel.anchorNode, domSel.anchorOffset)\n}\n","import {Selection, NodeSelection, TextSelection, AllSelection} from \"prosemirror-state\"\nimport browser from \"./browser\"\nimport {domIndex, selectionCollapsed} from \"./dom\"\nimport {selectionToDOM} from \"./selection\"\n\nfunction moveSelectionBlock(state, dir) {\n  let {$anchor, $head} = state.selection\n  let $side = dir > 0 ? $anchor.max($head) : $anchor.min($head)\n  let $start = !$side.parent.inlineContent ? $side : $side.depth ? state.doc.resolve(dir > 0 ? $side.after() : $side.before()) : null\n  return $start && Selection.findFrom($start, dir)\n}\n\nfunction apply(view, sel) {\n  view.dispatch(view.state.tr.setSelection(sel).scrollIntoView())\n  return true\n}\n\nfunction selectHorizontally(view, dir, mods) {\n  let sel = view.state.selection\n  if (sel instanceof TextSelection) {\n    if (!sel.empty || mods.indexOf(\"s\") > -1) {\n      return false\n    } else if (view.endOfTextblock(dir > 0 ? \"right\" : \"left\")) {\n      let next = moveSelectionBlock(view.state, dir)\n      if (next && (next instanceof NodeSelection)) return apply(view, next)\n      return false\n    } else if (!(browser.mac && mods.indexOf(\"m\") > -1)) {\n      let $head = sel.$head, node = $head.textOffset ? null : dir < 0 ? $head.nodeBefore : $head.nodeAfter, desc\n      if (!node || node.isText) return false\n      let nodePos = dir < 0 ? $head.pos - node.nodeSize : $head.pos\n      if (!(node.isAtom || (desc = view.docView.descAt(nodePos)) && !desc.contentDOM)) return false\n      if (NodeSelection.isSelectable(node)) {\n        return apply(view, new NodeSelection(dir < 0 ? view.state.doc.resolve($head.pos - node.nodeSize) : $head))\n      } else if (browser.webkit) {\n        // Chrome and Safari will introduce extra pointless cursor\n        // positions around inline uneditable nodes, so we have to\n        // take over and move the cursor past them (#937)\n        return apply(view, new TextSelection(view.state.doc.resolve(dir < 0 ? nodePos : nodePos + node.nodeSize)))\n      } else {\n        return false\n      }\n    }\n  } else if (sel instanceof NodeSelection && sel.node.isInline) {\n    return apply(view, new TextSelection(dir > 0 ? sel.$to : sel.$from))\n  } else {\n    let next = moveSelectionBlock(view.state, dir)\n    if (next) return apply(view, next)\n    return false\n  }\n}\n\nfunction nodeLen(node) {\n  return node.nodeType == 3 ? node.nodeValue.length : node.childNodes.length\n}\n\nfunction isIgnorable(dom) {\n  let desc = dom.pmViewDesc\n  return desc && desc.size == 0 && (dom.nextSibling || dom.nodeName != \"BR\")\n}\n\n// Make sure the cursor isn't directly after one or more ignored\n// nodes, which will confuse the browser's cursor motion logic.\nfunction skipIgnoredNodesLeft(view) {\n  let sel = view.root.getSelection()\n  let node = sel.focusNode, offset = sel.focusOffset\n  if (!node) return\n  let moveNode, moveOffset, force = false\n  // Gecko will do odd things when the selection is directly in front\n  // of a non-editable node, so in that case, move it into the next\n  // node if possible. Issue prosemirror/prosemirror#832.\n  if (browser.gecko && node.nodeType == 1 && offset < nodeLen(node) && isIgnorable(node.childNodes[offset])) force = true\n  for (;;) {\n    if (offset > 0) {\n      if (node.nodeType != 1) {\n        break\n      } else {\n        let before = node.childNodes[offset - 1]\n        if (isIgnorable(before)) {\n          moveNode = node\n          moveOffset = --offset\n        } else if (before.nodeType == 3) {\n          node = before\n          offset = node.nodeValue.length\n        } else break\n      }\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      let prev = node.previousSibling\n      while (prev && isIgnorable(prev)) {\n        moveNode = node.parentNode\n        moveOffset = domIndex(prev)\n        prev = prev.previousSibling\n      }\n      if (!prev) {\n        node = node.parentNode\n        if (node == view.dom) break\n        offset = 0\n      } else {\n        node = prev\n        offset = nodeLen(node)\n      }\n    }\n  }\n  if (force) setSelFocus(view, sel, node, offset)\n  else if (moveNode) setSelFocus(view, sel, moveNode, moveOffset)\n}\n\n// Make sure the cursor isn't directly before one or more ignored\n// nodes.\nfunction skipIgnoredNodesRight(view) {\n  let sel = view.root.getSelection()\n  let node = sel.focusNode, offset = sel.focusOffset\n  if (!node) return\n  let len = nodeLen(node)\n  let moveNode, moveOffset\n  for (;;) {\n    if (offset < len) {\n      if (node.nodeType != 1) break\n      let after = node.childNodes[offset]\n      if (isIgnorable(after)) {\n        moveNode = node\n        moveOffset = ++offset\n      }\n      else break\n    } else if (isBlockNode(node)) {\n      break\n    } else {\n      let next = node.nextSibling\n      while (next && isIgnorable(next)) {\n        moveNode = next.parentNode\n        moveOffset = domIndex(next) + 1\n        next = next.nextSibling\n      }\n      if (!next) {\n        node = node.parentNode\n        if (node == view.dom) break\n        offset = len = 0\n      } else {\n        node = next\n        offset = 0\n        len = nodeLen(node)\n      }\n    }\n  }\n  if (moveNode) setSelFocus(view, sel, moveNode, moveOffset)\n}\n\nfunction isBlockNode(dom) {\n  let desc = dom.pmViewDesc\n  return desc && desc.node && desc.node.isBlock\n}\n\nfunction setSelFocus(view, sel, node, offset) {\n  if (selectionCollapsed(sel)) {\n    let range = document.createRange()\n    range.setEnd(node, offset)\n    range.setStart(node, offset)\n    sel.removeAllRanges()\n    sel.addRange(range)\n  } else if (sel.extend) {\n    sel.extend(node, offset)\n  }\n  view.domObserver.setCurSelection()\n  let {state} = view\n  // If no state update ends up happening, reset the selection.\n  setTimeout(() => {\n    if (view.state == state) selectionToDOM(view)\n  }, 50)\n}\n\n// : (EditorState, number)\n// Check whether vertical selection motion would involve node\n// selections. If so, apply it (if not, the result is left to the\n// browser)\nfunction selectVertically(view, dir, mods) {\n  let sel = view.state.selection\n  if (sel instanceof TextSelection && !sel.empty || mods.indexOf(\"s\") > -1) return false\n  if (browser.mac && mods.indexOf(\"m\") > -1) return false\n  let {$from, $to} = sel\n\n  if (!$from.parent.inlineContent || view.endOfTextblock(dir < 0 ? \"up\" : \"down\")) {\n    let next = moveSelectionBlock(view.state, dir)\n    if (next && (next instanceof NodeSelection))\n      return apply(view, next)\n  }\n  if (!$from.parent.inlineContent) {\n    let side = dir < 0 ? $from : $to\n    let beyond = sel instanceof AllSelection ? Selection.near(side, dir) : Selection.findFrom(side, dir)\n    return beyond ? apply(view, beyond) : false\n  }\n  return false\n}\n\nfunction stopNativeHorizontalDelete(view, dir) {\n  if (!(view.state.selection instanceof TextSelection)) return true\n  let {$head, $anchor, empty} = view.state.selection\n  if (!$head.sameParent($anchor)) return true\n  if (!empty) return false\n  if (view.endOfTextblock(dir > 0 ? \"forward\" : \"backward\")) return true\n  let nextNode = !$head.textOffset && (dir < 0 ? $head.nodeBefore : $head.nodeAfter)\n  if (nextNode && !nextNode.isText) {\n    let tr = view.state.tr\n    if (dir < 0) tr.delete($head.pos - nextNode.nodeSize, $head.pos)\n    else tr.delete($head.pos, $head.pos + nextNode.nodeSize)\n    view.dispatch(tr)\n    return true\n  }\n  return false\n}\n\nfunction switchEditable(view, node, state) {\n  view.domObserver.stop()\n  node.contentEditable = state\n  view.domObserver.start()\n}\n\n// Issue #867 / #1090 / https://bugs.chromium.org/p/chromium/issues/detail?id=903821\n// In which Safari (and at some point in the past, Chrome) does really\n// wrong things when the down arrow is pressed when the cursor is\n// directly at the start of a textblock and has an uneditable node\n// after it\nfunction safariDownArrowBug(view) {\n  if (!browser.safari || view.state.selection.$head.parentOffset > 0) return\n  let {focusNode, focusOffset} = view.root.getSelection()\n  if (focusNode && focusNode.nodeType == 1 && focusOffset == 0 &&\n      focusNode.firstChild && focusNode.firstChild.contentEditable == \"false\") {\n    let child = focusNode.firstChild\n    switchEditable(view, child, true)\n    setTimeout(() => switchEditable(view, child, false), 20)\n  }\n}\n\n// A backdrop key mapping used to make sure we always suppress keys\n// that have a dangerous default effect, even if the commands they are\n// bound to return false, and to make sure that cursor-motion keys\n// find a cursor (as opposed to a node selection) when pressed. For\n// cursor-motion keys, the code in the handlers also takes care of\n// block selections.\n\nfunction getMods(event) {\n  let result = \"\"\n  if (event.ctrlKey) result += \"c\"\n  if (event.metaKey) result += \"m\"\n  if (event.altKey) result += \"a\"\n  if (event.shiftKey) result += \"s\"\n  return result\n}\n\nexport function captureKeyDown(view, event) {\n  let code = event.keyCode, mods = getMods(event)\n  if (code == 8 || (browser.mac && code == 72 && mods == \"c\")) { // Backspace, Ctrl-h on Mac\n    return stopNativeHorizontalDelete(view, -1) || skipIgnoredNodesLeft(view)\n  } else if (code == 46 || (browser.mac && code == 68 && mods == \"c\")) { // Delete, Ctrl-d on Mac\n    return stopNativeHorizontalDelete(view, 1) || skipIgnoredNodesRight(view)\n  } else if (code == 13 || code == 27) { // Enter, Esc\n    return true\n  } else if (code == 37) { // Left arrow\n    return selectHorizontally(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 39) { // Right arrow\n    return selectHorizontally(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (code == 38) { // Up arrow\n    return selectVertically(view, -1, mods) || skipIgnoredNodesLeft(view)\n  } else if (code == 40) { // Down arrow\n    return safariDownArrowBug(view) || selectVertically(view, 1, mods) || skipIgnoredNodesRight(view)\n  } else if (mods == (browser.mac ? \"m\" : \"c\") &&\n             (code == 66 || code == 73 || code == 89 || code == 90)) { // Mod-[biyz]\n    return true\n  }\n  return false\n}\n","import {Fragment, DOMParser} from \"prosemirror-model\"\nimport {Selection, TextSelection} from \"prosemirror-state\"\n\nimport {selectionBetween, selectionFromDOM, selectionToDOM} from \"./selection\"\nimport {selectionCollapsed, keyEvent} from \"./dom\"\nimport browser from \"./browser\"\n\n// Note that all referencing and parsing is done with the\n// start-of-operation selection and document, since that's the one\n// that the DOM represents. If any changes came in in the meantime,\n// the modification is mapped over those before it is applied, in\n// readDOMChange.\n\nfunction parseBetween(view, from_, to_) {\n  let {node: parent, fromOffset, toOffset, from, to} = view.docView.parseRange(from_, to_)\n\n  let domSel = view.root.getSelection(), find = null, anchor = domSel.anchorNode\n  if (anchor && view.dom.contains(anchor.nodeType == 1 ? anchor : anchor.parentNode)) {\n    find = [{node: anchor, offset: domSel.anchorOffset}]\n    if (!selectionCollapsed(domSel))\n      find.push({node: domSel.focusNode, offset: domSel.focusOffset})\n  }\n  // Work around issue in Chrome where backspacing sometimes replaces\n  // the deleted content with a random BR node (issues #799, #831)\n  if (browser.chrome && view.lastKeyCode === 8) {\n    for (let off = toOffset; off > fromOffset; off--) {\n      let node = parent.childNodes[off - 1], desc = node.pmViewDesc\n      if (node.nodeName == \"BR\" && !desc) { toOffset = off; break }\n      if (!desc || desc.size) break\n    }\n  }\n  let startDoc = view.state.doc\n  let parser = view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema)\n  let $from = startDoc.resolve(from)\n\n  let sel = null, doc = parser.parse(parent, {\n    topNode: $from.parent,\n    topMatch: $from.parent.contentMatchAt($from.index()),\n    topOpen: true,\n    from: fromOffset,\n    to: toOffset,\n    preserveWhitespace: $from.parent.type.whitespace == \"pre\" ? \"full\" : true,\n    editableContent: true,\n    findPositions: find,\n    ruleFromNode,\n    context: $from\n  })\n  if (find && find[0].pos != null) {\n    let anchor = find[0].pos, head = find[1] && find[1].pos\n    if (head == null) head = anchor\n    sel = {anchor: anchor + from, head: head + from}\n  }\n  return {doc, sel, from, to}\n}\n\nfunction ruleFromNode(dom) {\n  let desc = dom.pmViewDesc\n  if (desc) {\n    return desc.parseRule()\n  } else if (dom.nodeName == \"BR\" && dom.parentNode) {\n    // Safari replaces the list item or table cell with a BR\n    // directly in the list node (?!) if you delete the last\n    // character in a list item or table cell (#708, #862)\n    if (browser.safari && /^(ul|ol)$/i.test(dom.parentNode.nodeName)) {\n      let skip = document.createElement(\"div\")\n      skip.appendChild(document.createElement(\"li\"))\n      return {skip}\n    } else if (dom.parentNode.lastChild == dom || browser.safari && /^(tr|table)$/i.test(dom.parentNode.nodeName)) {\n      return {ignore: true}\n    }\n  } else if (dom.nodeName == \"IMG\" && dom.getAttribute(\"mark-placeholder\")) {\n    return {ignore: true}\n  }\n}\n\nexport function readDOMChange(view, from, to, typeOver, addedNodes) {\n  if (from < 0) {\n    let origin = view.lastSelectionTime > Date.now() - 50 ? view.lastSelectionOrigin : null\n    let newSel = selectionFromDOM(view, origin)\n    if (newSel && !view.state.selection.eq(newSel)) {\n      let tr = view.state.tr.setSelection(newSel)\n      if (origin == \"pointer\") tr.setMeta(\"pointer\", true)\n      else if (origin == \"key\") tr.scrollIntoView()\n      view.dispatch(tr)\n    }\n    return\n  }\n\n  let $before = view.state.doc.resolve(from)\n  let shared = $before.sharedDepth(to)\n  from = $before.before(shared + 1)\n  to = view.state.doc.resolve(to).after(shared + 1)\n\n  let sel = view.state.selection\n  let parse = parseBetween(view, from, to)\n\n  // Chrome sometimes leaves the cursor before the inserted text when\n  // composing after a cursor wrapper. This moves it forward.\n  if (browser.chrome && view.cursorWrapper && parse.sel && parse.sel.anchor == view.cursorWrapper.deco.from) {\n    let text = view.cursorWrapper.deco.type.toDOM.nextSibling\n    let size = text && text.nodeValue ? text.nodeValue.length : 1\n    parse.sel = {anchor: parse.sel.anchor + size, head: parse.sel.anchor + size}\n  }\n\n  let doc = view.state.doc, compare = doc.slice(parse.from, parse.to)\n  let preferredPos, preferredSide\n  // Prefer anchoring to end when Backspace is pressed\n  if (view.lastKeyCode === 8 && Date.now() - 100 < view.lastKeyCodeTime) {\n    preferredPos = view.state.selection.to\n    preferredSide = \"end\"\n  } else {\n    preferredPos = view.state.selection.from\n    preferredSide = \"start\"\n  }\n  view.lastKeyCode = null\n\n  let change = findDiff(compare.content, parse.doc.content, parse.from, preferredPos, preferredSide)\n  if ((browser.ios && view.lastIOSEnter > Date.now() - 225 || browser.android) &&\n      addedNodes.some(n => n.nodeName == \"DIV\" || n.nodeName == \"P\") &&\n      (!change || change.endA >= change.endB) &&\n      view.someProp(\"handleKeyDown\", f => f(view, keyEvent(13, \"Enter\")))) {\n    view.lastIOSEnter = 0\n    return\n  }\n  if (!change) {\n    if (typeOver && sel instanceof TextSelection && !sel.empty && sel.$head.sameParent(sel.$anchor) &&\n        !view.composing && !(parse.sel && parse.sel.anchor != parse.sel.head)) {\n      change = {start: sel.from, endA: sel.to, endB: sel.to}\n    } else {\n      if (parse.sel) {\n        let sel = resolveSelection(view, view.state.doc, parse.sel)\n        if (sel && !sel.eq(view.state.selection)) view.dispatch(view.state.tr.setSelection(sel))\n      }\n      return\n    }\n  }\n  view.domChangeCount++\n  // Handle the case where overwriting a selection by typing matches\n  // the start or end of the selected content, creating a change\n  // that's smaller than what was actually overwritten.\n  if (view.state.selection.from < view.state.selection.to &&\n      change.start == change.endB &&\n      view.state.selection instanceof TextSelection) {\n    if (change.start > view.state.selection.from && change.start <= view.state.selection.from + 2 &&\n        view.state.selection.from >= parse.from) {\n      change.start = view.state.selection.from\n    } else if (change.endA < view.state.selection.to && change.endA >= view.state.selection.to - 2 &&\n               view.state.selection.to <= parse.to) {\n      change.endB += (view.state.selection.to - change.endA)\n      change.endA = view.state.selection.to\n    }\n  }\n\n  // IE11 will insert a non-breaking space _ahead_ of the space after\n  // the cursor space when adding a space before another space. When\n  // that happened, adjust the change to cover the space instead.\n  if (browser.ie && browser.ie_version <= 11 && change.endB == change.start + 1 &&\n      change.endA == change.start && change.start > parse.from &&\n      parse.doc.textBetween(change.start - parse.from - 1, change.start - parse.from + 1) == \" \\u00a0\") {\n    change.start--\n    change.endA--\n    change.endB--\n  }\n\n  let $from = parse.doc.resolveNoCache(change.start - parse.from)\n  let $to = parse.doc.resolveNoCache(change.endB - parse.from)\n  let inlineChange = $from.sameParent($to) && $from.parent.inlineContent\n  let nextSel\n  // If this looks like the effect of pressing Enter (or was recorded\n  // as being an iOS enter press), just dispatch an Enter key instead.\n  if (((browser.ios && view.lastIOSEnter > Date.now() - 225 &&\n        (!inlineChange || addedNodes.some(n => n.nodeName == \"DIV\" || n.nodeName == \"P\"))) ||\n       (!inlineChange && $from.pos < parse.doc.content.size &&\n        (nextSel = Selection.findFrom(parse.doc.resolve($from.pos + 1), 1, true)) &&\n        nextSel.head == $to.pos)) &&\n      view.someProp(\"handleKeyDown\", f => f(view, keyEvent(13, \"Enter\")))) {\n    view.lastIOSEnter = 0\n    return\n  }\n  // Same for backspace\n  if (view.state.selection.anchor > change.start &&\n      looksLikeJoin(doc, change.start, change.endA, $from, $to) &&\n      view.someProp(\"handleKeyDown\", f => f(view, keyEvent(8, \"Backspace\")))) {\n    if (browser.android && browser.chrome) view.domObserver.suppressSelectionUpdates() // #820\n    return\n  }\n\n  // Chrome Android will occasionally, during composition, delete the\n  // entire composition and then immediately insert it again. This is\n  // used to detect that situation.\n  if (browser.chrome && browser.android && change.toB == change.from)\n    view.lastAndroidDelete = Date.now()\n\n  // This tries to detect Android virtual keyboard\n  // enter-and-pick-suggestion action. That sometimes (see issue\n  // #1059) first fires a DOM mutation, before moving the selection to\n  // the newly created block. And then, because ProseMirror cleans up\n  // the DOM selection, it gives up moving the selection entirely,\n  // leaving the cursor in the wrong place. When that happens, we drop\n  // the new paragraph from the initial change, and fire a simulated\n  // enter key afterwards.\n  if (browser.android && !inlineChange && $from.start() != $to.start() && $to.parentOffset == 0 && $from.depth == $to.depth &&\n      parse.sel && parse.sel.anchor == parse.sel.head && parse.sel.head == change.endA) {\n    change.endB -= 2\n    $to = parse.doc.resolveNoCache(change.endB - parse.from)\n    setTimeout(() => {\n      view.someProp(\"handleKeyDown\", function (f) { return f(view, keyEvent(13, \"Enter\")); })\n    }, 20)\n  }\n\n  let chFrom = change.start, chTo = change.endA\n\n  let tr, storedMarks, markChange, $from1\n  if (inlineChange) {\n    if ($from.pos == $to.pos) { // Deletion\n      // IE11 sometimes weirdly moves the DOM selection around after\n      // backspacing out the first element in a textblock\n      if (browser.ie && browser.ie_version <= 11 && $from.parentOffset == 0) {\n        view.domObserver.suppressSelectionUpdates()\n        setTimeout(() => selectionToDOM(view), 20)\n      }\n      tr = view.state.tr.delete(chFrom, chTo)\n      storedMarks = doc.resolve(change.start).marksAcross(doc.resolve(change.endA))\n    } else if ( // Adding or removing a mark\n      change.endA == change.endB && ($from1 = doc.resolve(change.start)) &&\n      (markChange = isMarkChange($from.parent.content.cut($from.parentOffset, $to.parentOffset),\n                                 $from1.parent.content.cut($from1.parentOffset, change.endA - $from1.start())))\n    ) {\n      tr = view.state.tr\n      if (markChange.type == \"add\") tr.addMark(chFrom, chTo, markChange.mark)\n      else tr.removeMark(chFrom, chTo, markChange.mark)\n    } else if ($from.parent.child($from.index()).isText && $from.index() == $to.index() - ($to.textOffset ? 0 : 1)) {\n      // Both positions in the same text node -- simply insert text\n      let text = $from.parent.textBetween($from.parentOffset, $to.parentOffset)\n      if (view.someProp(\"handleTextInput\", f => f(view, chFrom, chTo, text))) return\n      tr = view.state.tr.insertText(text, chFrom, chTo)\n    }\n  }\n\n  if (!tr)\n    tr = view.state.tr.replace(chFrom, chTo, parse.doc.slice(change.start - parse.from, change.endB - parse.from))\n  if (parse.sel) {\n    let sel = resolveSelection(view, tr.doc, parse.sel)\n    // Chrome Android will sometimes, during composition, report the\n    // selection in the wrong place. If it looks like that is\n    // happening, don't update the selection.\n    // Edge just doesn't move the cursor forward when you start typing\n    // in an empty block or between br nodes.\n    if (sel && !(browser.chrome && browser.android && view.composing && sel.empty &&\n                 (change.start != change.endB || view.lastAndroidDelete < Date.now() - 100) &&\n                 (sel.head == chFrom || sel.head == tr.mapping.map(chTo) - 1) ||\n                 browser.ie && sel.empty && sel.head == chFrom))\n      tr.setSelection(sel)\n  }\n  if (storedMarks) tr.ensureMarks(storedMarks)\n  view.dispatch(tr.scrollIntoView())\n}\n\nfunction resolveSelection(view, doc, parsedSel) {\n  if (Math.max(parsedSel.anchor, parsedSel.head) > doc.content.size) return null\n  return selectionBetween(view, doc.resolve(parsedSel.anchor), doc.resolve(parsedSel.head))\n}\n\n// : (Fragment, Fragment) → ?{mark: Mark, type: string}\n// Given two same-length, non-empty fragments of inline content,\n// determine whether the first could be created from the second by\n// removing or adding a single mark type.\nfunction isMarkChange(cur, prev) {\n  let curMarks = cur.firstChild.marks, prevMarks = prev.firstChild.marks\n  let added = curMarks, removed = prevMarks, type, mark, update\n  for (let i = 0; i < prevMarks.length; i++) added = prevMarks[i].removeFromSet(added)\n  for (let i = 0; i < curMarks.length; i++) removed = curMarks[i].removeFromSet(removed)\n  if (added.length == 1 && removed.length == 0) {\n    mark = added[0]\n    type = \"add\"\n    update = node => node.mark(mark.addToSet(node.marks))\n  } else if (added.length == 0 && removed.length == 1) {\n    mark = removed[0]\n    type = \"remove\"\n    update = node => node.mark(mark.removeFromSet(node.marks))\n  } else {\n    return null\n  }\n  let updated = []\n  for (let i = 0; i < prev.childCount; i++) updated.push(update(prev.child(i)))\n  if (Fragment.from(updated).eq(cur)) return {mark, type}\n}\n\nfunction looksLikeJoin(old, start, end, $newStart, $newEnd) {\n  if (!$newStart.parent.isTextblock ||\n      // The content must have shrunk\n      end - start <= $newEnd.pos - $newStart.pos ||\n      // newEnd must point directly at or after the end of the block that newStart points into\n      skipClosingAndOpening($newStart, true, false) < $newEnd.pos)\n    return false\n\n  let $start = old.resolve(start)\n  // Start must be at the end of a block\n  if ($start.parentOffset < $start.parent.content.size || !$start.parent.isTextblock)\n    return false\n  let $next = old.resolve(skipClosingAndOpening($start, true, true))\n  // The next textblock must start before end and end near it\n  if (!$next.parent.isTextblock || $next.pos > end ||\n      skipClosingAndOpening($next, true, false) < end)\n    return false\n\n  // The fragments after the join point must match\n  return $newStart.parent.content.cut($newStart.parentOffset).eq($next.parent.content)\n}\n\nfunction skipClosingAndOpening($pos, fromEnd, mayOpen) {\n  let depth = $pos.depth, end = fromEnd ? $pos.end() : $pos.pos\n  while (depth > 0 && (fromEnd || $pos.indexAfter(depth) == $pos.node(depth).childCount)) {\n    depth--\n    end++\n    fromEnd = false\n  }\n  if (mayOpen) {\n    let next = $pos.node(depth).maybeChild($pos.indexAfter(depth))\n    while (next && !next.isLeaf) {\n      next = next.firstChild\n      end++\n    }\n  }\n  return end\n}\n\nfunction findDiff(a, b, pos, preferredPos, preferredSide) {\n  let start = a.findDiffStart(b, pos)\n  if (start == null) return null\n  let {a: endA, b: endB} = a.findDiffEnd(b, pos + a.size, pos + b.size)\n  if (preferredSide == \"end\") {\n    let adjust = Math.max(0, start - Math.min(endA, endB))\n    preferredPos -= endA + adjust - start\n  }\n  if (endA < start && a.size < b.size) {\n    let move = preferredPos <= start && preferredPos >= endA ? start - preferredPos : 0\n    start -= move\n    endB = start + (endB - endA)\n    endA = start\n  } else if (endB < start) {\n    let move = preferredPos <= start && preferredPos >= endB ? start - preferredPos : 0\n    start -= move\n    endA = start + (endA - endB)\n    endB = start\n  }\n  return {start, endA, endB}\n}\n","import {Slice, Fragment, DOMParser, DOMSerializer} from \"prosemirror-model\"\nimport browser from \"./browser\"\n\nexport function serializeForClipboard(view, slice) {\n  let context = [], {content, openStart, openEnd} = slice\n  while (openStart > 1 && openEnd > 1 && content.childCount == 1 && content.firstChild.childCount == 1) {\n    openStart--\n    openEnd--\n    let node = content.firstChild\n    context.push(node.type.name, node.attrs != node.type.defaultAttrs ? node.attrs : null)\n    content = node.content\n  }\n\n  let serializer = view.someProp(\"clipboardSerializer\") || DOMSerializer.fromSchema(view.state.schema)\n  let doc = detachedDoc(), wrap = doc.createElement(\"div\")\n  wrap.appendChild(serializer.serializeFragment(content, {document: doc}))\n\n  let firstChild = wrap.firstChild, needsWrap\n  while (firstChild && firstChild.nodeType == 1 && (needsWrap = wrapMap[firstChild.nodeName.toLowerCase()])) {\n    for (let i = needsWrap.length - 1; i >= 0; i--) {\n      let wrapper = doc.createElement(needsWrap[i])\n      while (wrap.firstChild) wrapper.appendChild(wrap.firstChild)\n      wrap.appendChild(wrapper)\n      if (needsWrap[i] != \"tbody\") {\n        openStart++\n        openEnd++\n      }\n    }\n    firstChild = wrap.firstChild\n  }\n\n  if (firstChild && firstChild.nodeType == 1)\n    firstChild.setAttribute(\"data-pm-slice\", `${openStart} ${openEnd} ${JSON.stringify(context)}`)\n\n  let text = view.someProp(\"clipboardTextSerializer\", f => f(slice)) ||\n      slice.content.textBetween(0, slice.content.size, \"\\n\\n\")\n\n  return {dom: wrap, text}\n}\n\n// : (EditorView, string, string, ?bool, ResolvedPos) → ?Slice\n// Read a slice of content from the clipboard (or drop data).\nexport function parseFromClipboard(view, text, html, plainText, $context) {\n  let dom, inCode = $context.parent.type.spec.code, slice\n  if (!html && !text) return null\n  let asText = text && (plainText || inCode || !html)\n  if (asText) {\n    view.someProp(\"transformPastedText\", f => { text = f(text, inCode || plainText) })\n    if (inCode) return text ? new Slice(Fragment.from(view.state.schema.text(text.replace(/\\r\\n?/g, \"\\n\"))), 0, 0) : Slice.empty\n    let parsed = view.someProp(\"clipboardTextParser\", f => f(text, $context, plainText))\n    if (parsed) {\n      slice = parsed\n    } else {\n      let marks = $context.marks()\n      let {schema} = view.state, serializer = DOMSerializer.fromSchema(schema)\n      dom = document.createElement(\"div\")\n      text.split(/(?:\\r\\n?|\\n)+/).forEach(block => {\n        let p = dom.appendChild(document.createElement(\"p\"))\n        if (block) p.appendChild(serializer.serializeNode(schema.text(block, marks)))\n      })\n    }\n  } else {\n    view.someProp(\"transformPastedHTML\", f => { html = f(html) })\n    dom = readHTML(html)\n    if (browser.webkit) restoreReplacedSpaces(dom)\n  }\n\n  let contextNode = dom && dom.querySelector(\"[data-pm-slice]\")\n  let sliceData = contextNode && /^(\\d+) (\\d+) (.*)/.exec(contextNode.getAttribute(\"data-pm-slice\"))\n  if (!slice) {\n    let parser = view.someProp(\"clipboardParser\") || view.someProp(\"domParser\") || DOMParser.fromSchema(view.state.schema)\n    slice = parser.parseSlice(dom, {\n      preserveWhitespace: !!(asText || sliceData),\n      context: $context,\n      ruleFromNode(dom) {\n        if (dom.nodeName == \"BR\" && !dom.nextSibling &&\n            dom.parentNode && !inlineParents.test(dom.parentNode.nodeName)) return {ignore: true}\n      }\n    })\n  }\n  if (sliceData) {\n    slice = addContext(closeSlice(slice, +sliceData[1], +sliceData[2]), sliceData[3])\n  } else { // HTML wasn't created by ProseMirror. Make sure top-level siblings are coherent\n    slice = Slice.maxOpen(normalizeSiblings(slice.content, $context), true)\n    if (slice.openStart || slice.openEnd) {\n      let openStart = 0, openEnd = 0\n      for (let node = slice.content.firstChild; openStart < slice.openStart && !node.type.spec.isolating;\n           openStart++, node = node.firstChild) {}\n      for (let node = slice.content.lastChild; openEnd < slice.openEnd && !node.type.spec.isolating;\n           openEnd++, node = node.lastChild) {}\n      slice = closeSlice(slice, openStart, openEnd)\n    }\n  }\n\n  view.someProp(\"transformPasted\", f => { slice = f(slice) })\n  return slice\n}\n\nconst inlineParents = /^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i\n\n// Takes a slice parsed with parseSlice, which means there hasn't been\n// any content-expression checking done on the top nodes, tries to\n// find a parent node in the current context that might fit the nodes,\n// and if successful, rebuilds the slice so that it fits into that parent.\n//\n// This addresses the problem that Transform.replace expects a\n// coherent slice, and will fail to place a set of siblings that don't\n// fit anywhere in the schema.\nfunction normalizeSiblings(fragment, $context) {\n  if (fragment.childCount < 2) return fragment\n  for (let d = $context.depth; d >= 0; d--) {\n    let parent = $context.node(d)\n    let match = parent.contentMatchAt($context.index(d))\n    let lastWrap, result = []\n    fragment.forEach(node => {\n      if (!result) return\n      let wrap = match.findWrapping(node.type), inLast\n      if (!wrap) return result = null\n      if (inLast = result.length && lastWrap.length && addToSibling(wrap, lastWrap, node, result[result.length - 1], 0)) {\n        result[result.length - 1] = inLast\n      } else {\n        if (result.length) result[result.length - 1] = closeRight(result[result.length - 1], lastWrap.length)\n        let wrapped = withWrappers(node, wrap)\n        result.push(wrapped)\n        match = match.matchType(wrapped.type, wrapped.attrs)\n        lastWrap = wrap\n      }\n    })\n    if (result) return Fragment.from(result)\n  }\n  return fragment\n}\n\nfunction withWrappers(node, wrap, from = 0) {\n  for (let i = wrap.length - 1; i >= from; i--)\n    node = wrap[i].create(null, Fragment.from(node))\n  return node\n}\n\n// Used to group adjacent nodes wrapped in similar parents by\n// normalizeSiblings into the same parent node\nfunction addToSibling(wrap, lastWrap, node, sibling, depth) {\n  if (depth < wrap.length && depth < lastWrap.length && wrap[depth] == lastWrap[depth]) {\n    let inner = addToSibling(wrap, lastWrap, node, sibling.lastChild, depth + 1)\n    if (inner) return sibling.copy(sibling.content.replaceChild(sibling.childCount - 1, inner))\n    let match = sibling.contentMatchAt(sibling.childCount)\n    if (match.matchType(depth == wrap.length - 1 ? node.type : wrap[depth + 1]))\n      return sibling.copy(sibling.content.append(Fragment.from(withWrappers(node, wrap, depth + 1))))\n  }\n}\n\nfunction closeRight(node, depth) {\n  if (depth == 0) return node\n  let fragment = node.content.replaceChild(node.childCount - 1, closeRight(node.lastChild, depth - 1))\n  let fill = node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true)\n  return node.copy(fragment.append(fill))\n}\n\nfunction closeRange(fragment, side, from, to, depth, openEnd) {\n  let node = side < 0 ? fragment.firstChild : fragment.lastChild, inner = node.content\n  if (depth < to - 1) inner = closeRange(inner, side, from, to, depth + 1, openEnd)\n  if (depth >= from)\n    inner = side < 0 ? node.contentMatchAt(0).fillBefore(inner, fragment.childCount > 1 || openEnd <= depth).append(inner)\n      : inner.append(node.contentMatchAt(node.childCount).fillBefore(Fragment.empty, true))\n  return fragment.replaceChild(side < 0 ? 0 : fragment.childCount - 1, node.copy(inner))\n}\n\nfunction closeSlice(slice, openStart, openEnd) {\n  if (openStart < slice.openStart)\n    slice = new Slice(closeRange(slice.content, -1, openStart, slice.openStart, 0, slice.openEnd), openStart, slice.openEnd)\n  if (openEnd < slice.openEnd)\n    slice = new Slice(closeRange(slice.content, 1, openEnd, slice.openEnd, 0, 0), slice.openStart, openEnd)\n  return slice\n}\n\n// Trick from jQuery -- some elements must be wrapped in other\n// elements for innerHTML to work. I.e. if you do `div.innerHTML =\n// \"<td>..</td>\"` the table cells are ignored.\nconst wrapMap = {\n  thead: [\"table\"],\n  tbody: [\"table\"],\n  tfoot: [\"table\"],\n  caption: [\"table\"],\n  colgroup: [\"table\"],\n  col: [\"table\", \"colgroup\"],\n  tr: [\"table\", \"tbody\"],\n  td: [\"table\", \"tbody\", \"tr\"],\n  th: [\"table\", \"tbody\", \"tr\"]\n}\n\nlet _detachedDoc = null\nfunction detachedDoc() {\n  return _detachedDoc || (_detachedDoc = document.implementation.createHTMLDocument(\"title\"))\n}\n\nfunction readHTML(html) {\n  let metas = /^(\\s*<meta [^>]*>)*/.exec(html)\n  if (metas) html = html.slice(metas[0].length)\n  let elt = detachedDoc().createElement(\"div\")\n  let firstTag = /<([a-z][^>\\s]+)/i.exec(html), wrap\n  if (wrap = firstTag && wrapMap[firstTag[1].toLowerCase()])\n    html = wrap.map(n => \"<\" + n + \">\").join(\"\") + html + wrap.map(n => \"</\" + n + \">\").reverse().join(\"\")\n  elt.innerHTML = html\n  if (wrap) for (let i = 0; i < wrap.length; i++) elt = elt.querySelector(wrap[i]) || elt\n  return elt\n}\n\n// Webkit browsers do some hard-to-predict replacement of regular\n// spaces with non-breaking spaces when putting content on the\n// clipboard. This tries to convert such non-breaking spaces (which\n// will be wrapped in a plain span on Chrome, a span with class\n// Apple-converted-space on Safari) back to regular spaces.\nfunction restoreReplacedSpaces(dom) {\n  let nodes = dom.querySelectorAll(browser.chrome ? \"span:not([class]):not([style])\" : \"span.Apple-converted-space\")\n  for (let i = 0; i < nodes.length; i++) {\n    let node = nodes[i]\n    if (node.childNodes.length == 1 && node.textContent == \"\\u00a0\" && node.parentNode)\n      node.parentNode.replaceChild(dom.ownerDocument.createTextNode(\" \"), node)\n  }\n}\n\nfunction addContext(slice, context) {\n  if (!slice.size) return slice\n  let schema = slice.content.firstChild.type.schema, array\n  try { array = JSON.parse(context) }\n  catch(e) { return slice }\n  let {content, openStart, openEnd} = slice\n  for (let i = array.length - 2; i >= 0; i -= 2) {\n    let type = schema.nodes[array[i]]\n    if (!type || type.hasRequiredAttrs()) break\n    content = Fragment.from(type.create(array[i + 1], content))\n    openStart++; openEnd++\n  }\n  return new Slice(content, openStart, openEnd)\n}\n","import browser from \"./browser\"\nimport {domIndex, isEquivalentPosition} from \"./dom\"\nimport {hasFocusAndSelection, hasSelection, selectionToDOM} from \"./selection\"\n\nconst observeOptions = {\n  childList: true,\n  characterData: true,\n  characterDataOldValue: true,\n  attributes: true,\n  attributeOldValue: true,\n  subtree: true\n}\n// IE11 has very broken mutation observers, so we also listen to DOMCharacterDataModified\nconst useCharData = browser.ie && browser.ie_version <= 11\n\nclass SelectionState {\n  constructor() {\n    this.anchorNode = this.anchorOffset = this.focusNode = this.focusOffset = null\n  }\n\n  set(sel) {\n    this.anchorNode = sel.anchorNode; this.anchorOffset = sel.anchorOffset\n    this.focusNode = sel.focusNode; this.focusOffset = sel.focusOffset\n  }\n\n  eq(sel) {\n    return sel.anchorNode == this.anchorNode && sel.anchorOffset == this.anchorOffset &&\n      sel.focusNode == this.focusNode && sel.focusOffset == this.focusOffset\n  }\n}\n\nexport class DOMObserver {\n  constructor(view, handleDOMChange) {\n    this.view = view\n    this.handleDOMChange = handleDOMChange\n    this.queue = []\n    this.flushingSoon = -1\n    this.observer = window.MutationObserver &&\n      new window.MutationObserver(mutations => {\n        for (let i = 0; i < mutations.length; i++) this.queue.push(mutations[i])\n        // IE11 will sometimes (on backspacing out a single character\n        // text node after a BR node) call the observer callback\n        // before actually updating the DOM, which will cause\n        // ProseMirror to miss the change (see #930)\n        if (browser.ie && browser.ie_version <= 11 && mutations.some(\n          m => m.type == \"childList\" && m.removedNodes.length ||\n               m.type == \"characterData\" && m.oldValue.length > m.target.nodeValue.length))\n          this.flushSoon()\n        else\n          this.flush()\n      })\n    this.currentSelection = new SelectionState\n    if (useCharData) {\n      this.onCharData = e => {\n        this.queue.push({target: e.target, type: \"characterData\", oldValue: e.prevValue})\n        this.flushSoon()\n      }\n    }\n    this.onSelectionChange = this.onSelectionChange.bind(this)\n    this.suppressingSelectionUpdates = false\n  }\n\n  flushSoon() {\n    if (this.flushingSoon < 0)\n      this.flushingSoon = window.setTimeout(() => { this.flushingSoon = -1; this.flush() }, 20)\n  }\n\n  forceFlush() {\n    if (this.flushingSoon > -1) {\n      window.clearTimeout(this.flushingSoon)\n      this.flushingSoon = -1\n      this.flush()\n    }\n  }\n\n  start() {\n    if (this.observer)\n      this.observer.observe(this.view.dom, observeOptions)\n    if (useCharData)\n      this.view.dom.addEventListener(\"DOMCharacterDataModified\", this.onCharData)\n    this.connectSelection()\n  }\n\n  stop() {\n    if (this.observer) {\n      let take = this.observer.takeRecords()\n      if (take.length) {\n        for (let i = 0; i < take.length; i++) this.queue.push(take[i])\n        window.setTimeout(() => this.flush(), 20)\n      }\n      this.observer.disconnect()\n    }\n    if (useCharData) this.view.dom.removeEventListener(\"DOMCharacterDataModified\", this.onCharData)\n    this.disconnectSelection()\n  }\n\n  connectSelection() {\n    this.view.dom.ownerDocument.addEventListener(\"selectionchange\", this.onSelectionChange)\n  }\n\n  disconnectSelection() {\n    this.view.dom.ownerDocument.removeEventListener(\"selectionchange\", this.onSelectionChange)\n  }\n\n  suppressSelectionUpdates() {\n    this.suppressingSelectionUpdates = true\n    setTimeout(() => this.suppressingSelectionUpdates = false, 50)\n  }\n\n  onSelectionChange() {\n    if (!hasFocusAndSelection(this.view)) return\n    if (this.suppressingSelectionUpdates) return selectionToDOM(this.view)\n    // Deletions on IE11 fire their events in the wrong order, giving\n    // us a selection change event before the DOM changes are\n    // reported.\n    if (browser.ie && browser.ie_version <= 11 && !this.view.state.selection.empty) {\n      let sel = this.view.root.getSelection()\n      // Selection.isCollapsed isn't reliable on IE\n      if (sel.focusNode && isEquivalentPosition(sel.focusNode, sel.focusOffset, sel.anchorNode, sel.anchorOffset))\n        return this.flushSoon()\n    }\n    this.flush()\n  }\n\n  setCurSelection() {\n    this.currentSelection.set(this.view.root.getSelection())\n  }\n\n  ignoreSelectionChange(sel) {\n    if (sel.rangeCount == 0) return true\n    let container = sel.getRangeAt(0).commonAncestorContainer\n    let desc = this.view.docView.nearestDesc(container)\n    if (desc && desc.ignoreMutation({type: \"selection\", target: container.nodeType == 3 ? container.parentNode : container})) {\n      this.setCurSelection()\n      return true\n    }\n  }\n\n  flush() {\n    if (!this.view.docView || this.flushingSoon > -1) return\n    let mutations = this.observer ? this.observer.takeRecords() : []\n    if (this.queue.length) {\n      mutations = this.queue.concat(mutations)\n      this.queue.length = 0\n    }\n\n    let sel = this.view.root.getSelection()\n    let newSel = !this.suppressingSelectionUpdates && !this.currentSelection.eq(sel) && hasSelection(this.view) && !this.ignoreSelectionChange(sel)\n\n    let from = -1, to = -1, typeOver = false, added = []\n    if (this.view.editable) {\n      for (let i = 0; i < mutations.length; i++) {\n        let result = this.registerMutation(mutations[i], added)\n        if (result) {\n          from = from < 0 ? result.from : Math.min(result.from, from)\n          to = to < 0 ? result.to : Math.max(result.to, to)\n          if (result.typeOver) typeOver = true\n        }\n      }\n    }\n\n    if (browser.gecko && added.length > 1) {\n      let brs = added.filter(n => n.nodeName == \"BR\")\n      if (brs.length == 2) {\n        let [a, b] = brs\n        if (a.parentNode && a.parentNode.parentNode == b.parentNode) b.remove()\n        else a.remove()\n      }\n    }\n\n    if (from > -1 || newSel) {\n      if (from > -1) {\n        this.view.docView.markDirty(from, to)\n        checkCSS(this.view)\n      }\n      this.handleDOMChange(from, to, typeOver, added)\n      if (this.view.docView && this.view.docView.dirty) this.view.updateState(this.view.state)\n      else if (!this.currentSelection.eq(sel)) selectionToDOM(this.view)\n      this.currentSelection.set(sel)\n    }\n  }\n\n  registerMutation(mut, added) {\n    // Ignore mutations inside nodes that were already noted as inserted\n    if (added.indexOf(mut.target) > -1) return null\n    let desc = this.view.docView.nearestDesc(mut.target)\n    if (mut.type == \"attributes\" &&\n        (desc == this.view.docView || mut.attributeName == \"contenteditable\" ||\n         // Firefox sometimes fires spurious events for null/empty styles\n         (mut.attributeName == \"style\" && !mut.oldValue && !mut.target.getAttribute(\"style\"))))\n      return null\n    if (!desc || desc.ignoreMutation(mut)) return null\n\n    if (mut.type == \"childList\") {\n      for (let i = 0; i < mut.addedNodes.length; i++) added.push(mut.addedNodes[i])\n      if (desc.contentDOM && desc.contentDOM != desc.dom && !desc.contentDOM.contains(mut.target))\n        return {from: desc.posBefore, to: desc.posAfter}\n      let prev = mut.previousSibling, next = mut.nextSibling\n      if (browser.ie && browser.ie_version <= 11 && mut.addedNodes.length) {\n        // IE11 gives us incorrect next/prev siblings for some\n        // insertions, so if there are added nodes, recompute those\n        for (let i = 0; i < mut.addedNodes.length; i++) {\n          let {previousSibling, nextSibling} = mut.addedNodes[i]\n          if (!previousSibling || Array.prototype.indexOf.call(mut.addedNodes, previousSibling) < 0) prev = previousSibling\n          if (!nextSibling || Array.prototype.indexOf.call(mut.addedNodes, nextSibling) < 0) next = nextSibling\n        }\n      }\n      let fromOffset = prev && prev.parentNode == mut.target\n          ? domIndex(prev) + 1 : 0\n      let from = desc.localPosFromDOM(mut.target, fromOffset, -1)\n      let toOffset = next && next.parentNode == mut.target\n          ? domIndex(next) : mut.target.childNodes.length\n      let to = desc.localPosFromDOM(mut.target, toOffset, 1)\n      return {from, to}\n    } else if (mut.type == \"attributes\") {\n      return {from: desc.posAtStart - desc.border, to: desc.posAtEnd + desc.border}\n    } else { // \"characterData\"\n      return {\n        from: desc.posAtStart,\n        to: desc.posAtEnd,\n        // An event was generated for a text change that didn't change\n        // any text. Mark the dom change to fall back to assuming the\n        // selection was typed over with an identical value if it can't\n        // find another change.\n        typeOver: mut.target.nodeValue == mut.oldValue\n      }\n    }\n  }\n}\n\nlet cssChecked = false\n\nfunction checkCSS(view) {\n  if (cssChecked) return\n  cssChecked = true\n  if (getComputedStyle(view.dom).whiteSpace == \"normal\")\n    console[\"warn\"](\"ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package.\")\n}\n","import {Selection, NodeSelection, TextSelection} from \"prosemirror-state\"\nimport {dropPoint} from \"prosemirror-transform\"\nimport {Slice} from \"prosemirror-model\"\n\nimport browser from \"./browser\"\nimport {captureKeyDown} from \"./capturekeys\"\nimport {readDOMChange} from \"./domchange\"\nimport {parseFromClipboard, serializeForClipboard} from \"./clipboard\"\nimport {DOMObserver} from \"./domobserver\"\nimport {selectionBetween, selectionToDOM, selectionFromDOM} from \"./selection\"\nimport {keyEvent} from \"./dom\"\n\n// A collection of DOM events that occur within the editor, and callback functions\n// to invoke when the event fires.\nconst handlers = {}, editHandlers = {}\n\nexport function initInput(view) {\n  view.shiftKey = false\n  view.mouseDown = null\n  view.lastKeyCode = null\n  view.lastKeyCodeTime = 0\n  view.lastClick = {time: 0, x: 0, y: 0, type: \"\"}\n  view.lastSelectionOrigin = null\n  view.lastSelectionTime = 0\n\n  view.lastIOSEnter = 0\n  view.lastIOSEnterFallbackTimeout = null\n  view.lastAndroidDelete = 0\n\n  view.composing = false\n  view.composingTimeout = null\n  view.compositionNodes = []\n  view.compositionEndedAt = -2e8\n\n  view.domObserver = new DOMObserver(view, (from, to, typeOver, added) => readDOMChange(view, from, to, typeOver, added))\n  view.domObserver.start()\n  // Used by hacks like the beforeinput handler to check whether anything happened in the DOM\n  view.domChangeCount = 0\n\n  view.eventHandlers = Object.create(null)\n  for (let event in handlers) {\n    let handler = handlers[event]\n    view.dom.addEventListener(event, view.eventHandlers[event] = event => {\n      if (eventBelongsToView(view, event) && !runCustomHandler(view, event) &&\n          (view.editable || !(event.type in editHandlers)))\n        handler(view, event)\n    })\n  }\n  // On Safari, for reasons beyond my understanding, adding an input\n  // event handler makes an issue where the composition vanishes when\n  // you press enter go away.\n  if (browser.safari) view.dom.addEventListener(\"input\", () => null)\n\n  ensureListeners(view)\n}\n\nfunction setSelectionOrigin(view, origin) {\n  view.lastSelectionOrigin = origin\n  view.lastSelectionTime = Date.now()\n}\n\nexport function destroyInput(view) {\n  view.domObserver.stop()\n  for (let type in view.eventHandlers)\n    view.dom.removeEventListener(type, view.eventHandlers[type])\n  clearTimeout(view.composingTimeout)\n  clearTimeout(view.lastIOSEnterFallbackTimeout)\n}\n\nexport function ensureListeners(view) {\n  view.someProp(\"handleDOMEvents\", currentHandlers => {\n    for (let type in currentHandlers) if (!view.eventHandlers[type])\n      view.dom.addEventListener(type, view.eventHandlers[type] = event => runCustomHandler(view, event))\n  })\n}\n\nfunction runCustomHandler(view, event) {\n  return view.someProp(\"handleDOMEvents\", handlers => {\n    let handler = handlers[event.type]\n    return handler ? handler(view, event) || event.defaultPrevented : false\n  })\n}\n\nfunction eventBelongsToView(view, event) {\n  if (!event.bubbles) return true\n  if (event.defaultPrevented) return false\n  for (let node = event.target; node != view.dom; node = node.parentNode)\n    if (!node || node.nodeType == 11 ||\n        (node.pmViewDesc && node.pmViewDesc.stopEvent(event)))\n      return false\n  return true\n}\n\nexport function dispatchEvent(view, event) {\n  if (!runCustomHandler(view, event) && handlers[event.type] &&\n      (view.editable || !(event.type in editHandlers)))\n    handlers[event.type](view, event)\n}\n\neditHandlers.keydown = (view, event) => {\n  view.shiftKey = event.keyCode == 16 || event.shiftKey\n  if (inOrNearComposition(view, event)) return\n  view.lastKeyCode = event.keyCode\n  view.lastKeyCodeTime = Date.now()\n  // Suppress enter key events on Chrome Android, because those tend\n  // to be part of a confused sequence of composition events fired,\n  // and handling them eagerly tends to corrupt the input.\n  if (browser.android && browser.chrome && event.keyCode == 13) return\n  if (event.keyCode != 229) view.domObserver.forceFlush()\n\n  // On iOS, if we preventDefault enter key presses, the virtual\n  // keyboard gets confused. So the hack here is to set a flag that\n  // makes the DOM change code recognize that what just happens should\n  // be replaced by whatever the Enter key handlers do.\n  if (browser.ios && event.keyCode == 13 && !event.ctrlKey && !event.altKey && !event.metaKey) {\n    let now = Date.now()\n    view.lastIOSEnter = now\n    view.lastIOSEnterFallbackTimeout = setTimeout(() => {\n      if (view.lastIOSEnter == now) {\n        view.someProp(\"handleKeyDown\", f => f(view, keyEvent(13, \"Enter\")))\n        view.lastIOSEnter = 0\n      }\n    }, 200)\n  } else if (view.someProp(\"handleKeyDown\", f => f(view, event)) || captureKeyDown(view, event)) {\n    event.preventDefault()\n  } else {\n    setSelectionOrigin(view, \"key\")\n  }\n}\n\neditHandlers.keyup = (view, e) => {\n  if (e.keyCode == 16) view.shiftKey = false\n}\n\neditHandlers.keypress = (view, event) => {\n  if (inOrNearComposition(view, event) || !event.charCode ||\n      event.ctrlKey && !event.altKey || browser.mac && event.metaKey) return\n\n  if (view.someProp(\"handleKeyPress\", f => f(view, event))) {\n    event.preventDefault()\n    return\n  }\n\n  let sel = view.state.selection\n  if (!(sel instanceof TextSelection) || !sel.$from.sameParent(sel.$to)) {\n    let text = String.fromCharCode(event.charCode)\n    if (!view.someProp(\"handleTextInput\", f => f(view, sel.$from.pos, sel.$to.pos, text)))\n      view.dispatch(view.state.tr.insertText(text).scrollIntoView())\n    event.preventDefault()\n  }\n}\n\nfunction eventCoords(event) { return {left: event.clientX, top: event.clientY} }\n\nfunction isNear(event, click) {\n  let dx = click.x - event.clientX, dy = click.y - event.clientY\n  return dx * dx + dy * dy < 100\n}\n\nfunction runHandlerOnContext(view, propName, pos, inside, event) {\n  if (inside == -1) return false\n  let $pos = view.state.doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    if (view.someProp(propName, f => i > $pos.depth ? f(view, pos, $pos.nodeAfter, $pos.before(i), event, true)\n                                                    : f(view, pos, $pos.node(i), $pos.before(i), event, false)))\n      return true\n  }\n  return false\n}\n\nfunction updateSelection(view, selection, origin) {\n  if (!view.focused) view.focus()\n  let tr = view.state.tr.setSelection(selection)\n  if (origin == \"pointer\") tr.setMeta(\"pointer\", true)\n  view.dispatch(tr)\n}\n\nfunction selectClickedLeaf(view, inside) {\n  if (inside == -1) return false\n  let $pos = view.state.doc.resolve(inside), node = $pos.nodeAfter\n  if (node && node.isAtom && NodeSelection.isSelectable(node)) {\n    updateSelection(view, new NodeSelection($pos), \"pointer\")\n    return true\n  }\n  return false\n}\n\nfunction selectClickedNode(view, inside) {\n  if (inside == -1) return false\n  let sel = view.state.selection, selectedNode, selectAt\n  if (sel instanceof NodeSelection) selectedNode = sel.node\n\n  let $pos = view.state.doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    let node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i)\n    if (NodeSelection.isSelectable(node)) {\n      if (selectedNode && sel.$from.depth > 0 &&\n          i >= sel.$from.depth && $pos.before(sel.$from.depth + 1) == sel.$from.pos)\n        selectAt = $pos.before(sel.$from.depth)\n      else\n        selectAt = $pos.before(i)\n      break\n    }\n  }\n\n  if (selectAt != null) {\n    updateSelection(view, NodeSelection.create(view.state.doc, selectAt), \"pointer\")\n    return true\n  } else {\n    return false\n  }\n}\n\nfunction handleSingleClick(view, pos, inside, event, selectNode) {\n  return runHandlerOnContext(view, \"handleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleClick\", f => f(view, pos, event)) ||\n    (selectNode ? selectClickedNode(view, inside) : selectClickedLeaf(view, inside))\n}\n\nfunction handleDoubleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleDoubleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleDoubleClick\", f => f(view, pos, event))\n}\n\nfunction handleTripleClick(view, pos, inside, event) {\n  return runHandlerOnContext(view, \"handleTripleClickOn\", pos, inside, event) ||\n    view.someProp(\"handleTripleClick\", f => f(view, pos, event)) ||\n    defaultTripleClick(view, inside, event)\n}\n\nfunction defaultTripleClick(view, inside, event) {\n  if (event.button != 0) return false\n  let doc = view.state.doc\n  if (inside == -1) {\n    if (doc.inlineContent) {\n      updateSelection(view, TextSelection.create(doc, 0, doc.content.size), \"pointer\")\n      return true\n    }\n    return false\n  }\n\n  let $pos = doc.resolve(inside)\n  for (let i = $pos.depth + 1; i > 0; i--) {\n    let node = i > $pos.depth ? $pos.nodeAfter : $pos.node(i)\n    let nodePos = $pos.before(i)\n    if (node.inlineContent)\n      updateSelection(view, TextSelection.create(doc, nodePos + 1, nodePos + 1 + node.content.size), \"pointer\")\n    else if (NodeSelection.isSelectable(node))\n      updateSelection(view, NodeSelection.create(doc, nodePos), \"pointer\")\n    else\n      continue\n    return true\n  }\n}\n\nfunction forceDOMFlush(view) {\n  return endComposition(view)\n}\n\nconst selectNodeModifier = browser.mac ? \"metaKey\" : \"ctrlKey\"\n\nhandlers.mousedown = (view, event) => {\n  view.shiftKey = event.shiftKey\n  let flushed = forceDOMFlush(view)\n  let now = Date.now(), type = \"singleClick\"\n  if (now - view.lastClick.time < 500 && isNear(event, view.lastClick) && !event[selectNodeModifier]) {\n    if (view.lastClick.type == \"singleClick\") type = \"doubleClick\"\n    else if (view.lastClick.type == \"doubleClick\") type = \"tripleClick\"\n  }\n  view.lastClick = {time: now, x: event.clientX, y: event.clientY, type}\n\n  let pos = view.posAtCoords(eventCoords(event))\n  if (!pos) return\n\n  if (type == \"singleClick\") {\n    if (view.mouseDown) view.mouseDown.done()\n    view.mouseDown = new MouseDown(view, pos, event, flushed)\n  } else if ((type == \"doubleClick\" ? handleDoubleClick : handleTripleClick)(view, pos.pos, pos.inside, event)) {\n    event.preventDefault()\n  } else {\n    setSelectionOrigin(view, \"pointer\")\n  }\n}\n\nclass MouseDown {\n  constructor(view, pos, event, flushed) {\n    this.view = view\n    this.startDoc = view.state.doc\n    this.pos = pos\n    this.event = event\n    this.flushed = flushed\n    this.selectNode = event[selectNodeModifier]\n    this.allowDefault = event.shiftKey\n    this.delayedSelectionSync = false\n\n    let targetNode, targetPos\n    if (pos.inside > -1) {\n      targetNode = view.state.doc.nodeAt(pos.inside)\n      targetPos = pos.inside\n    } else {\n      let $pos = view.state.doc.resolve(pos.pos)\n      targetNode = $pos.parent\n      targetPos = $pos.depth ? $pos.before() : 0\n    }\n\n    this.mightDrag = null\n\n    const target = flushed ? null : event.target\n    const targetDesc = target ? view.docView.nearestDesc(target, true) : null\n    this.target = targetDesc ? targetDesc.dom : null\n\n    let {selection} = view.state\n    if (event.button == 0 &&\n        targetNode.type.spec.draggable && targetNode.type.spec.selectable !== false ||\n        selection instanceof NodeSelection && selection.from <= targetPos && selection.to > targetPos)\n      this.mightDrag = {node: targetNode,\n                        pos: targetPos,\n                        addAttr: this.target && !this.target.draggable,\n                        setUneditable: this.target && browser.gecko && !this.target.hasAttribute(\"contentEditable\")}\n\n    if (this.target && this.mightDrag && (this.mightDrag.addAttr || this.mightDrag.setUneditable)) {\n      this.view.domObserver.stop()\n      if (this.mightDrag.addAttr) this.target.draggable = true\n      if (this.mightDrag.setUneditable)\n        setTimeout(() => {\n          if (this.view.mouseDown == this) this.target.setAttribute(\"contentEditable\", \"false\")\n        }, 20)\n      this.view.domObserver.start()\n    }\n\n    view.root.addEventListener(\"mouseup\", this.up = this.up.bind(this))\n    view.root.addEventListener(\"mousemove\", this.move = this.move.bind(this))\n    setSelectionOrigin(view, \"pointer\")\n  }\n\n  done() {\n    this.view.root.removeEventListener(\"mouseup\", this.up)\n    this.view.root.removeEventListener(\"mousemove\", this.move)\n    if (this.mightDrag && this.target) {\n      this.view.domObserver.stop()\n      if (this.mightDrag.addAttr) this.target.removeAttribute(\"draggable\")\n      if (this.mightDrag.setUneditable) this.target.removeAttribute(\"contentEditable\")\n      this.view.domObserver.start()\n    }\n    if (this.delayedSelectionSync) setTimeout(() => selectionToDOM(this.view))\n    this.view.mouseDown = null\n  }\n\n  up(event) {\n    this.done()\n\n    if (!this.view.dom.contains(event.target.nodeType == 3 ? event.target.parentNode : event.target))\n      return\n\n    let pos = this.pos\n    if (this.view.state.doc != this.startDoc) pos = this.view.posAtCoords(eventCoords(event))\n\n    if (this.allowDefault || !pos) {\n      setSelectionOrigin(this.view, \"pointer\")\n    } else if (handleSingleClick(this.view, pos.pos, pos.inside, event, this.selectNode)) {\n      event.preventDefault()\n    } else if (event.button == 0 &&\n               (this.flushed ||\n                // Safari ignores clicks on draggable elements\n                (browser.safari && this.mightDrag && !this.mightDrag.node.isAtom) ||\n                // Chrome will sometimes treat a node selection as a\n                // cursor, but still report that the node is selected\n                // when asked through getSelection. You'll then get a\n                // situation where clicking at the point where that\n                // (hidden) cursor is doesn't change the selection, and\n                // thus doesn't get a reaction from ProseMirror. This\n                // works around that.\n                (browser.chrome && !(this.view.state.selection instanceof TextSelection) &&\n                 Math.min(Math.abs(pos.pos - this.view.state.selection.from),\n                          Math.abs(pos.pos - this.view.state.selection.to)) <= 2))) {\n      updateSelection(this.view, Selection.near(this.view.state.doc.resolve(pos.pos)), \"pointer\")\n      event.preventDefault()\n    } else {\n      setSelectionOrigin(this.view, \"pointer\")\n    }\n  }\n\n  move(event) {\n    if (!this.allowDefault && (Math.abs(this.event.x - event.clientX) > 4 ||\n                               Math.abs(this.event.y - event.clientY) > 4))\n      this.allowDefault = true\n    setSelectionOrigin(this.view, \"pointer\")\n    if (event.buttons == 0) this.done()\n  }\n}\n\nhandlers.touchdown = view => {\n  forceDOMFlush(view)\n  setSelectionOrigin(view, \"pointer\")\n}\n\nhandlers.contextmenu = view => forceDOMFlush(view)\n\nfunction inOrNearComposition(view, event) {\n  if (view.composing) return true\n  // See https://www.stum.de/2016/06/24/handling-ime-events-in-javascript/.\n  // On Japanese input method editors (IMEs), the Enter key is used to confirm character\n  // selection. On Safari, when Enter is pressed, compositionend and keydown events are\n  // emitted. The keydown event triggers newline insertion, which we don't want.\n  // This method returns true if the keydown event should be ignored.\n  // We only ignore it once, as pressing Enter a second time *should* insert a newline.\n  // Furthermore, the keydown event timestamp must be close to the compositionEndedAt timestamp.\n  // This guards against the case where compositionend is triggered without the keyboard\n  // (e.g. character confirmation may be done with the mouse), and keydown is triggered\n  // afterwards- we wouldn't want to ignore the keydown event in this case.\n  if (browser.safari && Math.abs(event.timeStamp - view.compositionEndedAt) < 500) {\n    view.compositionEndedAt = -2e8\n    return true\n  }\n  return false\n}\n\n// Drop active composition after 5 seconds of inactivity on Android\nconst timeoutComposition = browser.android ? 5000 : -1\n\neditHandlers.compositionstart = editHandlers.compositionupdate = view => {\n  if (!view.composing) {\n    view.domObserver.flush()\n    let {state} = view, $pos = state.selection.$from\n    if (state.selection.empty &&\n        (state.storedMarks ||\n         (!$pos.textOffset && $pos.parentOffset && $pos.nodeBefore.marks.some(m => m.type.spec.inclusive === false)))) {\n      // Need to wrap the cursor in mark nodes different from the ones in the DOM context\n      view.markCursor = view.state.storedMarks || $pos.marks()\n      endComposition(view, true)\n      view.markCursor = null\n    } else {\n      endComposition(view)\n      // In firefox, if the cursor is after but outside a marked node,\n      // the inserted text won't inherit the marks. So this moves it\n      // inside if necessary.\n      if (browser.gecko && state.selection.empty && $pos.parentOffset && !$pos.textOffset && $pos.nodeBefore.marks.length) {\n        let sel = view.root.getSelection()\n        for (let node = sel.focusNode, offset = sel.focusOffset; node && node.nodeType == 1 && offset != 0;) {\n          let before = offset < 0 ? node.lastChild : node.childNodes[offset - 1]\n          if (!before) break\n          if (before.nodeType == 3) {\n            sel.collapse(before, before.nodeValue.length)\n            break\n          } else {\n            node = before\n            offset = -1\n          }\n        }\n      }\n    }\n    view.composing = true\n  }\n  scheduleComposeEnd(view, timeoutComposition)\n}\n\neditHandlers.compositionend = (view, event) => {\n  if (view.composing) {\n    view.composing = false\n    view.compositionEndedAt = event.timeStamp\n    scheduleComposeEnd(view, 20)\n  }\n}\n\nfunction scheduleComposeEnd(view, delay) {\n  clearTimeout(view.composingTimeout)\n  if (delay > -1) view.composingTimeout = setTimeout(() => endComposition(view), delay)\n}\n\nexport function clearComposition(view) {\n  if (view.composing) {\n    view.composing = false\n    view.compositionEndedAt = timestampFromCustomEvent()\n  }\n  while (view.compositionNodes.length > 0) view.compositionNodes.pop().markParentsDirty()\n}\n\nfunction timestampFromCustomEvent() {\n  let event = document.createEvent(\"Event\")\n  event.initEvent(\"event\", true, true)\n  return event.timeStamp\n}\n\nexport function endComposition(view, forceUpdate) {\n  if (browser.android && view.domObserver.flushingSoon >= 0) return\n  view.domObserver.forceFlush()\n  clearComposition(view)\n  if (forceUpdate || view.docView && view.docView.dirty) {\n    let sel = selectionFromDOM(view)\n    if (sel && !sel.eq(view.state.selection)) view.dispatch(view.state.tr.setSelection(sel))\n    else view.updateState(view.state)\n    return true\n  }\n  return false\n}\n\nfunction captureCopy(view, dom) {\n  // The extra wrapper is somehow necessary on IE/Edge to prevent the\n  // content from being mangled when it is put onto the clipboard\n  if (!view.dom.parentNode) return\n  let wrap = view.dom.parentNode.appendChild(document.createElement(\"div\"))\n  wrap.appendChild(dom)\n  wrap.style.cssText = \"position: fixed; left: -10000px; top: 10px\"\n  let sel = getSelection(), range = document.createRange()\n  range.selectNodeContents(dom)\n  // Done because IE will fire a selectionchange moving the selection\n  // to its start when removeAllRanges is called and the editor still\n  // has focus (which will mess up the editor's selection state).\n  view.dom.blur()\n  sel.removeAllRanges()\n  sel.addRange(range)\n  setTimeout(() => {\n    if (wrap.parentNode) wrap.parentNode.removeChild(wrap)\n    view.focus()\n  }, 50)\n}\n\n// This is very crude, but unfortunately both these browsers _pretend_\n// that they have a clipboard API—all the objects and methods are\n// there, they just don't work, and they are hard to test.\nconst brokenClipboardAPI = (browser.ie && browser.ie_version < 15) ||\n      (browser.ios && browser.webkit_version < 604)\n\nhandlers.copy = editHandlers.cut = (view, e) => {\n  let sel = view.state.selection, cut = e.type == \"cut\"\n  if (sel.empty) return\n\n  // IE and Edge's clipboard interface is completely broken\n  let data = brokenClipboardAPI ? null : e.clipboardData\n  let slice = sel.content(), {dom, text} = serializeForClipboard(view, slice)\n  if (data) {\n    e.preventDefault()\n    data.clearData()\n    data.setData(\"text/html\", dom.innerHTML)\n    data.setData(\"text/plain\", text)\n  } else {\n    captureCopy(view, dom)\n  }\n  if (cut) view.dispatch(view.state.tr.deleteSelection().scrollIntoView().setMeta(\"uiEvent\", \"cut\"))\n}\n\nfunction sliceSingleNode(slice) {\n  return slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1 ? slice.content.firstChild : null\n}\n\nfunction capturePaste(view, e) {\n  if (!view.dom.parentNode) return\n  let plainText = view.shiftKey || view.state.selection.$from.parent.type.spec.code\n  let target = view.dom.parentNode.appendChild(document.createElement(plainText ? \"textarea\" : \"div\"))\n  if (!plainText) target.contentEditable = \"true\"\n  target.style.cssText = \"position: fixed; left: -10000px; top: 10px\"\n  target.focus()\n  setTimeout(() => {\n    view.focus()\n    if (target.parentNode) target.parentNode.removeChild(target)\n    if (plainText) doPaste(view, target.value, null, e)\n    else doPaste(view, target.textContent, target.innerHTML, e)\n  }, 50)\n}\n\nfunction doPaste(view, text, html, e) {\n  let slice = parseFromClipboard(view, text, html, view.shiftKey, view.state.selection.$from)\n  if (view.someProp(\"handlePaste\", f => f(view, e, slice || Slice.empty))) return true\n  if (!slice) return false\n\n  let singleNode = sliceSingleNode(slice)\n  let tr = singleNode ? view.state.tr.replaceSelectionWith(singleNode, view.shiftKey) : view.state.tr.replaceSelection(slice)\n  view.dispatch(tr.scrollIntoView().setMeta(\"paste\", true).setMeta(\"uiEvent\", \"paste\"))\n  return true\n}\n\neditHandlers.paste = (view, e) => {\n  // Handling paste from JavaScript during composition is very poorly\n  // handled by browsers, so as a dodgy but preferable kludge, we just\n  // let the browser do its native thing there, except on Android,\n  // where the editor is almost always composing.\n  if (view.composing && !browser.android) return\n  let data = brokenClipboardAPI ? null : e.clipboardData\n  if (data && doPaste(view, data.getData(\"text/plain\"), data.getData(\"text/html\"), e)) e.preventDefault()\n  else capturePaste(view, e)\n}\n\nclass Dragging {\n  constructor(slice, move) {\n    this.slice = slice\n    this.move = move\n  }\n}\n\nconst dragCopyModifier = browser.mac ? \"altKey\" : \"ctrlKey\"\n\nhandlers.dragstart = (view, e) => {\n  let mouseDown = view.mouseDown\n  if (mouseDown) mouseDown.done()\n  if (!e.dataTransfer) return\n\n  let sel = view.state.selection\n  let pos = sel.empty ? null : view.posAtCoords(eventCoords(e))\n  if (pos && pos.pos >= sel.from && pos.pos <= (sel instanceof NodeSelection ? sel.to - 1: sel.to)) {\n    // In selection\n  } else if (mouseDown && mouseDown.mightDrag) {\n    view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, mouseDown.mightDrag.pos)))\n  } else if (e.target && e.target.nodeType == 1) {\n    let desc = view.docView.nearestDesc(e.target, true)\n    if (desc && desc.node.type.spec.draggable && desc != view.docView)\n      view.dispatch(view.state.tr.setSelection(NodeSelection.create(view.state.doc, desc.posBefore)))\n  }\n  let slice = view.state.selection.content(), {dom, text} = serializeForClipboard(view, slice)\n  e.dataTransfer.clearData()\n  e.dataTransfer.setData(brokenClipboardAPI ? \"Text\" : \"text/html\", dom.innerHTML)\n  // See https://github.com/ProseMirror/prosemirror/issues/1156\n  e.dataTransfer.effectAllowed = \"copyMove\"\n  if (!brokenClipboardAPI) e.dataTransfer.setData(\"text/plain\", text)\n  view.dragging = new Dragging(slice, !e[dragCopyModifier])\n}\n\nhandlers.dragend = view => {\n  let dragging = view.dragging\n  window.setTimeout(() => {\n    if (view.dragging == dragging)  view.dragging = null\n  }, 50)\n}\n\neditHandlers.dragover = editHandlers.dragenter = (_, e) => e.preventDefault()\n\neditHandlers.drop = (view, e) => {\n  let dragging = view.dragging\n  view.dragging = null\n\n  if (!e.dataTransfer) return\n\n  let eventPos = view.posAtCoords(eventCoords(e))\n  if (!eventPos) return\n  let $mouse = view.state.doc.resolve(eventPos.pos)\n  if (!$mouse) return\n  let slice = dragging && dragging.slice\n  if (slice) {\n    view.someProp(\"transformPasted\", f => { slice = f(slice) })\n  } else {\n    slice = parseFromClipboard(view, e.dataTransfer.getData(brokenClipboardAPI ? \"Text\" : \"text/plain\"),\n                               brokenClipboardAPI ? null : e.dataTransfer.getData(\"text/html\"), false, $mouse)\n  }\n  let move = dragging && !e[dragCopyModifier]\n  if (view.someProp(\"handleDrop\", f => f(view, e, slice || Slice.empty, move))) {\n    e.preventDefault()\n    return\n  }\n  if (!slice) return\n\n  e.preventDefault()\n  let insertPos = slice ? dropPoint(view.state.doc, $mouse.pos, slice) : $mouse.pos\n  if (insertPos == null) insertPos = $mouse.pos\n\n  let tr = view.state.tr\n  if (move) tr.deleteSelection()\n\n  let pos = tr.mapping.map(insertPos)\n  let isNode = slice.openStart == 0 && slice.openEnd == 0 && slice.content.childCount == 1\n  let beforeInsert = tr.doc\n  if (isNode)\n    tr.replaceRangeWith(pos, pos, slice.content.firstChild)\n  else\n    tr.replaceRange(pos, pos, slice)\n  if (tr.doc.eq(beforeInsert)) return\n\n  let $pos = tr.doc.resolve(pos)\n  if (isNode && NodeSelection.isSelectable(slice.content.firstChild) &&\n      $pos.nodeAfter && $pos.nodeAfter.sameMarkup(slice.content.firstChild)) {\n    tr.setSelection(new NodeSelection($pos))\n  } else {\n    let end = tr.mapping.map(insertPos)\n    tr.mapping.maps[tr.mapping.maps.length - 1].forEach((_from, _to, _newFrom, newTo) => end = newTo)\n    tr.setSelection(selectionBetween(view, $pos, tr.doc.resolve(end)))\n  }\n  view.focus()\n  view.dispatch(tr.setMeta(\"uiEvent\", \"drop\"))\n}\n\nhandlers.focus = view => {\n  if (!view.focused) {\n    view.domObserver.stop()\n    view.dom.classList.add(\"ProseMirror-focused\")\n    view.domObserver.start()\n    view.focused = true\n    setTimeout(() => {\n      if (view.docView && view.hasFocus() && !view.domObserver.currentSelection.eq(view.root.getSelection()))\n        selectionToDOM(view)\n    }, 20)\n  }\n}\n\nhandlers.blur = (view, e) => {\n  if (view.focused) {\n    view.domObserver.stop()\n    view.dom.classList.remove(\"ProseMirror-focused\")\n    view.domObserver.start()\n    if (e.relatedTarget && view.dom.contains(e.relatedTarget))\n      view.domObserver.currentSelection.set({})\n    view.focused = false\n  }\n}\n\nhandlers.beforeinput = (view, event) => {\n  // We should probably do more with beforeinput events, but support\n  // is so spotty that I'm still waiting to see where they are going.\n\n  // Very specific hack to deal with backspace sometimes failing on\n  // Chrome Android when after an uneditable node.\n  if (browser.chrome && browser.android && event.inputType == \"deleteContentBackward\") {\n    view.domObserver.flushSoon()\n    let {domChangeCount} = view\n    setTimeout(() => {\n      if (view.domChangeCount != domChangeCount) return // Event already had some effect\n      // This bug tends to close the virtual keyboard, so we refocus\n      view.dom.blur()\n      view.focus()\n      if (view.someProp(\"handleKeyDown\", f => f(view, keyEvent(8, \"Backspace\")))) return\n      let {$cursor} = view.state.selection\n      // Crude approximation of backspace behavior when no command handled it\n      if ($cursor && $cursor.pos > 0) view.dispatch(view.state.tr.delete($cursor.pos - 1, $cursor.pos).scrollIntoView())\n    }, 50)\n  }\n}\n\n// Make sure all handlers get registered\nfor (let prop in editHandlers) handlers[prop] = editHandlers[prop]\n","function compareObjs(a, b) {\n  if (a == b) return true\n  for (let p in a) if (a[p] !== b[p]) return false\n  for (let p in b) if (!(p in a)) return false\n  return true\n}\n\nclass WidgetType {\n  constructor(toDOM, spec) {\n    this.spec = spec || noSpec\n    this.side = this.spec.side || 0\n    this.toDOM = toDOM\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let {pos, deleted} = mapping.mapResult(span.from + oldOffset, this.side < 0 ? -1 : 1)\n    return deleted ? null : new Decoration(pos - offset, pos - offset, this)\n  }\n\n  valid() { return true }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof WidgetType &&\n       (this.spec.key && this.spec.key == other.spec.key ||\n        this.toDOM == other.toDOM && compareObjs(this.spec, other.spec)))\n  }\n\n  destroy(node) {\n    if (this.spec.destroy) this.spec.destroy(node)\n  }\n}\n\nclass InlineType {\n  constructor(attrs, spec) {\n    this.spec = spec || noSpec\n    this.attrs = attrs\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let from = mapping.map(span.from + oldOffset, this.spec.inclusiveStart ? -1 : 1) - offset\n    let to = mapping.map(span.to + oldOffset, this.spec.inclusiveEnd ? 1 : -1) - offset\n    return from >= to ? null : new Decoration(from, to, this)\n  }\n\n  valid(_, span) { return span.from < span.to }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof InlineType && compareObjs(this.attrs, other.attrs) &&\n       compareObjs(this.spec, other.spec))\n  }\n\n  static is(span) { return span.type instanceof InlineType }\n}\n\nclass NodeType {\n  constructor(attrs, spec) {\n    this.spec = spec || noSpec\n    this.attrs = attrs\n  }\n\n  map(mapping, span, offset, oldOffset) {\n    let from = mapping.mapResult(span.from + oldOffset, 1)\n    if (from.deleted) return null\n    let to = mapping.mapResult(span.to + oldOffset, -1)\n    if (to.deleted || to.pos <= from.pos) return null\n    return new Decoration(from.pos - offset, to.pos - offset, this)\n  }\n\n  valid(node, span) {\n    let {index, offset} = node.content.findIndex(span.from), child\n    return offset == span.from && !(child = node.child(index)).isText && offset + child.nodeSize == span.to\n  }\n\n  eq(other) {\n    return this == other ||\n      (other instanceof NodeType && compareObjs(this.attrs, other.attrs) &&\n       compareObjs(this.spec, other.spec))\n  }\n}\n\n// ::- Decoration objects can be provided to the view through the\n// [`decorations` prop](#view.EditorProps.decorations). They come in\n// several variants—see the static members of this class for details.\nexport class Decoration {\n  constructor(from, to, type) {\n    // :: number\n    // The start position of the decoration.\n    this.from = from\n    // :: number\n    // The end position. Will be the same as `from` for [widget\n    // decorations](#view.Decoration^widget).\n    this.to = to\n    this.type = type\n  }\n\n  copy(from, to) {\n    return new Decoration(from, to, this.type)\n  }\n\n  eq(other, offset = 0) {\n    return this.type.eq(other.type) && this.from + offset == other.from && this.to + offset == other.to\n  }\n\n  map(mapping, offset, oldOffset) {\n    return this.type.map(mapping, this, offset, oldOffset)\n  }\n\n  // :: (number, union<(view: EditorView, getPos: () → number) → dom.Node, dom.Node>, ?Object) → Decoration\n  // Creates a widget decoration, which is a DOM node that's shown in\n  // the document at the given position. It is recommended that you\n  // delay rendering the widget by passing a function that will be\n  // called when the widget is actually drawn in a view, but you can\n  // also directly pass a DOM node. `getPos` can be used to find the\n  // widget's current document position.\n  //\n  //   spec::- These options are supported:\n  //\n  //     side:: ?number\n  //     Controls which side of the document position this widget is\n  //     associated with. When negative, it is drawn before a cursor\n  //     at its position, and content inserted at that position ends\n  //     up after the widget. When zero (the default) or positive, the\n  //     widget is drawn after the cursor and content inserted there\n  //     ends up before the widget.\n  //\n  //     When there are multiple widgets at a given position, their\n  //     `side` values determine the order in which they appear. Those\n  //     with lower values appear first. The ordering of widgets with\n  //     the same `side` value is unspecified.\n  //\n  //     When `marks` is null, `side` also determines the marks that\n  //     the widget is wrapped in—those of the node before when\n  //     negative, those of the node after when positive.\n  //\n  //     marks:: ?[Mark]\n  //     The precise set of marks to draw around the widget.\n  //\n  //     stopEvent:: ?(event: dom.Event) → bool\n  //     Can be used to control which DOM events, when they bubble out\n  //     of this widget, the editor view should ignore.\n  //\n  //     ignoreSelection:: ?bool\n  //     When set (defaults to false), selection changes inside the\n  //     widget are ignored, and don't cause ProseMirror to try and\n  //     re-sync the selection with its selection state.\n  //\n  //     key:: ?string\n  //     When comparing decorations of this type (in order to decide\n  //     whether it needs to be redrawn), ProseMirror will by default\n  //     compare the widget DOM node by identity. If you pass a key,\n  //     that key will be compared instead, which can be useful when\n  //     you generate decorations on the fly and don't want to store\n  //     and reuse DOM nodes. Make sure that any widgets with the same\n  //     key are interchangeable—if widgets differ in, for example,\n  //     the behavior of some event handler, they should get\n  //     different keys.\n  //\n  //     destroy:: ?(node: dom.Node)\n  //     Called when the widget decoration is removed as a result of\n  //     mapping\n  static widget(pos, toDOM, spec) {\n    return new Decoration(pos, pos, new WidgetType(toDOM, spec))\n  }\n\n  // :: (number, number, DecorationAttrs, ?Object) → Decoration\n  // Creates an inline decoration, which adds the given attributes to\n  // each inline node between `from` and `to`.\n  //\n  //   spec::- These options are recognized:\n  //\n  //     inclusiveStart:: ?bool\n  //     Determines how the left side of the decoration is\n  //     [mapped](#transform.Position_Mapping) when content is\n  //     inserted directly at that position. By default, the decoration\n  //     won't include the new content, but you can set this to `true`\n  //     to make it inclusive.\n  //\n  //     inclusiveEnd:: ?bool\n  //     Determines how the right side of the decoration is mapped.\n  //     See\n  //     [`inclusiveStart`](#view.Decoration^inline^spec.inclusiveStart).\n  static inline(from, to, attrs, spec) {\n    return new Decoration(from, to, new InlineType(attrs, spec))\n  }\n\n  // :: (number, number, DecorationAttrs, ?Object) → Decoration\n  // Creates a node decoration. `from` and `to` should point precisely\n  // before and after a node in the document. That node, and only that\n  // node, will receive the given attributes.\n  //\n  //   spec::-\n  //\n  //   Optional information to store with the decoration. It\n  //   is also used when comparing decorators for equality.\n  static node(from, to, attrs, spec) {\n    return new Decoration(from, to, new NodeType(attrs, spec))\n  }\n\n  // :: Object\n  // The spec provided when creating this decoration. Can be useful\n  // if you've stored extra information in that object.\n  get spec() { return this.type.spec }\n\n  get inline() { return this.type instanceof InlineType }\n}\n\n// DecorationAttrs:: interface\n// A set of attributes to add to a decorated node. Most properties\n// simply directly correspond to DOM attributes of the same name,\n// which will be set to the property's value. These are exceptions:\n//\n//   class:: ?string\n//   A CSS class name or a space-separated set of class names to be\n//   _added_ to the classes that the node already had.\n//\n//   style:: ?string\n//   A string of CSS to be _added_ to the node's existing `style` property.\n//\n//   nodeName:: ?string\n//   When non-null, the target node is wrapped in a DOM element of\n//   this type (and the other attributes are applied to this element).\n\nconst none = [], noSpec = {}\n\n// :: class extends DecorationSource\n// A collection of [decorations](#view.Decoration), organized in\n// such a way that the drawing algorithm can efficiently use and\n// compare them. This is a persistent data structure—it is not\n// modified, updates create a new value.\nexport class DecorationSet {\n  constructor(local, children) {\n    this.local = local && local.length ? local : none\n    this.children = children && children.length ? children : none\n  }\n\n  // :: (Node, [Decoration]) → DecorationSet\n  // Create a set of decorations, using the structure of the given\n  // document.\n  static create(doc, decorations) {\n    return decorations.length ? buildTree(decorations, doc, 0, noSpec) : empty\n  }\n\n  // :: (?number, ?number, ?(spec: Object) → bool) → [Decoration]\n  // Find all decorations in this set which touch the given range\n  // (including decorations that start or end directly at the\n  // boundaries) and match the given predicate on their spec. When\n  // `start` and `end` are omitted, all decorations in the set are\n  // considered. When `predicate` isn't given, all decorations are\n  // assumed to match.\n  find(start, end, predicate) {\n    let result = []\n    this.findInner(start == null ? 0 : start, end == null ? 1e9 : end, result, 0, predicate)\n    return result\n  }\n\n  findInner(start, end, result, offset, predicate) {\n    for (let i = 0; i < this.local.length; i++) {\n      let span = this.local[i]\n      if (span.from <= end && span.to >= start && (!predicate || predicate(span.spec)))\n        result.push(span.copy(span.from + offset, span.to + offset))\n    }\n    for (let i = 0; i < this.children.length; i += 3) {\n      if (this.children[i] < end && this.children[i + 1] > start) {\n        let childOff = this.children[i] + 1\n        this.children[i + 2].findInner(start - childOff, end - childOff, result, offset + childOff, predicate)\n      }\n    }\n  }\n\n  // :: (Mapping, Node, ?Object) → DecorationSet\n  // Map the set of decorations in response to a change in the\n  // document.\n  //\n  //   options::- An optional set of options.\n  //\n  //     onRemove:: ?(decorationSpec: Object)\n  //     When given, this function will be called for each decoration\n  //     that gets dropped as a result of the mapping, passing the\n  //     spec of that decoration.\n  map(mapping, doc, options) {\n    if (this == empty || mapping.maps.length == 0) return this\n    return this.mapInner(mapping, doc, 0, 0, options || noSpec)\n  }\n\n  mapInner(mapping, node, offset, oldOffset, options) {\n    let newLocal\n    for (let i = 0; i < this.local.length; i++) {\n      let mapped = this.local[i].map(mapping, offset, oldOffset)\n      if (mapped && mapped.type.valid(node, mapped)) (newLocal || (newLocal = [])).push(mapped)\n      else if (options.onRemove) options.onRemove(this.local[i].spec)\n    }\n\n    if (this.children.length)\n      return mapChildren(this.children, newLocal, mapping, node, offset, oldOffset, options)\n    else\n      return newLocal ? new DecorationSet(newLocal.sort(byPos)) : empty\n  }\n\n  // :: (Node, [Decoration]) → DecorationSet\n  // Add the given array of decorations to the ones in the set,\n  // producing a new set. Needs access to the current document to\n  // create the appropriate tree structure.\n  add(doc, decorations) {\n    if (!decorations.length) return this\n    if (this == empty) return DecorationSet.create(doc, decorations)\n    return this.addInner(doc, decorations, 0)\n  }\n\n  addInner(doc, decorations, offset) {\n    let children, childIndex = 0\n    doc.forEach((childNode, childOffset) => {\n      let baseOffset = childOffset + offset, found\n      if (!(found = takeSpansForNode(decorations, childNode, baseOffset))) return\n\n      if (!children) children = this.children.slice()\n      while (childIndex < children.length && children[childIndex] < childOffset) childIndex += 3\n      if (children[childIndex] == childOffset)\n        children[childIndex + 2] = children[childIndex + 2].addInner(childNode, found, baseOffset + 1)\n      else\n        children.splice(childIndex, 0, childOffset, childOffset + childNode.nodeSize, buildTree(found, childNode, baseOffset + 1, noSpec))\n      childIndex += 3\n    })\n\n    let local = moveSpans(childIndex ? withoutNulls(decorations) : decorations, -offset)\n    for (let i = 0; i < local.length; i++) if (!local[i].type.valid(doc, local[i])) local.splice(i--, 1)\n\n    return new DecorationSet(local.length ? this.local.concat(local).sort(byPos) : this.local,\n                             children || this.children)\n  }\n\n  // :: ([Decoration]) → DecorationSet\n  // Create a new set that contains the decorations in this set, minus\n  // the ones in the given array.\n  remove(decorations) {\n    if (decorations.length == 0 || this == empty) return this\n    return this.removeInner(decorations, 0)\n  }\n\n  removeInner(decorations, offset) {\n    let children = this.children, local = this.local\n    for (let i = 0; i < children.length; i += 3) {\n      let found, from = children[i] + offset, to = children[i + 1] + offset\n      for (let j = 0, span; j < decorations.length; j++) if (span = decorations[j]) {\n        if (span.from > from && span.to < to) {\n          decorations[j] = null\n          ;(found || (found = [])).push(span)\n        }\n      }\n      if (!found) continue\n      if (children == this.children) children = this.children.slice()\n      let removed = children[i + 2].removeInner(found, from + 1)\n      if (removed != empty) {\n        children[i + 2] = removed\n      } else {\n        children.splice(i, 3)\n        i -= 3\n      }\n    }\n    if (local.length) for (let i = 0, span; i < decorations.length; i++) if (span = decorations[i]) {\n      for (let j = 0; j < local.length; j++) if (local[j].eq(span, offset)) {\n        if (local == this.local) local = this.local.slice()\n        local.splice(j--, 1)\n      }\n    }\n    if (children == this.children && local == this.local) return this\n    return local.length || children.length ? new DecorationSet(local, children) : empty\n  }\n\n  forChild(offset, node) {\n    if (this == empty) return this\n    if (node.isLeaf) return DecorationSet.empty\n\n    let child, local\n    for (let i = 0; i < this.children.length; i += 3) if (this.children[i] >= offset) {\n      if (this.children[i] == offset) child = this.children[i + 2]\n      break\n    }\n    let start = offset + 1, end = start + node.content.size\n    for (let i = 0; i < this.local.length; i++) {\n      let dec = this.local[i]\n      if (dec.from < end && dec.to > start && (dec.type instanceof InlineType)) {\n        let from = Math.max(start, dec.from) - start, to = Math.min(end, dec.to) - start\n        if (from < to) (local || (local = [])).push(dec.copy(from, to))\n      }\n    }\n    if (local) {\n      let localSet = new DecorationSet(local.sort(byPos))\n      return child ? new DecorationGroup([localSet, child]) : localSet\n    }\n    return child || empty\n  }\n\n  eq(other) {\n    if (this == other) return true\n    if (!(other instanceof DecorationSet) ||\n        this.local.length != other.local.length ||\n        this.children.length != other.children.length) return false\n    for (let i = 0; i < this.local.length; i++)\n      if (!this.local[i].eq(other.local[i])) return false\n    for (let i = 0; i < this.children.length; i += 3)\n      if (this.children[i] != other.children[i] ||\n          this.children[i + 1] != other.children[i + 1] ||\n          !this.children[i + 2].eq(other.children[i + 2])) return false\n    return true\n  }\n\n  locals(node) {\n    return removeOverlap(this.localsInner(node))\n  }\n\n  localsInner(node) {\n    if (this == empty) return none\n    if (node.inlineContent || !this.local.some(InlineType.is)) return this.local\n    let result = []\n    for (let i = 0; i < this.local.length; i++) {\n      if (!(this.local[i].type instanceof InlineType))\n        result.push(this.local[i])\n    }\n    return result\n  }\n}\n\n// DecorationSource:: interface\n// An object that can [provide](#view.EditorProps.decorations)\n// decorations. Implemented by [`DecorationSet`](#view.DecorationSet),\n// and passed to [node views](#view.EditorProps.nodeViews).\n//\n//   map:: (Mapping, Node) → DecorationSource\n//   Map the set of decorations in response to a change in the\n//   document.\n\nconst empty = new DecorationSet()\n\n// :: DecorationSet\n// The empty set of decorations.\nDecorationSet.empty = empty\n\nDecorationSet.removeOverlap = removeOverlap\n\n// :- An abstraction that allows the code dealing with decorations to\n// treat multiple DecorationSet objects as if it were a single object\n// with (a subset of) the same interface.\nclass DecorationGroup {\n  constructor(members) {\n    this.members = members\n  }\n\n  map(mapping, doc) {\n    const mappedDecos = this.members.map(\n      member => member.map(mapping, doc, noSpec)\n    )\n    return DecorationGroup.from(mappedDecos)\n  }\n\n  forChild(offset, child) {\n    if (child.isLeaf) return DecorationSet.empty\n    let found = []\n    for (let i = 0; i < this.members.length; i++) {\n      let result = this.members[i].forChild(offset, child)\n      if (result == empty) continue\n      if (result instanceof DecorationGroup) found = found.concat(result.members)\n      else found.push(result)\n    }\n    return DecorationGroup.from(found)\n  }\n\n  eq(other) {\n    if (!(other instanceof DecorationGroup) ||\n        other.members.length != this.members.length) return false\n    for (let i = 0; i < this.members.length; i++)\n      if (!this.members[i].eq(other.members[i])) return false\n    return true\n  }\n\n  locals(node) {\n    let result, sorted = true\n    for (let i = 0; i < this.members.length; i++) {\n      let locals = this.members[i].localsInner(node)\n      if (!locals.length) continue\n      if (!result) {\n        result = locals\n      } else {\n        if (sorted) {\n          result = result.slice()\n          sorted = false\n        }\n        for (let j = 0; j < locals.length; j++) result.push(locals[j])\n      }\n    }\n    return result ? removeOverlap(sorted ? result : result.sort(byPos)) : none\n  }\n\n  // : ([DecorationSet]) → union<DecorationSet, DecorationGroup>\n  // Create a group for the given array of decoration sets, or return\n  // a single set when possible.\n  static from(members) {\n    switch (members.length) {\n      case 0: return empty\n      case 1: return members[0]\n      default: return new DecorationGroup(members)\n    }\n  }\n}\n\nfunction mapChildren(oldChildren, newLocal, mapping, node, offset, oldOffset, options) {\n  let children = oldChildren.slice()\n\n  // Mark the children that are directly touched by changes, and\n  // move those that are after the changes.\n  let shift = (oldStart, oldEnd, newStart, newEnd) => {\n    for (let i = 0; i < children.length; i += 3) {\n      let end = children[i + 1], dSize\n      if (end < 0 || oldStart > end + oldOffset) continue\n      let start = children[i] + oldOffset\n      if (oldEnd >= start) {\n        children[i + 1] = oldStart <= start ? -2 : -1\n      } else if (newStart >= offset && (dSize = (newEnd - newStart) - (oldEnd - oldStart))) {\n        children[i] += dSize\n        children[i + 1] += dSize\n      }\n    }\n  }\n  for (let i = 0; i < mapping.maps.length; i++) mapping.maps[i].forEach(shift)\n\n  // Find the child nodes that still correspond to a single node,\n  // recursively call mapInner on them and update their positions.\n  let mustRebuild = false\n  for (let i = 0; i < children.length; i += 3) if (children[i + 1] < 0) { // Touched nodes\n    if (children[i + 1] == -2) {\n      mustRebuild = true\n      children[i + 1] = -1\n      continue\n    }\n    let from = mapping.map(oldChildren[i] + oldOffset), fromLocal = from - offset\n    if (fromLocal < 0 || fromLocal >= node.content.size) {\n      mustRebuild = true\n      continue\n    }\n    // Must read oldChildren because children was tagged with -1\n    let to = mapping.map(oldChildren[i + 1] + oldOffset, -1), toLocal = to - offset\n    let {index, offset: childOffset} = node.content.findIndex(fromLocal)\n    let childNode = node.maybeChild(index)\n    if (childNode && childOffset == fromLocal && childOffset + childNode.nodeSize == toLocal) {\n      let mapped = children[i + 2].mapInner(mapping, childNode, from + 1, oldChildren[i] + oldOffset + 1, options)\n      if (mapped != empty) {\n        children[i] = fromLocal\n        children[i + 1] = toLocal\n        children[i + 2] = mapped\n      } else {\n        children[i + 1] = -2\n        mustRebuild = true\n      }\n    } else {\n      mustRebuild = true\n    }\n  }\n\n  // Remaining children must be collected and rebuilt into the appropriate structure\n  if (mustRebuild) {\n    let decorations = mapAndGatherRemainingDecorations(children, oldChildren, newLocal || [], mapping,\n                                                       offset, oldOffset, options)\n    let built = buildTree(decorations, node, 0, options)\n    newLocal = built.local\n    for (let i = 0; i < children.length; i += 3) if (children[i + 1] < 0) {\n      children.splice(i, 3)\n      i -= 3\n    }\n    for (let i = 0, j = 0; i < built.children.length; i += 3) {\n      let from = built.children[i]\n      while (j < children.length && children[j] < from) j += 3\n      children.splice(j, 0, built.children[i], built.children[i + 1], built.children[i + 2])\n    }\n  }\n\n  return new DecorationSet(newLocal && newLocal.sort(byPos), children)\n}\n\nfunction moveSpans(spans, offset) {\n  if (!offset || !spans.length) return spans\n  let result = []\n  for (let i = 0; i < spans.length; i++) {\n    let span = spans[i]\n    result.push(new Decoration(span.from + offset, span.to + offset, span.type))\n  }\n  return result\n}\n\nfunction mapAndGatherRemainingDecorations(children, oldChildren, decorations, mapping, offset, oldOffset, options) {\n  // Gather all decorations from the remaining marked children\n  function gather(set, oldOffset) {\n    for (let i = 0; i < set.local.length; i++) {\n      let mapped = set.local[i].map(mapping, offset, oldOffset)\n      if (mapped) decorations.push(mapped)\n      else if (options.onRemove) options.onRemove(set.local[i].spec)\n    }\n    for (let i = 0; i < set.children.length; i += 3)\n      gather(set.children[i + 2], set.children[i] + oldOffset + 1)\n  }\n  for (let i = 0; i < children.length; i += 3) if (children[i + 1] == -1)\n    gather(children[i + 2], oldChildren[i] + oldOffset + 1)\n\n  return decorations\n}\n\nfunction takeSpansForNode(spans, node, offset) {\n  if (node.isLeaf) return null\n  let end = offset + node.nodeSize, found = null\n  for (let i = 0, span; i < spans.length; i++) {\n    if ((span = spans[i]) && span.from > offset && span.to < end) {\n      ;(found || (found = [])).push(span)\n      spans[i] = null\n    }\n  }\n  return found\n}\n\nfunction withoutNulls(array) {\n  let result = []\n  for (let i = 0; i < array.length; i++)\n    if (array[i] != null) result.push(array[i])\n  return result\n}\n\n// : ([Decoration], Node, number) → DecorationSet\n// Build up a tree that corresponds to a set of decorations. `offset`\n// is a base offset that should be subtracted from the `from` and `to`\n// positions in the spans (so that we don't have to allocate new spans\n// for recursive calls).\nfunction buildTree(spans, node, offset, options) {\n  let children = [], hasNulls = false\n  node.forEach((childNode, localStart) => {\n    let found = takeSpansForNode(spans, childNode, localStart + offset)\n    if (found) {\n      hasNulls = true\n      let subtree = buildTree(found, childNode, offset + localStart + 1, options)\n      if (subtree != empty)\n        children.push(localStart, localStart + childNode.nodeSize, subtree)\n    }\n  })\n  let locals = moveSpans(hasNulls ? withoutNulls(spans) : spans, -offset).sort(byPos)\n  for (let i = 0; i < locals.length; i++) if (!locals[i].type.valid(node, locals[i])) {\n    if (options.onRemove) options.onRemove(locals[i].spec)\n    locals.splice(i--, 1)\n  }\n  return locals.length || children.length ? new DecorationSet(locals, children) : empty\n}\n\n// : (Decoration, Decoration) → number\n// Used to sort decorations so that ones with a low start position\n// come first, and within a set with the same start position, those\n// with an smaller end position come first.\nfunction byPos(a, b) {\n  return a.from - b.from || a.to - b.to\n}\n\n// : ([Decoration]) → [Decoration]\n// Scan a sorted array of decorations for partially overlapping spans,\n// and split those so that only fully overlapping spans are left (to\n// make subsequent rendering easier). Will return the input array if\n// no partially overlapping spans are found (the common case).\nfunction removeOverlap(spans) {\n  let working = spans\n  for (let i = 0; i < working.length - 1; i++) {\n    let span = working[i]\n    if (span.from != span.to) for (let j = i + 1; j < working.length; j++) {\n      let next = working[j]\n      if (next.from == span.from) {\n        if (next.to != span.to) {\n          if (working == spans) working = spans.slice()\n          // Followed by a partially overlapping larger span. Split that\n          // span.\n          working[j] = next.copy(next.from, span.to)\n          insertAhead(working, j + 1, next.copy(span.to, next.to))\n        }\n        continue\n      } else {\n        if (next.from < span.to) {\n          if (working == spans) working = spans.slice()\n          // The end of this one overlaps with a subsequent span. Split\n          // this one.\n          working[i] = span.copy(span.from, next.from)\n          insertAhead(working, j, span.copy(next.from, span.to))\n        }\n        break\n      }\n    }\n  }\n  return working\n}\n\nfunction insertAhead(array, i, deco) {\n  while (i < array.length && byPos(deco, array[i]) > 0) i++\n  array.splice(i, 0, deco)\n}\n\n// : (EditorView) → union<DecorationSet, DecorationGroup>\n// Get the decorations associated with the current props of a view.\nexport function viewDecorations(view) {\n  let found = []\n  view.someProp(\"decorations\", f => {\n    let result = f(view.state)\n    if (result && result != empty) found.push(result)\n  })\n  if (view.cursorWrapper)\n    found.push(DecorationSet.create(view.state.doc, [view.cursorWrapper.deco]))\n  return DecorationGroup.from(found)\n}\n","import {NodeSelection} from \"prosemirror-state\"\n\nimport {scrollRectIntoView, posAtCoords, coordsAtPos, endOfTextblock, storeScrollPos,\n        resetScrollPos, focusPreventScroll} from \"./domcoords\"\nimport {docViewDesc} from \"./viewdesc\"\nimport {initInput, destroyInput, dispatchEvent, ensureListeners, clearComposition} from \"./input\"\nimport {selectionToDOM, anchorInRightPlace, syncNodeSelection} from \"./selection\"\nimport {Decoration, viewDecorations} from \"./decoration\"\nimport browser from \"./browser\"\n\nexport {Decoration, DecorationSet} from \"./decoration\"\n\n// Exported for testing\nexport {serializeForClipboard as __serializeForClipboard, parseFromClipboard as __parseFromClipboard} from \"./clipboard\"\nexport {endComposition as __endComposition} from \"./input\"\n\n// ::- An editor view manages the DOM structure that represents an\n// editable document. Its state and behavior are determined by its\n// [props](#view.DirectEditorProps).\nexport class EditorView {\n  // :: (?union<dom.Node, (dom.Node), {mount: dom.Node}>, DirectEditorProps)\n  // Create a view. `place` may be a DOM node that the editor should\n  // be appended to, a function that will place it into the document,\n  // or an object whose `mount` property holds the node to use as the\n  // document container. If it is `null`, the editor will not be added\n  // to the document.\n  constructor(place, props) {\n    this._props = props\n    // :: EditorState\n    // The view's current [state](#state.EditorState).\n    this.state = props.state\n\n    this.directPlugins = props.plugins || []\n    this.directPlugins.forEach(checkStateComponent)\n\n    this.dispatch = this.dispatch.bind(this)\n\n    this._root = null\n    this.focused = false\n    // Kludge used to work around a Chrome bug\n    this.trackWrites = null\n\n    // :: dom.Element\n    // An editable DOM node containing the document. (You probably\n    // should not directly interfere with its content.)\n    this.dom = (place && place.mount) || document.createElement(\"div\")\n    if (place) {\n      if (place.appendChild) place.appendChild(this.dom)\n      else if (place.apply) place(this.dom)\n      else if (place.mount) this.mounted = true\n    }\n\n    // :: bool\n    // Indicates whether the editor is currently [editable](#view.EditorProps.editable).\n    this.editable = getEditable(this)\n    this.markCursor = null\n    this.cursorWrapper = null\n    updateCursorWrapper(this)\n    this.nodeViews = buildNodeViews(this)\n    this.docView = docViewDesc(this.state.doc, computeDocDeco(this), viewDecorations(this), this.dom, this)\n\n    this.lastSelectedViewDesc = null\n    // :: ?{slice: Slice, move: bool}\n    // When editor content is being dragged, this object contains\n    // information about the dragged slice and whether it is being\n    // copied or moved. At any other time, it is null.\n    this.dragging = null\n\n    initInput(this)\n\n    this.prevDirectPlugins = []\n    this.pluginViews = []\n    this.updatePluginViews()\n  }\n\n  // composing:: boolean\n  // Holds `true` when a\n  // [composition](https://developer.mozilla.org/en-US/docs/Mozilla/IME_handling_guide)\n  // is active.\n\n  // :: DirectEditorProps\n  // The view's current [props](#view.EditorProps).\n  get props() {\n    if (this._props.state != this.state) {\n      let prev = this._props\n      this._props = {}\n      for (let name in prev) this._props[name] = prev[name]\n      this._props.state = this.state\n    }\n    return this._props\n  }\n\n  // :: (DirectEditorProps)\n  // Update the view's props. Will immediately cause an update to\n  // the DOM.\n  update(props) {\n    if (props.handleDOMEvents != this._props.handleDOMEvents) ensureListeners(this)\n    this._props = props\n    if (props.plugins) {\n      props.plugins.forEach(checkStateComponent)\n      this.directPlugins = props.plugins\n    }\n    this.updateStateInner(props.state, true)\n  }\n\n  // :: (DirectEditorProps)\n  // Update the view by updating existing props object with the object\n  // given as argument. Equivalent to `view.update(Object.assign({},\n  // view.props, props))`.\n  setProps(props) {\n    let updated = {}\n    for (let name in this._props) updated[name] = this._props[name]\n    updated.state = this.state\n    for (let name in props) updated[name] = props[name]\n    this.update(updated)\n  }\n\n  // :: (EditorState)\n  // Update the editor's `state` prop, without touching any of the\n  // other props.\n  updateState(state) {\n    this.updateStateInner(state, this.state.plugins != state.plugins)\n  }\n\n  updateStateInner(state, reconfigured) {\n    let prev = this.state, redraw = false, updateSel = false\n    // When stored marks are added, stop composition, so that they can\n    // be displayed.\n    if (state.storedMarks && this.composing) {\n      clearComposition(this)\n      updateSel = true\n    }\n    this.state = state\n    if (reconfigured) {\n      let nodeViews = buildNodeViews(this)\n      if (changedNodeViews(nodeViews, this.nodeViews)) {\n        this.nodeViews = nodeViews\n        redraw = true\n      }\n      ensureListeners(this)\n    }\n\n    this.editable = getEditable(this)\n    updateCursorWrapper(this)\n    let innerDeco = viewDecorations(this), outerDeco = computeDocDeco(this)\n\n    let scroll = reconfigured ? \"reset\"\n        : state.scrollToSelection > prev.scrollToSelection ? \"to selection\" : \"preserve\"\n    let updateDoc = redraw || !this.docView.matchesNode(state.doc, outerDeco, innerDeco)\n    if (updateDoc || !state.selection.eq(prev.selection)) updateSel = true\n    let oldScrollPos = scroll == \"preserve\" && updateSel && this.dom.style.overflowAnchor == null && storeScrollPos(this)\n\n    if (updateSel) {\n      this.domObserver.stop()\n      // Work around an issue in Chrome, IE, and Edge where changing\n      // the DOM around an active selection puts it into a broken\n      // state where the thing the user sees differs from the\n      // selection reported by the Selection object (#710, #973,\n      // #1011, #1013, #1035).\n      let forceSelUpdate = updateDoc && (browser.ie || browser.chrome) && !this.composing &&\n          !prev.selection.empty && !state.selection.empty && selectionContextChanged(prev.selection, state.selection)\n      if (updateDoc) {\n        // If the node that the selection points into is written to,\n        // Chrome sometimes starts misreporting the selection, so this\n        // tracks that and forces a selection reset when our update\n        // did write to the node.\n        let chromeKludge = browser.chrome ? (this.trackWrites = this.root.getSelection().focusNode) : null\n        if (redraw || !this.docView.update(state.doc, outerDeco, innerDeco, this)) {\n          this.docView.updateOuterDeco([])\n          this.docView.destroy()\n          this.docView = docViewDesc(state.doc, outerDeco, innerDeco, this.dom, this)\n        }\n        if (chromeKludge && !this.trackWrites) forceSelUpdate = true\n      }\n      // Work around for an issue where an update arriving right between\n      // a DOM selection change and the \"selectionchange\" event for it\n      // can cause a spurious DOM selection update, disrupting mouse\n      // drag selection.\n      if (forceSelUpdate ||\n          !(this.mouseDown && this.domObserver.currentSelection.eq(this.root.getSelection()) && anchorInRightPlace(this))) {\n        selectionToDOM(this, forceSelUpdate)\n      } else {\n        syncNodeSelection(this, state.selection)\n        this.domObserver.setCurSelection()\n      }\n      this.domObserver.start()\n    }\n\n    this.updatePluginViews(prev)\n\n    if (scroll == \"reset\") {\n      this.dom.scrollTop = 0\n    } else if (scroll == \"to selection\") {\n      let startDOM = this.root.getSelection().focusNode\n      if (this.someProp(\"handleScrollToSelection\", f => f(this)))\n        {} // Handled\n      else if (state.selection instanceof NodeSelection)\n        scrollRectIntoView(this, this.docView.domAfterPos(state.selection.from).getBoundingClientRect(), startDOM)\n      else\n        scrollRectIntoView(this, this.coordsAtPos(state.selection.head, 1), startDOM)\n    } else if (oldScrollPos) {\n      resetScrollPos(oldScrollPos)\n    }\n  }\n\n  destroyPluginViews() {\n    let view\n    while (view = this.pluginViews.pop()) if (view.destroy) view.destroy()\n  }\n\n  updatePluginViews(prevState) {\n    if (!prevState || prevState.plugins != this.state.plugins || this.directPlugins != this.prevDirectPlugins) {\n      this.prevDirectPlugins = this.directPlugins\n      this.destroyPluginViews()\n      for (let i = 0; i < this.directPlugins.length; i++) {\n        let plugin = this.directPlugins[i]\n        if (plugin.spec.view) this.pluginViews.push(plugin.spec.view(this))\n      }\n      for (let i = 0; i < this.state.plugins.length; i++) {\n        let plugin = this.state.plugins[i]\n        if (plugin.spec.view) this.pluginViews.push(plugin.spec.view(this))\n      }\n    } else {\n      for (let i = 0; i < this.pluginViews.length; i++) {\n        let pluginView = this.pluginViews[i]\n        if (pluginView.update) pluginView.update(this, prevState)\n      }\n    }\n  }\n\n  // :: (string, ?(prop: *) → *) → *\n  // Goes over the values of a prop, first those provided directly,\n  // then those from plugins given to the view, then from plugins in\n  // the state (in order), and calls `f` every time a non-undefined\n  // value is found. When `f` returns a truthy value, that is\n  // immediately returned. When `f` isn't provided, it is treated as\n  // the identity function (the prop value is returned directly).\n  someProp(propName, f) {\n    let prop = this._props && this._props[propName], value\n    if (prop != null && (value = f ? f(prop) : prop)) return value\n    for (let i = 0; i < this.directPlugins.length; i++) {\n      let prop = this.directPlugins[i].props[propName]\n      if (prop != null && (value = f ? f(prop) : prop)) return value\n    }\n    let plugins = this.state.plugins\n    if (plugins) for (let i = 0; i < plugins.length; i++) {\n      let prop = plugins[i].props[propName]\n      if (prop != null && (value = f ? f(prop) : prop)) return value\n    }\n  }\n\n  // :: () → bool\n  // Query whether the view has focus.\n  hasFocus() {\n    return this.root.activeElement == this.dom\n  }\n\n  // :: ()\n  // Focus the editor.\n  focus() {\n    this.domObserver.stop()\n    if (this.editable) focusPreventScroll(this.dom)\n    selectionToDOM(this)\n    this.domObserver.start()\n  }\n\n  // :: union<dom.Document, dom.DocumentFragment>\n  // Get the document root in which the editor exists. This will\n  // usually be the top-level `document`, but might be a [shadow\n  // DOM](https://developer.mozilla.org/en-US/docs/Web/Web_Components/Shadow_DOM)\n  // root if the editor is inside one.\n  get root() {\n    let cached = this._root\n    if (cached == null) for (let search = this.dom.parentNode; search; search = search.parentNode) {\n      if (search.nodeType == 9 || (search.nodeType == 11 && search.host)) {\n        if (!search.getSelection) Object.getPrototypeOf(search).getSelection = () => document.getSelection()\n        return this._root = search\n      }\n    }\n    return cached || document\n  }\n\n  // :: ({left: number, top: number}) → ?{pos: number, inside: number}\n  // Given a pair of viewport coordinates, return the document\n  // position that corresponds to them. May return null if the given\n  // coordinates aren't inside of the editor. When an object is\n  // returned, its `pos` property is the position nearest to the\n  // coordinates, and its `inside` property holds the position of the\n  // inner node that the position falls inside of, or -1 if it is at\n  // the top level, not in any node.\n  posAtCoords(coords) {\n    return posAtCoords(this, coords)\n  }\n\n  // :: (number, number) → {left: number, right: number, top: number, bottom: number}\n  // Returns the viewport rectangle at a given document position.\n  // `left` and `right` will be the same number, as this returns a\n  // flat cursor-ish rectangle. If the position is between two things\n  // that aren't directly adjacent, `side` determines which element is\n  // used. When < 0, the element before the position is used,\n  // otherwise the element after.\n  coordsAtPos(pos, side = 1) {\n    return coordsAtPos(this, pos, side)\n  }\n\n  // :: (number, number) → {node: dom.Node, offset: number}\n  // Find the DOM position that corresponds to the given document\n  // position. When `side` is negative, find the position as close as\n  // possible to the content before the position. When positive,\n  // prefer positions close to the content after the position. When\n  // zero, prefer as shallow a position as possible.\n  //\n  // Note that you should **not** mutate the editor's internal DOM,\n  // only inspect it (and even that is usually not necessary).\n  domAtPos(pos, side = 0) {\n    return this.docView.domFromPos(pos, side)\n  }\n\n  // :: (number) → ?dom.Node\n  // Find the DOM node that represents the document node after the\n  // given position. May return `null` when the position doesn't point\n  // in front of a node or if the node is inside an opaque node view.\n  //\n  // This is intended to be able to call things like\n  // `getBoundingClientRect` on that DOM node. Do **not** mutate the\n  // editor DOM directly, or add styling this way, since that will be\n  // immediately overriden by the editor as it redraws the node.\n  nodeDOM(pos) {\n    let desc = this.docView.descAt(pos)\n    return desc ? desc.nodeDOM : null\n  }\n\n  // :: (dom.Node, number, ?number) → number\n  // Find the document position that corresponds to a given DOM\n  // position. (Whenever possible, it is preferable to inspect the\n  // document structure directly, rather than poking around in the\n  // DOM, but sometimes—for example when interpreting an event\n  // target—you don't have a choice.)\n  //\n  // The `bias` parameter can be used to influence which side of a DOM\n  // node to use when the position is inside a leaf node.\n  posAtDOM(node, offset, bias = -1) {\n    let pos = this.docView.posFromDOM(node, offset, bias)\n    if (pos == null) throw new RangeError(\"DOM position not inside the editor\")\n    return pos\n  }\n\n  // :: (union<\"up\", \"down\", \"left\", \"right\", \"forward\", \"backward\">, ?EditorState) → bool\n  // Find out whether the selection is at the end of a textblock when\n  // moving in a given direction. When, for example, given `\"left\"`,\n  // it will return true if moving left from the current cursor\n  // position would leave that position's parent textblock. Will apply\n  // to the view's current state by default, but it is possible to\n  // pass a different state.\n  endOfTextblock(dir, state) {\n    return endOfTextblock(this, state || this.state, dir)\n  }\n\n  // :: ()\n  // Removes the editor from the DOM and destroys all [node\n  // views](#view.NodeView).\n  destroy() {\n    if (!this.docView) return\n    destroyInput(this)\n    this.destroyPluginViews()\n    if (this.mounted) {\n      this.docView.update(this.state.doc, [], viewDecorations(this), this)\n      this.dom.textContent = \"\"\n    } else if (this.dom.parentNode) {\n      this.dom.parentNode.removeChild(this.dom)\n    }\n    this.docView.destroy()\n    this.docView = null\n  }\n\n  // :: boolean\n  // This is true when the view has been\n  // [destroyed](#view.EditorView.destroy) (and thus should not be\n  // used anymore).\n  get isDestroyed() {\n    return this.docView == null\n  }\n\n  // Used for testing.\n  dispatchEvent(event) {\n    return dispatchEvent(this, event)\n  }\n\n  // :: (Transaction)\n  // Dispatch a transaction. Will call\n  // [`dispatchTransaction`](#view.DirectEditorProps.dispatchTransaction)\n  // when given, and otherwise defaults to applying the transaction to\n  // the current state and calling\n  // [`updateState`](#view.EditorView.updateState) with the result.\n  // This method is bound to the view instance, so that it can be\n  // easily passed around.\n  dispatch(tr) {\n    let dispatchTransaction = this._props.dispatchTransaction\n    if (dispatchTransaction) dispatchTransaction.call(this, tr)\n    else this.updateState(this.state.apply(tr))\n  }\n}\n\nfunction computeDocDeco(view) {\n  let attrs = Object.create(null)\n  attrs.class = \"ProseMirror\"\n  attrs.contenteditable = String(view.editable)\n  attrs.translate = \"no\"\n\n  view.someProp(\"attributes\", value => {\n    if (typeof value == \"function\") value = value(view.state)\n    if (value) for (let attr in value) {\n      if (attr == \"class\")\n        attrs.class += \" \" + value[attr]\n      if (attr == \"style\") {\n        attrs.style = (attrs.style ? attrs.style + \";\" : \"\") + value[attr]\n      }\n      else if (!attrs[attr] && attr != \"contenteditable\" && attr != \"nodeName\")\n        attrs[attr] = String(value[attr])\n    }\n  })\n\n  return [Decoration.node(0, view.state.doc.content.size, attrs)]\n}\n\nfunction updateCursorWrapper(view) {\n  if (view.markCursor) {\n    let dom = document.createElement(\"img\")\n    dom.className = \"ProseMirror-separator\"\n    dom.setAttribute(\"mark-placeholder\", \"true\")\n    dom.setAttribute(\"alt\", \"\")\n    view.cursorWrapper = {dom, deco: Decoration.widget(view.state.selection.head, dom, {raw: true, marks: view.markCursor})}\n  } else {\n    view.cursorWrapper = null\n  }\n}\n\nfunction getEditable(view) {\n  return !view.someProp(\"editable\", value => value(view.state) === false)\n}\n\nfunction selectionContextChanged(sel1, sel2) {\n  let depth = Math.min(sel1.$anchor.sharedDepth(sel1.head), sel2.$anchor.sharedDepth(sel2.head))\n  return sel1.$anchor.start(depth) != sel2.$anchor.start(depth)\n}\n\nfunction buildNodeViews(view) {\n  let result = {}\n  view.someProp(\"nodeViews\", obj => {\n    for (let prop in obj) if (!Object.prototype.hasOwnProperty.call(result, prop))\n      result[prop] = obj[prop]\n  })\n  return result\n}\n\nfunction changedNodeViews(a, b) {\n  let nA = 0, nB = 0\n  for (let prop in a) {\n    if (a[prop] != b[prop]) return true\n    nA++\n  }\n  for (let _ in b) nB++\n  return nA != nB\n}\n\nfunction checkStateComponent(plugin) {\n  if (plugin.spec.state || plugin.spec.filterTransaction || plugin.spec.appendTransaction)\n    throw new RangeError(\"Plugins passed directly to the view must not have a state component\")\n}\n\n// EditorProps:: interface\n//\n// Props are configuration values that can be passed to an editor view\n// or included in a plugin. This interface lists the supported props.\n//\n// The various event-handling functions may all return `true` to\n// indicate that they handled the given event. The view will then take\n// care to call `preventDefault` on the event, except with\n// `handleDOMEvents`, where the handler itself is responsible for that.\n//\n// How a prop is resolved depends on the prop. Handler functions are\n// called one at a time, starting with the base props and then\n// searching through the plugins (in order of appearance) until one of\n// them returns true. For some props, the first plugin that yields a\n// value gets precedence.\n//\n//   handleDOMEvents:: ?Object<(view: EditorView, event: dom.Event) → bool>\n//   Can be an object mapping DOM event type names to functions that\n//   handle them. Such functions will be called before any handling\n//   ProseMirror does of events fired on the editable DOM element.\n//   Contrary to the other event handling props, when returning true\n//   from such a function, you are responsible for calling\n//   `preventDefault` yourself (or not, if you want to allow the\n//   default behavior).\n//\n//   handleKeyDown:: ?(view: EditorView, event: dom.KeyboardEvent) → bool\n//   Called when the editor receives a `keydown` event.\n//\n//   handleKeyPress:: ?(view: EditorView, event: dom.KeyboardEvent) → bool\n//   Handler for `keypress` events.\n//\n//   handleTextInput:: ?(view: EditorView, from: number, to: number, text: string) → bool\n//   Whenever the user directly input text, this handler is called\n//   before the input is applied. If it returns `true`, the default\n//   behavior of actually inserting the text is suppressed.\n//\n//   handleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a click, from the inside out. The\n//   `direct` flag will be true for the inner node.\n//\n//   handleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is clicked, after `handleClickOn` handlers\n//   have been called.\n//\n//   handleDoubleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a double click.\n//\n//   handleDoubleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is double-clicked, after `handleDoubleClickOn`.\n//\n//   handleTripleClickOn:: ?(view: EditorView, pos: number, node: Node, nodePos: number, event: dom.MouseEvent, direct: bool) → bool\n//   Called for each node around a triple click.\n//\n//   handleTripleClick:: ?(view: EditorView, pos: number, event: dom.MouseEvent) → bool\n//   Called when the editor is triple-clicked, after `handleTripleClickOn`.\n//\n//   handlePaste:: ?(view: EditorView, event: dom.ClipboardEvent, slice: Slice) → bool\n//   Can be used to override the behavior of pasting. `slice` is the\n//   pasted content parsed by the editor, but you can directly access\n//   the event to get at the raw content.\n//\n//   handleDrop:: ?(view: EditorView, event: dom.Event, slice: Slice, moved: bool) → bool\n//   Called when something is dropped on the editor. `moved` will be\n//   true if this drop moves from the current selection (which should\n//   thus be deleted).\n//\n//   handleScrollToSelection:: ?(view: EditorView) → bool\n//   Called when the view, after updating its state, tries to scroll\n//   the selection into view. A handler function may return false to\n//   indicate that it did not handle the scrolling and further\n//   handlers or the default behavior should be tried.\n//\n//   createSelectionBetween:: ?(view: EditorView, anchor: ResolvedPos, head: ResolvedPos) → ?Selection\n//   Can be used to override the way a selection is created when\n//   reading a DOM selection between the given anchor and head.\n//\n//   domParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading editor changes\n//   from the DOM. Defaults to calling\n//   [`DOMParser.fromSchema`](#model.DOMParser^fromSchema) on the\n//   editor's schema.\n//\n//   transformPastedHTML:: ?(html: string) → string\n//   Can be used to transform pasted HTML text, _before_ it is parsed,\n//   for example to clean it up.\n//\n//   clipboardParser:: ?DOMParser\n//   The [parser](#model.DOMParser) to use when reading content from\n//   the clipboard. When not given, the value of the\n//   [`domParser`](#view.EditorProps.domParser) prop is used.\n//\n//   transformPastedText:: ?(text: string, plain: bool) → string\n//   Transform pasted plain text. The `plain` flag will be true when\n//   the text is pasted as plain text.\n//\n//   clipboardTextParser:: ?(text: string, $context: ResolvedPos, plain: bool) → Slice\n//   A function to parse text from the clipboard into a document\n//   slice. Called after\n//   [`transformPastedText`](#view.EditorProps.transformPastedText).\n//   The default behavior is to split the text into lines, wrap them\n//   in `<p>` tags, and call\n//   [`clipboardParser`](#view.EditorProps.clipboardParser) on it.\n//   The `plain` flag will be true when the text is pasted as plain text.\n//\n//   transformPasted:: ?(Slice) → Slice\n//   Can be used to transform pasted content before it is applied to\n//   the document.\n//\n//   nodeViews:: ?Object<(node: Node, view: EditorView, getPos: () → number, decorations: [Decoration], innerDecorations: DecorationSource) → NodeView>\n//   Allows you to pass custom rendering and behavior logic for nodes\n//   and marks. Should map node and mark names to constructor\n//   functions that produce a [`NodeView`](#view.NodeView) object\n//   implementing the node's display behavior. For nodes, the third\n//   argument `getPos` is a function that can be called to get the\n//   node's current position, which can be useful when creating\n//   transactions to update it. For marks, the third argument is a\n//   boolean that indicates whether the mark's content is inline.\n//\n//   `decorations` is an array of node or inline decorations that are\n//   active around the node. They are automatically drawn in the\n//   normal way, and you will usually just want to ignore this, but\n//   they can also be used as a way to provide context information to\n//   the node view without adding it to the document itself.\n//\n//   `innerDecorations` holds the decorations for the node's content.\n//   You can safely ignore this if your view has no content or a\n//   `contentDOM` property, since the editor will draw the decorations\n//   on the content. But if you, for example, want to create a nested\n//   editor with the content, it may make sense to provide it with the\n//   inner decorations.\n//\n//   clipboardSerializer:: ?DOMSerializer\n//   The DOM serializer to use when putting content onto the\n//   clipboard. If not given, the result of\n//   [`DOMSerializer.fromSchema`](#model.DOMSerializer^fromSchema)\n//   will be used. This object will only have its\n//   [`serializeFragment`](#model.DOMSerializer.serializeFragment)\n//   method called, and you may provide an alternative object type\n//   implementing a compatible method.\n//\n//   clipboardTextSerializer:: ?(Slice) → string\n//   A function that will be called to get the text for the current\n//   selection when copying text to the clipboard. By default, the\n//   editor will use [`textBetween`](#model.Node.textBetween) on the\n//   selected range.\n//\n//   decorations:: ?(state: EditorState) → ?DecorationSource\n//   A set of [document decorations](#view.Decoration) to show in the\n//   view.\n//\n//   editable:: ?(state: EditorState) → bool\n//   When this returns false, the content of the view is not directly\n//   editable.\n//\n//   attributes:: ?union<Object<string>, (EditorState) → ?Object<string>>\n//   Control the DOM attributes of the editable element. May be either\n//   an object or a function going from an editor state to an object.\n//   By default, the element will get a class `\"ProseMirror\"`, and\n//   will have its `contentEditable` attribute determined by the\n//   [`editable` prop](#view.EditorProps.editable). Additional classes\n//   provided here will be added to the class. For other attributes,\n//   the value provided first (as in\n//   [`someProp`](#view.EditorView.someProp)) will be used.\n//\n//   scrollThreshold:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the distance (in pixels) between the cursor and the\n//   end of the visible viewport at which point, when scrolling the\n//   cursor into view, scrolling takes place. Defaults to 0.\n//\n//   scrollMargin:: ?union<number, {top: number, right: number, bottom: number, left: number}>\n//   Determines the extra space (in pixels) that is left above or\n//   below the cursor when it is scrolled into view. Defaults to 5.\n\n// DirectEditorProps:: interface extends EditorProps\n//\n// The props object given directly to the editor view supports two\n// fields that can't be used in plugins:\n//\n//   state:: EditorState\n//   The current state of the editor.\n//\n//   plugins:: [Plugin]\n//   A set of plugins to use in the view, applying their [plugin\n//   view](#state.PluginSpec.view) and\n//   [props](#state.PluginSpec.props). Passing plugins with a state\n//   component (a [state field](#state.PluginSpec.state) field or a\n//   [transaction](#state.PluginSpec.filterTransaction) filter or\n//   appender) will result in an error, since such plugins must be\n//   present in the state to work.\n//\n//   dispatchTransaction:: ?(tr: Transaction)\n//   The callback over which to send transactions (state updates)\n//   produced by the view. If you specify this, you probably want to\n//   make sure this ends up calling the view's\n//   [`updateState`](#view.EditorView.updateState) method with a new\n//   state that has the transaction\n//   [applied](#state.EditorState.apply). The callback will be bound to have\n//   the view instance as its `this` binding.\n","'use strict';\n\n\nmodule.exports = require('./lib/');\n","import {Schema} from \"prosemirror-model\"\n\n// ::Schema Document schema for the data model used by CommonMark.\nexport const schema = new Schema({\n  nodes: {\n    doc: {\n      content: \"block+\"\n    },\n\n    paragraph: {\n      content: \"inline*\",\n      group: \"block\",\n      parseDOM: [{tag: \"p\"}],\n      toDOM() { return [\"p\", 0] }\n    },\n\n    blockquote: {\n      content: \"block+\",\n      group: \"block\",\n      parseDOM: [{tag: \"blockquote\"}],\n      toDOM() { return [\"blockquote\", 0] }\n    },\n\n    horizontal_rule: {\n      group: \"block\",\n      parseDOM: [{tag: \"hr\"}],\n      toDOM() { return [\"div\", [\"hr\"]] }\n    },\n\n    heading: {\n      attrs: {level: {default: 1}},\n      content: \"(text | image)*\",\n      group: \"block\",\n      defining: true,\n      parseDOM: [{tag: \"h1\", attrs: {level: 1}},\n                 {tag: \"h2\", attrs: {level: 2}},\n                 {tag: \"h3\", attrs: {level: 3}},\n                 {tag: \"h4\", attrs: {level: 4}},\n                 {tag: \"h5\", attrs: {level: 5}},\n                 {tag: \"h6\", attrs: {level: 6}}],\n      toDOM(node) { return [\"h\" + node.attrs.level, 0] }\n    },\n\n    code_block: {\n      content: \"text*\",\n      group: \"block\",\n      code: true,\n      defining: true,\n      marks: \"\",\n      attrs: {params: {default: \"\"}},\n      parseDOM: [{tag: \"pre\", preserveWhitespace: \"full\", getAttrs: node => (\n        {params: node.getAttribute(\"data-params\") || \"\"}\n      )}],\n      toDOM(node) { return [\"pre\", node.attrs.params ? {\"data-params\": node.attrs.params} : {}, [\"code\", 0]] }\n    },\n\n    ordered_list: {\n      content: \"list_item+\",\n      group: \"block\",\n      attrs: {order: {default: 1}, tight: {default: false}},\n      parseDOM: [{tag: \"ol\", getAttrs(dom) {\n        return {order: dom.hasAttribute(\"start\") ? +dom.getAttribute(\"start\") : 1,\n                tight: dom.hasAttribute(\"data-tight\")}\n      }}],\n      toDOM(node) {\n        return [\"ol\", {start: node.attrs.order == 1 ? null : node.attrs.order,\n                       \"data-tight\": node.attrs.tight ? \"true\" : null}, 0]\n      }\n    },\n\n    bullet_list: {\n      content: \"list_item+\",\n      group: \"block\",\n      attrs: {tight: {default: false}},\n      parseDOM: [{tag: \"ul\", getAttrs: dom => ({tight: dom.hasAttribute(\"data-tight\")})}],\n      toDOM(node) { return [\"ul\", {\"data-tight\": node.attrs.tight ? \"true\" : null}, 0] }\n    },\n\n    list_item: {\n      content: \"paragraph block*\",\n      defining: true,\n      parseDOM: [{tag: \"li\"}],\n      toDOM() { return [\"li\", 0] }\n    },\n\n    text: {\n      group: \"inline\"\n    },\n\n    image: {\n      inline: true,\n      attrs: {\n        src: {},\n        alt: {default: null},\n        title: {default: null}\n      },\n      group: \"inline\",\n      draggable: true,\n      parseDOM: [{tag: \"img[src]\", getAttrs(dom) {\n        return {\n          src: dom.getAttribute(\"src\"),\n          title: dom.getAttribute(\"title\"),\n          alt: dom.getAttribute(\"alt\")\n        }\n      }}],\n      toDOM(node) { return [\"img\", node.attrs] }\n    },\n\n    hard_break: {\n      inline: true,\n      group: \"inline\",\n      selectable: false,\n      parseDOM: [{tag: \"br\"}],\n      toDOM() { return [\"br\"] }\n    }\n  },\n\n  marks: {\n    em: {\n      parseDOM: [{tag: \"i\"}, {tag: \"em\"},\n                 {style: \"font-style\", getAttrs: value => value == \"italic\" && null}],\n      toDOM() { return [\"em\"] }\n    },\n\n    strong: {\n      parseDOM: [{tag: \"b\"}, {tag: \"strong\"},\n                 {style: \"font-weight\", getAttrs: value => /^(bold(er)?|[5-9]\\d{2,})$/.test(value) && null}],\n      toDOM() { return [\"strong\"] }\n    },\n\n    link: {\n      attrs: {\n        href: {},\n        title: {default: null}\n      },\n      inclusive: false,\n      parseDOM: [{tag: \"a[href]\", getAttrs(dom) {\n        return {href: dom.getAttribute(\"href\"), title: dom.getAttribute(\"title\")}\n      }}],\n      toDOM(node) { return [\"a\", node.attrs] }\n    },\n\n    code: {\n      parseDOM: [{tag: \"code\"}],\n      toDOM() { return [\"code\"] }\n    }\n  }\n})\n","import markdownit from \"markdown-it\"\nimport {schema} from \"./schema\"\nimport {Mark} from \"prosemirror-model\"\n\nfunction maybeMerge(a, b) {\n  if (a.isText && b.isText && Mark.sameSet(a.marks, b.marks))\n    return a.withText(a.text + b.text)\n}\n\n// Object used to track the context of a running parse.\nclass MarkdownParseState {\n  constructor(schema, tokenHandlers) {\n    this.schema = schema\n    this.stack = [{type: schema.topNodeType, content: []}]\n    this.marks = Mark.none\n    this.tokenHandlers = tokenHandlers\n  }\n\n  top() {\n    return this.stack[this.stack.length - 1]\n  }\n\n  push(elt) {\n    if (this.stack.length) this.top().content.push(elt)\n  }\n\n  // : (string)\n  // Adds the given text to the current position in the document,\n  // using the current marks as styling.\n  addText(text) {\n    if (!text) return\n    let nodes = this.top().content, last = nodes[nodes.length - 1]\n    let node = this.schema.text(text, this.marks), merged\n    if (last && (merged = maybeMerge(last, node))) nodes[nodes.length - 1] = merged\n    else nodes.push(node)\n  }\n\n  // : (Mark)\n  // Adds the given mark to the set of active marks.\n  openMark(mark) {\n    this.marks = mark.addToSet(this.marks)\n  }\n\n  // : (Mark)\n  // Removes the given mark from the set of active marks.\n  closeMark(mark) {\n    this.marks = mark.removeFromSet(this.marks)\n  }\n\n  parseTokens(toks) {\n    for (let i = 0; i < toks.length; i++) {\n      let tok = toks[i]\n      let handler = this.tokenHandlers[tok.type]\n      if (!handler)\n        throw new Error(\"Token type `\" + tok.type + \"` not supported by Markdown parser\")\n      handler(this, tok, toks, i)\n    }\n  }\n\n  // : (NodeType, ?Object, ?[Node]) → ?Node\n  // Add a node at the current position.\n  addNode(type, attrs, content) {\n    let node = type.createAndFill(attrs, content, this.marks)\n    if (!node) return null\n    this.push(node)\n    return node\n  }\n\n  // : (NodeType, ?Object)\n  // Wrap subsequent content in a node of the given type.\n  openNode(type, attrs) {\n    this.stack.push({type: type, attrs: attrs, content: []})\n  }\n\n  // : () → ?Node\n  // Close and return the node that is currently on top of the stack.\n  closeNode() {\n    if (this.marks.length) this.marks = Mark.none\n    let info = this.stack.pop()\n    return this.addNode(info.type, info.attrs, info.content)\n  }\n}\n\nfunction attrs(spec, token, tokens, i) {\n  if (spec.getAttrs) return spec.getAttrs(token, tokens, i)\n  // For backwards compatibility when `attrs` is a Function\n  else if (spec.attrs instanceof Function) return spec.attrs(token)\n  else return spec.attrs\n}\n\n// Code content is represented as a single token with a `content`\n// property in Markdown-it.\nfunction noCloseToken(spec, type) {\n  return spec.noCloseToken || type == \"code_inline\" || type == \"code_block\" || type == \"fence\"\n}\n\nfunction withoutTrailingNewline(str) {\n  return str[str.length - 1] == \"\\n\" ? str.slice(0, str.length - 1) : str\n}\n\nfunction noOp() {}\n\nfunction tokenHandlers(schema, tokens) {\n  let handlers = Object.create(null)\n  for (let type in tokens) {\n    let spec = tokens[type]\n    if (spec.block) {\n      let nodeType = schema.nodeType(spec.block)\n      if (noCloseToken(spec, type)) {\n        handlers[type] = (state, tok, tokens, i) => {\n          state.openNode(nodeType, attrs(spec, tok, tokens, i))\n          state.addText(withoutTrailingNewline(tok.content))\n          state.closeNode()\n        }\n      } else {\n        handlers[type + \"_open\"] = (state, tok, tokens, i) => state.openNode(nodeType, attrs(spec, tok, tokens, i))\n        handlers[type + \"_close\"] = state => state.closeNode()\n      }\n    } else if (spec.node) {\n      let nodeType = schema.nodeType(spec.node)\n      handlers[type] = (state, tok, tokens, i) => state.addNode(nodeType, attrs(spec, tok, tokens, i))\n    } else if (spec.mark) {\n      let markType = schema.marks[spec.mark]\n      if (noCloseToken(spec, type)) {\n        handlers[type] = (state, tok, tokens, i) => {\n          state.openMark(markType.create(attrs(spec, tok, tokens, i)))\n          state.addText(withoutTrailingNewline(tok.content))\n          state.closeMark(markType)\n        }\n      } else {\n        handlers[type + \"_open\"] = (state, tok, tokens, i) => state.openMark(markType.create(attrs(spec, tok, tokens, i)))\n        handlers[type + \"_close\"] = state => state.closeMark(markType)\n      }\n    } else if (spec.ignore) {\n      if (noCloseToken(spec, type)) {\n        handlers[type] = noOp\n      } else {\n        handlers[type + \"_open\"] = noOp\n        handlers[type + \"_close\"] = noOp\n      }\n    } else {\n      throw new RangeError(\"Unrecognized parsing spec \" + JSON.stringify(spec))\n    }\n  }\n\n  handlers.text = (state, tok) => state.addText(tok.content)\n  handlers.inline = (state, tok) => state.parseTokens(tok.children)\n  handlers.softbreak = handlers.softbreak || (state => state.addText(\"\\n\"))\n\n  return handlers\n}\n\n// ::- A configuration of a Markdown parser. Such a parser uses\n// [markdown-it](https://github.com/markdown-it/markdown-it) to\n// tokenize a file, and then runs the custom rules it is given over\n// the tokens to create a ProseMirror document tree.\nexport class MarkdownParser {\n  // :: (Schema, MarkdownIt, Object)\n  // Create a parser with the given configuration. You can configure\n  // the markdown-it parser to parse the dialect you want, and provide\n  // a description of the ProseMirror entities those tokens map to in\n  // the `tokens` object, which maps token names to descriptions of\n  // what to do with them. Such a description is an object, and may\n  // have the following properties:\n  //\n  // **`node`**`: ?string`\n  //   : This token maps to a single node, whose type can be looked up\n  //     in the schema under the given name. Exactly one of `node`,\n  //     `block`, or `mark` must be set.\n  //\n  // **`block`**`: ?string`\n  //   : This token (unless `noCloseToken` is true) comes in `_open`\n  //     and `_close` variants (which are appended to the base token\n  //     name provides a the object property), and wraps a block of\n  //     content. The block should be wrapped in a node of the type\n  //     named to by the property's value. If the token does not have\n  //     `_open` or `_close`, use the `noCloseToken` option.\n  //\n  // **`mark`**`: ?string`\n  //   : This token (again, unless `noCloseToken` is true) also comes\n  //     in `_open` and `_close` variants, but should add a mark\n  //     (named by the value) to its content, rather than wrapping it\n  //     in a node.\n  //\n  // **`attrs`**`: ?Object`\n  //   : Attributes for the node or mark. When `getAttrs` is provided,\n  //     it takes precedence.\n  //\n  // **`getAttrs`**`: ?(MarkdownToken) → Object`\n  //   : A function used to compute the attributes for the node or mark\n  //     that takes a [markdown-it\n  //     token](https://markdown-it.github.io/markdown-it/#Token) and\n  //     returns an attribute object.\n  //\n  // **`noCloseToken`**`: ?boolean`\n  //   : Indicates that the [markdown-it\n  //     token](https://markdown-it.github.io/markdown-it/#Token) has\n  //     no `_open` or `_close` for the nodes. This defaults to `true`\n  //     for `code_inline`, `code_block` and `fence`.\n  //\n  // **`ignore`**`: ?bool`\n  //   : When true, ignore content for the matched token.\n  constructor(schema, tokenizer, tokens) {\n    // :: Object The value of the `tokens` object used to construct\n    // this parser. Can be useful to copy and modify to base other\n    // parsers on.\n    this.tokens = tokens\n    this.schema = schema\n    // :: This parser's markdown-it tokenizer.\n    this.tokenizer = tokenizer\n    this.tokenHandlers = tokenHandlers(schema, tokens)\n  }\n\n  // :: (string) → Node\n  // Parse a string as [CommonMark](http://commonmark.org/) markup,\n  // and create a ProseMirror document as prescribed by this parser's\n  // rules.\n  parse(text) {\n    let state = new MarkdownParseState(this.schema, this.tokenHandlers), doc\n    state.parseTokens(this.tokenizer.parse(text, {}))\n    do { doc = state.closeNode() } while (state.stack.length)\n    return doc || this.schema.topNodeType.createAndFill()\n  }\n}\n\nfunction listIsTight(tokens, i) {\n  while (++i < tokens.length)\n    if (tokens[i].type != \"list_item_open\") return tokens[i].hidden\n  return false\n}\n\n// :: MarkdownParser\n// A parser parsing unextended [CommonMark](http://commonmark.org/),\n// without inline HTML, and producing a document in the basic schema.\nexport const defaultMarkdownParser = new MarkdownParser(schema, markdownit(\"commonmark\", {html: false}), {\n  blockquote: {block: \"blockquote\"},\n  paragraph: {block: \"paragraph\"},\n  list_item: {block: \"list_item\"},\n  bullet_list: {block: \"bullet_list\", getAttrs: (_, tokens, i) => ({tight: listIsTight(tokens, i)})},\n  ordered_list: {block: \"ordered_list\", getAttrs: (tok, tokens, i) => ({\n    order: +tok.attrGet(\"start\") || 1,\n    tight: listIsTight(tokens, i)\n  })},\n  heading: {block: \"heading\", getAttrs: tok => ({level: +tok.tag.slice(1)})},\n  code_block: {block: \"code_block\", noCloseToken: true},\n  fence: {block: \"code_block\", getAttrs: tok => ({params: tok.info || \"\"}), noCloseToken: true},\n  hr: {node: \"horizontal_rule\"},\n  image: {node: \"image\", getAttrs: tok => ({\n    src: tok.attrGet(\"src\"),\n    title: tok.attrGet(\"title\") || null,\n    alt: tok.children[0] && tok.children[0].content || null\n  })},\n  hardbreak: {node: \"hard_break\"},\n\n  em: {mark: \"em\"},\n  strong: {mark: \"strong\"},\n  link: {mark: \"link\", getAttrs: tok => ({\n    href: tok.attrGet(\"href\"),\n    title: tok.attrGet(\"title\") || null\n  })},\n  code_inline: {mark: \"code\", noCloseToken: true}\n})\n","// ::- A specification for serializing a ProseMirror document as\n// Markdown/CommonMark text.\nexport class MarkdownSerializer {\n  // :: (Object<(state: MarkdownSerializerState, node: Node, parent: Node, index: number)>, Object, ?Object)\n  // Construct a serializer with the given configuration. The `nodes`\n  // object should map node names in a given schema to function that\n  // take a serializer state and such a node, and serialize the node.\n  //\n  // The `marks` object should hold objects with `open` and `close`\n  // properties, which hold the strings that should appear before and\n  // after a piece of text marked that way, either directly or as a\n  // function that takes a serializer state and a mark, and returns a\n  // string. `open` and `close` can also be functions, which will be\n  // called as\n  //\n  //     (state: MarkdownSerializerState, mark: Mark,\n  //      parent: Fragment, index: number) → string\n  //\n  // Where `parent` and `index` allow you to inspect the mark's\n  // context to see which nodes it applies to.\n  //\n  // Mark information objects can also have a `mixable` property\n  // which, when `true`, indicates that the order in which the mark's\n  // opening and closing syntax appears relative to other mixable\n  // marks can be varied. (For example, you can say `**a *b***` and\n  // `*a **b***`, but not `` `a *b*` ``.)\n  //\n  // To disable character escaping in a mark, you can give it an\n  // `escape` property of `false`. Such a mark has to have the highest\n  // precedence (must always be the innermost mark).\n  //\n  // The `expelEnclosingWhitespace` mark property causes the\n  // serializer to move enclosing whitespace from inside the marks to\n  // outside the marks. This is necessary for emphasis marks as\n  // CommonMark does not permit enclosing whitespace inside emphasis\n  // marks, see: http://spec.commonmark.org/0.26/#example-330\n  //\n  //   options::- Optional additional options.\n  //     escapeExtraCharacters:: ?RegExp\n  //     Extra characters can be added for escaping. This is passed\n  //     directly to String.replace(), and the matching characters are\n  //     preceded by a backslash.\n  constructor(nodes, marks, options) {\n    // :: Object<(MarkdownSerializerState, Node)> The node serializer\n    // functions for this serializer.\n    this.nodes = nodes\n    // :: Object The mark serializer info.\n    this.marks = marks\n    this.options = options || {}\n  }\n\n  // :: (Node, ?Object) → string\n  // Serialize the content of the given node to\n  // [CommonMark](http://commonmark.org/).\n  serialize(content, options) {\n    options = Object.assign(this.options, options)\n    let state = new MarkdownSerializerState(this.nodes, this.marks, options)\n    state.renderContent(content)\n    return state.out\n  }\n}\n\n// :: MarkdownSerializer\n// A serializer for the [basic schema](#schema).\nexport const defaultMarkdownSerializer = new MarkdownSerializer({\n  blockquote(state, node) {\n    state.wrapBlock(\"> \", null, node, () => state.renderContent(node))\n  },\n  code_block(state, node) {\n    state.write(\"```\" + (node.attrs.params || \"\") + \"\\n\")\n    state.text(node.textContent, false)\n    state.ensureNewLine()\n    state.write(\"```\")\n    state.closeBlock(node)\n  },\n  heading(state, node) {\n    state.write(state.repeat(\"#\", node.attrs.level) + \" \")\n    state.renderInline(node)\n    state.closeBlock(node)\n  },\n  horizontal_rule(state, node) {\n    state.write(node.attrs.markup || \"---\")\n    state.closeBlock(node)\n  },\n  bullet_list(state, node) {\n    state.renderList(node, \"  \", () => (node.attrs.bullet || \"*\") + \" \")\n  },\n  ordered_list(state, node) {\n    let start = node.attrs.order || 1\n    let maxW = String(start + node.childCount - 1).length\n    let space = state.repeat(\" \", maxW + 2)\n    state.renderList(node, space, i => {\n      let nStr = String(start + i)\n      return state.repeat(\" \", maxW - nStr.length) + nStr + \". \"\n    })\n  },\n  list_item(state, node) {\n    state.renderContent(node)\n  },\n  paragraph(state, node) {\n    state.renderInline(node)\n    state.closeBlock(node)\n  },\n\n  image(state, node) {\n    state.write(\"![\" + state.esc(node.attrs.alt || \"\") + \"](\" + node.attrs.src +\n                (node.attrs.title ? ' \"' + node.attrs.title.replace(/\"/g, '\\\\\"') + '\"' : \"\") + \")\")\n  },\n  hard_break(state, node, parent, index) {\n    for (let i = index + 1; i < parent.childCount; i++)\n      if (parent.child(i).type != node.type) {\n        state.write(\"\\\\\\n\")\n        return\n      }\n  },\n  text(state, node) {\n    state.text(node.text)\n  }\n}, {\n  em: {open: \"*\", close: \"*\", mixable: true, expelEnclosingWhitespace: true},\n  strong: {open: \"**\", close: \"**\", mixable: true, expelEnclosingWhitespace: true},\n  link: {\n    open(_state, mark, parent, index) {\n      return isPlainURL(mark, parent, index, 1) ? \"<\" : \"[\"\n    },\n    close(state, mark, parent, index) {\n      return isPlainURL(mark, parent, index, -1) ? \">\"\n        : \"](\" + mark.attrs.href + (mark.attrs.title ? ' \"' + mark.attrs.title.replace(/\"/g, '\\\\\"') + '\"' : \"\") + \")\"\n    }\n  },\n  code: {open(_state, _mark, parent, index) { return backticksFor(parent.child(index), -1) },\n         close(_state, _mark, parent, index) { return backticksFor(parent.child(index - 1), 1) },\n         escape: false}\n})\n\nfunction backticksFor(node, side) {\n  let ticks = /`+/g, m, len = 0\n  if (node.isText) while (m = ticks.exec(node.text)) len = Math.max(len, m[0].length)\n  let result = len > 0 && side > 0 ? \" `\" : \"`\"\n  for (let i = 0; i < len; i++) result += \"`\"\n  if (len > 0 && side < 0) result += \" \"\n  return result\n}\n\nfunction isPlainURL(link, parent, index, side) {\n  if (link.attrs.title || !/^\\w+:/.test(link.attrs.href)) return false\n  let content = parent.child(index + (side < 0 ? -1 : 0))\n  if (!content.isText || content.text != link.attrs.href || content.marks[content.marks.length - 1] != link) return false\n  if (index == (side < 0 ? 1 : parent.childCount - 1)) return true\n  let next = parent.child(index + (side < 0 ? -2 : 1))\n  return !link.isInSet(next.marks)\n}\n\n// ::- This is an object used to track state and expose\n// methods related to markdown serialization. Instances are passed to\n// node and mark serialization methods (see `toMarkdown`).\nexport class MarkdownSerializerState {\n  constructor(nodes, marks, options) {\n    this.nodes = nodes\n    this.marks = marks\n    this.delim = this.out = \"\"\n    this.closed = false\n    this.inTightList = false\n    // :: Object\n    // The options passed to the serializer.\n    //   tightLists:: ?bool\n    //   Whether to render lists in a tight style. This can be overridden\n    //   on a node level by specifying a tight attribute on the node.\n    //   Defaults to false.\n    this.options = options || {}\n    if (typeof this.options.tightLists == \"undefined\")\n      this.options.tightLists = false\n  }\n\n  flushClose(size) {\n    if (this.closed) {\n      if (!this.atBlank()) this.out += \"\\n\"\n      if (size == null) size = 2\n      if (size > 1) {\n        let delimMin = this.delim\n        let trim = /\\s+$/.exec(delimMin)\n        if (trim) delimMin = delimMin.slice(0, delimMin.length - trim[0].length)\n        for (let i = 1; i < size; i++)\n          this.out += delimMin + \"\\n\"\n      }\n      this.closed = false\n    }\n  }\n\n  // :: (string, ?string, Node, ())\n  // Render a block, prefixing each line with `delim`, and the first\n  // line in `firstDelim`. `node` should be the node that is closed at\n  // the end of the block, and `f` is a function that renders the\n  // content of the block.\n  wrapBlock(delim, firstDelim, node, f) {\n    let old = this.delim\n    this.write(firstDelim || delim)\n    this.delim += delim\n    f()\n    this.delim = old\n    this.closeBlock(node)\n  }\n\n  atBlank() {\n    return /(^|\\n)$/.test(this.out)\n  }\n\n  // :: ()\n  // Ensure the current content ends with a newline.\n  ensureNewLine() {\n    if (!this.atBlank()) this.out += \"\\n\"\n  }\n\n  // :: (?string)\n  // Prepare the state for writing output (closing closed paragraphs,\n  // adding delimiters, and so on), and then optionally add content\n  // (unescaped) to the output.\n  write(content) {\n    this.flushClose()\n    if (this.delim && this.atBlank())\n      this.out += this.delim\n    if (content) this.out += content\n  }\n\n  // :: (Node)\n  // Close the block for the given node.\n  closeBlock(node) {\n    this.closed = node\n  }\n\n  // :: (string, ?bool)\n  // Add the given text to the document. When escape is not `false`,\n  // it will be escaped.\n  text(text, escape) {\n    let lines = text.split(\"\\n\")\n    for (let i = 0; i < lines.length; i++) {\n      var startOfLine = this.atBlank() || this.closed\n      this.write()\n      this.out += escape !== false ? this.esc(lines[i], startOfLine) : lines[i]\n      if (i != lines.length - 1) this.out += \"\\n\"\n    }\n  }\n\n  // :: (Node)\n  // Render the given node as a block.\n  render(node, parent, index) {\n    if (typeof parent == \"number\") throw new Error(\"!\")\n    if (!this.nodes[node.type.name]) throw new Error(\"Token type `\" + node.type.name + \"` not supported by Markdown renderer\")\n    this.nodes[node.type.name](this, node, parent, index)\n  }\n\n  // :: (Node)\n  // Render the contents of `parent` as block nodes.\n  renderContent(parent) {\n    parent.forEach((node, _, i) => this.render(node, parent, i))\n  }\n\n  // :: (Node)\n  // Render the contents of `parent` as inline content.\n  renderInline(parent) {\n    let active = [], trailing = \"\"\n    let progress = (node, _, index) => {\n      let marks = node ? node.marks : []\n\n      // Remove marks from `hard_break` that are the last node inside\n      // that mark to prevent parser edge cases with new lines just\n      // before closing marks.\n      // (FIXME it'd be nice if we had a schema-agnostic way to\n      // identify nodes that serialize as hard breaks)\n      if (node && node.type.name === \"hard_break\")\n        marks = marks.filter(m => {\n          if (index + 1 == parent.childCount) return false\n          let next = parent.child(index + 1)\n          return m.isInSet(next.marks) && (!next.isText || /\\S/.test(next.text))\n        })\n\n      let leading = trailing\n      trailing = \"\"\n      // If whitespace has to be expelled from the node, adjust\n      // leading and trailing accordingly.\n      if (node && node.isText && marks.some(mark => {\n        let info = this.marks[mark.type.name]\n        return info && info.expelEnclosingWhitespace\n      })) {\n        let [_, lead, inner, trail] = /^(\\s*)(.*?)(\\s*)$/m.exec(node.text)\n        leading += lead\n        trailing = trail\n        if (lead || trail) {\n          node = inner ? node.withText(inner) : null\n          if (!node) marks = active\n        }\n      }\n\n      let inner = marks.length && marks[marks.length - 1], noEsc = inner && this.marks[inner.type.name].escape === false\n      let len = marks.length - (noEsc ? 1 : 0)\n\n      // Try to reorder 'mixable' marks, such as em and strong, which\n      // in Markdown may be opened and closed in different order, so\n      // that order of the marks for the token matches the order in\n      // active.\n      outer: for (let i = 0; i < len; i++) {\n        let mark = marks[i]\n        if (!this.marks[mark.type.name].mixable) break\n        for (let j = 0; j < active.length; j++) {\n          let other = active[j]\n          if (!this.marks[other.type.name].mixable) break\n          if (mark.eq(other)) {\n            if (i > j)\n              marks = marks.slice(0, j).concat(mark).concat(marks.slice(j, i)).concat(marks.slice(i + 1, len))\n            else if (j > i)\n              marks = marks.slice(0, i).concat(marks.slice(i + 1, j)).concat(mark).concat(marks.slice(j, len))\n            continue outer\n          }\n        }\n      }\n\n      // Find the prefix of the mark set that didn't change\n      let keep = 0\n      while (keep < Math.min(active.length, len) && marks[keep].eq(active[keep])) ++keep\n\n      // Close the marks that need to be closed\n      while (keep < active.length)\n        this.text(this.markString(active.pop(), false, parent, index), false)\n\n      // Output any previously expelled trailing whitespace outside the marks\n      if (leading) this.text(leading)\n\n      // Open the marks that need to be opened\n      if (node) {\n        while (active.length < len) {\n          let add = marks[active.length]\n          active.push(add)\n          this.text(this.markString(add, true, parent, index), false)\n        }\n\n        // Render the node. Special case code marks, since their content\n        // may not be escaped.\n        if (noEsc && node.isText)\n          this.text(this.markString(inner, true, parent, index) + node.text +\n                    this.markString(inner, false, parent, index + 1), false)\n        else\n          this.render(node, parent, index)\n      }\n    }\n    parent.forEach(progress)\n    progress(null, null, parent.childCount)\n  }\n\n  // :: (Node, string, (number) → string)\n  // Render a node's content as a list. `delim` should be the extra\n  // indentation added to all lines except the first in an item,\n  // `firstDelim` is a function going from an item index to a\n  // delimiter for the first line of the item.\n  renderList(node, delim, firstDelim) {\n    if (this.closed && this.closed.type == node.type)\n      this.flushClose(3)\n    else if (this.inTightList)\n      this.flushClose(1)\n\n    let isTight = typeof node.attrs.tight != \"undefined\" ? node.attrs.tight : this.options.tightLists\n    let prevTight = this.inTightList\n    this.inTightList = isTight\n    node.forEach((child, _, i) => {\n      if (i && isTight) this.flushClose(1)\n      this.wrapBlock(delim, firstDelim(i), node, () => this.render(child, node, i))\n    })\n    this.inTightList = prevTight\n  }\n\n  // :: (string, ?bool) → string\n  // Escape the given string so that it can safely appear in Markdown\n  // content. If `startOfLine` is true, also escape characters that\n  // have special meaning only at the start of the line.\n  esc(str, startOfLine) {\n    str = str.replace(\n      /[`*\\\\~\\[\\]_]/g, \n      (m, i) => m == \"_\" && i > 0 && i + 1 < str.length && str[i-1].match(/\\w/) && str[i+1].match(/\\w/) ?  m : \"\\\\\" + m\n    )\n    if (startOfLine) str = str.replace(/^[:#\\-*+>]/, \"\\\\$&\").replace(/^(\\s*\\d+)\\./, \"$1\\\\.\")\n    if (this.options.escapeExtraCharacters) str = str.replace(this.options.escapeExtraCharacters, \"\\\\$&\")\n    return str\n  }\n\n  quote(str) {\n    var wrap = str.indexOf('\"') == -1 ? '\"\"' : str.indexOf(\"'\") == -1 ? \"''\" : \"()\"\n    return wrap[0] + str + wrap[1]\n  }\n\n  // :: (string, number) → string\n  // Repeat the given string `n` times.\n  repeat(str, n) {\n    let out = \"\"\n    for (let i = 0; i < n; i++) out += str\n    return out\n  }\n\n  // : (Mark, bool, string?) → string\n  // Get the markdown string for a given opening or closing mark.\n  markString(mark, open, parent, index) {\n    let info = this.marks[mark.type.name]\n    let value = open ? info.open : info.close\n    return typeof value == \"string\" ? value : value(this, mark, parent, index)\n  }\n\n  // :: (string) → { leading: ?string, trailing: ?string }\n  // Get leading and trailing whitespace from a string. Values of\n  // leading or trailing property of the return object will be undefined\n  // if there is no match.\n  getEnclosingWhitespace(text) {\n    return {\n      leading: (text.match(/^(\\s+)/) || [])[0],\n      trailing: (text.match(/(\\s+)$/) || [])[0]\n    }\n  }\n}\n","export var base = {\n  8: \"Backspace\",\n  9: \"Tab\",\n  10: \"Enter\",\n  12: \"NumLock\",\n  13: \"Enter\",\n  16: \"Shift\",\n  17: \"Control\",\n  18: \"Alt\",\n  20: \"CapsLock\",\n  27: \"Escape\",\n  32: \" \",\n  33: \"PageUp\",\n  34: \"PageDown\",\n  35: \"End\",\n  36: \"Home\",\n  37: \"ArrowLeft\",\n  38: \"ArrowUp\",\n  39: \"ArrowRight\",\n  40: \"ArrowDown\",\n  44: \"PrintScreen\",\n  45: \"Insert\",\n  46: \"Delete\",\n  59: \";\",\n  61: \"=\",\n  91: \"Meta\",\n  92: \"Meta\",\n  106: \"*\",\n  107: \"+\",\n  108: \",\",\n  109: \"-\",\n  110: \".\",\n  111: \"/\",\n  144: \"NumLock\",\n  145: \"ScrollLock\",\n  160: \"Shift\",\n  161: \"Shift\",\n  162: \"Control\",\n  163: \"Control\",\n  164: \"Alt\",\n  165: \"Alt\",\n  173: \"-\",\n  186: \";\",\n  187: \"=\",\n  188: \",\",\n  189: \"-\",\n  190: \".\",\n  191: \"/\",\n  192: \"`\",\n  219: \"[\",\n  220: \"\\\\\",\n  221: \"]\",\n  222: \"'\",\n  229: \"q\"\n}\n\nexport var shift = {\n  48: \")\",\n  49: \"!\",\n  50: \"@\",\n  51: \"#\",\n  52: \"$\",\n  53: \"%\",\n  54: \"^\",\n  55: \"&\",\n  56: \"*\",\n  57: \"(\",\n  59: \":\",\n  61: \"+\",\n  173: \"_\",\n  186: \":\",\n  187: \"+\",\n  188: \"<\",\n  189: \"_\",\n  190: \">\",\n  191: \"?\",\n  192: \"~\",\n  219: \"{\",\n  220: \"|\",\n  221: \"}\",\n  222: \"\\\"\",\n  229: \"Q\"\n}\n\nvar chrome = typeof navigator != \"undefined\" && /Chrome\\/(\\d+)/.exec(navigator.userAgent)\nvar safari = typeof navigator != \"undefined\" && /Apple Computer/.test(navigator.vendor)\nvar gecko = typeof navigator != \"undefined\" && /Gecko\\/\\d+/.test(navigator.userAgent)\nvar mac = typeof navigator != \"undefined\" && /Mac/.test(navigator.platform)\nvar ie = typeof navigator != \"undefined\" && /MSIE \\d|Trident\\/(?:[7-9]|\\d{2,})\\..*rv:(\\d+)/.exec(navigator.userAgent)\nvar brokenModifierNames = chrome && (mac || +chrome[1] < 57) || gecko && mac\n\n// Fill in the digit keys\nfor (var i = 0; i < 10; i++) base[48 + i] = base[96 + i] = String(i)\n\n// The function keys\nfor (var i = 1; i <= 24; i++) base[i + 111] = \"F\" + i\n\n// And the alphabetic keys\nfor (var i = 65; i <= 90; i++) {\n  base[i] = String.fromCharCode(i + 32)\n  shift[i] = String.fromCharCode(i)\n}\n\n// For each code that doesn't have a shift-equivalent, copy the base name\nfor (var code in base) if (!shift.hasOwnProperty(code)) shift[code] = base[code]\n\nexport function keyName(event) {\n  // Don't trust event.key in Chrome when there are modifiers until\n  // they fix https://bugs.chromium.org/p/chromium/issues/detail?id=633838\n  var ignoreKey = brokenModifierNames && (event.ctrlKey || event.altKey || event.metaKey) ||\n    (safari || ie) && event.shiftKey && event.key && event.key.length == 1\n  var name = (!ignoreKey && event.key) ||\n    (event.shiftKey ? shift : base)[event.keyCode] ||\n    event.key || \"Unidentified\"\n  // Edge sometimes produces wrong names (Issue #3)\n  if (name == \"Esc\") name = \"Escape\"\n  if (name == \"Del\") name = \"Delete\"\n  // https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/8860571/\n  if (name == \"Left\") name = \"ArrowLeft\"\n  if (name == \"Up\") name = \"ArrowUp\"\n  if (name == \"Right\") name = \"ArrowRight\"\n  if (name == \"Down\") name = \"ArrowDown\"\n  return name\n}\n","import {base, keyName} from \"w3c-keyname\"\nimport {Plugin} from \"prosemirror-state\"\n\n// declare global: navigator\n\nconst mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform) : false\n\nfunction normalizeKeyName(name) {\n  let parts = name.split(/-(?!$)/), result = parts[parts.length - 1]\n  if (result == \"Space\") result = \" \"\n  let alt, ctrl, shift, meta\n  for (let i = 0; i < parts.length - 1; i++) {\n    let mod = parts[i]\n    if (/^(cmd|meta|m)$/i.test(mod)) meta = true\n    else if (/^a(lt)?$/i.test(mod)) alt = true\n    else if (/^(c|ctrl|control)$/i.test(mod)) ctrl = true\n    else if (/^s(hift)?$/i.test(mod)) shift = true\n    else if (/^mod$/i.test(mod)) { if (mac) meta = true; else ctrl = true }\n    else throw new Error(\"Unrecognized modifier name: \" + mod)\n  }\n  if (alt) result = \"Alt-\" + result\n  if (ctrl) result = \"Ctrl-\" + result\n  if (meta) result = \"Meta-\" + result\n  if (shift) result = \"Shift-\" + result\n  return result\n}\n\nfunction normalize(map) {\n  let copy = Object.create(null)\n  for (let prop in map) copy[normalizeKeyName(prop)] = map[prop]\n  return copy\n}\n\nfunction modifiers(name, event, shift) {\n  if (event.altKey) name = \"Alt-\" + name\n  if (event.ctrlKey) name = \"Ctrl-\" + name\n  if (event.metaKey) name = \"Meta-\" + name\n  if (shift !== false && event.shiftKey) name = \"Shift-\" + name\n  return name\n}\n\n// :: (Object) → Plugin\n// Create a keymap plugin for the given set of bindings.\n//\n// Bindings should map key names to [command](#commands)-style\n// functions, which will be called with `(EditorState, dispatch,\n// EditorView)` arguments, and should return true when they've handled\n// the key. Note that the view argument isn't part of the command\n// protocol, but can be used as an escape hatch if a binding needs to\n// directly interact with the UI.\n//\n// Key names may be strings like `\"Shift-Ctrl-Enter\"`—a key\n// identifier prefixed with zero or more modifiers. Key identifiers\n// are based on the strings that can appear in\n// [`KeyEvent.key`](https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key).\n// Use lowercase letters to refer to letter keys (or uppercase letters\n// if you want shift to be held). You may use `\"Space\"` as an alias\n// for the `\" \"` name.\n//\n// Modifiers can be given in any order. `Shift-` (or `s-`), `Alt-` (or\n// `a-`), `Ctrl-` (or `c-` or `Control-`) and `Cmd-` (or `m-` or\n// `Meta-`) are recognized. For characters that are created by holding\n// shift, the `Shift-` prefix is implied, and should not be added\n// explicitly.\n//\n// You can use `Mod-` as a shorthand for `Cmd-` on Mac and `Ctrl-` on\n// other platforms.\n//\n// You can add multiple keymap plugins to an editor. The order in\n// which they appear determines their precedence (the ones early in\n// the array get to dispatch first).\nexport function keymap(bindings) {\n  return new Plugin({props: {handleKeyDown: keydownHandler(bindings)}})\n}\n\n// :: (Object) → (view: EditorView, event: dom.Event) → bool\n// Given a set of bindings (using the same format as\n// [`keymap`](#keymap.keymap), return a [keydown\n// handler](#view.EditorProps.handleKeyDown) that handles them.\nexport function keydownHandler(bindings) {\n  let map = normalize(bindings)\n  return function(view, event) {\n    let name = keyName(event), isChar = name.length == 1 && name != \" \", baseName\n    let direct = map[modifiers(name, event, !isChar)]\n    if (direct && direct(view.state, view.dispatch, view)) return true\n    if (isChar && (event.shiftKey || event.altKey || event.metaKey || name.charCodeAt(0) > 127) &&\n        (baseName = base[event.keyCode]) && baseName != name) {\n      // Try falling back to the keyCode when there's a modifier\n      // active or the character produced isn't ASCII, and our table\n      // produces a different name from the the keyCode. See #668,\n      // #1060\n      let fromCode = map[modifiers(baseName, event, true)]\n      if (fromCode && fromCode(view.state, view.dispatch, view)) return true\n    } else if (isChar && event.shiftKey) {\n      // Otherwise, if shift is active, also try the binding with the\n      // Shift- prefix enabled. See #997\n      let withShift = map[modifiers(name, event, true)]\n      if (withShift && withShift(view.state, view.dispatch, view)) return true\n    }\n    return false\n  }\n}\n","var GOOD_LEAF_SIZE = 200;\n\n// :: class<T> A rope sequence is a persistent sequence data structure\n// that supports appending, prepending, and slicing without doing a\n// full copy. It is represented as a mostly-balanced tree.\nvar RopeSequence = function RopeSequence () {};\n\nRopeSequence.prototype.append = function append (other) {\n  if (!other.length) { return this }\n  other = RopeSequence.from(other);\n\n  return (!this.length && other) ||\n    (other.length < GOOD_LEAF_SIZE && this.leafAppend(other)) ||\n    (this.length < GOOD_LEAF_SIZE && other.leafPrepend(this)) ||\n    this.appendInner(other)\n};\n\n// :: (union<[T], RopeSequence<T>>) → RopeSequence<T>\n// Prepend an array or other rope to this one, returning a new rope.\nRopeSequence.prototype.prepend = function prepend (other) {\n  if (!other.length) { return this }\n  return RopeSequence.from(other).append(this)\n};\n\nRopeSequence.prototype.appendInner = function appendInner (other) {\n  return new Append(this, other)\n};\n\n// :: (?number, ?number) → RopeSequence<T>\n// Create a rope repesenting a sub-sequence of this rope.\nRopeSequence.prototype.slice = function slice (from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from >= to) { return RopeSequence.empty }\n  return this.sliceInner(Math.max(0, from), Math.min(this.length, to))\n};\n\n// :: (number) → T\n// Retrieve the element at the given position from this rope.\nRopeSequence.prototype.get = function get (i) {\n  if (i < 0 || i >= this.length) { return undefined }\n  return this.getInner(i)\n};\n\n// :: ((element: T, index: number) → ?bool, ?number, ?number)\n// Call the given function for each element between the given\n// indices. This tends to be more efficient than looping over the\n// indices and calling `get`, because it doesn't have to descend the\n// tree for every element.\nRopeSequence.prototype.forEach = function forEach (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  if (from <= to)\n    { this.forEachInner(f, from, to, 0); }\n  else\n    { this.forEachInvertedInner(f, from, to, 0); }\n};\n\n// :: ((element: T, index: number) → U, ?number, ?number) → [U]\n// Map the given functions over the elements of the rope, producing\n// a flat array.\nRopeSequence.prototype.map = function map (f, from, to) {\n    if ( from === void 0 ) from = 0;\n    if ( to === void 0 ) to = this.length;\n\n  var result = [];\n  this.forEach(function (elt, i) { return result.push(f(elt, i)); }, from, to);\n  return result\n};\n\n// :: (?union<[T], RopeSequence<T>>) → RopeSequence<T>\n// Create a rope representing the given array, or return the rope\n// itself if a rope was given.\nRopeSequence.from = function from (values) {\n  if (values instanceof RopeSequence) { return values }\n  return values && values.length ? new Leaf(values) : RopeSequence.empty\n};\n\nvar Leaf = /*@__PURE__*/(function (RopeSequence) {\n  function Leaf(values) {\n    RopeSequence.call(this);\n    this.values = values;\n  }\n\n  if ( RopeSequence ) Leaf.__proto__ = RopeSequence;\n  Leaf.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Leaf.prototype.constructor = Leaf;\n\n  var prototypeAccessors = { length: { configurable: true },depth: { configurable: true } };\n\n  Leaf.prototype.flatten = function flatten () {\n    return this.values\n  };\n\n  Leaf.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    return new Leaf(this.values.slice(from, to))\n  };\n\n  Leaf.prototype.getInner = function getInner (i) {\n    return this.values[i]\n  };\n\n  Leaf.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    for (var i = from; i < to; i++)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    for (var i = from - 1; i >= to; i--)\n      { if (f(this.values[i], start + i) === false) { return false } }\n  };\n\n  Leaf.prototype.leafAppend = function leafAppend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(this.values.concat(other.flatten())) }\n  };\n\n  Leaf.prototype.leafPrepend = function leafPrepend (other) {\n    if (this.length + other.length <= GOOD_LEAF_SIZE)\n      { return new Leaf(other.flatten().concat(this.values)) }\n  };\n\n  prototypeAccessors.length.get = function () { return this.values.length };\n\n  prototypeAccessors.depth.get = function () { return 0 };\n\n  Object.defineProperties( Leaf.prototype, prototypeAccessors );\n\n  return Leaf;\n}(RopeSequence));\n\n// :: RopeSequence\n// The empty rope sequence.\nRopeSequence.empty = new Leaf([]);\n\nvar Append = /*@__PURE__*/(function (RopeSequence) {\n  function Append(left, right) {\n    RopeSequence.call(this);\n    this.left = left;\n    this.right = right;\n    this.length = left.length + right.length;\n    this.depth = Math.max(left.depth, right.depth) + 1;\n  }\n\n  if ( RopeSequence ) Append.__proto__ = RopeSequence;\n  Append.prototype = Object.create( RopeSequence && RopeSequence.prototype );\n  Append.prototype.constructor = Append;\n\n  Append.prototype.flatten = function flatten () {\n    return this.left.flatten().concat(this.right.flatten())\n  };\n\n  Append.prototype.getInner = function getInner (i) {\n    return i < this.left.length ? this.left.get(i) : this.right.get(i - this.left.length)\n  };\n\n  Append.prototype.forEachInner = function forEachInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from < leftLen &&\n        this.left.forEachInner(f, from, Math.min(to, leftLen), start) === false)\n      { return false }\n    if (to > leftLen &&\n        this.right.forEachInner(f, Math.max(from - leftLen, 0), Math.min(this.length, to) - leftLen, start + leftLen) === false)\n      { return false }\n  };\n\n  Append.prototype.forEachInvertedInner = function forEachInvertedInner (f, from, to, start) {\n    var leftLen = this.left.length;\n    if (from > leftLen &&\n        this.right.forEachInvertedInner(f, from - leftLen, Math.max(to, leftLen) - leftLen, start + leftLen) === false)\n      { return false }\n    if (to < leftLen &&\n        this.left.forEachInvertedInner(f, Math.min(from, leftLen), to, start) === false)\n      { return false }\n  };\n\n  Append.prototype.sliceInner = function sliceInner (from, to) {\n    if (from == 0 && to == this.length) { return this }\n    var leftLen = this.left.length;\n    if (to <= leftLen) { return this.left.slice(from, to) }\n    if (from >= leftLen) { return this.right.slice(from - leftLen, to - leftLen) }\n    return this.left.slice(from, leftLen).append(this.right.slice(0, to - leftLen))\n  };\n\n  Append.prototype.leafAppend = function leafAppend (other) {\n    var inner = this.right.leafAppend(other);\n    if (inner) { return new Append(this.left, inner) }\n  };\n\n  Append.prototype.leafPrepend = function leafPrepend (other) {\n    var inner = this.left.leafPrepend(other);\n    if (inner) { return new Append(inner, this.right) }\n  };\n\n  Append.prototype.appendInner = function appendInner (other) {\n    if (this.left.depth >= Math.max(this.right.depth, other.depth) + 1)\n      { return new Append(this.left, new Append(this.right, other)) }\n    return new Append(this, other)\n  };\n\n  return Append;\n}(RopeSequence));\n\nvar ropeSequence = RopeSequence;\n\nexport default ropeSequence;\n","import RopeSequence from \"rope-sequence\"\nimport {Mapping} from \"prosemirror-transform\"\nimport {Plugin, PluginKey} from \"prosemirror-state\"\n\n// ProseMirror's history isn't simply a way to roll back to a previous\n// state, because ProseMirror supports applying changes without adding\n// them to the history (for example during collaboration).\n//\n// To this end, each 'Branch' (one for the undo history and one for\n// the redo history) keeps an array of 'Items', which can optionally\n// hold a step (an actual undoable change), and always hold a position\n// map (which is needed to move changes below them to apply to the\n// current document).\n//\n// An item that has both a step and a selection bookmark is the start\n// of an 'event' — a group of changes that will be undone or redone at\n// once. (It stores only the bookmark, since that way we don't have to\n// provide a document until the selection is actually applied, which\n// is useful when compressing.)\n\n// Used to schedule history compression\nconst max_empty_items = 500\n\nclass Branch {\n  constructor(items, eventCount) {\n    this.items = items\n    this.eventCount = eventCount\n  }\n\n  // : (EditorState, bool) → ?{transform: Transform, selection: ?SelectionBookmark, remaining: Branch}\n  // Pop the latest event off the branch's history and apply it\n  // to a document transform.\n  popEvent(state, preserveItems) {\n    if (this.eventCount == 0) return null\n\n    let end = this.items.length\n    for (;; end--) {\n      let next = this.items.get(end - 1)\n      if (next.selection) { --end; break }\n    }\n\n    let remap, mapFrom\n    if (preserveItems) {\n      remap = this.remapping(end, this.items.length)\n      mapFrom = remap.maps.length\n    }\n    let transform = state.tr\n    let selection, remaining\n    let addAfter = [], addBefore = []\n\n    this.items.forEach((item, i) => {\n      if (!item.step) {\n        if (!remap) {\n          remap = this.remapping(end, i + 1)\n          mapFrom = remap.maps.length\n        }\n        mapFrom--\n        addBefore.push(item)\n        return\n      }\n\n      if (remap) {\n        addBefore.push(new Item(item.map))\n        let step = item.step.map(remap.slice(mapFrom)), map\n\n        if (step && transform.maybeStep(step).doc) {\n          map = transform.mapping.maps[transform.mapping.maps.length - 1]\n          addAfter.push(new Item(map, null, null, addAfter.length + addBefore.length))\n        }\n        mapFrom--\n        if (map) remap.appendMap(map, mapFrom)\n      } else {\n        transform.maybeStep(item.step)\n      }\n\n      if (item.selection) {\n        selection = remap ? item.selection.map(remap.slice(mapFrom)) : item.selection\n        remaining = new Branch(this.items.slice(0, end).append(addBefore.reverse().concat(addAfter)), this.eventCount - 1)\n        return false\n      }\n    }, this.items.length, 0)\n\n    return {remaining, transform, selection}\n  }\n\n  // : (Transform, ?SelectionBookmark, Object) → Branch\n  // Create a new branch with the given transform added.\n  addTransform(transform, selection, histOptions, preserveItems) {\n    let newItems = [], eventCount = this.eventCount\n    let oldItems = this.items, lastItem = !preserveItems && oldItems.length ? oldItems.get(oldItems.length - 1) : null\n\n    for (let i = 0; i < transform.steps.length; i++) {\n      let step = transform.steps[i].invert(transform.docs[i])\n      let item = new Item(transform.mapping.maps[i], step, selection), merged\n      if (merged = lastItem && lastItem.merge(item)) {\n        item = merged\n        if (i) newItems.pop()\n        else oldItems = oldItems.slice(0, oldItems.length - 1)\n      }\n      newItems.push(item)\n      if (selection) {\n        eventCount++\n        selection = null\n      }\n      if (!preserveItems) lastItem = item\n    }\n    let overflow = eventCount - histOptions.depth\n    if (overflow > DEPTH_OVERFLOW) {\n      oldItems = cutOffEvents(oldItems, overflow)\n      eventCount -= overflow\n    }\n    return new Branch(oldItems.append(newItems), eventCount)\n  }\n\n  remapping(from, to) {\n    let maps = new Mapping\n    this.items.forEach((item, i) => {\n      let mirrorPos = item.mirrorOffset != null && i - item.mirrorOffset >= from\n          ? maps.maps.length - item.mirrorOffset : null\n      maps.appendMap(item.map, mirrorPos)\n    }, from, to)\n    return maps\n  }\n\n  addMaps(array) {\n    if (this.eventCount == 0) return this\n    return new Branch(this.items.append(array.map(map => new Item(map))), this.eventCount)\n  }\n\n  // : (Transform, number)\n  // When the collab module receives remote changes, the history has\n  // to know about those, so that it can adjust the steps that were\n  // rebased on top of the remote changes, and include the position\n  // maps for the remote changes in its array of items.\n  rebased(rebasedTransform, rebasedCount) {\n    if (!this.eventCount) return this\n\n    let rebasedItems = [], start = Math.max(0, this.items.length - rebasedCount)\n\n    let mapping = rebasedTransform.mapping\n    let newUntil = rebasedTransform.steps.length\n    let eventCount = this.eventCount\n    this.items.forEach(item => { if (item.selection) eventCount-- }, start)\n\n    let iRebased = rebasedCount\n    this.items.forEach(item => {\n      let pos = mapping.getMirror(--iRebased)\n      if (pos == null) return\n      newUntil = Math.min(newUntil, pos)\n      let map = mapping.maps[pos]\n      if (item.step) {\n        let step = rebasedTransform.steps[pos].invert(rebasedTransform.docs[pos])\n        let selection = item.selection && item.selection.map(mapping.slice(iRebased + 1, pos))\n        if (selection) eventCount++\n        rebasedItems.push(new Item(map, step, selection))\n      } else {\n        rebasedItems.push(new Item(map))\n      }\n    }, start)\n\n    let newMaps = []\n    for (let i = rebasedCount; i < newUntil; i++)\n      newMaps.push(new Item(mapping.maps[i]))\n    let items = this.items.slice(0, start).append(newMaps).append(rebasedItems)\n    let branch = new Branch(items, eventCount)\n\n    if (branch.emptyItemCount() > max_empty_items)\n      branch = branch.compress(this.items.length - rebasedItems.length)\n    return branch\n  }\n\n  emptyItemCount() {\n    let count = 0\n    this.items.forEach(item => { if (!item.step) count++ })\n    return count\n  }\n\n  // Compressing a branch means rewriting it to push the air (map-only\n  // items) out. During collaboration, these naturally accumulate\n  // because each remote change adds one. The `upto` argument is used\n  // to ensure that only the items below a given level are compressed,\n  // because `rebased` relies on a clean, untouched set of items in\n  // order to associate old items with rebased steps.\n  compress(upto = this.items.length) {\n    let remap = this.remapping(0, upto), mapFrom = remap.maps.length\n    let items = [], events = 0\n    this.items.forEach((item, i) => {\n      if (i >= upto) {\n        items.push(item)\n        if (item.selection) events++\n      } else if (item.step) {\n        let step = item.step.map(remap.slice(mapFrom)), map = step && step.getMap()\n        mapFrom--\n        if (map) remap.appendMap(map, mapFrom)\n        if (step) {\n          let selection = item.selection && item.selection.map(remap.slice(mapFrom))\n          if (selection) events++\n          let newItem = new Item(map.invert(), step, selection), merged, last = items.length - 1\n          if (merged = items.length && items[last].merge(newItem))\n            items[last] = merged\n          else\n            items.push(newItem)\n        }\n      } else if (item.map) {\n        mapFrom--\n      }\n    }, this.items.length, 0)\n    return new Branch(RopeSequence.from(items.reverse()), events)\n  }\n}\n\nBranch.empty = new Branch(RopeSequence.empty, 0)\n\nfunction cutOffEvents(items, n) {\n  let cutPoint\n  items.forEach((item, i) => {\n    if (item.selection && (n-- == 0)) {\n      cutPoint = i\n      return false\n    }\n  })\n  return items.slice(cutPoint)\n}\n\nclass Item {\n  constructor(map, step, selection, mirrorOffset) {\n    // The (forward) step map for this item.\n    this.map = map\n    // The inverted step\n    this.step = step\n    // If this is non-null, this item is the start of a group, and\n    // this selection is the starting selection for the group (the one\n    // that was active before the first step was applied)\n    this.selection = selection\n    // If this item is the inverse of a previous mapping on the stack,\n    // this points at the inverse's offset\n    this.mirrorOffset = mirrorOffset\n  }\n\n  merge(other) {\n    if (this.step && other.step && !other.selection) {\n      let step = other.step.merge(this.step)\n      if (step) return new Item(step.getMap().invert(), step, this.selection)\n    }\n  }\n}\n\n// The value of the state field that tracks undo/redo history for that\n// state. Will be stored in the plugin state when the history plugin\n// is active.\nexport class HistoryState {\n  constructor(done, undone, prevRanges, prevTime) {\n    this.done = done\n    this.undone = undone\n    this.prevRanges = prevRanges\n    this.prevTime = prevTime\n  }\n}\n\nconst DEPTH_OVERFLOW = 20\n\n// : (HistoryState, EditorState, Transaction, Object)\n// Record a transformation in undo history.\nfunction applyTransaction(history, state, tr, options) {\n  let historyTr = tr.getMeta(historyKey), rebased\n  if (historyTr) return historyTr.historyState\n\n  if (tr.getMeta(closeHistoryKey)) history = new HistoryState(history.done, history.undone, null, 0)\n\n  let appended = tr.getMeta(\"appendedTransaction\")\n\n  if (tr.steps.length == 0) {\n    return history\n  } else if (appended && appended.getMeta(historyKey)) {\n    if (appended.getMeta(historyKey).redo)\n      return new HistoryState(history.done.addTransform(tr, null, options, mustPreserveItems(state)),\n                              history.undone, rangesFor(tr.mapping.maps[tr.steps.length - 1]), history.prevTime)\n    else\n      return new HistoryState(history.done, history.undone.addTransform(tr, null, options, mustPreserveItems(state)),\n                              null, history.prevTime)\n  } else if (tr.getMeta(\"addToHistory\") !== false && !(appended && appended.getMeta(\"addToHistory\") === false)) {\n    // Group transforms that occur in quick succession into one event.\n    let newGroup = history.prevTime == 0 || !appended && (history.prevTime < (tr.time || 0) - options.newGroupDelay ||\n                                                          !isAdjacentTo(tr, history.prevRanges))\n    let prevRanges = appended ? mapRanges(history.prevRanges, tr.mapping) : rangesFor(tr.mapping.maps[tr.steps.length - 1])\n    return new HistoryState(history.done.addTransform(tr, newGroup ? state.selection.getBookmark() : null,\n                                                      options, mustPreserveItems(state)),\n                            Branch.empty, prevRanges, tr.time)\n  } else if (rebased = tr.getMeta(\"rebased\")) {\n    // Used by the collab module to tell the history that some of its\n    // content has been rebased.\n    return new HistoryState(history.done.rebased(tr, rebased),\n                            history.undone.rebased(tr, rebased),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  } else {\n    return new HistoryState(history.done.addMaps(tr.mapping.maps),\n                            history.undone.addMaps(tr.mapping.maps),\n                            mapRanges(history.prevRanges, tr.mapping), history.prevTime)\n  }\n}\n\nfunction isAdjacentTo(transform, prevRanges) {\n  if (!prevRanges) return false\n  if (!transform.docChanged) return true\n  let adjacent = false\n  transform.mapping.maps[0].forEach((start, end) => {\n    for (let i = 0; i < prevRanges.length; i += 2)\n      if (start <= prevRanges[i + 1] && end >= prevRanges[i])\n        adjacent = true\n  })\n  return adjacent\n}\n\nfunction rangesFor(map) {\n  let result = []\n  map.forEach((_from, _to, from, to) => result.push(from, to))\n  return result\n}\n\nfunction mapRanges(ranges, mapping) {\n  if (!ranges) return null\n  let result = []\n  for (let i = 0; i < ranges.length; i += 2) {\n    let from = mapping.map(ranges[i], 1), to = mapping.map(ranges[i + 1], -1)\n    if (from <= to) result.push(from, to)\n  }\n  return result\n}\n\n// : (HistoryState, EditorState, (tr: Transaction), bool)\n// Apply the latest event from one branch to the document and shift the event\n// onto the other branch.\nfunction histTransaction(history, state, dispatch, redo) {\n  let preserveItems = mustPreserveItems(state), histOptions = historyKey.get(state).spec.config\n  let pop = (redo ? history.undone : history.done).popEvent(state, preserveItems)\n  if (!pop) return\n\n  let selection = pop.selection.resolve(pop.transform.doc)\n  let added = (redo ? history.done : history.undone).addTransform(pop.transform, state.selection.getBookmark(),\n                                                                  histOptions, preserveItems)\n\n  let newHist = new HistoryState(redo ? added : pop.remaining, redo ? pop.remaining : added, null, 0)\n  dispatch(pop.transform.setSelection(selection).setMeta(historyKey, {redo, historyState: newHist}).scrollIntoView())\n}\n\nlet cachedPreserveItems = false, cachedPreserveItemsPlugins = null\n// Check whether any plugin in the given state has a\n// `historyPreserveItems` property in its spec, in which case we must\n// preserve steps exactly as they came in, so that they can be\n// rebased.\nfunction mustPreserveItems(state) {\n  let plugins = state.plugins\n  if (cachedPreserveItemsPlugins != plugins) {\n    cachedPreserveItems = false\n    cachedPreserveItemsPlugins = plugins\n    for (let i = 0; i < plugins.length; i++) if (plugins[i].spec.historyPreserveItems) {\n      cachedPreserveItems = true\n      break\n    }\n  }\n  return cachedPreserveItems\n}\n\n// :: (Transaction) → Transaction\n// Set a flag on the given transaction that will prevent further steps\n// from being appended to an existing history event (so that they\n// require a separate undo command to undo).\nexport function closeHistory(tr) {\n  return tr.setMeta(closeHistoryKey, true)\n}\n\nconst historyKey = new PluginKey(\"history\")\nconst closeHistoryKey = new PluginKey(\"closeHistory\")\n\n// :: (?Object) → Plugin\n// Returns a plugin that enables the undo history for an editor. The\n// plugin will track undo and redo stacks, which can be used with the\n// [`undo`](#history.undo) and [`redo`](#history.redo) commands.\n//\n// You can set an `\"addToHistory\"` [metadata\n// property](#state.Transaction.setMeta) of `false` on a transaction\n// to prevent it from being rolled back by undo.\n//\n//   config::-\n//   Supports the following configuration options:\n//\n//     depth:: ?number\n//     The amount of history events that are collected before the\n//     oldest events are discarded. Defaults to 100.\n//\n//     newGroupDelay:: ?number\n//     The delay between changes after which a new group should be\n//     started. Defaults to 500 (milliseconds). Note that when changes\n//     aren't adjacent, a new group is always started.\nexport function history(config) {\n  config = {depth: config && config.depth || 100,\n            newGroupDelay: config && config.newGroupDelay || 500}\n  return new Plugin({\n    key: historyKey,\n\n    state: {\n      init() {\n        return new HistoryState(Branch.empty, Branch.empty, null, 0)\n      },\n      apply(tr, hist, state) {\n        return applyTransaction(hist, state, tr, config)\n      }\n    },\n\n    config\n  })\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// A command function that undoes the last change, if any.\nexport function undo(state, dispatch) {\n  let hist = historyKey.getState(state)\n  if (!hist || hist.done.eventCount == 0) return false\n  if (dispatch) histTransaction(hist, state, dispatch, false)\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// A command function that redoes the last undone change, if any.\nexport function redo(state, dispatch) {\n  let hist = historyKey.getState(state)\n  if (!hist || hist.undone.eventCount == 0) return false\n  if (dispatch) histTransaction(hist, state, dispatch, true)\n  return true\n}\n\n// :: (EditorState) → number\n// The amount of undoable events available in a given state.\nexport function undoDepth(state) {\n  let hist = historyKey.getState(state)\n  return hist ? hist.done.eventCount : 0\n}\n\n// :: (EditorState) → number\n// The amount of redoable events available in a given editor state.\nexport function redoDepth(state) {\n  let hist = historyKey.getState(state)\n  return hist ? hist.undone.eventCount : 0\n}\n","import {joinPoint, canJoin, findWrapping, liftTarget, canSplit, ReplaceAroundStep} from \"prosemirror-transform\"\nimport {Slice, Fragment} from \"prosemirror-model\"\nimport {Selection, TextSelection, NodeSelection, AllSelection} from \"prosemirror-state\"\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Delete the selection, if there is one.\nexport function deleteSelection(state, dispatch) {\n  if (state.selection.empty) return false\n  if (dispatch) dispatch(state.tr.deleteSelection().scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// If the selection is empty and at the start of a textblock, try to\n// reduce the distance between that block and the one before it—if\n// there's a block directly before it that can be joined, join them.\n// If not, try to move the selected block closer to the next one in\n// the document structure by lifting it out of its parent or moving it\n// into a parent of the previous block. Will use the view for accurate\n// (bidi-aware) start-of-textblock detection if given.\nexport function joinBackward(state, dispatch, view) {\n  let {$cursor} = state.selection\n  if (!$cursor || (view ? !view.endOfTextblock(\"backward\", state)\n                        : $cursor.parentOffset > 0))\n    return false\n\n  let $cut = findCutBefore($cursor)\n\n  // If there is no node before this, try to lift\n  if (!$cut) {\n    let range = $cursor.blockRange(), target = range && liftTarget(range)\n    if (target == null) return false\n    if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n    return true\n  }\n\n  let before = $cut.nodeBefore\n  // Apply the joining algorithm\n  if (!before.type.spec.isolating && deleteBarrier(state, $cut, dispatch))\n    return true\n\n  // If the node below has no content and the node above is\n  // selectable, delete the node below and select the one above.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(before, \"end\") || NodeSelection.isSelectable(before))) {\n    if (dispatch) {\n      let tr = state.tr.deleteRange($cursor.before(), $cursor.after())\n      tr.setSelection(textblockAt(before, \"end\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos, -1)), -1)\n                      : NodeSelection.create(tr.doc, $cut.pos - before.nodeSize))\n      dispatch(tr.scrollIntoView())\n    }\n    return true\n  }\n\n  // If the node before is an atom, delete it\n  if (before.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) dispatch(state.tr.delete($cut.pos - before.nodeSize, $cut.pos).scrollIntoView())\n    return true\n  }\n\n  return false\n}\n\nfunction textblockAt(node, side) {\n  for (; node; node = (side == \"start\" ? node.firstChild : node.lastChild))\n    if (node.isTextblock) return true\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// When the selection is empty and at the start of a textblock, select\n// the node before that textblock, if possible. This is intended to be\n// bound to keys like backspace, after\n// [`joinBackward`](#commands.joinBackward) or other deleting\n// commands, as a fall-back behavior when the schema doesn't allow\n// deletion at the selected point.\nexport function selectNodeBackward(state, dispatch, view) {\n  let {$head, empty} = state.selection, $cut = $head\n  if (!empty) return false\n\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"backward\", state) : $head.parentOffset > 0) return false\n    $cut = findCutBefore($head)\n  }\n  let node = $cut && $cut.nodeBefore\n  if (!node || !NodeSelection.isSelectable(node)) return false\n  if (dispatch)\n    dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos - node.nodeSize)).scrollIntoView())\n  return true\n}\n\nfunction findCutBefore($pos) {\n  if (!$pos.parent.type.spec.isolating) for (let i = $pos.depth - 1; i >= 0; i--) {\n    if ($pos.index(i) > 0) return $pos.doc.resolve($pos.before(i + 1))\n    if ($pos.node(i).type.spec.isolating) break\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// If the selection is empty and the cursor is at the end of a\n// textblock, try to reduce or remove the boundary between that block\n// and the one after it, either by joining them or by moving the other\n// block closer to this one in the tree structure. Will use the view\n// for accurate start-of-textblock detection if given.\nexport function joinForward(state, dispatch, view) {\n  let {$cursor} = state.selection\n  if (!$cursor || (view ? !view.endOfTextblock(\"forward\", state)\n                        : $cursor.parentOffset < $cursor.parent.content.size))\n    return false\n\n  let $cut = findCutAfter($cursor)\n\n  // If there is no node after this, there's nothing to do\n  if (!$cut) return false\n\n  let after = $cut.nodeAfter\n  // Try the joining algorithm\n  if (deleteBarrier(state, $cut, dispatch)) return true\n\n  // If the node above has no content and the node below is\n  // selectable, delete the node above and select the one below.\n  if ($cursor.parent.content.size == 0 &&\n      (textblockAt(after, \"start\") || NodeSelection.isSelectable(after))) {\n    if (dispatch) {\n      let tr = state.tr.deleteRange($cursor.before(), $cursor.after())\n      tr.setSelection(textblockAt(after, \"start\") ? Selection.findFrom(tr.doc.resolve(tr.mapping.map($cut.pos)), 1)\n                      : NodeSelection.create(tr.doc, tr.mapping.map($cut.pos)))\n      dispatch(tr.scrollIntoView())\n    }\n    return true\n  }\n\n  // If the next node is an atom, delete it\n  if (after.isAtom && $cut.depth == $cursor.depth - 1) {\n    if (dispatch) dispatch(state.tr.delete($cut.pos, $cut.pos + after.nodeSize).scrollIntoView())\n    return true\n  }\n\n  return false\n}\n\n// :: (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// When the selection is empty and at the end of a textblock, select\n// the node coming after that textblock, if possible. This is intended\n// to be bound to keys like delete, after\n// [`joinForward`](#commands.joinForward) and similar deleting\n// commands, to provide a fall-back behavior when the schema doesn't\n// allow deletion at the selected point.\nexport function selectNodeForward(state, dispatch, view) {\n  let {$head, empty} = state.selection, $cut = $head\n  if (!empty) return false\n  if ($head.parent.isTextblock) {\n    if (view ? !view.endOfTextblock(\"forward\", state) : $head.parentOffset < $head.parent.content.size)\n      return false\n    $cut = findCutAfter($head)\n  }\n  let node = $cut && $cut.nodeAfter\n  if (!node || !NodeSelection.isSelectable(node)) return false\n  if (dispatch)\n    dispatch(state.tr.setSelection(NodeSelection.create(state.doc, $cut.pos)).scrollIntoView())\n  return true\n}\n\nfunction findCutAfter($pos) {\n  if (!$pos.parent.type.spec.isolating) for (let i = $pos.depth - 1; i >= 0; i--) {\n    let parent = $pos.node(i)\n    if ($pos.index(i) + 1 < parent.childCount) return $pos.doc.resolve($pos.after(i + 1))\n    if (parent.type.spec.isolating) break\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Join the selected block or, if there is a text selection, the\n// closest ancestor block of the selection that can be joined, with\n// the sibling above it.\nexport function joinUp(state, dispatch) {\n  let sel = state.selection, nodeSel = sel instanceof NodeSelection, point\n  if (nodeSel) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.from)) return false\n    point = sel.from\n  } else {\n    point = joinPoint(state.doc, sel.from, -1)\n    if (point == null) return false\n  }\n  if (dispatch) {\n    let tr = state.tr.join(point)\n    if (nodeSel) tr.setSelection(NodeSelection.create(tr.doc, point - state.doc.resolve(point).nodeBefore.nodeSize))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Join the selected block, or the closest ancestor of the selection\n// that can be joined, with the sibling after it.\nexport function joinDown(state, dispatch) {\n  let sel = state.selection, point\n  if (sel instanceof NodeSelection) {\n    if (sel.node.isTextblock || !canJoin(state.doc, sel.to)) return false\n    point = sel.to\n  } else {\n    point = joinPoint(state.doc, sel.to, 1)\n    if (point == null) return false\n  }\n  if (dispatch)\n    dispatch(state.tr.join(point).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Lift the selected block, or the closest ancestor block of the\n// selection that can be lifted, out of its parent node.\nexport function lift(state, dispatch) {\n  let {$from, $to} = state.selection\n  let range = $from.blockRange($to), target = range && liftTarget(range)\n  if (target == null) return false\n  if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If the selection is in a node whose type has a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, replace the\n// selection with a newline character.\nexport function newlineInCode(state, dispatch) {\n  let {$head, $anchor} = state.selection\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) return false\n  if (dispatch) dispatch(state.tr.insertText(\"\\n\").scrollIntoView())\n  return true\n}\n\nfunction defaultBlockAt(match) {\n  for (let i = 0; i < match.edgeCount; i++) {\n    let {type} = match.edge(i)\n    if (type.isTextblock && !type.hasRequiredAttrs()) return type\n  }\n  return null\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// When the selection is in a node with a truthy\n// [`code`](#model.NodeSpec.code) property in its spec, create a\n// default block after the code block, and move the cursor there.\nexport function exitCode(state, dispatch) {\n  let {$head, $anchor} = state.selection\n  if (!$head.parent.type.spec.code || !$head.sameParent($anchor)) return false\n  let above = $head.node(-1), after = $head.indexAfter(-1), type = defaultBlockAt(above.contentMatchAt(after))\n  if (!above.canReplaceWith(after, after, type)) return false\n  if (dispatch) {\n    let pos = $head.after(), tr = state.tr.replaceWith(pos, pos, type.createAndFill())\n    tr.setSelection(Selection.near(tr.doc.resolve(pos), 1))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If a block node is selected, create an empty paragraph before (if\n// it is its parent's first child) or after it.\nexport function createParagraphNear(state, dispatch) {\n  let {$from, $to} = state.selection\n  if ($from.parent.inlineContent || $to.parent.inlineContent) return false\n  let type = defaultBlockAt($from.parent.contentMatchAt($to.indexAfter()))\n  if (!type || !type.isTextblock) return false\n  if (dispatch) {\n    let side = (!$from.parentOffset && $to.index() < $to.parent.childCount ? $from : $to).pos\n    let tr = state.tr.insert(side, type.createAndFill())\n    tr.setSelection(TextSelection.create(tr.doc, side + 1))\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// If the cursor is in an empty textblock that can be lifted, lift the\n// block.\nexport function liftEmptyBlock(state, dispatch) {\n  let {$cursor} = state.selection\n  if (!$cursor || $cursor.parent.content.size) return false\n  if ($cursor.depth > 1 && $cursor.after() != $cursor.end(-1)) {\n    let before = $cursor.before()\n    if (canSplit(state.doc, before)) {\n      if (dispatch) dispatch(state.tr.split(before).scrollIntoView())\n      return true\n    }\n  }\n  let range = $cursor.blockRange(), target = range && liftTarget(range)\n  if (target == null) return false\n  if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Split the parent block of the selection. If the selection is a text\n// selection, also delete its content.\nexport function splitBlock(state, dispatch) {\n  let {$from, $to} = state.selection\n  if (state.selection instanceof NodeSelection && state.selection.node.isBlock) {\n    if (!$from.parentOffset || !canSplit(state.doc, $from.pos)) return false\n    if (dispatch) dispatch(state.tr.split($from.pos).scrollIntoView())\n    return true\n  }\n\n  if (!$from.parent.isBlock) return false\n\n  if (dispatch) {\n    let atEnd = $to.parentOffset == $to.parent.content.size\n    let tr = state.tr\n    if (state.selection instanceof TextSelection) tr.deleteSelection()\n    let deflt = $from.depth == 0 ? null : defaultBlockAt($from.node(-1).contentMatchAt($from.indexAfter(-1)))\n    let types = atEnd && deflt ? [{type: deflt}] : null\n    let can = canSplit(tr.doc, tr.mapping.map($from.pos), 1, types)\n    if (!types && !can && canSplit(tr.doc, tr.mapping.map($from.pos), 1, deflt && [{type: deflt}])) {\n      types = [{type: deflt}]\n      can = true\n    }\n    if (can) {\n      tr.split(tr.mapping.map($from.pos), 1, types)\n      if (!atEnd && !$from.parentOffset && $from.parent.type != deflt &&\n          $from.node(-1).canReplace($from.index(-1), $from.indexAfter(-1), Fragment.from(deflt.create(), $from.parent)))\n        tr.setNodeMarkup(tr.mapping.map($from.before()), deflt)\n    }\n    dispatch(tr.scrollIntoView())\n  }\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Acts like [`splitBlock`](#commands.splitBlock), but without\n// resetting the set of active marks at the cursor.\nexport function splitBlockKeepMarks(state, dispatch) {\n  return splitBlock(state, dispatch && (tr => {\n    let marks = state.storedMarks || (state.selection.$to.parentOffset && state.selection.$from.marks())\n    if (marks) tr.ensureMarks(marks)\n    dispatch(tr)\n  }))\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Move the selection to the node wrapping the current selection, if\n// any. (Will not select the document node.)\nexport function selectParentNode(state, dispatch) {\n  let {$from, to} = state.selection, pos\n  let same = $from.sharedDepth(to)\n  if (same == 0) return false\n  pos = $from.before(same)\n  if (dispatch) dispatch(state.tr.setSelection(NodeSelection.create(state.doc, pos)))\n  return true\n}\n\n// :: (EditorState, ?(tr: Transaction)) → bool\n// Select the whole document.\nexport function selectAll(state, dispatch) {\n  if (dispatch) dispatch(state.tr.setSelection(new AllSelection(state.doc)))\n  return true\n}\n\nfunction joinMaybeClear(state, $pos, dispatch) {\n  let before = $pos.nodeBefore, after = $pos.nodeAfter, index = $pos.index()\n  if (!before || !after || !before.type.compatibleContent(after.type)) return false\n  if (!before.content.size && $pos.parent.canReplace(index - 1, index)) {\n    if (dispatch) dispatch(state.tr.delete($pos.pos - before.nodeSize, $pos.pos).scrollIntoView())\n    return true\n  }\n  if (!$pos.parent.canReplace(index, index + 1) || !(after.isTextblock || canJoin(state.doc, $pos.pos)))\n    return false\n  if (dispatch)\n    dispatch(state.tr\n             .clearIncompatible($pos.pos, before.type, before.contentMatchAt(before.childCount))\n             .join($pos.pos)\n             .scrollIntoView())\n  return true\n}\n\nfunction deleteBarrier(state, $cut, dispatch) {\n  let before = $cut.nodeBefore, after = $cut.nodeAfter, conn, match\n  if (before.type.spec.isolating || after.type.spec.isolating) return false\n  if (joinMaybeClear(state, $cut, dispatch)) return true\n\n  if ($cut.parent.canReplace($cut.index(), $cut.index() + 1) &&\n      (conn = (match = before.contentMatchAt(before.childCount)).findWrapping(after.type)) &&\n      match.matchType(conn[0] || after.type).validEnd) {\n    if (dispatch) {\n      let end = $cut.pos + after.nodeSize, wrap = Fragment.empty\n      for (let i = conn.length - 1; i >= 0; i--)\n        wrap = Fragment.from(conn[i].create(null, wrap))\n      wrap = Fragment.from(before.copy(wrap))\n      let tr = state.tr.step(new ReplaceAroundStep($cut.pos - 1, end, $cut.pos, end, new Slice(wrap, 1, 0), conn.length, true))\n      let joinAt = end + 2 * conn.length\n      if (canJoin(tr.doc, joinAt)) tr.join(joinAt)\n      dispatch(tr.scrollIntoView())\n    }\n    return true\n  }\n\n  let selAfter = Selection.findFrom($cut, 1)\n  let range = selAfter && selAfter.$from.blockRange(selAfter.$to), target = range && liftTarget(range)\n  if (target != null && target >= $cut.depth) {\n    if (dispatch) dispatch(state.tr.lift(range, target).scrollIntoView())\n    return true\n  }\n\n  return false\n}\n\n// Parameterized commands\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Wrap the selection in a node of the given type with the given\n// attributes.\nexport function wrapIn(nodeType, attrs) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to), wrapping = range && findWrapping(range, nodeType, attrs)\n    if (!wrapping) return false\n    if (dispatch) dispatch(state.tr.wrap(range, wrapping).scrollIntoView())\n    return true\n  }\n}\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Returns a command that tries to set the selected textblocks to the\n// given node type with the given attributes.\nexport function setBlockType(nodeType, attrs) {\n  return function(state, dispatch) {\n    let {from, to} = state.selection\n    let applicable = false\n    state.doc.nodesBetween(from, to, (node, pos) => {\n      if (applicable) return false\n      if (!node.isTextblock || node.hasMarkup(nodeType, attrs)) return\n      if (node.type == nodeType) {\n        applicable = true\n      } else {\n        let $pos = state.doc.resolve(pos), index = $pos.index()\n        applicable = $pos.parent.canReplaceWith(index, index + 1, nodeType)\n      }\n    })\n    if (!applicable) return false\n    if (dispatch) dispatch(state.tr.setBlockType(from, to, nodeType, attrs).scrollIntoView())\n    return true\n  }\n}\n\nfunction markApplies(doc, ranges, type) {\n  for (let i = 0; i < ranges.length; i++) {\n    let {$from, $to} = ranges[i]\n    let can = $from.depth == 0 ? doc.type.allowsMarkType(type) : false\n    doc.nodesBetween($from.pos, $to.pos, node => {\n      if (can) return false\n      can = node.inlineContent && node.type.allowsMarkType(type)\n    })\n    if (can) return true\n  }\n  return false\n}\n\n// :: (MarkType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command function that toggles the given mark with the\n// given attributes. Will return `false` when the current selection\n// doesn't support that mark. This will remove the mark if any marks\n// of that type exist in the selection, or add it otherwise. If the\n// selection is empty, this applies to the [stored\n// marks](#state.EditorState.storedMarks) instead of a range of the\n// document.\nexport function toggleMark(markType, attrs) {\n  return function(state, dispatch) {\n    let {empty, $cursor, ranges} = state.selection\n    if ((empty && !$cursor) || !markApplies(state.doc, ranges, markType)) return false\n    if (dispatch) {\n      if ($cursor) {\n        if (markType.isInSet(state.storedMarks || $cursor.marks()))\n          dispatch(state.tr.removeStoredMark(markType))\n        else\n          dispatch(state.tr.addStoredMark(markType.create(attrs)))\n      } else {\n        let has = false, tr = state.tr\n        for (let i = 0; !has && i < ranges.length; i++) {\n          let {$from, $to} = ranges[i]\n          has = state.doc.rangeHasMark($from.pos, $to.pos, markType)\n        }\n        for (let i = 0; i < ranges.length; i++) {\n          let {$from, $to} = ranges[i]\n          if (has) tr.removeMark($from.pos, $to.pos, markType)\n          else tr.addMark($from.pos, $to.pos, markType.create(attrs))\n        }\n        dispatch(tr.scrollIntoView())\n      }\n    }\n    return true\n  }\n}\n\nfunction wrapDispatchForJoin(dispatch, isJoinable) {\n  return tr => {\n    if (!tr.isGeneric) return dispatch(tr)\n\n    let ranges = []\n    for (let i = 0; i < tr.mapping.maps.length; i++) {\n      let map = tr.mapping.maps[i]\n      for (let j = 0; j < ranges.length; j++)\n        ranges[j] = map.map(ranges[j])\n      map.forEach((_s, _e, from, to) => ranges.push(from, to))\n    }\n\n    // Figure out which joinable points exist inside those ranges,\n    // by checking all node boundaries in their parent nodes.\n    let joinable = []\n    for (let i = 0; i < ranges.length; i += 2) {\n      let from = ranges[i], to = ranges[i + 1]\n      let $from = tr.doc.resolve(from), depth = $from.sharedDepth(to), parent = $from.node(depth)\n      for (let index = $from.indexAfter(depth), pos = $from.after(depth + 1); pos <= to; ++index) {\n        let after = parent.maybeChild(index)\n        if (!after) break\n        if (index && joinable.indexOf(pos) == -1) {\n          let before = parent.child(index - 1)\n          if (before.type == after.type && isJoinable(before, after))\n            joinable.push(pos)\n        }\n        pos += after.nodeSize\n      }\n    }\n    // Join the joinable points\n    joinable.sort((a, b) => a - b)\n    for (let i = joinable.length - 1; i >= 0; i--) {\n      if (canJoin(tr.doc, joinable[i])) tr.join(joinable[i])\n    }\n    dispatch(tr)\n  }\n}\n\n// :: ((state: EditorState, ?(tr: Transaction)) → bool, union<(before: Node, after: Node) → bool, [string]>) → (state: EditorState, ?(tr: Transaction)) → bool\n// Wrap a command so that, when it produces a transform that causes\n// two joinable nodes to end up next to each other, those are joined.\n// Nodes are considered joinable when they are of the same type and\n// when the `isJoinable` predicate returns true for them or, if an\n// array of strings was passed, if their node type name is in that\n// array.\nexport function autoJoin(command, isJoinable) {\n  if (Array.isArray(isJoinable)) {\n    let types = isJoinable\n    isJoinable = node => types.indexOf(node.type.name) > -1\n  }\n  return (state, dispatch) => command(state, dispatch && wrapDispatchForJoin(dispatch, isJoinable))\n}\n\n// :: (...[(EditorState, ?(tr: Transaction), ?EditorView) → bool]) → (EditorState, ?(tr: Transaction), ?EditorView) → bool\n// Combine a number of command functions into a single function (which\n// calls them one by one until one returns true).\nexport function chainCommands(...commands) {\n  return function(state, dispatch, view) {\n    for (let i = 0; i < commands.length; i++)\n      if (commands[i](state, dispatch, view)) return true\n    return false\n  }\n}\n\nlet backspace = chainCommands(deleteSelection, joinBackward, selectNodeBackward)\nlet del = chainCommands(deleteSelection, joinForward, selectNodeForward)\n\n// :: Object\n// A basic keymap containing bindings not specific to any schema.\n// Binds the following keys (when multiple commands are listed, they\n// are chained with [`chainCommands`](#commands.chainCommands)):\n//\n// * **Enter** to `newlineInCode`, `createParagraphNear`, `liftEmptyBlock`, `splitBlock`\n// * **Mod-Enter** to `exitCode`\n// * **Backspace** and **Mod-Backspace** to `deleteSelection`, `joinBackward`, `selectNodeBackward`\n// * **Delete** and **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-Delete** to `deleteSelection`, `joinForward`, `selectNodeForward`\n// * **Mod-a** to `selectAll`\nexport let pcBaseKeymap = {\n  \"Enter\": chainCommands(newlineInCode, createParagraphNear, liftEmptyBlock, splitBlock),\n  \"Mod-Enter\": exitCode,\n  \"Backspace\": backspace,\n  \"Mod-Backspace\": backspace,\n  \"Delete\": del,\n  \"Mod-Delete\": del,\n  \"Mod-a\": selectAll\n}\n\n// :: Object\n// A copy of `pcBaseKeymap` that also binds **Ctrl-h** like Backspace,\n// **Ctrl-d** like Delete, **Alt-Backspace** like Ctrl-Backspace, and\n// **Ctrl-Alt-Backspace**, **Alt-Delete**, and **Alt-d** like\n// Ctrl-Delete.\nexport let macBaseKeymap = {\n  \"Ctrl-h\": pcBaseKeymap[\"Backspace\"],\n  \"Alt-Backspace\": pcBaseKeymap[\"Mod-Backspace\"],\n  \"Ctrl-d\": pcBaseKeymap[\"Delete\"],\n  \"Ctrl-Alt-Backspace\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-Delete\": pcBaseKeymap[\"Mod-Delete\"],\n  \"Alt-d\": pcBaseKeymap[\"Mod-Delete\"]\n}\nfor (let key in pcBaseKeymap) macBaseKeymap[key] = pcBaseKeymap[key]\n\n// declare global: os, navigator\nconst mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform)\n          : typeof os != \"undefined\" ? os.platform() == \"darwin\" : false\n\n// :: Object\n// Depending on the detected platform, this will hold\n// [`pcBasekeymap`](#commands.pcBaseKeymap) or\n// [`macBaseKeymap`](#commands.macBaseKeymap).\nexport let baseKeymap = mac ? macBaseKeymap : pcBaseKeymap\n","import {Plugin} from \"prosemirror-state\"\nimport {dropPoint} from \"prosemirror-transform\"\n\n// :: (options: ?Object) → Plugin\n// Create a plugin that, when added to a ProseMirror instance,\n// causes a decoration to show up at the drop position when something\n// is dragged over the editor.\n//\n//   options::- These options are supported:\n//\n//     color:: ?string\n//     The color of the cursor. Defaults to `black`.\n//\n//     width:: ?number\n//     The precise width of the cursor in pixels. Defaults to 1.\n//\n//     class:: ?string\n//     A CSS class name to add to the cursor element.\nexport function dropCursor(options = {}) {\n  return new Plugin({\n    view(editorView) { return new DropCursorView(editorView, options) }\n  })\n}\n\nclass DropCursorView {\n  constructor(editorView, options) {\n    this.editorView = editorView\n    this.width = options.width || 1\n    this.color = options.color || \"black\"\n    this.class = options.class\n    this.cursorPos = null\n    this.element = null\n    this.timeout = null\n\n    this.handlers = [\"dragover\", \"dragend\", \"drop\", \"dragleave\"].map(name => {\n      let handler = e => this[name](e)\n      editorView.dom.addEventListener(name, handler)\n      return {name, handler}\n    })\n  }\n\n  destroy() {\n    this.handlers.forEach(({name, handler}) => this.editorView.dom.removeEventListener(name, handler))\n  }\n\n  update(editorView, prevState) {\n    if (this.cursorPos != null && prevState.doc != editorView.state.doc) this.updateOverlay()\n  }\n\n  setCursor(pos) {\n    if (pos == this.cursorPos) return\n    this.cursorPos = pos\n    if (pos == null) {\n      this.element.parentNode.removeChild(this.element)\n      this.element = null\n    } else {\n      this.updateOverlay()\n    }\n  }\n\n  updateOverlay() {\n    let $pos = this.editorView.state.doc.resolve(this.cursorPos), rect\n    if (!$pos.parent.inlineContent) {\n      let before = $pos.nodeBefore, after = $pos.nodeAfter\n      if (before || after) {\n        let nodeRect = this.editorView.nodeDOM(this.cursorPos - (before ?  before.nodeSize : 0)).getBoundingClientRect()\n        let top = before ? nodeRect.bottom : nodeRect.top\n        if (before && after)\n          top = (top + this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top) / 2\n        rect = {left: nodeRect.left, right: nodeRect.right, top: top - this.width / 2, bottom: top + this.width / 2}\n      }\n    }\n    if (!rect) {\n      let coords = this.editorView.coordsAtPos(this.cursorPos)\n      rect = {left: coords.left - this.width / 2, right: coords.left + this.width / 2, top: coords.top, bottom: coords.bottom}\n    }\n\n    let parent = this.editorView.dom.offsetParent\n    if (!this.element) {\n      this.element = parent.appendChild(document.createElement(\"div\"))\n      if (this.class) this.element.className = this.class\n      this.element.style.cssText = \"position: absolute; z-index: 50; pointer-events: none; background-color: \" + this.color\n    }\n    let parentRect = !parent || parent == document.body && getComputedStyle(parent).position == \"static\"\n        ? {left: -pageXOffset, top: -pageYOffset} : parent.getBoundingClientRect()\n    this.element.style.left = (rect.left - parentRect.left) + \"px\"\n    this.element.style.top = (rect.top - parentRect.top) + \"px\"\n    this.element.style.width = (rect.right - rect.left) + \"px\"\n    this.element.style.height = (rect.bottom - rect.top) + \"px\"\n  }\n\n  scheduleRemoval(timeout) {\n    clearTimeout(this.timeout)\n    this.timeout = setTimeout(() => this.setCursor(null), timeout)\n  }\n\n  dragover(event) {\n    if (!this.editorView.editable) return\n    let pos = this.editorView.posAtCoords({left: event.clientX, top: event.clientY})\n    if (pos) {\n      let target = pos.pos\n      if (this.editorView.dragging && this.editorView.dragging.slice) {\n        target = dropPoint(this.editorView.state.doc, target, this.editorView.dragging.slice)\n        if (target == null) target = pos.pos\n      }\n      this.setCursor(target)\n      this.scheduleRemoval(5000)\n    }\n  }\n\n  dragend() {\n    this.scheduleRemoval(20)\n  }\n\n  drop() {\n    this.scheduleRemoval(20)\n  }\n\n  dragleave(event) {\n    if (event.target == this.editorView.dom || !this.editorView.dom.contains(event.relatedTarget))\n      this.setCursor(null)\n  }\n}\n","import {Selection, NodeSelection} from \"prosemirror-state\"\nimport {Slice} from \"prosemirror-model\"\n\n// ::- Gap cursor selections are represented using this class. Its\n// `$anchor` and `$head` properties both point at the cursor position.\nexport class GapCursor extends Selection {\n  // : (ResolvedPos)\n  constructor($pos) {\n    super($pos, $pos)\n  }\n\n  map(doc, mapping) {\n    let $pos = doc.resolve(mapping.map(this.head))\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  }\n\n  content() { return Slice.empty }\n\n  eq(other) {\n    return other instanceof GapCursor && other.head == this.head\n  }\n\n  toJSON() {\n    return {type: \"gapcursor\", pos: this.head}\n  }\n\n  static fromJSON(doc, json) {\n    if (typeof json.pos != \"number\") throw new RangeError(\"Invalid input for GapCursor.fromJSON\")\n    return new GapCursor(doc.resolve(json.pos))\n  }\n\n  getBookmark() { return new GapBookmark(this.anchor) }\n\n  static valid($pos) {\n    let parent = $pos.parent\n    if (parent.isTextblock || !closedBefore($pos) || !closedAfter($pos)) return false\n    let override = parent.type.spec.allowGapCursor\n    if (override != null) return override\n    let deflt = parent.contentMatchAt($pos.index()).defaultType\n    return deflt && deflt.isTextblock\n  }\n\n  static findFrom($pos, dir, mustMove) {\n    search: for (;;) {\n      if (!mustMove && GapCursor.valid($pos)) return $pos\n      let pos = $pos.pos, next = null\n      // Scan up from this position\n      for (let d = $pos.depth;; d--) {\n        let parent = $pos.node(d)\n        if (dir > 0 ? $pos.indexAfter(d) < parent.childCount : $pos.index(d) > 0) {\n          next = parent.child(dir > 0 ? $pos.indexAfter(d) : $pos.index(d) - 1)\n          break\n        } else if (d == 0) {\n          return null\n        }\n        pos += dir\n        let $cur = $pos.doc.resolve(pos)\n        if (GapCursor.valid($cur)) return $cur\n      }\n\n      // And then down into the next node\n      for (;;) {\n        let inside = dir > 0 ? next.firstChild : next.lastChild\n        if (!inside) {\n          if (next.isAtom && !next.isText && !NodeSelection.isSelectable(next)) {\n            $pos = $pos.doc.resolve(pos + next.nodeSize * dir)\n            mustMove = false\n            continue search\n          }\n          break\n        }\n        next = inside\n        pos += dir\n        let $cur = $pos.doc.resolve(pos)\n        if (GapCursor.valid($cur)) return $cur\n      }\n\n      return null\n    }\n  }\n}\n\nGapCursor.prototype.visible = false\n\nSelection.jsonID(\"gapcursor\", GapCursor)\n\nclass GapBookmark {\n  constructor(pos) {\n    this.pos = pos\n  }\n  map(mapping) {\n    return new GapBookmark(mapping.map(this.pos))\n  }\n  resolve(doc) {\n    let $pos = doc.resolve(this.pos)\n    return GapCursor.valid($pos) ? new GapCursor($pos) : Selection.near($pos)\n  }\n}\n\nfunction closedBefore($pos) {\n  for (let d = $pos.depth; d >= 0; d--) {\n    let index = $pos.index(d)\n    // At the start of this parent, look at next one\n    if (index == 0) continue\n    // See if the node before (or its first ancestor) is closed\n    for (let before = $pos.node(d).child(index - 1);; before = before.lastChild) {\n      if ((before.childCount == 0 && !before.inlineContent) || before.isAtom || before.type.spec.isolating) return true\n      if (before.inlineContent) return false\n    }\n  }\n  // Hit start of document\n  return true\n}\n\nfunction closedAfter($pos) {\n  for (let d = $pos.depth; d >= 0; d--) {\n    let index = $pos.indexAfter(d), parent = $pos.node(d)\n    if (index == parent.childCount) continue\n    for (let after = parent.child(index);; after = after.firstChild) {\n      if ((after.childCount == 0 && !after.inlineContent) || after.isAtom || after.type.spec.isolating) return true\n      if (after.inlineContent) return false\n    }\n  }\n  return true\n}\n","import {keydownHandler} from \"prosemirror-keymap\"\nimport {TextSelection, NodeSelection, Plugin} from \"prosemirror-state\"\nimport {Decoration, DecorationSet} from \"prosemirror-view\"\n\nimport {GapCursor} from \"./gapcursor\"\n\n// :: () → Plugin\n// Create a gap cursor plugin. When enabled, this will capture clicks\n// near and arrow-key-motion past places that don't have a normally\n// selectable position nearby, and create a gap cursor selection for\n// them. The cursor is drawn as an element with class\n// `ProseMirror-gapcursor`. You can either include\n// `style/gapcursor.css` from the package's directory or add your own\n// styles to make it visible.\nexport const gapCursor = function() {\n  return new Plugin({\n    props: {\n      decorations: drawGapCursor,\n\n      createSelectionBetween(_view, $anchor, $head) {\n        if ($anchor.pos == $head.pos && GapCursor.valid($head)) return new GapCursor($head)\n      },\n\n      handleClick,\n      handleKeyDown\n    }\n  })\n}\n\nexport {GapCursor}\n\nconst handleKeyDown = keydownHandler({\n  \"ArrowLeft\": arrow(\"horiz\", -1),\n  \"ArrowRight\": arrow(\"horiz\", 1),\n  \"ArrowUp\": arrow(\"vert\", -1),\n  \"ArrowDown\": arrow(\"vert\", 1)\n})\n\nfunction arrow(axis, dir) {\n  let dirStr = axis == \"vert\" ? (dir > 0 ? \"down\" : \"up\") : (dir > 0 ? \"right\" : \"left\")\n  return function(state, dispatch, view) {\n    let sel = state.selection\n    let $start = dir > 0 ? sel.$to : sel.$from, mustMove = sel.empty\n    if (sel instanceof TextSelection) {\n      if (!view.endOfTextblock(dirStr) || $start.depth == 0) return false\n      mustMove = false\n      $start = state.doc.resolve(dir > 0 ? $start.after() : $start.before())\n    }\n    let $found = GapCursor.findFrom($start, dir, mustMove)\n    if (!$found) return false\n    if (dispatch) dispatch(state.tr.setSelection(new GapCursor($found)))\n    return true\n  }\n}\n\nfunction handleClick(view, pos, event) {\n  if (!view.editable) return false\n  let $pos = view.state.doc.resolve(pos)\n  if (!GapCursor.valid($pos)) return false\n  let {inside} = view.posAtCoords({left: event.clientX, top: event.clientY})\n  if (inside > -1 && NodeSelection.isSelectable(view.state.doc.nodeAt(inside))) return false\n  view.dispatch(view.state.tr.setSelection(new GapCursor($pos)))\n  return true\n}\n\nfunction drawGapCursor(state) {\n  if (!(state.selection instanceof GapCursor)) return null\n  let node = document.createElement(\"div\")\n  node.className = \"ProseMirror-gapcursor\"\n  return DecorationSet.create(state.doc, [Decoration.widget(state.selection.head, node, {key: \"gapcursor\"})])\n}\n","export default function crelt() {\n  var elt = arguments[0]\n  if (typeof elt == \"string\") elt = document.createElement(elt)\n  var i = 1, next = arguments[1]\n  if (next && typeof next == \"object\" && next.nodeType == null && !Array.isArray(next)) {\n    for (var name in next) if (Object.prototype.hasOwnProperty.call(next, name)) {\n      var value = next[name]\n      if (typeof value == \"string\") elt.setAttribute(name, value)\n      else if (value != null) elt[name] = value\n    }\n    i++\n  }\n  for (; i < arguments.length; i++) add(elt, arguments[i])\n  return elt\n}\n\nfunction add(elt, child) {\n  if (typeof child == \"string\") {\n    elt.appendChild(document.createTextNode(child))\n  } else if (child == null) {\n  } else if (child.nodeType != null) {\n    elt.appendChild(child)\n  } else if (Array.isArray(child)) {\n    for (var i = 0; i < child.length; i++) add(elt, child[i])\n  } else {\n    throw new RangeError(\"Unsupported child node: \" + child)\n  }\n}\n","const SVG = \"http://www.w3.org/2000/svg\"\nconst XLINK = \"http://www.w3.org/1999/xlink\"\n\nconst prefix = \"ProseMirror-icon\"\n\nfunction hashPath(path) {\n  let hash = 0\n  for (let i = 0; i < path.length; i++)\n    hash = (((hash << 5) - hash) + path.charCodeAt(i)) | 0\n  return hash\n}\n\nexport function getIcon(icon) {\n  let node = document.createElement(\"div\")\n  node.className = prefix\n  if (icon.path) {\n    let name = \"pm-icon-\" + hashPath(icon.path).toString(16)\n    if (!document.getElementById(name)) buildSVG(name, icon)\n    let svg = node.appendChild(document.createElementNS(SVG, \"svg\"))\n    svg.style.width = (icon.width / icon.height) + \"em\"\n    let use = svg.appendChild(document.createElementNS(SVG, \"use\"))\n    use.setAttributeNS(XLINK, \"href\", /([^#]*)/.exec(document.location)[1] + \"#\" + name)\n  } else if (icon.dom) {\n    node.appendChild(icon.dom.cloneNode(true))\n  } else {\n    node.appendChild(document.createElement(\"span\")).textContent = icon.text || ''\n    if (icon.css) node.firstChild.style.cssText = icon.css\n  }\n  return node\n}\n\nfunction buildSVG(name, data) {\n  let collection = document.getElementById(prefix + \"-collection\")\n  if (!collection) {\n    collection = document.createElementNS(SVG, \"svg\")\n    collection.id = prefix + \"-collection\"\n    collection.style.display = \"none\"\n    document.body.insertBefore(collection, document.body.firstChild)\n  }\n  let sym = document.createElementNS(SVG, \"symbol\")\n  sym.id = name\n  sym.setAttribute(\"viewBox\", \"0 0 \" + data.width + \" \" + data.height)\n  let path = sym.appendChild(document.createElementNS(SVG, \"path\"))\n  path.setAttribute(\"d\", data.path)\n  collection.appendChild(sym)\n}\n","import crel from \"crelt\"\nimport {lift, joinUp, selectParentNode, wrapIn, setBlockType} from \"prosemirror-commands\"\nimport {undo, redo} from \"prosemirror-history\"\n\nimport {getIcon} from \"./icons\"\n\nconst prefix = \"ProseMirror-menu\"\n\n// ::- An icon or label that, when clicked, executes a command.\nexport class MenuItem {\n  // :: (MenuItemSpec)\n  constructor(spec) {\n    // :: MenuItemSpec\n    // The spec used to create the menu item.\n    this.spec = spec\n  }\n\n  // :: (EditorView) → {dom: dom.Node, update: (EditorState) → bool}\n  // Renders the icon according to its [display\n  // spec](#menu.MenuItemSpec.display), and adds an event handler which\n  // executes the command when the representation is clicked.\n  render(view) {\n    let spec = this.spec\n    let dom = spec.render ? spec.render(view)\n        : spec.icon ? getIcon(spec.icon)\n        : spec.label ? crel(\"div\", null, translate(view, spec.label))\n        : null\n    if (!dom) throw new RangeError(\"MenuItem without icon or label property\")\n    if (spec.title) {\n      const title = (typeof spec.title === \"function\" ? spec.title(view.state) : spec.title)\n      dom.setAttribute(\"title\", translate(view, title))\n    }\n    if (spec.class) dom.classList.add(spec.class)\n    if (spec.css) dom.style.cssText += spec.css\n\n    dom.addEventListener(\"mousedown\", e => {\n      e.preventDefault()\n      if (!dom.classList.contains(prefix + \"-disabled\"))\n        spec.run(view.state, view.dispatch, view, e)\n    })\n\n    function update(state) {\n      if (spec.select) {\n        let selected = spec.select(state)\n        dom.style.display = selected ? \"\" : \"none\"\n        if (!selected) return false\n      }\n      let enabled = true\n      if (spec.enable) {\n        enabled = spec.enable(state) || false\n        setClass(dom, prefix + \"-disabled\", !enabled)\n      }\n      if (spec.active) {\n        let active = enabled && spec.active(state) || false\n        setClass(dom, prefix + \"-active\", active)\n      }\n      return true\n    }\n\n    return {dom, update}\n  }\n}\n\nfunction translate(view, text) {\n  return view._props.translate ? view._props.translate(text) : text\n}\n\n// MenuItemSpec:: interface\n// The configuration object passed to the `MenuItem` constructor.\n//\n//   run:: (EditorState, (Transaction), EditorView, dom.Event)\n//   The function to execute when the menu item is activated.\n//\n//   select:: ?(EditorState) → bool\n//   Optional function that is used to determine whether the item is\n//   appropriate at the moment. Deselected items will be hidden.\n//\n//   enable:: ?(EditorState) → bool\n//   Function that is used to determine if the item is enabled. If\n//   given and returning false, the item will be given a disabled\n//   styling.\n//\n//   active:: ?(EditorState) → bool\n//   A predicate function to determine whether the item is 'active' (for\n//   example, the item for toggling the strong mark might be active then\n//   the cursor is in strong text).\n//\n//   render:: ?(EditorView) → dom.Node\n//   A function that renders the item. You must provide either this,\n//   [`icon`](#menu.MenuItemSpec.icon), or [`label`](#MenuItemSpec.label).\n//\n//   icon:: ?Object\n//   Describes an icon to show for this item. The object may specify\n//   an SVG icon, in which case its `path` property should be an [SVG\n//   path\n//   spec](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/d),\n//   and `width` and `height` should provide the viewbox in which that\n//   path exists. Alternatively, it may have a `text` property\n//   specifying a string of text that makes up the icon, with an\n//   optional `css` property giving additional CSS styling for the\n//   text. _Or_ it may contain `dom` property containing a DOM node.\n//\n//   label:: ?string\n//   Makes the item show up as a text label. Mostly useful for items\n//   wrapped in a [drop-down](#menu.Dropdown) or similar menu. The object\n//   should have a `label` property providing the text to display.\n//\n//   title:: ?union<string, (EditorState) → string>\n//   Defines DOM title (mouseover) text for the item.\n//\n//   class:: ?string\n//   Optionally adds a CSS class to the item's DOM representation.\n//\n//   css:: ?string\n//   Optionally adds a string of inline CSS to the item's DOM\n//   representation.\n\nlet lastMenuEvent = {time: 0, node: null}\nfunction markMenuEvent(e) {\n  lastMenuEvent.time = Date.now()\n  lastMenuEvent.node = e.target\n}\nfunction isMenuEvent(wrapper) {\n  return Date.now() - 100 < lastMenuEvent.time &&\n    lastMenuEvent.node && wrapper.contains(lastMenuEvent.node)\n}\n\n// ::- A drop-down menu, displayed as a label with a downwards-pointing\n// triangle to the right of it.\nexport class Dropdown {\n  // :: ([MenuElement], ?Object)\n  // Create a dropdown wrapping the elements. Options may include\n  // the following properties:\n  //\n  // **`label`**`: string`\n  //   : The label to show on the drop-down control.\n  //\n  // **`title`**`: string`\n  //   : Sets the\n  //     [`title`](https://developer.mozilla.org/en-US/docs/Web/HTML/Global_attributes/title)\n  //     attribute given to the menu control.\n  //\n  // **`class`**`: string`\n  //   : When given, adds an extra CSS class to the menu control.\n  //\n  // **`css`**`: string`\n  //   : When given, adds an extra set of CSS styles to the menu control.\n  constructor(content, options) {\n    this.options = options || {}\n    this.content = Array.isArray(content) ? content : [content]\n  }\n\n  // :: (EditorView) → {dom: dom.Node, update: (EditorState)}\n  // Render the dropdown menu and sub-items.\n  render(view) {\n    let content = renderDropdownItems(this.content, view)\n\n    let label = crel(\"div\", {class: prefix + \"-dropdown \" + (this.options.class || \"\"),\n                             style: this.options.css},\n                     translate(view, this.options.label))\n    if (this.options.title) label.setAttribute(\"title\", translate(view, this.options.title))\n    let wrap = crel(\"div\", {class: prefix + \"-dropdown-wrap\"}, label)\n    let open = null, listeningOnClose = null\n    let close = () => {\n      if (open && open.close()) {\n        open = null\n        window.removeEventListener(\"mousedown\", listeningOnClose)\n      }\n    }\n    label.addEventListener(\"mousedown\", e => {\n      e.preventDefault()\n      markMenuEvent(e)\n      if (open) {\n        close()\n      } else {\n        open = this.expand(wrap, content.dom)\n        window.addEventListener(\"mousedown\", listeningOnClose = () => {\n          if (!isMenuEvent(wrap)) close()\n        })\n      }\n    })\n\n    function update(state) {\n      let inner = content.update(state)\n      wrap.style.display = inner ? \"\" : \"none\"\n      return inner\n    }\n\n    return {dom: wrap, update}\n  }\n\n  expand(dom, items) {\n    let menuDOM = crel(\"div\", {class: prefix + \"-dropdown-menu \" + (this.options.class || \"\")}, items)\n\n    let done = false\n    function close() {\n      if (done) return\n      done = true\n      dom.removeChild(menuDOM)\n      return true\n    }\n    dom.appendChild(menuDOM)\n    return {close, node: menuDOM}\n  }\n}\n\nfunction renderDropdownItems(items, view) {\n  let rendered = [], updates = []\n  for (let i = 0; i < items.length; i++) {\n    let {dom, update} = items[i].render(view)\n    rendered.push(crel(\"div\", {class: prefix + \"-dropdown-item\"}, dom))\n    updates.push(update)\n  }\n  return {dom: rendered, update: combineUpdates(updates, rendered)}\n}\n\nfunction combineUpdates(updates, nodes) {\n  return state => {\n    let something = false\n    for (let i = 0; i < updates.length; i++) {\n      let up = updates[i](state)\n      nodes[i].style.display = up ? \"\" : \"none\"\n      if (up) something = true\n    }\n    return something\n  }\n}\n\n// ::- Represents a submenu wrapping a group of elements that start\n// hidden and expand to the right when hovered over or tapped.\nexport class DropdownSubmenu {\n  // :: ([MenuElement], ?Object)\n  // Creates a submenu for the given group of menu elements. The\n  // following options are recognized:\n  //\n  // **`label`**`: string`\n  //   : The label to show on the submenu.\n  constructor(content, options) {\n    this.options = options || {}\n    this.content = Array.isArray(content) ? content : [content]\n  }\n\n  // :: (EditorView) → {dom: dom.Node, update: (EditorState) → bool}\n  // Renders the submenu.\n  render(view) {\n    let items = renderDropdownItems(this.content, view)\n\n    let label = crel(\"div\", {class: prefix + \"-submenu-label\"}, translate(view, this.options.label))\n    let wrap = crel(\"div\", {class: prefix + \"-submenu-wrap\"}, label,\n                   crel(\"div\", {class: prefix + \"-submenu\"}, items.dom))\n    let listeningOnClose = null\n    label.addEventListener(\"mousedown\", e => {\n      e.preventDefault()\n      markMenuEvent(e)\n      setClass(wrap, prefix + \"-submenu-wrap-active\")\n      if (!listeningOnClose)\n        window.addEventListener(\"mousedown\", listeningOnClose = () => {\n          if (!isMenuEvent(wrap)) {\n            wrap.classList.remove(prefix + \"-submenu-wrap-active\")\n            window.removeEventListener(\"mousedown\", listeningOnClose)\n            listeningOnClose = null\n          }\n        })\n    })\n\n    function update(state) {\n      let inner = items.update(state)\n      wrap.style.display = inner ? \"\" : \"none\"\n      return inner\n    }\n    return {dom: wrap, update}\n  }\n}\n\n// :: (EditorView, [union<MenuElement, [MenuElement]>]) → {dom: ?dom.DocumentFragment, update: (EditorState) → bool}\n// Render the given, possibly nested, array of menu elements into a\n// document fragment, placing separators between them (and ensuring no\n// superfluous separators appear when some of the groups turn out to\n// be empty).\nexport function renderGrouped(view, content) {\n  let result = document.createDocumentFragment()\n  let updates = [], separators = []\n  for (let i = 0; i < content.length; i++) {\n    let items = content[i], localUpdates = [], localNodes = []\n    for (let j = 0; j < items.length; j++) {\n      let {dom, update} = items[j].render(view)\n      let span = crel(\"span\", {class: prefix + \"item\"}, dom)\n      result.appendChild(span)\n      localNodes.push(span)\n      localUpdates.push(update)\n    }\n    if (localUpdates.length) {\n      updates.push(combineUpdates(localUpdates, localNodes))\n      if (i < content.length - 1)\n        separators.push(result.appendChild(separator()))\n    }\n  }\n\n  function update(state) {\n    let something = false, needSep = false\n    for (let i = 0; i < updates.length; i++) {\n      let hasContent = updates[i](state)\n      if (i) separators[i - 1].style.display = needSep && hasContent ? \"\" : \"none\"\n      needSep = hasContent\n      if (hasContent) something = true\n    }\n    return something\n  }\n  return {dom: result, update}\n}\n\nfunction separator() {\n  return crel(\"span\", {class: prefix + \"separator\"})\n}\n\n// :: Object\n// A set of basic editor-related icons. Contains the properties\n// `join`, `lift`, `selectParentNode`, `undo`, `redo`, `strong`, `em`,\n// `code`, `link`, `bulletList`, `orderedList`, and `blockquote`, each\n// holding an object that can be used as the `icon` option to\n// `MenuItem`.\nexport const icons = {\n  join: {\n    width: 800, height: 900,\n    path: \"M0 75h800v125h-800z M0 825h800v-125h-800z M250 400h100v-100h100v100h100v100h-100v100h-100v-100h-100z\"\n  },\n  lift: {\n    width: 1024, height: 1024,\n    path: \"M219 310v329q0 7-5 12t-12 5q-8 0-13-5l-164-164q-5-5-5-13t5-13l164-164q5-5 13-5 7 0 12 5t5 12zM1024 749v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12zM1024 530v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 310v109q0 7-5 12t-12 5h-621q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h621q7 0 12 5t5 12zM1024 91v109q0 7-5 12t-12 5h-987q-7 0-12-5t-5-12v-109q0-7 5-12t12-5h987q7 0 12 5t5 12z\"\n  },\n  selectParentNode: {text: \"\\u2b1a\", css: \"font-weight: bold\"},\n  undo: {\n    width: 1024, height: 1024,\n    path: \"M761 1024c113-206 132-520-313-509v253l-384-384 384-384v248c534-13 594 472 313 775z\"\n  },\n  redo: {\n    width: 1024, height: 1024,\n    path: \"M576 248v-248l384 384-384 384v-253c-446-10-427 303-313 509-280-303-221-789 313-775z\"\n  },\n  strong: {\n    width: 805, height: 1024,\n    path: \"M317 869q42 18 80 18 214 0 214-191 0-65-23-102-15-25-35-42t-38-26-46-14-48-6-54-1q-41 0-57 5 0 30-0 90t-0 90q0 4-0 38t-0 55 2 47 6 38zM309 442q24 4 62 4 46 0 81-7t62-25 42-51 14-81q0-40-16-70t-45-46-61-24-70-8q-28 0-74 7 0 28 2 86t2 86q0 15-0 45t-0 45q0 26 0 39zM0 950l1-53q8-2 48-9t60-15q4-6 7-15t4-19 3-18 1-21 0-19v-37q0-561-12-585-2-4-12-8t-25-6-28-4-27-2-17-1l-2-47q56-1 194-6t213-5q13 0 39 0t38 0q40 0 78 7t73 24 61 40 42 59 16 78q0 29-9 54t-22 41-36 32-41 25-48 22q88 20 146 76t58 141q0 57-20 102t-53 74-78 48-93 27-100 8q-25 0-75-1t-75-1q-60 0-175 6t-132 6z\"\n  },\n  em: {\n    width: 585, height: 1024,\n    path: \"M0 949l9-48q3-1 46-12t63-21q16-20 23-57 0-4 35-165t65-310 29-169v-14q-13-7-31-10t-39-4-33-3l10-58q18 1 68 3t85 4 68 1q27 0 56-1t69-4 56-3q-2 22-10 50-17 5-58 16t-62 19q-4 10-8 24t-5 22-4 26-3 24q-15 84-50 239t-44 203q-1 5-7 33t-11 51-9 47-3 32l0 10q9 2 105 17-1 25-9 56-6 0-18 0t-18 0q-16 0-49-5t-49-5q-78-1-117-1-29 0-81 5t-69 6z\"\n  },\n  code: {\n    width: 896, height: 1024,\n    path: \"M608 192l-96 96 224 224-224 224 96 96 288-320-288-320zM288 192l-288 320 288 320 96-96-224-224 224-224-96-96z\"\n  },\n  link: {\n    width: 951, height: 1024,\n    path: \"M832 694q0-22-16-38l-118-118q-16-16-38-16-24 0-41 18 1 1 10 10t12 12 8 10 7 14 2 15q0 22-16 38t-38 16q-8 0-15-2t-14-7-10-8-12-12-10-10q-18 17-18 41 0 22 16 38l117 118q15 15 38 15 22 0 38-14l84-83q16-16 16-38zM430 292q0-22-16-38l-117-118q-16-16-38-16-22 0-38 15l-84 83q-16 16-16 38 0 22 16 38l118 118q15 15 38 15 24 0 41-17-1-1-10-10t-12-12-8-10-7-14-2-15q0-22 16-38t38-16q8 0 15 2t14 7 10 8 12 12 10 10q18-17 18-41zM941 694q0 68-48 116l-84 83q-47 47-116 47-69 0-116-48l-117-118q-47-47-47-116 0-70 50-119l-50-50q-49 50-118 50-68 0-116-48l-118-118q-48-48-48-116t48-116l84-83q47-47 116-47 69 0 116 48l117 118q47 47 47 116 0 70-50 119l50 50q49-50 118-50 68 0 116 48l118 118q48 48 48 116z\"\n  },\n  bulletList: {\n    width: 768, height: 896,\n    path: \"M0 512h128v-128h-128v128zM0 256h128v-128h-128v128zM0 768h128v-128h-128v128zM256 512h512v-128h-512v128zM256 256h512v-128h-512v128zM256 768h512v-128h-512v128z\"\n  },\n  orderedList: {\n    width: 768, height: 896,\n    path: \"M320 512h448v-128h-448v128zM320 768h448v-128h-448v128zM320 128v128h448v-128h-448zM79 384h78v-256h-36l-85 23v50l43-2v185zM189 590c0-36-12-78-96-78-33 0-64 6-83 16l1 66c21-10 42-15 67-15s32 11 32 28c0 26-30 58-110 112v50h192v-67l-91 2c49-30 87-66 87-113l1-1z\"\n  },\n  blockquote: {\n    width: 640, height: 896,\n    path: \"M0 448v256h256v-256h-128c0 0 0-128 128-128v-128c0 0-256 0-256 256zM640 320v-128c0 0-256 0-256 256v256h256v-256h-128c0 0 0-128 128-128z\"\n  }\n}\n\n// :: MenuItem\n// Menu item for the `joinUp` command.\nexport const joinUpItem = new MenuItem({\n  title: \"Join with above block\",\n  run: joinUp,\n  select: state => joinUp(state),\n  icon: icons.join\n})\n\n// :: MenuItem\n// Menu item for the `lift` command.\nexport const liftItem = new MenuItem({\n  title: \"Lift out of enclosing block\",\n  run: lift,\n  select: state => lift(state),\n  icon: icons.lift\n})\n\n// :: MenuItem\n// Menu item for the `selectParentNode` command.\nexport const selectParentNodeItem = new MenuItem({\n  title: \"Select parent node\",\n  run: selectParentNode,\n  select: state => selectParentNode(state),\n  icon: icons.selectParentNode\n})\n\n// :: MenuItem\n// Menu item for the `undo` command.\nexport let undoItem = new MenuItem({\n  title: \"Undo last change\",\n  run: undo,\n  enable: state => undo(state),\n  icon: icons.undo\n})\n\n// :: MenuItem\n// Menu item for the `redo` command.\nexport let redoItem = new MenuItem({\n  title: \"Redo last undone change\",\n  run: redo,\n  enable: state => redo(state),\n  icon: icons.redo\n})\n\n// :: (NodeType, Object) → MenuItem\n// Build a menu item for wrapping the selection in a given node type.\n// Adds `run` and `select` properties to the ones present in\n// `options`. `options.attrs` may be an object or a function.\nexport function wrapItem(nodeType, options) {\n  let passedOptions = {\n    run(state, dispatch) {\n      // FIXME if (options.attrs instanceof Function) options.attrs(state, attrs => wrapIn(nodeType, attrs)(state))\n      return wrapIn(nodeType, options.attrs)(state, dispatch)\n    },\n    select(state) {\n      return wrapIn(nodeType, options.attrs instanceof Function ? null : options.attrs)(state)\n    }\n  }\n  for (let prop in options) passedOptions[prop] = options[prop]\n  return new MenuItem(passedOptions)\n}\n\n// :: (NodeType, Object) → MenuItem\n// Build a menu item for changing the type of the textblock around the\n// selection to the given type. Provides `run`, `active`, and `select`\n// properties. Others must be given in `options`. `options.attrs` may\n// be an object to provide the attributes for the textblock node.\nexport function blockTypeItem(nodeType, options) {\n  let command = setBlockType(nodeType, options.attrs)\n  let passedOptions = {\n    run: command,\n    enable(state) { return command(state) },\n    active(state) {\n      let {$from, to, node} = state.selection\n      if (node) return node.hasMarkup(nodeType, options.attrs)\n      return to <= $from.end() && $from.parent.hasMarkup(nodeType, options.attrs)\n    }\n  }\n  for (let prop in options) passedOptions[prop] = options[prop]\n  return new MenuItem(passedOptions)\n}\n\n// Work around classList.toggle being broken in IE11\nfunction setClass(dom, cls, on) {\n  if (on) dom.classList.add(cls)\n  else dom.classList.remove(cls)\n}\n","import crel from \"crelt\"\nimport {Plugin} from \"prosemirror-state\"\n\nimport {renderGrouped} from \"./menu\"\n\nconst prefix = \"ProseMirror-menubar\"\n\nfunction isIOS() {\n  if (typeof navigator == \"undefined\") return false\n  let agent = navigator.userAgent\n  return !/Edge\\/\\d/.test(agent) && /AppleWebKit/.test(agent) && /Mobile\\/\\w+/.test(agent)\n}\n\n// :: (Object) → Plugin\n// A plugin that will place a menu bar above the editor. Note that\n// this involves wrapping the editor in an additional `<div>`.\n//\n//   options::-\n//   Supports the following options:\n//\n//     content:: [[MenuElement]]\n//     Provides the content of the menu, as a nested array to be\n//     passed to `renderGrouped`.\n//\n//     floating:: ?bool\n//     Determines whether the menu floats, i.e. whether it sticks to\n//     the top of the viewport when the editor is partially scrolled\n//     out of view.\nexport function menuBar(options) {\n  return new Plugin({\n    view(editorView) { return new MenuBarView(editorView, options) }\n  })\n}\n\nclass MenuBarView {\n  constructor(editorView, options) {\n    this.editorView = editorView\n    this.options = options\n\n    this.wrapper = crel(\"div\", {class: prefix + \"-wrapper\"})\n    this.menu = this.wrapper.appendChild(crel(\"div\", {class: prefix}))\n    this.menu.className = prefix\n    this.spacer = null\n\n    editorView.dom.parentNode.replaceChild(this.wrapper, editorView.dom)\n    this.wrapper.appendChild(editorView.dom)\n\n    this.maxHeight = 0\n    this.widthForMaxHeight = 0\n    this.floating = false\n\n    let {dom, update} = renderGrouped(this.editorView, this.options.content)\n    this.contentUpdate = update\n    this.menu.appendChild(dom)\n    this.update()\n\n    if (options.floating && !isIOS()) {\n      this.updateFloat()\n      let potentialScrollers = getAllWrapping(this.wrapper)\n      this.scrollFunc = (e) => {\n        let root = this.editorView.root\n        if (!(root.body || root).contains(this.wrapper)) {\n            potentialScrollers.forEach(el => el.removeEventListener(\"scroll\", this.scrollFunc))\n        } else {\n            this.updateFloat(e.target.getBoundingClientRect && e.target)\n        }\n      }\n      potentialScrollers.forEach(el => el.addEventListener('scroll', this.scrollFunc))\n    }\n  }\n\n  update() {\n    this.contentUpdate(this.editorView.state)\n\n    if (this.floating) {\n      this.updateScrollCursor()\n    } else {\n      if (this.menu.offsetWidth != this.widthForMaxHeight) {\n        this.widthForMaxHeight = this.menu.offsetWidth\n        this.maxHeight = 0\n      }\n      if (this.menu.offsetHeight > this.maxHeight) {\n        this.maxHeight = this.menu.offsetHeight\n        this.menu.style.minHeight = this.maxHeight + \"px\"\n      }\n    }\n  }\n\n  updateScrollCursor() {\n    let selection = this.editorView.root.getSelection()\n    if (!selection.focusNode) return\n    let rects = selection.getRangeAt(0).getClientRects()\n    let selRect = rects[selectionIsInverted(selection) ? 0 : rects.length - 1]\n    if (!selRect) return\n    let menuRect = this.menu.getBoundingClientRect()\n    if (selRect.top < menuRect.bottom && selRect.bottom > menuRect.top) {\n      let scrollable = findWrappingScrollable(this.wrapper)\n      if (scrollable) scrollable.scrollTop -= (menuRect.bottom - selRect.top)\n    }\n  }\n\n  updateFloat(scrollAncestor) {\n    let parent = this.wrapper, editorRect = parent.getBoundingClientRect(),\n        top = scrollAncestor ? Math.max(0, scrollAncestor.getBoundingClientRect().top) : 0\n\n    if (this.floating) {\n      if (editorRect.top >= top || editorRect.bottom < this.menu.offsetHeight + 10) {\n        this.floating = false\n        this.menu.style.position = this.menu.style.left = this.menu.style.top = this.menu.style.width = \"\"\n        this.menu.style.display = \"\"\n        this.spacer.parentNode.removeChild(this.spacer)\n        this.spacer = null\n      } else {\n        let border = (parent.offsetWidth - parent.clientWidth) / 2\n        this.menu.style.left = (editorRect.left + border) + \"px\"\n        this.menu.style.display = (editorRect.top > window.innerHeight ? \"none\" : \"\")\n        if (scrollAncestor) this.menu.style.top = top + \"px\"\n      }\n    } else {\n      if (editorRect.top < top && editorRect.bottom >= this.menu.offsetHeight + 10) {\n        this.floating = true\n        let menuRect = this.menu.getBoundingClientRect()\n        this.menu.style.left = menuRect.left + \"px\"\n        this.menu.style.width = menuRect.width + \"px\"\n        if (scrollAncestor) this.menu.style.top = top + \"px\"\n        this.menu.style.position = \"fixed\"\n        this.spacer = crel(\"div\", {class: prefix + \"-spacer\", style: `height: ${menuRect.height}px`})\n        parent.insertBefore(this.spacer, this.menu)\n      }\n    }\n  }\n\n  destroy() {\n    if (this.wrapper.parentNode)\n      this.wrapper.parentNode.replaceChild(this.editorView.dom, this.wrapper)\n  }\n}\n\n// Not precise, but close enough\nfunction selectionIsInverted(selection) {\n  if (selection.anchorNode == selection.focusNode) return selection.anchorOffset > selection.focusOffset\n  return selection.anchorNode.compareDocumentPosition(selection.focusNode) == Node.DOCUMENT_POSITION_FOLLOWING\n}\n\nfunction findWrappingScrollable(node) {\n  for (let cur = node.parentNode; cur; cur = cur.parentNode)\n    if (cur.scrollHeight > cur.clientHeight) return cur\n}\n\nfunction getAllWrapping(node) {\n    let res = [window]\n    for (let cur = node.parentNode; cur; cur = cur.parentNode)\n        res.push(cur)\n    return res\n}\n","import {findWrapping, liftTarget, canSplit, ReplaceAroundStep} from \"prosemirror-transform\"\nimport {Slice, Fragment, NodeRange} from \"prosemirror-model\"\n\nconst olDOM = [\"ol\", 0], ulDOM = [\"ul\", 0], liDOM = [\"li\", 0]\n\n// :: NodeSpec\n// An ordered list [node spec](#model.NodeSpec). Has a single\n// attribute, `order`, which determines the number at which the list\n// starts counting, and defaults to 1. Represented as an `<ol>`\n// element.\nexport const orderedList = {\n  attrs: {order: {default: 1}},\n  parseDOM: [{tag: \"ol\", getAttrs(dom) {\n    return {order: dom.hasAttribute(\"start\") ? +dom.getAttribute(\"start\") : 1}\n  }}],\n  toDOM(node) {\n    return node.attrs.order == 1 ? olDOM : [\"ol\", {start: node.attrs.order}, 0]\n  }\n}\n\n// :: NodeSpec\n// A bullet list node spec, represented in the DOM as `<ul>`.\nexport const bulletList = {\n  parseDOM: [{tag: \"ul\"}],\n  toDOM() { return ulDOM }\n}\n\n// :: NodeSpec\n// A list item (`<li>`) spec.\nexport const listItem = {\n  parseDOM: [{tag: \"li\"}],\n  toDOM() { return liDOM },\n  defining: true\n}\n\nfunction add(obj, props) {\n  let copy = {}\n  for (let prop in obj) copy[prop] = obj[prop]\n  for (let prop in props) copy[prop] = props[prop]\n  return copy\n}\n\n// :: (OrderedMap<NodeSpec>, string, ?string) → OrderedMap<NodeSpec>\n// Convenience function for adding list-related node types to a map\n// specifying the nodes for a schema. Adds\n// [`orderedList`](#schema-list.orderedList) as `\"ordered_list\"`,\n// [`bulletList`](#schema-list.bulletList) as `\"bullet_list\"`, and\n// [`listItem`](#schema-list.listItem) as `\"list_item\"`.\n//\n// `itemContent` determines the content expression for the list items.\n// If you want the commands defined in this module to apply to your\n// list structure, it should have a shape like `\"paragraph block*\"` or\n// `\"paragraph (ordered_list | bullet_list)*\"`. `listGroup` can be\n// given to assign a group name to the list node types, for example\n// `\"block\"`.\nexport function addListNodes(nodes, itemContent, listGroup) {\n  return nodes.append({\n    ordered_list: add(orderedList, {content: \"list_item+\", group: listGroup}),\n    bullet_list: add(bulletList, {content: \"list_item+\", group: listGroup}),\n    list_item: add(listItem, {content: itemContent})\n  })\n}\n\n// :: (NodeType, ?Object) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Returns a command function that wraps the selection in a list with\n// the given type an attributes. If `dispatch` is null, only return a\n// value to indicate whether this is possible, but don't actually\n// perform the change.\nexport function wrapInList(listType, attrs) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to), doJoin = false, outerRange = range\n    if (!range) return false\n    // This is at the top of an existing list item\n    if (range.depth >= 2 && $from.node(range.depth - 1).type.compatibleContent(listType) && range.startIndex == 0) {\n      // Don't do anything if this is the top of the list\n      if ($from.index(range.depth - 1) == 0) return false\n      let $insert = state.doc.resolve(range.start - 2)\n      outerRange = new NodeRange($insert, $insert, range.depth)\n      if (range.endIndex < range.parent.childCount)\n        range = new NodeRange($from, state.doc.resolve($to.end(range.depth)), range.depth)\n      doJoin = true\n    }\n    let wrap = findWrapping(outerRange, listType, attrs, range)\n    if (!wrap) return false\n    if (dispatch) dispatch(doWrapInList(state.tr, range, wrap, doJoin, listType).scrollIntoView())\n    return true\n  }\n}\n\nfunction doWrapInList(tr, range, wrappers, joinBefore, listType) {\n  let content = Fragment.empty\n  for (let i = wrappers.length - 1; i >= 0; i--)\n    content = Fragment.from(wrappers[i].type.create(wrappers[i].attrs, content))\n\n  tr.step(new ReplaceAroundStep(range.start - (joinBefore ? 2 : 0), range.end, range.start, range.end,\n                                new Slice(content, 0, 0), wrappers.length, true))\n\n  let found = 0\n  for (let i = 0; i < wrappers.length; i++) if (wrappers[i].type == listType) found = i + 1\n  let splitDepth = wrappers.length - found\n\n  let splitPos = range.start + wrappers.length - (joinBefore ? 2 : 0), parent = range.parent\n  for (let i = range.startIndex, e = range.endIndex, first = true; i < e; i++, first = false) {\n    if (!first && canSplit(tr.doc, splitPos, splitDepth)) {\n      tr.split(splitPos, splitDepth)\n      splitPos += 2 * splitDepth\n    }\n    splitPos += parent.child(i).nodeSize\n  }\n  return tr\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Build a command that splits a non-empty textblock at the top level\n// of a list item by also splitting that list item.\nexport function splitListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to, node} = state.selection\n    if ((node && node.isBlock) || $from.depth < 2 || !$from.sameParent($to)) return false\n    let grandParent = $from.node(-1)\n    if (grandParent.type != itemType) return false\n    if ($from.parent.content.size == 0 && $from.node(-1).childCount == $from.indexAfter(-1)) {\n      // In an empty block. If this is a nested list, the wrapping\n      // list item should be split. Otherwise, bail out and let next\n      // command handle lifting.\n      if ($from.depth == 2 || $from.node(-3).type != itemType ||\n          $from.index(-2) != $from.node(-2).childCount - 1) return false\n      if (dispatch) {\n        let wrap = Fragment.empty, keepItem = $from.index(-1) > 0\n        // Build a fragment containing empty versions of the structure\n        // from the outer list item to the parent node of the cursor\n        for (let d = $from.depth - (keepItem ? 1 : 2); d >= $from.depth - 3; d--)\n          wrap = Fragment.from($from.node(d).copy(wrap))\n        // Add a second list item with an empty default start node\n        wrap = wrap.append(Fragment.from(itemType.createAndFill()))\n        let tr = state.tr.replace($from.before(keepItem ? null : -1), $from.after(-3), new Slice(wrap, keepItem ? 3 : 2, 2))\n        tr.setSelection(state.selection.constructor.near(tr.doc.resolve($from.pos + (keepItem ? 3 : 2))))\n        dispatch(tr.scrollIntoView())\n      }\n      return true\n    }\n    let nextType = $to.pos == $from.end() ? grandParent.contentMatchAt(0).defaultType : null\n    let tr = state.tr.delete($from.pos, $to.pos)\n    let types = nextType && [null, {type: nextType}]\n    if (!canSplit(tr.doc, $from.pos, 2, types)) return false\n    if (dispatch) dispatch(tr.split($from.pos, 2, types).scrollIntoView())\n    return true\n  }\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command to lift the list item around the selection up into\n// a wrapping list.\nexport function liftListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to, node => node.childCount && node.firstChild.type == itemType)\n    if (!range) return false\n    if (!dispatch) return true\n    if ($from.node(range.depth - 1).type == itemType) // Inside a parent list\n      return liftToOuterList(state, dispatch, itemType, range)\n    else // Outer list node\n      return liftOutOfList(state, dispatch, range)\n  }\n}\n\nfunction liftToOuterList(state, dispatch, itemType, range) {\n  let tr = state.tr, end = range.end, endOfList = range.$to.end(range.depth)\n  if (end < endOfList) {\n    // There are siblings after the lifted items, which must become\n    // children of the last item\n    tr.step(new ReplaceAroundStep(end - 1, endOfList, end, endOfList,\n                                  new Slice(Fragment.from(itemType.create(null, range.parent.copy())), 1, 0), 1, true))\n    range = new NodeRange(tr.doc.resolve(range.$from.pos), tr.doc.resolve(endOfList), range.depth)\n  }\n  dispatch(tr.lift(range, liftTarget(range)).scrollIntoView())\n  return true\n}\n\nfunction liftOutOfList(state, dispatch, range) {\n  let tr = state.tr, list = range.parent\n  // Merge the list items into a single big item\n  for (let pos = range.end, i = range.endIndex - 1, e = range.startIndex; i > e; i--) {\n    pos -= list.child(i).nodeSize\n    tr.delete(pos - 1, pos + 1)\n  }\n  let $start = tr.doc.resolve(range.start), item = $start.nodeAfter\n  let atStart = range.startIndex == 0, atEnd = range.endIndex == list.childCount\n  let parent = $start.node(-1), indexBefore = $start.index(-1)\n  if (!parent.canReplace(indexBefore + (atStart ? 0 : 1), indexBefore + 1,\n                         item.content.append(atEnd ? Fragment.empty : Fragment.from(list))))\n    return false\n  let start = $start.pos, end = start + item.nodeSize\n  // Strip off the surrounding list. At the sides where we're not at\n  // the end of the list, the existing list is closed. At sides where\n  // this is the end, it is overwritten to its end.\n  tr.step(new ReplaceAroundStep(start - (atStart ? 1 : 0), end + (atEnd ? 1 : 0), start + 1, end - 1,\n                                new Slice((atStart ? Fragment.empty : Fragment.from(list.copy(Fragment.empty)))\n                                          .append(atEnd ? Fragment.empty : Fragment.from(list.copy(Fragment.empty))),\n                                          atStart ? 0 : 1, atEnd ? 0 : 1), atStart ? 0 : 1))\n  dispatch(tr.scrollIntoView())\n  return true\n}\n\n// :: (NodeType) → (state: EditorState, dispatch: ?(tr: Transaction)) → bool\n// Create a command to sink the list item around the selection down\n// into an inner list.\nexport function sinkListItem(itemType) {\n  return function(state, dispatch) {\n    let {$from, $to} = state.selection\n    let range = $from.blockRange($to, node => node.childCount && node.firstChild.type == itemType)\n    if (!range) return false\n    let startIndex = range.startIndex\n    if (startIndex == 0) return false\n    let parent = range.parent, nodeBefore = parent.child(startIndex - 1)\n    if (nodeBefore.type != itemType) return false\n\n    if (dispatch) {\n      let nestedBefore = nodeBefore.lastChild && nodeBefore.lastChild.type == parent.type\n      let inner = Fragment.from(nestedBefore ? itemType.create() : null)\n      let slice = new Slice(Fragment.from(itemType.create(null, Fragment.from(parent.type.create(null, inner)))),\n                            nestedBefore ? 3 : 1, 0)\n      let before = range.start, after = range.end\n      dispatch(state.tr.step(new ReplaceAroundStep(before - (nestedBefore ? 3 : 1), after,\n                                                   before, after, slice, 1, true))\n               .scrollIntoView())\n    }\n    return true\n  }\n}\n","import {Plugin} from \"prosemirror-state\"\n\n// ::- Input rules are regular expressions describing a piece of text\n// that, when typed, causes something to happen. This might be\n// changing two dashes into an emdash, wrapping a paragraph starting\n// with `\"> \"` into a blockquote, or something entirely different.\nexport class InputRule {\n  // :: (RegExp, union<string, (state: EditorState, match: [string], start: number, end: number) → ?Transaction>)\n  // Create an input rule. The rule applies when the user typed\n  // something and the text directly in front of the cursor matches\n  // `match`, which should end with `$`.\n  //\n  // The `handler` can be a string, in which case the matched text, or\n  // the first matched group in the regexp, is replaced by that\n  // string.\n  //\n  // Or a it can be a function, which will be called with the match\n  // array produced by\n  // [`RegExp.exec`](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/RegExp/exec),\n  // as well as the start and end of the matched range, and which can\n  // return a [transaction](#state.Transaction) that describes the\n  // rule's effect, or null to indicate the input was not handled.\n  constructor(match, handler) {\n    this.match = match\n    this.handler = typeof handler == \"string\" ? stringHandler(handler) : handler\n  }\n}\n\nfunction stringHandler(string) {\n  return function(state, match, start, end) {\n    let insert = string\n    if (match[1]) {\n      let offset = match[0].lastIndexOf(match[1])\n      insert += match[0].slice(offset + match[1].length)\n      start += offset\n      let cutOff = start - end\n      if (cutOff > 0) {\n        insert = match[0].slice(offset - cutOff, offset) + insert\n        start = end\n      }\n    }\n    return state.tr.insertText(insert, start, end)\n  }\n}\n\nconst MAX_MATCH = 500\n\n// :: (config: {rules: [InputRule]}) → Plugin\n// Create an input rules plugin. When enabled, it will cause text\n// input that matches any of the given rules to trigger the rule's\n// action.\nexport function inputRules({rules}) {\n  let plugin = new Plugin({\n    state: {\n      init() { return null },\n      apply(tr, prev) {\n        let stored = tr.getMeta(this)\n        if (stored) return stored\n        return tr.selectionSet || tr.docChanged ? null : prev\n      }\n    },\n\n    props: {\n      handleTextInput(view, from, to, text) {\n        return run(view, from, to, text, rules, plugin)\n      },\n      handleDOMEvents: {\n        compositionend: (view) => {\n          setTimeout(() => {\n            let {$cursor} = view.state.selection\n            if ($cursor) run(view, $cursor.pos, $cursor.pos, \"\", rules, plugin)\n          })\n        }\n      }\n    },\n\n    isInputRules: true\n  })\n  return plugin\n}\n\nfunction run(view, from, to, text, rules, plugin) {\n  if (view.composing) return false\n  let state = view.state, $from = state.doc.resolve(from)\n  if ($from.parent.type.spec.code) return false\n  let textBefore = $from.parent.textBetween(Math.max(0, $from.parentOffset - MAX_MATCH), $from.parentOffset,\n                                            null, \"\\ufffc\") + text\n  for (let i = 0; i < rules.length; i++) {\n    let match = rules[i].match.exec(textBefore)\n    let tr = match && rules[i].handler(state, match, from - (match[0].length - text.length), to)\n    if (!tr) continue\n    view.dispatch(tr.setMeta(plugin, {transform: tr, from, to, text}))\n    return true\n  }\n  return false\n}\n\n// :: (EditorState, ?(Transaction)) → bool\n// This is a command that will undo an input rule, if applying such a\n// rule was the last thing that the user did.\nexport function undoInputRule(state, dispatch) {\n  let plugins = state.plugins\n  for (let i = 0; i < plugins.length; i++) {\n    let plugin = plugins[i], undoable\n    if (plugin.spec.isInputRules && (undoable = plugin.getState(state))) {\n      if (dispatch) {\n        let tr = state.tr, toUndo = undoable.transform\n        for (let j = toUndo.steps.length - 1; j >= 0; j--)\n          tr.step(toUndo.steps[j].invert(toUndo.docs[j]))\n        if (undoable.text) {\n          let marks = tr.doc.resolve(undoable.from).marks()\n          tr.replaceWith(undoable.from, undoable.to, state.schema.text(undoable.text, marks))\n        } else {\n          tr.delete(undoable.from, undoable.to)\n        }\n        dispatch(tr)\n      }\n      return true\n    }\n  }\n  return false\n}\n","import {InputRule} from \"./inputrules\"\n\n// :: InputRule Converts double dashes to an emdash.\nexport const emDash = new InputRule(/--$/, \"—\")\n// :: InputRule Converts three dots to an ellipsis character.\nexport const ellipsis = new InputRule(/\\.\\.\\.$/, \"…\")\n// :: InputRule “Smart” opening double quotes.\nexport const openDoubleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(\")$/, \"“\")\n// :: InputRule “Smart” closing double quotes.\nexport const closeDoubleQuote = new InputRule(/\"$/, \"”\")\n// :: InputRule “Smart” opening single quotes.\nexport const openSingleQuote = new InputRule(/(?:^|[\\s\\{\\[\\(\\<'\"\\u2018\\u201C])(')$/, \"‘\")\n// :: InputRule “Smart” closing single quotes.\nexport const closeSingleQuote = new InputRule(/'$/, \"’\")\n\n// :: [InputRule] Smart-quote related input rules.\nexport const smartQuotes = [openDoubleQuote, closeDoubleQuote, openSingleQuote, closeSingleQuote]\n","import {InputRule} from \"./inputrules\"\nimport {findWrapping, canJoin} from \"prosemirror-transform\"\n\n// :: (RegExp, NodeType, ?union<Object, ([string]) → ?Object>, ?([string], Node) → bool) → InputRule\n// Build an input rule for automatically wrapping a textblock when a\n// given string is typed. The `regexp` argument is\n// directly passed through to the `InputRule` constructor. You'll\n// probably want the regexp to start with `^`, so that the pattern can\n// only occur at the start of a textblock.\n//\n// `nodeType` is the type of node to wrap in. If it needs attributes,\n// you can either pass them directly, or pass a function that will\n// compute them from the regular expression match.\n//\n// By default, if there's a node with the same type above the newly\n// wrapped node, the rule will try to [join](#transform.Transform.join) those\n// two nodes. You can pass a join predicate, which takes a regular\n// expression match and the node before the wrapped node, and can\n// return a boolean to indicate whether a join should happen.\nexport function wrappingInputRule(regexp, nodeType, getAttrs, joinPredicate) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    let attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs\n    let tr = state.tr.delete(start, end)\n    let $start = tr.doc.resolve(start), range = $start.blockRange(), wrapping = range && findWrapping(range, nodeType, attrs)\n    if (!wrapping) return null\n    tr.wrap(range, wrapping)\n    let before = tr.doc.resolve(start - 1).nodeBefore\n    if (before && before.type == nodeType && canJoin(tr.doc, start - 1) &&\n        (!joinPredicate || joinPredicate(match, before)))\n      tr.join(start - 1)\n    return tr\n  })\n}\n\n// :: (RegExp, NodeType, ?union<Object, ([string]) → ?Object>) → InputRule\n// Build an input rule that changes the type of a textblock when the\n// matched text is typed into it. You'll usually want to start your\n// regexp with `^` to that it is only matched at the start of a\n// textblock. The optional `getAttrs` parameter can be used to compute\n// the new node's attributes, and works the same as in the\n// `wrappingInputRule` function.\nexport function textblockTypeInputRule(regexp, nodeType, getAttrs) {\n  return new InputRule(regexp, (state, match, start, end) => {\n    let $start = state.doc.resolve(start)\n    let attrs = getAttrs instanceof Function ? getAttrs(match) : getAttrs\n    if (!$start.node(-1).canReplaceWith($start.index(-1), $start.indexAfter(-1), nodeType)) return null\n    return state.tr\n      .delete(start, end)\n      .setBlockType(start, start, nodeType, attrs)\n  })\n}\n","const prefix = \"ProseMirror-prompt\"\n\nexport function openPrompt(options) {\n  let wrapper = document.body.appendChild(document.createElement(\"div\"))\n  wrapper.className = prefix\n\n  let mouseOutside = e => { if (!wrapper.contains(e.target)) close() }\n  setTimeout(() => window.addEventListener(\"mousedown\", mouseOutside), 50)\n  let close = () => {\n    window.removeEventListener(\"mousedown\", mouseOutside)\n    if (wrapper.parentNode) wrapper.parentNode.removeChild(wrapper)\n  }\n\n  let domFields = []\n  for (let name in options.fields) domFields.push(options.fields[name].render())\n\n  let submitButton = document.createElement(\"button\")\n  submitButton.type = \"submit\"\n  submitButton.className = prefix + \"-submit\"\n  submitButton.textContent = \"OK\"\n  let cancelButton = document.createElement(\"button\")\n  cancelButton.type = \"button\"\n  cancelButton.className = prefix + \"-cancel\"\n  cancelButton.textContent = \"Cancel\"\n  cancelButton.addEventListener(\"click\", close)\n\n  let form = wrapper.appendChild(document.createElement(\"form\"))\n  if (options.title) form.appendChild(document.createElement(\"h5\")).textContent = options.title\n  domFields.forEach(field => {\n    form.appendChild(document.createElement(\"div\")).appendChild(field)\n  })\n  let buttons = form.appendChild(document.createElement(\"div\"))\n  buttons.className = prefix + \"-buttons\"\n  buttons.appendChild(submitButton)\n  buttons.appendChild(document.createTextNode(\" \"))\n  buttons.appendChild(cancelButton)\n\n  let box = wrapper.getBoundingClientRect()\n  wrapper.style.top = ((window.innerHeight - box.height) / 2) + \"px\"\n  wrapper.style.left = ((window.innerWidth - box.width) / 2) + \"px\"\n\n  let submit = () => {\n    let params = getValues(options.fields, domFields)\n    if (params) {\n      close()\n      options.callback(params)\n    }\n  }\n\n  form.addEventListener(\"submit\", e => {\n    e.preventDefault()\n    submit()\n  })\n\n  form.addEventListener(\"keydown\", e => {\n    if (e.keyCode == 27) {\n      e.preventDefault()\n      close()\n    } else if (e.keyCode == 13 && !(e.ctrlKey || e.metaKey || e.shiftKey)) {\n      e.preventDefault()\n      submit()\n    } else if (e.keyCode == 9) {\n      window.setTimeout(() => {\n        if (!wrapper.contains(document.activeElement)) close()\n      }, 500)\n    }\n  })\n\n  let input = form.elements[0]\n  if (input) input.focus()\n}\n\nfunction getValues(fields, domFields) {\n  let result = Object.create(null), i = 0\n  for (let name in fields) {\n    let field = fields[name], dom = domFields[i++]\n    let value = field.read(dom), bad = field.validate(value)\n    if (bad) {\n      reportInvalid(dom, bad)\n      return null\n    }\n    result[name] = field.clean(value)\n  }\n  return result\n}\n\nfunction reportInvalid(dom, message) {\n  // FIXME this is awful and needs a lot more work\n  let parent = dom.parentNode\n  let msg = parent.appendChild(document.createElement(\"div\"))\n  msg.style.left = (dom.offsetLeft + dom.offsetWidth + 2) + \"px\"\n  msg.style.top = (dom.offsetTop - 5) + \"px\"\n  msg.className = \"ProseMirror-invalid\"\n  msg.textContent = message\n  setTimeout(() => parent.removeChild(msg), 1500)\n}\n\n// ::- The type of field that `FieldPrompt` expects to be passed to it.\nexport class Field {\n  // :: (Object)\n  // Create a field with the given options. Options support by all\n  // field types are:\n  //\n  // **`value`**`: ?any`\n  //   : The starting value for the field.\n  //\n  // **`label`**`: string`\n  //   : The label for the field.\n  //\n  // **`required`**`: ?bool`\n  //   : Whether the field is required.\n  //\n  // **`validate`**`: ?(any) → ?string`\n  //   : A function to validate the given value. Should return an\n  //     error message if it is not valid.\n  constructor(options) { this.options = options }\n\n  // render:: (state: EditorState, props: Object) → dom.Node\n  // Render the field to the DOM. Should be implemented by all subclasses.\n\n  // :: (dom.Node) → any\n  // Read the field's value from its DOM node.\n  read(dom) { return dom.value }\n\n  // :: (any) → ?string\n  // A field-type-specific validation function.\n  validateType(_value) {}\n\n  validate(value) {\n    if (!value && this.options.required)\n      return \"Required field\"\n    return this.validateType(value) || (this.options.validate && this.options.validate(value))\n  }\n\n  clean(value) {\n    return this.options.clean ? this.options.clean(value) : value\n  }\n}\n\n// ::- A field class for single-line text fields.\nexport class TextField extends Field {\n  render() {\n    let input = document.createElement(\"input\")\n    input.type = \"text\"\n    input.placeholder = this.options.label\n    input.value = this.options.value || \"\"\n    input.autocomplete = \"off\"\n    return input\n  }\n}\n\n\n// ::- A field class for dropdown fields based on a plain `<select>`\n// tag. Expects an option `options`, which should be an array of\n// `{value: string, label: string}` objects, or a function taking a\n// `ProseMirror` instance and returning such an array.\nexport class SelectField extends Field {\n  render() {\n    let select = document.createElement(\"select\")\n    this.options.options.forEach(o => {\n      let opt = select.appendChild(document.createElement(\"option\"))\n      opt.value = o.value\n      opt.selected = o.value == this.options.value\n      opt.label = o.label\n    })\n    return select\n  }\n}\n","import {wrapItem, blockTypeItem, Dropdown, DropdownSubmenu, joinUpItem, liftItem,\n       selectParentNodeItem, undoItem, redoItem, icons, MenuItem} from \"prosemirror-menu\"\nimport {NodeSelection} from \"prosemirror-state\"\nimport {toggleMark} from \"prosemirror-commands\"\nimport {wrapInList} from \"prosemirror-schema-list\"\nimport {TextField, openPrompt} from \"./prompt\"\n\n// Helpers to create specific types of items\n\nfunction canInsert(state, nodeType) {\n  let $from = state.selection.$from\n  for (let d = $from.depth; d >= 0; d--) {\n    let index = $from.index(d)\n    if ($from.node(d).canReplaceWith(index, index, nodeType)) return true\n  }\n  return false\n}\n\nfunction insertImageItem(nodeType) {\n  return new MenuItem({\n    title: \"Insert image\",\n    label: \"Image\",\n    enable(state) { return canInsert(state, nodeType) },\n    run(state, _, view) {\n      let {from, to} = state.selection, attrs = null\n      if (state.selection instanceof NodeSelection && state.selection.node.type == nodeType)\n        attrs = state.selection.node.attrs\n      openPrompt({\n        title: \"Insert image\",\n        fields: {\n          src: new TextField({label: \"Location\", required: true, value: attrs && attrs.src}),\n          title: new TextField({label: \"Title\", value: attrs && attrs.title}),\n          alt: new TextField({label: \"Description\",\n                              value: attrs ? attrs.alt : state.doc.textBetween(from, to, \" \")})\n        },\n        callback(attrs) {\n          view.dispatch(view.state.tr.replaceSelectionWith(nodeType.createAndFill(attrs)))\n          view.focus()\n        }\n      })\n    }\n  })\n}\n\nfunction cmdItem(cmd, options) {\n  let passedOptions = {\n    label: options.title,\n    run: cmd\n  }\n  for (let prop in options) passedOptions[prop] = options[prop]\n  if ((!options.enable || options.enable === true) && !options.select)\n    passedOptions[options.enable ? \"enable\" : \"select\"] = state => cmd(state)\n\n  return new MenuItem(passedOptions)\n}\n\nfunction markActive(state, type) {\n  let {from, $from, to, empty} = state.selection\n  if (empty) return type.isInSet(state.storedMarks || $from.marks())\n  else return state.doc.rangeHasMark(from, to, type)\n}\n\nfunction markItem(markType, options) {\n  let passedOptions = {\n    active(state) { return markActive(state, markType) },\n    enable: true\n  }\n  for (let prop in options) passedOptions[prop] = options[prop]\n  return cmdItem(toggleMark(markType), passedOptions)\n}\n\nfunction linkItem(markType) {\n  return new MenuItem({\n    title: \"Add or remove link\",\n    icon: icons.link,\n    active(state) { return markActive(state, markType) },\n    enable(state) { return !state.selection.empty },\n    run(state, dispatch, view) {\n      if (markActive(state, markType)) {\n        toggleMark(markType)(state, dispatch)\n        return true\n      }\n      openPrompt({\n        title: \"Create a link\",\n        fields: {\n          href: new TextField({\n            label: \"Link target\",\n            required: true\n          }),\n          title: new TextField({label: \"Title\"})\n        },\n        callback(attrs) {\n          toggleMark(markType, attrs)(view.state, view.dispatch)\n          view.focus()\n        }\n      })\n    }\n  })\n}\n\nfunction wrapListItem(nodeType, options) {\n  return cmdItem(wrapInList(nodeType, options.attrs), options)\n}\n\n// :: (Schema) → Object\n// Given a schema, look for default mark and node types in it and\n// return an object with relevant menu items relating to those marks:\n//\n// **`toggleStrong`**`: MenuItem`\n//   : A menu item to toggle the [strong mark](#schema-basic.StrongMark).\n//\n// **`toggleEm`**`: MenuItem`\n//   : A menu item to toggle the [emphasis mark](#schema-basic.EmMark).\n//\n// **`toggleCode`**`: MenuItem`\n//   : A menu item to toggle the [code font mark](#schema-basic.CodeMark).\n//\n// **`toggleLink`**`: MenuItem`\n//   : A menu item to toggle the [link mark](#schema-basic.LinkMark).\n//\n// **`insertImage`**`: MenuItem`\n//   : A menu item to insert an [image](#schema-basic.Image).\n//\n// **`wrapBulletList`**`: MenuItem`\n//   : A menu item to wrap the selection in a [bullet list](#schema-list.BulletList).\n//\n// **`wrapOrderedList`**`: MenuItem`\n//   : A menu item to wrap the selection in an [ordered list](#schema-list.OrderedList).\n//\n// **`wrapBlockQuote`**`: MenuItem`\n//   : A menu item to wrap the selection in a [block quote](#schema-basic.BlockQuote).\n//\n// **`makeParagraph`**`: MenuItem`\n//   : A menu item to set the current textblock to be a normal\n//     [paragraph](#schema-basic.Paragraph).\n//\n// **`makeCodeBlock`**`: MenuItem`\n//   : A menu item to set the current textblock to be a\n//     [code block](#schema-basic.CodeBlock).\n//\n// **`makeHead[N]`**`: MenuItem`\n//   : Where _N_ is 1 to 6. Menu items to set the current textblock to\n//     be a [heading](#schema-basic.Heading) of level _N_.\n//\n// **`insertHorizontalRule`**`: MenuItem`\n//   : A menu item to insert a horizontal rule.\n//\n// The return value also contains some prefabricated menu elements and\n// menus, that you can use instead of composing your own menu from\n// scratch:\n//\n// **`insertMenu`**`: Dropdown`\n//   : A dropdown containing the `insertImage` and\n//     `insertHorizontalRule` items.\n//\n// **`typeMenu`**`: Dropdown`\n//   : A dropdown containing the items for making the current\n//     textblock a paragraph, code block, or heading.\n//\n// **`fullMenu`**`: [[MenuElement]]`\n//   : An array of arrays of menu elements for use as the full menu\n//     for, for example the [menu bar](https://github.com/prosemirror/prosemirror-menu#user-content-menubar).\nexport function buildMenuItems(schema) {\n  let r = {}, type\n  if (type = schema.marks.strong)\n    r.toggleStrong = markItem(type, {title: \"Toggle strong style\", icon: icons.strong})\n  if (type = schema.marks.em)\n    r.toggleEm = markItem(type, {title: \"Toggle emphasis\", icon: icons.em})\n  if (type = schema.marks.code)\n    r.toggleCode = markItem(type, {title: \"Toggle code font\", icon: icons.code})\n  if (type = schema.marks.link)\n    r.toggleLink = linkItem(type)\n\n  if (type = schema.nodes.image)\n    r.insertImage = insertImageItem(type)\n  if (type = schema.nodes.bullet_list)\n    r.wrapBulletList = wrapListItem(type, {\n      title: \"Wrap in bullet list\",\n      icon: icons.bulletList\n    })\n  if (type = schema.nodes.ordered_list)\n    r.wrapOrderedList = wrapListItem(type, {\n      title: \"Wrap in ordered list\",\n      icon: icons.orderedList\n    })\n  if (type = schema.nodes.blockquote)\n    r.wrapBlockQuote = wrapItem(type, {\n      title: \"Wrap in block quote\",\n      icon: icons.blockquote\n    })\n  if (type = schema.nodes.paragraph)\n    r.makeParagraph = blockTypeItem(type, {\n      title: \"Change to paragraph\",\n      label: \"Plain\"\n    })\n  if (type = schema.nodes.code_block)\n    r.makeCodeBlock = blockTypeItem(type, {\n      title: \"Change to code block\",\n      label: \"Code\"\n    })\n  if (type = schema.nodes.heading)\n    for (let i = 1; i <= 10; i++)\n      r[\"makeHead\" + i] = blockTypeItem(type, {\n        title: \"Change to heading \" + i,\n        label: \"Level \" + i,\n        attrs: {level: i}\n      })\n  if (type = schema.nodes.horizontal_rule) {\n    let hr = type\n    r.insertHorizontalRule = new MenuItem({\n      title: \"Insert horizontal rule\",\n      label: \"Horizontal rule\",\n      enable(state) { return canInsert(state, hr) },\n      run(state, dispatch) { dispatch(state.tr.replaceSelectionWith(hr.create())) }\n    })\n  }\n\n  let cut = arr => arr.filter(x => x)\n  r.insertMenu = new Dropdown(cut([r.insertImage, r.insertHorizontalRule]), {label: \"Insert\"})\n  r.typeMenu = new Dropdown(cut([r.makeParagraph, r.makeCodeBlock, r.makeHead1 && new DropdownSubmenu(cut([\n    r.makeHead1, r.makeHead2, r.makeHead3, r.makeHead4, r.makeHead5, r.makeHead6\n  ]), {label: \"Heading\"})]), {label: \"Type...\"})\n\n  r.inlineMenu = [cut([r.toggleStrong, r.toggleEm, r.toggleCode, r.toggleLink])]\n  r.blockMenu = [cut([r.wrapBulletList, r.wrapOrderedList, r.wrapBlockQuote, joinUpItem,\n                      liftItem, selectParentNodeItem])]\n  r.fullMenu = r.inlineMenu.concat([[r.insertMenu, r.typeMenu]], [[undoItem, redoItem]], r.blockMenu)\n\n  return r\n}\n","import {wrapIn, setBlockType, chainCommands, toggleMark, exitCode,\n        joinUp, joinDown, lift, selectParentNode} from \"prosemirror-commands\"\nimport {wrapInList, splitListItem, liftListItem, sinkListItem} from \"prosemirror-schema-list\"\nimport {undo, redo} from \"prosemirror-history\"\nimport {undoInputRule} from \"prosemirror-inputrules\"\n\nconst mac = typeof navigator != \"undefined\" ? /Mac/.test(navigator.platform) : false\n\n// :: (Schema, ?Object) → Object\n// Inspect the given schema looking for marks and nodes from the\n// basic schema, and if found, add key bindings related to them.\n// This will add:\n//\n// * **Mod-b** for toggling [strong](#schema-basic.StrongMark)\n// * **Mod-i** for toggling [emphasis](#schema-basic.EmMark)\n// * **Mod-`** for toggling [code font](#schema-basic.CodeMark)\n// * **Ctrl-Shift-0** for making the current textblock a paragraph\n// * **Ctrl-Shift-1** to **Ctrl-Shift-Digit6** for making the current\n//   textblock a heading of the corresponding level\n// * **Ctrl-Shift-Backslash** to make the current textblock a code block\n// * **Ctrl-Shift-8** to wrap the selection in an ordered list\n// * **Ctrl-Shift-9** to wrap the selection in a bullet list\n// * **Ctrl->** to wrap the selection in a block quote\n// * **Enter** to split a non-empty textblock in a list item while at\n//   the same time splitting the list item\n// * **Mod-Enter** to insert a hard break\n// * **Mod-_** to insert a horizontal rule\n// * **Backspace** to undo an input rule\n// * **Alt-ArrowUp** to `joinUp`\n// * **Alt-ArrowDown** to `joinDown`\n// * **Mod-BracketLeft** to `lift`\n// * **Escape** to `selectParentNode`\n//\n// You can suppress or map these bindings by passing a `mapKeys`\n// argument, which maps key names (say `\"Mod-B\"` to either `false`, to\n// remove the binding, or a new key name string.\nexport function buildKeymap(schema, mapKeys) {\n  let keys = {}, type\n  function bind(key, cmd) {\n    if (mapKeys) {\n      let mapped = mapKeys[key]\n      if (mapped === false) return\n      if (mapped) key = mapped\n    }\n    keys[key] = cmd\n  }\n\n\n  bind(\"Mod-z\", undo)\n  bind(\"Shift-Mod-z\", redo)\n  bind(\"Backspace\", undoInputRule)\n  if (!mac) bind(\"Mod-y\", redo)\n\n  bind(\"Alt-ArrowUp\", joinUp)\n  bind(\"Alt-ArrowDown\", joinDown)\n  bind(\"Mod-BracketLeft\", lift)\n  bind(\"Escape\", selectParentNode)\n\n  if (type = schema.marks.strong) {\n    bind(\"Mod-b\", toggleMark(type))\n    bind(\"Mod-B\", toggleMark(type))\n  }\n  if (type = schema.marks.em) {\n    bind(\"Mod-i\", toggleMark(type))\n    bind(\"Mod-I\", toggleMark(type))\n  }\n  if (type = schema.marks.code)\n    bind(\"Mod-`\", toggleMark(type))\n\n  if (type = schema.nodes.bullet_list)\n    bind(\"Shift-Ctrl-8\", wrapInList(type))\n  if (type = schema.nodes.ordered_list)\n    bind(\"Shift-Ctrl-9\", wrapInList(type))\n  if (type = schema.nodes.blockquote)\n    bind(\"Ctrl->\", wrapIn(type))\n  if (type = schema.nodes.hard_break) {\n    let br = type, cmd = chainCommands(exitCode, (state, dispatch) => {\n      dispatch(state.tr.replaceSelectionWith(br.create()).scrollIntoView())\n      return true\n    })\n    bind(\"Mod-Enter\", cmd)\n    bind(\"Shift-Enter\", cmd)\n    if (mac) bind(\"Ctrl-Enter\", cmd)\n  }\n  if (type = schema.nodes.list_item) {\n    bind(\"Enter\", splitListItem(type))\n    bind(\"Mod-[\", liftListItem(type))\n    bind(\"Mod-]\", sinkListItem(type))\n  }\n  if (type = schema.nodes.paragraph)\n    bind(\"Shift-Ctrl-0\", setBlockType(type))\n  if (type = schema.nodes.code_block)\n    bind(\"Shift-Ctrl-\\\\\", setBlockType(type))\n  if (type = schema.nodes.heading)\n    for (let i = 1; i <= 6; i++) bind(\"Shift-Ctrl-\" + i, setBlockType(type, {level: i}))\n  if (type = schema.nodes.horizontal_rule) {\n    let hr = type\n    bind(\"Mod-_\", (state, dispatch) => {\n      dispatch(state.tr.replaceSelectionWith(hr.create()).scrollIntoView())\n      return true\n    })\n  }\n\n  return keys\n}\n","import {inputRules, wrappingInputRule, textblockTypeInputRule,\n        smartQuotes, emDash, ellipsis} from \"prosemirror-inputrules\"\n\n// : (NodeType) → InputRule\n// Given a blockquote node type, returns an input rule that turns `\"> \"`\n// at the start of a textblock into a blockquote.\nexport function blockQuoteRule(nodeType) {\n  return wrappingInputRule(/^\\s*>\\s$/, nodeType)\n}\n\n// : (NodeType) → InputRule\n// Given a list node type, returns an input rule that turns a number\n// followed by a dot at the start of a textblock into an ordered list.\nexport function orderedListRule(nodeType) {\n  return wrappingInputRule(/^(\\d+)\\.\\s$/, nodeType, match => ({order: +match[1]}),\n                           (match, node) => node.childCount + node.attrs.order == +match[1])\n}\n\n// : (NodeType) → InputRule\n// Given a list node type, returns an input rule that turns a bullet\n// (dash, plush, or asterisk) at the start of a textblock into a\n// bullet list.\nexport function bulletListRule(nodeType) {\n  return wrappingInputRule(/^\\s*([-+*])\\s$/, nodeType)\n}\n\n// : (NodeType) → InputRule\n// Given a code block node type, returns an input rule that turns a\n// textblock starting with three backticks into a code block.\nexport function codeBlockRule(nodeType) {\n  return textblockTypeInputRule(/^```$/, nodeType)\n}\n\n// : (NodeType, number) → InputRule\n// Given a node type and a maximum level, creates an input rule that\n// turns up to that number of `#` characters followed by a space at\n// the start of a textblock into a heading whose level corresponds to\n// the number of `#` signs.\nexport function headingRule(nodeType, maxLevel) {\n  return textblockTypeInputRule(new RegExp(\"^(#{1,\" + maxLevel + \"})\\\\s$\"),\n                                nodeType, match => ({level: match[1].length}))\n}\n\n// : (Schema) → Plugin\n// A set of input rules for creating the basic block quotes, lists,\n// code blocks, and heading.\nexport function buildInputRules(schema) {\n  let rules = smartQuotes.concat(ellipsis, emDash), type\n  if (type = schema.nodes.blockquote) rules.push(blockQuoteRule(type))\n  if (type = schema.nodes.ordered_list) rules.push(orderedListRule(type))\n  if (type = schema.nodes.bullet_list) rules.push(bulletListRule(type))\n  if (type = schema.nodes.code_block) rules.push(codeBlockRule(type))\n  if (type = schema.nodes.heading) rules.push(headingRule(type, 6))\n  return inputRules({rules})\n}\n","import {keymap} from \"prosemirror-keymap\"\nimport {history} from \"prosemirror-history\"\nimport {baseKeymap} from \"prosemirror-commands\"\nimport {Plugin} from \"prosemirror-state\"\nimport {dropCursor} from \"prosemirror-dropcursor\"\nimport {gapCursor} from \"prosemirror-gapcursor\"\nimport {menuBar} from \"prosemirror-menu\"\n\nimport {buildMenuItems} from \"./menu\"\nimport {buildKeymap} from \"./keymap\"\nimport {buildInputRules} from \"./inputrules\"\n\nexport {buildMenuItems, buildKeymap, buildInputRules}\n\n// !! This module exports helper functions for deriving a set of basic\n// menu items, input rules, or key bindings from a schema. These\n// values need to know about the schema for two reasons—they need\n// access to specific instances of node and mark types, and they need\n// to know which of the node and mark types that they know about are\n// actually present in the schema.\n//\n// The `exampleSetup` plugin ties these together into a plugin that\n// will automatically enable this basic functionality in an editor.\n\n// :: (Object) → [Plugin]\n// A convenience plugin that bundles together a simple menu with basic\n// key bindings, input rules, and styling for the example schema.\n// Probably only useful for quickly setting up a passable\n// editor—you'll need more control over your settings in most\n// real-world situations.\n//\n//   options::- The following options are recognized:\n//\n//     schema:: Schema\n//     The schema to generate key bindings and menu items for.\n//\n//     mapKeys:: ?Object\n//     Can be used to [adjust](#example-setup.buildKeymap) the key bindings created.\n//\n//     menuBar:: ?bool\n//     Set to false to disable the menu bar.\n//\n//     history:: ?bool\n//     Set to false to disable the history plugin.\n//\n//     floatingMenu:: ?bool\n//     Set to false to make the menu bar non-floating.\n//\n//     menuContent:: [[MenuItem]]\n//     Can be used to override the menu content.\nexport function exampleSetup(options) {\n  let plugins = [\n    buildInputRules(options.schema),\n    keymap(buildKeymap(options.schema, options.mapKeys)),\n    keymap(baseKeymap),\n    dropCursor(),\n    gapCursor()\n  ]\n  if (options.menuBar !== false)\n    plugins.push(menuBar({floating: options.floatingMenu !== false,\n                          content: options.menuContent || buildMenuItems(options.schema).fullMenu}))\n  if (options.history !== false)\n    plugins.push(history())\n\n  return plugins.concat(new Plugin({\n    props: {\n      attributes: {class: \"ProseMirror-example-setup-style\"}\n    }\n  }))\n}\n","import {\n\tEditorView\n}\n\tfrom 'prosemirror-view'\n\nimport {\n\tEditorState\n}\n\tfrom 'prosemirror-state'\n\nimport {\n\tschema, defaultMarkdownParser,\n\tdefaultMarkdownSerializer\n}\n\tfrom 'prosemirror-markdown'\n\nimport {\n\texampleSetup\n}\n\tfrom 'prosemirror-example-setup'\n\nclass MarkdownView {\n\tconstructor (target, content) {\n\t\tthis.textarea = target.appendChild(document.createElement('textarea'))\n\t\tthis.textarea.value = content\n\t}\n\n\tget content () {\n\t\treturn this.textarea.value\n\t}\n\n\tfocus () {\n\t\tthis.textarea.focus()\n\t}\n\n\tdestroy () {\n\t\tthis.textarea.remove()\n\t}\n}\n\nclass ProseMirrorView {\n\tconstructor (target, content) {\n\t\tthis.view = new EditorView(target, {\n\t\t\tstate: EditorState.create({\n\t\t\t\tdoc: defaultMarkdownParser.parse(content),\n\t\t\t\tplugins: exampleSetup({\n\t\t\t\t\tschema\n\t\t\t\t})\n\t\t\t})\n\t\t})\n\t}\n\n\tget content () {\n\t\treturn defaultMarkdownSerializer.serialize(this.view.state.doc)\n\t}\n\n\tfocus () {\n\t\tthis.view.focus()\n\t}\n\n\tdestroy () {\n\t\tthis.view.destroy()\n\t}\n}\n\nexport {\n\tMarkdownView,\n\tProseMirrorView\n}\n","import {\n\tSargasso, utils\n}\n\tfrom '@pelagiccreatures/sargasso'\n\nimport {\n\tMarkdownView,\n\tProseMirrorView\n}\n\tfrom './prose-mirror'\n\nclass markdownEditor extends Sargasso {\n\tconstructor (elem, options = {}) {\n\t\toptions.watchDOM = true\n\t\tsuper(elem, options)\n\n\t\tthis.target = this.element.querySelector(this.element.getAttribute('data-target'))\n\t\tthis.content = this.element.querySelector(this.element.getAttribute('data-content'))\n\t}\n\n\tstart () {\n\t\tsuper.start()\n\t\tthis.view = new ProseMirrorView(this.target, this.content.value)\n\n\t\tutils.elementTools.on(this.uid, this.target, 'input blur focus keyup paste click', '[contenteditable]', (e) => {\n\t\t\tthis.content.value = this.view.content\n\t\t\tthis.content.dispatchEvent(new Event('change'))\n\t\t})\n\n\t\tutils.elementTools.on(this.uid, this.target, 'input blur focus keyup paste', 'textarea', (e) => {\n\t\t\tthis.content.value = this.view.content\n\t\t\tthis.content.dispatchEvent(new Event('change'))\n\t\t})\n\n\t\tthis.handler = (e) => {\n\t\t\tconst button = e.srcElement\n\t\t\tif (!button.checked) return\n\t\t\tconst View = button.value === 'markdown' ? MarkdownView : ProseMirrorView\n\t\t\tif (this.view instanceof View) return\n\t\t\tconst content = this.view.content\n\t\t\tthis.view.destroy()\n\t\t\tthis.view = new View(this.target, content)\n\t\t\tthis.view.focus()\n\t\t}\n\n\t\tArray.from(this.element.querySelectorAll('input[type=radio]')).forEach((el) => {\n\t\t\tel.addEventListener('change', this.handler)\n\t\t})\n\t}\n\n\tsleep () {\n\t\tArray.from(this.element.querySelectorAll('input[type=radio]')).forEach((el) => {\n\t\t\tel.removeEventListener('change', this.handler)\n\t\t})\n\t\tthis.view.destroy()\n\t\tutils.elementTools.off(this.uid, this.target, 'input blur focus keyup paste click', '[contenteditable]')\n\t\tutils.elementTools.off(this.uid, this.target, 'input blur focus keyup paste', 'textarea')\n\t\tsuper.sleep()\n\t}\n\n\tDOMChanged () {\n\t\tif (this.content && this.view && this.content.value !== this.view.content) {\n\t\t\tthis.content.value = this.view.content\n\t\t\tthis.content.dispatchEvent(new Event('change'))\n\t\t}\n\t}\n}\n\nutils.registerSargassoClass('markdownEditor', markdownEditor)\n\nexport {\n\tmarkdownEditor\n}\n"],"names":["$b82f7f8c6321b7f3$var$OrderedMap","content","this","$b1808bd5898dfaf1$var$config","default","parcelRequire","zero","commonmark","$b1808bd5898dfaf1$var$BAD_PROTO_RE","$b1808bd5898dfaf1$var$GOOD_DATA_RE","$b1808bd5898dfaf1$var$validateLink","url","str","trim","toLowerCase","test","$b1808bd5898dfaf1$var$RECODE_HOSTNAME_FOR","$b1808bd5898dfaf1$var$normalizeLink","parsed","$7wnEp","parse","hostname","protocol","indexOf","$75xW2","toASCII","er","encode","format","$b1808bd5898dfaf1$var$normalizeLinkText","toUnicode","decode","defaultChars","$b1808bd5898dfaf1$var$MarkdownIt","presetName","options","$bzA5E","isString","inline","$28497","block","$ieRN0","core","$9eJFL","renderer","$94P6a","linkify","$lKiqX","validateLink","normalizeLink","normalizeLinkText","utils","helpers","assign","$jGPx9","configure","set","prototype","presets","self","Error","components","Object","keys","forEach","name","rules","ruler","enableOnly","rules2","ruler2","enable","list","ignoreInvalid","result","Array","isArray","chain","concat","missed","filter","length","disable","use","plugin","args","slice","call","arguments","apply","src","env","state","State","process","tokens","render","parseInline","inlineMode","renderInline","module","exports","$86cef553e7286197$export$16c08b91f883959a","$86cef553e7286197$export$e6e34fd1f2686227","$86cef553e7286197$export$844ec244b1367d54","$86cef553e7286197$export$a4f4bb6b1453fff5","$86cef553e7286197$export$5ccde1ea0c14bb03","$86cef553e7286197$export$db8a17c6655f7e2c","$86cef553e7286197$export$644a8f5b13b2a36d","$86cef553e7286197$export$73bfc63873071f74","$86cef553e7286197$export$4cf11838cdc2a8a8","$86cef553e7286197$export$f78478f71955b6bc","$86cef553e7286197$export$1d5ccafae59b4926","$86cef553e7286197$export$3c52dd84024ae72c","$86cef553e7286197$export$829a0d33ae4e744","$86cef553e7286197$export$4888a643af800fc1","$86cef553e7286197$export$bc616c8f7dc20d5d","$86cef553e7286197$export$20ef46802c8744b","$86cef553e7286197$var$_hasOwnProperty","hasOwnProperty","$86cef553e7286197$var$has","object","key","$86cef553e7286197$var$isValidEntityCode","c","$86cef553e7286197$var$fromCodePoint","surrogate1","surrogate2","String","fromCharCode","$86cef553e7286197$var$UNESCAPE_MD_RE","$86cef553e7286197$var$UNESCAPE_ALL_RE","RegExp","source","$86cef553e7286197$var$DIGITAL_ENTITY_TEST_RE","$86cef553e7286197$var$HTML_ESCAPE_TEST_RE","$86cef553e7286197$var$HTML_ESCAPE_REPLACE_RE","$86cef553e7286197$var$HTML_REPLACEMENTS","$86cef553e7286197$var$replaceUnsafeChar","ch","$86cef553e7286197$var$REGEXP_ESCAPE_RE","mdurl","ucmicro","obj","sources","TypeError","toString","$86cef553e7286197$var$_class","replace","match","escaped","entity","code","$2OLbZ","charCodeAt","parseInt","$86cef553e7286197$var$replaceEntityPattern","pos","newElements","$iIgWd","toUpperCase","JSON","$579dde1d04931335$export$c564cdbbe6da493","$579dde1d04931335$export$2f872c0f2117be69","$579dde1d04931335$export$d9468344d3651243","$579dde1d04931335$export$98e6a39c04603d36","$506f081174b10438$var$encodeCache","$506f081174b10438$var$encode","string","exclude","keepEscaped","i","l","nextCode","cache","push","$506f081174b10438$var$getEncodeCache","encodeURIComponent","componentChars","$a3bbc84f1e2be8fa$var$decodeCache","$a3bbc84f1e2be8fa$var$decode","$a3bbc84f1e2be8fa$var$getDecodeCache","seq","b1","b2","b3","b4","chr","slashes","auth","port","pathname","search","hash","$735fe0e2fbd6a1c9$var$Url","$735fe0e2fbd6a1c9$var$protocolPattern","$735fe0e2fbd6a1c9$var$portPattern","$735fe0e2fbd6a1c9$var$simplePathPattern","$735fe0e2fbd6a1c9$var$unwise","$735fe0e2fbd6a1c9$var$autoEscape","$735fe0e2fbd6a1c9$var$nonHostChars","$735fe0e2fbd6a1c9$var$hostEndingChars","$735fe0e2fbd6a1c9$var$hostnamePartPattern","$735fe0e2fbd6a1c9$var$hostnamePartStart","$735fe0e2fbd6a1c9$var$hostlessProtocol","javascript","$735fe0e2fbd6a1c9$var$slashedProtocol","http","https","ftp","gopher","file","slashesDenoteHost","lowerProto","hec","rest","split","simplePath","exec","proto","substr","atSign","hostEnd","lastIndexOf","host","parseHost","ipv6Hostname","hostparts","part","newpart","j","k","validParts","notHost","bit","unshift","join","qm","u","$3f6582092c423cc8$export$b24b633b1364b94b","$3f6582092c423cc8$export$15dafbac7aec8a57","$3f6582092c423cc8$export$239cff0cce87eb56","$3f6582092c423cc8$export$56c0d5a1e737357d","$3f6582092c423cc8$export$dc98b0b04f4c7758","$e559ea15297a7b92$export$2a2c8612930e58d0","$e559ea15297a7b92$export$22bd24080f95f2b3","$e559ea15297a7b92$export$89650c5477a69db9","start","disableNested","level","found","marker","prevPos","labelEnd","max","posMax","oldPos","md","skipToken","unescapeAll","ok","lines","$77c562715acc9f89$require$unescapeAll","$9fad0ee884dd726d$require$unescapeAll","escapeHtml","$69bc1fdfa8156ef4$var$default_rules","$69bc1fdfa8156ef4$var$Renderer","$69bc1fdfa8156ef4$require$assign","code_inline","idx","slf","token","renderAttrs","$69bc1fdfa8156ef4$require$escapeHtml","code_block","fence","highlighted","arr","tmpAttrs","tmpToken","info","$69bc1fdfa8156ef4$require$unescapeAll","langName","langAttrs","highlight","attrIndex","attrs","langPrefix","image","renderInlineAsText","children","renderToken","hardbreak","xhtmlOut","softbreak","breaks","text","html_block","html_inline","nextToken","needLf","hidden","nesting","tag","type","len","$6b98d980cca6e412$var$_rules","$6b98d980cca6e412$var$Core","$iDD60","getRules","$d91a32278ce53f3b$var$Ruler","__rules__","__cache__","__find__","__compile__","chains","rule","enabled","alt","altName","fn","at","index","opt","before","beforeName","ruleName","splice","after","afterName","chainName","$6ee2c219ab593c46$var$NEWLINES_RE","$6ee2c219ab593c46$var$NULL_RE","Token","map","tok","arrayReplaceAt","$24b792e62c2160c8$var$isLinkClose","currentToken","nodes","ln","lastPos","htmlLinkLevel","fullUrl","urlText","links","blockTokens","pretest","schema","markup","lastIndex","$24b792e62c2160c8$require$arrayReplaceAt","$fbb6b56543377825$var$RARE_RE","$fbb6b56543377825$var$SCOPED_ABBR_TEST_RE","$fbb6b56543377825$var$SCOPED_ABBR_RE","$fbb6b56543377825$var$SCOPED_ABBR","r","p","tm","$fbb6b56543377825$var$replaceFn","$fbb6b56543377825$var$replace_scoped","inlineTokens","inside_autolink","$fbb6b56543377825$var$replace_rare","blkIdx","typographer","isWhiteSpace","isPunctChar","isMdAsciiPunct","$625ff44f85d6ed44$var$QUOTE_TEST_RE","$625ff44f85d6ed44$var$QUOTE_RE","$625ff44f85d6ed44$var$replaceAt","$625ff44f85d6ed44$var$process_inlines","t","thisLevel","item","lastChar","nextChar","isLastPunctChar","isNextPunctChar","isLastWhiteSpace","isNextWhiteSpace","canOpen","canClose","isSingle","stack","openQuote","closeQuote","OUTER","$625ff44f85d6ed44$require$isMdAsciiPunct","$625ff44f85d6ed44$require$isPunctChar","$625ff44f85d6ed44$require$isWhiteSpace","single","quotes","$cc1afef7395041c7$var$StateCore","$b8xAo","$81ba7e85bc9eba62$var$Token","meta","attrPush","attrData","attrSet","value","attrGet","attrJoin","$d4734246406ccead$var$_rules","$d4734246406ccead$var$ParserBlock","tokenize","startLine","endLine","line","hasEmptyLines","maxNesting","skipEmptyLines","sCount","blkIndent","tight","isEmpty","outTokens","lineMax","isSpace","$cca3481d1f20eac0$var$getLine","bMarks","tShift","eMarks","$cca3481d1f20eac0$var$escapedSplit","isEscaped","current","substring","silent","lineText","nextLine","columns","columnCount","aligns","tableLines","tbodyLines","oldParentType","terminate","terminatorRules","firstCh","secondCh","$cca3481d1f20eac0$require$isSpace","shift","pop","parentType","last","getLines","params","mem","haveEndMarker","skipChars","skipSpaces","adjustTab","initial","lastLineEmpty","offset","oldBMarks","oldBSCount","oldIndent","oldSCount","oldTShift","spaceAfterMarker","isOutdented","oldLineMax","bsCount","$6b0625a4e0a45701$require$isSpace","cnt","$886b5914ba9eb7d1$require$isSpace","$4a2be9a9856f2192$var$skipBulletListMarker","$4a2be9a9856f2192$require$isSpace","$4a2be9a9856f2192$var$skipOrderedListMarker","contentStart","indent","indentAfterMarker","isOrdered","itemLines","listLines","listTokIdx","markerCharCode","markerValue","oldListIndent","oldTight","posAfterMarker","prevEmptyEnd","isTerminatingParagraph","listIndent","Number","Math","min","$4a2be9a9856f2192$var$markTightParagraphs","normalizeReference","_endLine","destEndPos","destEndLineNo","href","label","res","title","$d2f5b2f9ad01aa70$require$isSpace","parseLinkDestination","parseLinkTitle","$d2f5b2f9ad01aa70$require$normalizeReference","references","HTML_OPEN_CLOSE_TAG_RE","$ecd6fafce4f158ba$var$HTML_SEQUENCES","$49824","$ecd6fafce4f158ba$require$HTML_OPEN_CLOSE_TAG_RE","html","$7368e0b262b21347$export$6db61d2c3a16e419","$7368e0b262b21347$export$cd48660d06f74639","$7368e0b262b21347$var$open_tag","$7368e0b262b21347$var$HTML_TAG_RE","$7368e0b262b21347$var$HTML_OPEN_CLOSE_TAG_RE","tmp","$ad115d1a39b04ebf$require$isSpace","skipSpacesBack","skipCharsBack","$90c6e52ebac51cee$var$StateBlock","s","indent_found","ddIndent","$90c6e52ebac51cee$require$isSpace","from","begin","end","keepLastLF","lineIndent","first","queue","lineStart","$18cf8b73eda3acda$var$_rules","$18cf8b73eda3acda$var$_rules2","postProcess","$18cf8b73eda3acda$var$ParserInline","pending","pushPending","$94eb40c2085875fe$var$isTerminatorChar","pmax","ws","$8427b05eaa079b1d$require$isSpace","$e1eb5f5cb429e171$var$ESCAPED","$e1eb5f5cb429e171$var$i","$e1eb5f5cb429e171$require$isSpace","matchStart","matchEnd","openerLength","closerLength","backticksScanned","backticks","$cf9972248a1c25d3$export$660b2ee2d4fb4eff","$cf9972248a1c25d3$export$7b804a0e0ce836d9","$cf9972248a1c25d3$var$postProcess","delimiters","startDelim","endDelim","loneMarkers","scanned","scanDelims","open","can_open","close","can_close","curr","tokens_meta","$3821dc0f7e96e10b$export$660b2ee2d4fb4eff","$3821dc0f7e96e10b$export$7b804a0e0ce836d9","$3821dc0f7e96e10b$var$postProcess","isStrong","labelStart","ref","parseReference","parseLinkLabel","$fafe1938d82caad2$require$isSpace","$fafe1938d82caad2$require$normalizeReference","$591e26c6b25e6f76$require$isSpace","$591e26c6b25e6f76$require$normalizeReference","$7863fda1a69fe7ce$var$EMAIL_RE","$7863fda1a69fe7ce$var$AUTOLINK_RE","HTML_TAG_RE","lc","$edb64e4a3aa7aacc$var$isLetter","$edb64e4a3aa7aacc$require$HTML_TAG_RE","has","isValidEntityCode","fromCodePoint","$df3678410b0d454d$var$DIGITAL_RE","$df3678410b0d454d$var$NAMED_RE","$df3678410b0d454d$require$isValidEntityCode","$df3678410b0d454d$require$fromCodePoint","$df3678410b0d454d$require$has","$3d4e473e601a693b$var$processDelimiters","closerIdx","openerIdx","closer","opener","minOpenerIdx","newMinOpenerIdx","isOddMatch","lastJump","openersBottom","headerIdx","lastTokenIdx","jumps","$669f5b69f8afcff0$var$StateInline","pendingLevel","_prev_delimiters","token_meta","canSplitWord","count","left_flanking","right_flanking","$669f5b69f8afcff0$require$isMdAsciiPunct","$669f5b69f8afcff0$require$isPunctChar","$669f5b69f8afcff0$require$isWhiteSpace","$fd4c3165214a66f4$var$assign","$fd4c3165214a66f4$var$_class","$fd4c3165214a66f4$var$isFunction","$fd4c3165214a66f4$var$escapeRE","$fd4c3165214a66f4$var$defaultOptions","fuzzyLink","fuzzyEmail","fuzzyIP","$fd4c3165214a66f4$var$defaultSchemas","validate","tail","re","src_auth","src_host_port_strict","src_path","no_http","src_domain","src_domain_root","src_port","src_host_terminator","mailto","src_email_name","src_host_strict","$fd4c3165214a66f4$var$tlds_default","$fd4c3165214a66f4$var$compile","__opts__","tlds","__tlds__","untpl","tpl","src_tlds","onCompile","__tlds_replaced__","src_xn","email_fuzzy","tpl_email_fuzzy","link_fuzzy","tpl_link_fuzzy","link_no_ip_fuzzy","tpl_link_no_ip_fuzzy","host_fuzzy_test","tpl_host_fuzzy_test","aliases","schemaError","val","__compiled__","__schemas__","compiled","link","$fd4c3165214a66f4$var$isRegExp","$fd4c3165214a66f4$var$createValidator","normalize","$fd4c3165214a66f4$var$isString","alias","slist","schema_test","src_ZPCc","schema_search","__index__","__text_cache__","$fd4c3165214a66f4$var$resetScanCache","$fd4c3165214a66f4$var$Match","__last_index__","__schema__","raw","$fd4c3165214a66f4$var$createMatch","$fd4c3165214a66f4$var$LinkifyIt","schemas","reduce","acc","add","definition","m","ml","me","next","tld_pos","testSchemaAt","keepOld","sort","el","reverse","opts","src_Any","src_Cc","src_Z","src_P","src_ZCc","src_pseudo_letter","src_ip4","src_host","tpl_host_fuzzy","tpl_host_no_ip_fuzzy","tpl_host_fuzzy_strict","tpl_host_port_fuzzy_strict","tpl_host_port_no_ip_fuzzy_strict","$529352d67bf562a7$var$maxInt","$529352d67bf562a7$var$base","$529352d67bf562a7$var$regexPunycode","$529352d67bf562a7$var$regexNonASCII","$529352d67bf562a7$var$regexSeparators","$529352d67bf562a7$var$errors","overflow","$529352d67bf562a7$var$floor","floor","$529352d67bf562a7$var$stringFromCharCode","$529352d67bf562a7$var$error","RangeError","$529352d67bf562a7$var$mapDomain","parts","encoded","array","$529352d67bf562a7$var$map","$529352d67bf562a7$export$c1700176c90f250f","output","counter","extra","$529352d67bf562a7$var$digitToBasic","digit","flag","$529352d67bf562a7$var$adapt","delta","numPoints","firstTime","$529352d67bf562a7$var$baseMinusTMin","$529352d67bf562a7$export$2f872c0f2117be69","input","inputLength","n","bias","basic","oldi","w","codePoint","baseMinusT","out","$529352d67bf562a7$export$c564cdbbe6da493","currentValue","basicLength","handledCPCount","handledCPCountPlusOne","currentValue1","q","qMinusT","$529352d67bf562a7$export$110c810e8727e62b","$529352d67bf562a7$export$69111c4ea6e0c4a0","constructor","find","get","undefined","update","newKey","remove","addToStart","addToEnd","addBefore","place","without","f","prepend","size","subtract","append","prop","$b82f7f8c6321b7f3$export$2e2bcd8739ae039","$6ab8e3fe6964f4b8$var$findDiffStart","a","b","let","childCount","childA","child","childB","sameMarkup","isText","inner","nodeSize","$6ab8e3fe6964f4b8$var$findDiffEnd","posA","posB","iA","iB","same","minSize","$6ab8e3fe6964f4b8$export$ffb0004e005737fa","$6ab8e3fe6964f4b8$var$prototypeAccessors","firstChild","configurable","lastChild","nodesBetween","to","nodeStart","parent","descendants","textBetween","blockSeparator","leafText","separated","node","isLeaf","isBlock","other","withText","cut","cutByIndex","empty","replaceChild","copy","eq","maybeChild","findDiffStart","findDiffEnd","otherPos","findIndex","round","$6ab8e3fe6964f4b8$var$retIndex","curPos","toStringInner","toJSON","fromJSON","nodeFromJSON","fromArray","joined","defineProperties","const","$6ab8e3fe6964f4b8$var$found","$6ab8e3fe6964f4b8$var$compareDeep","$6ab8e3fe6964f4b8$export$c9d15bcfc6d42044","$6ab8e3fe6964f4b8$export$6de0e778727af3f2","message","err","__proto__","addToSet","placed","excludes","rank","removeFromSet","isInSet","_","json","marks","create","sameSet","setFrom","none","$6ab8e3fe6964f4b8$export$b3f2e2de3a8baa1e","openStart","openEnd","$6ab8e3fe6964f4b8$var$prototypeAccessors$1","$6ab8e3fe6964f4b8$var$removeRange","ref$1","indexTo","offsetTo","$6ab8e3fe6964f4b8$var$insertInto","dist","insert","canReplace","$6ab8e3fe6964f4b8$var$replace","$from","$to","depth","$6ab8e3fe6964f4b8$var$replaceOuter","$along","resolveNoCache","$6ab8e3fe6964f4b8$var$prepareSliceForReplace","$6ab8e3fe6964f4b8$var$close","$6ab8e3fe6964f4b8$var$replaceThreeWay","parentOffset","$6ab8e3fe6964f4b8$var$replaceTwoWay","$6ab8e3fe6964f4b8$var$checkJoin","main","sub","compatibleContent","$6ab8e3fe6964f4b8$var$joinable","$before","$after","$6ab8e3fe6964f4b8$var$addNode","target","$6ab8e3fe6964f4b8$var$addRange","$start","$end","startIndex","endIndex","textOffset","nodeAfter","nodeBefore","validContent","prototypeAccessors","insertAt","fragment","removeBetween","maxOpen","openIsolating","spec","isolating","$6ab8e3fe6964f4b8$export$b2a42f82e59e4b19","path","$6ab8e3fe6964f4b8$var$prototypeAccessors$2","doc","resolveDepth","indexAfter","dOff","posAtIndex","inclusive","marksAcross","isInline","sharedDepth","blockRange","pred","d","inlineContent","$6ab8e3fe6964f4b8$export$7bc461ceb770fb16","sameParent","resolve","rem","resolveCached","$6ab8e3fe6964f4b8$var$resolveCache","cached","$6ab8e3fe6964f4b8$var$resolveCachePos","$6ab8e3fe6964f4b8$var$resolveCacheSize","$6ab8e3fe6964f4b8$var$prototypeAccessors$1$1","prototypeAccessors$1","$6ab8e3fe6964f4b8$var$emptyAttrs","$6ab8e3fe6964f4b8$export$85c928794f8d04d4","$6ab8e3fe6964f4b8$var$prototypeAccessors$3","textContent","isTextblock","isAtom","startPos","hasMarkup","defaultAttrs","mark","includeParents","nodeAt","childAfter","childBefore","rangeHasMark","toDebugString","$6ab8e3fe6964f4b8$var$wrapMarks","contentMatchAt","contentMatch","matchFragment","replacement","one","two","validEnd","allowsMarks","canReplaceWith","matchType","canAppend","check","markFromJSON","nodeType","$6ab8e3fe6964f4b8$var$TextNode","TextNode","super","stringify","base","$6ab8e3fe6964f4b8$export$364ed450558d7ec4","wrapCache","$6ab8e3fe6964f4b8$var$prototypeAccessors$4","defaultType","edgeCount","nodeTypes","stream","$6ab8e3fe6964f4b8$var$TokenStream","expr","$6ab8e3fe6964f4b8$var$parseExpr","nfa","labeled","explore","$6ab8e3fe6964f4b8$var$nullFrom","states","node2","term","known","$6ab8e3fe6964f4b8$var$cmp","$6ab8e3fe6964f4b8$var$dfa","expr1","connect","compile","edge1","edge","edges","expr2","exprs","loop","cur","$6ab8e3fe6964f4b8$var$nfa","work","dead","hasRequiredAttrs","$6ab8e3fe6964f4b8$var$checkForDeadEnds","frag","compatible","fillBefore","toEnd","seen","types","finished","tp","createAndFill","findWrapping","computed","computeWrapping","active","via","scan","$6ab8e3fe6964f4b8$var$prototypeAccessors$1$2","$6ab8e3fe6964f4b8$var$parseExprSeq","eat","$6ab8e3fe6964f4b8$var$parseExprSubscript","typeName","groups","$6ab8e3fe6964f4b8$var$resolveName","$6ab8e3fe6964f4b8$var$parseExprAtom","$6ab8e3fe6964f4b8$var$parseExprRange","$6ab8e3fe6964f4b8$var$parseNum","node1","$6ab8e3fe6964f4b8$var$defaultAttrs","defaults","attrName","attr","hasDefault","$6ab8e3fe6964f4b8$var$computeAttrs","built","given","$6ab8e3fe6964f4b8$var$initAttrs","$6ab8e3fe6964f4b8$var$Attribute","SyntaxError","$6ab8e3fe6964f4b8$export$f06e977173f1857c","group","markSet","$6ab8e3fe6964f4b8$var$prototypeAccessors$5","whitespace","atom","isRequired","computeAttrs","createChecked","allowsMarkType","markType","allowedMarks","topType","topNode","$6ab8e3fe6964f4b8$var$prototypeAccessors$1$3","$6ab8e3fe6964f4b8$export$b6a78689043c6521","excluded","instance","$6ab8e3fe6964f4b8$export$19342e026b58ebb7","contentExprCache","contentExpr","markExpr","$6ab8e3fe6964f4b8$var$gatherMarks","excl","bind","topNodeType","wrappings","$6ab8e3fe6964f4b8$export$1059c6e7d2ce5669","tags","styles","style","normalizeLists","some","dom","context","$6ab8e3fe6964f4b8$var$ParseContext","addAll","finish","parseSlice","matchTag","$6ab8e3fe6964f4b8$var$matches","namespace","namespaceURI","matchesContext","getAttrs","matchStyle","schemaRules","priority","parseDOM","$6ab8e3fe6964f4b8$var$copy","name1","fromSchema","domParser","$6ab8e3fe6964f4b8$var$blockTags","address","article","aside","blockquote","canvas","dd","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","noscript","ol","pre","section","table","tfoot","ul","$6ab8e3fe6964f4b8$var$ignoreTags","head","script","$6ab8e3fe6964f4b8$var$listTags","$6ab8e3fe6964f4b8$var$wsOptionsFor","preserveWhitespace","$6ab8e3fe6964f4b8$var$OPT_PRESERVE_WS","$6ab8e3fe6964f4b8$var$NodeContext","pendingMarks","solid","activeMarks","stashMarks","fill","wrap","popFromStashMark","applyPending","nextType","$6ab8e3fe6964f4b8$var$markMayApply","inlineContext","parentNode","nodeName","parser","isOpen","topContext","topOptions","topMatch","findPositions","needsBlock","$6ab8e3fe6964f4b8$var$prototypeAccessors$6","top","currentPos","selector","matches","msMatchesSelector","webkitMatchesSelector","mozMatchesSelector","v","name2","addDOM","addTextNode","getAttribute","readStyles","$6ab8e3fe6964f4b8$var$parseStyles","addPendingMark","addElement","removePendingMark","nodeValue","domNodeBefore","previousSibling","insertNode","findInText","findInside","matchAfter","ruleID","prevItem","nextSibling","appendChild","$6ab8e3fe6964f4b8$var$normalizeList","ruleFromNode","ignore","ignoreFallback","skip","closeParent","sync","oldNeedsBlock","leafFallback","addElementByRule","consuming","ownerDocument","createTextNode","findPlace","continueAfter","enter","startIn","getContent","contentDOM","contentElement","querySelector","findAround","childNodes","findAtPoint","route","cx","enterInner","textblockFromContext","closeExtra","preserveWS","topOpen","contains","compareDocumentPosition","textNode","option","useRoot","minDepth","$context","deflt","$6ab8e3fe6964f4b8$var$findSameMarkInSet","upto","stashMark","$6ab8e3fe6964f4b8$export$3476b78f8f5a8b72","$6ab8e3fe6964f4b8$var$gatherToDOM","toDOM","$6ab8e3fe6964f4b8$var$doc","document","window","serializeFragment","createDocumentFragment","keep","rendered","spanning","markDOM","serializeMark","serializeNodeInner","renderSpec","onContent","serializeNode","structure","xmlNS","tagName","space","createElementNS","createElement","setAttributeNS","setAttribute","innerContent","domSerializer","nodesFromSchema","marksFromSchema","$9c0bd8193fa770bb$var$factor16","pow","$9c0bd8193fa770bb$var$recoverIndex","$9c0bd8193fa770bb$export$c77c9be41668e9b4","deleted","recover","$9c0bd8193fa770bb$export$c53d01c3ab9721b3","ranges","inverted","diff","$9c0bd8193fa770bb$var$recoverOffset","mapResult","assoc","_map","simple","oldIndex","newIndex","oldSize","newSize","touches","oldStart","newStart","invert","$9c0bd8193fa770bb$export$f5f785078011b62","maps","mirror","$9c0bd8193fa770bb$export$88cc3a1dfce48dd3","appendMap","mirrors","setMirror","appendMapping","mapping","startSize","mirr","getMirror","appendMappingInverted","totalSize","inverse","corr","$9c0bd8193fa770bb$export$563a914cafbdc389","steps","docs","$9c0bd8193fa770bb$var$prototypeAccessors","docChanged","$9c0bd8193fa770bb$var$mustOverride","step","maybeStep","failed","addStep","getMap","$9c0bd8193fa770bb$var$stepsByID","$9c0bd8193fa770bb$export$fd55ce593607084a","_doc","_mapping","merge","_other","stepType","jsonID","id","stepClass","$9c0bd8193fa770bb$export$8ebf1578a4199c09","fail","fromReplace","e","$9c0bd8193fa770bb$export$5c860b2e74034756","$9c0bd8193fa770bb$var$contentBetween","$9c0bd8193fa770bb$export$444ba800d6024a98","gapFrom","gapTo","gap","inserted","$9c0bd8193fa770bb$var$canCut","$9c0bd8193fa770bb$export$f1508b72cc76a09e","range","$9c0bd8193fa770bb$export$118cb9a83e81ba37","innerRange","around","outer","$9c0bd8193fa770bb$var$findWrappingOutside","inside","innerMatch","$9c0bd8193fa770bb$var$findWrappingInside","$9c0bd8193fa770bb$var$withAttrs","$9c0bd8193fa770bb$export$5aaf008897aef029","typesAfter","$pos","innerType","baseType","$9c0bd8193fa770bb$export$f15f89fd9d8cc98a","$9c0bd8193fa770bb$var$joinable","$9c0bd8193fa770bb$export$41b1d4cb5ceb3147","dir","$9c0bd8193fa770bb$export$2819d598d048fc9c","pass","insertPos","$9c0bd8193fa770bb$var$mapFragment","mapped","lift","gapStart","gapEnd","splitting","wrappers","setBlockType","mapFrom","$9c0bd8193fa770bb$var$canChangeType","clearIncompatible","startM","endM","setNodeMarkup","newNode","replaceWith","typeAfter","$9c0bd8193fa770bb$export$d24ba56b0e3464a9","oldSlice","parent1","$9c0bd8193fa770bb$export$94150db1311f67a9","$9c0bd8193fa770bb$var$fitsTrivially","addMark","removed","added","removing","adding","newSet","removeMark","matched","toRemove","delSteps","allowed","$9c0bd8193fa770bb$var$Fitter","fit","$9c0bd8193fa770bb$export$ed6ac67359824afd","delete","unplaced","frontier","$9c0bd8193fa770bb$var$prototypeAccessors$1","$9c0bd8193fa770bb$var$dropFromFragment","$9c0bd8193fa770bb$var$addToFragment","$9c0bd8193fa770bb$var$contentAt","$9c0bd8193fa770bb$var$closeNodeStart","$9c0bd8193fa770bb$var$contentAfterFits","$9c0bd8193fa770bb$var$invalidMarks","$9c0bd8193fa770bb$var$closeFragment","oldOpen","newOpen","$9c0bd8193fa770bb$var$coveredDepths","findFittable","placeNodes","openMore","dropNode","moveInline","mustMoveInline","placedSize","sliceDepth","frontierDepth","inject","openAtEnd","closeFrontierNode","openFrontierNode","taken","openEndCount","findCloseLevel","dropInner","match$1","move","replaceRange","deleteRange","targetDepths","preferredTarget","defining","preferredTargetIndex","leftNodes","preferredDepth","openDepth","targetDepth","expand","startSteps","replaceRangeWith","point","$9c0bd8193fa770bb$export$64cb316d02de1dd1","covered","$bd6418fbd98bcc23$var$classesById","$bd6418fbd98bcc23$export$52baac22726c72bf","$anchor","$head","$bd6418fbd98bcc23$export$7bd1839c3c5d5bd4","$bd6418fbd98bcc23$var$prototypeAccessors","anchor","tr","lastNode","lastParent","$bd6418fbd98bcc23$var$selectionToInsertionEnd","findFrom","textOnly","$bd6418fbd98bcc23$export$c2b25f346d19bcbb","$bd6418fbd98bcc23$var$findSelectionIn","near","$bd6418fbd98bcc23$export$c15d9ba76bdbcd95","atStart","atEnd","cls","selectionClass","getBookmark","between","visible","$cursor","ensureMarks","$bd6418fbd98bcc23$var$TextBookmark","dPos","$bd6418fbd98bcc23$export$e2940151ac854c0b","$bd6418fbd98bcc23$var$NodeBookmark","isSelectable","selectable","sel","selection","setSelection","$bd6418fbd98bcc23$var$AllBookmark","startLen","_from","_to","_newFrom","newTo","$bd6418fbd98bcc23$export$febc5573c75cefb0","Transform","time","Date","now","curSelection","curSelectionFor","storedMarks","updated","selectionSet","storedMarksSet","isGeneric","scrolledIntoView","setStoredMarks","addStoredMark","removeStoredMark","setTime","replaceSelection","replaceSelectionWith","inheritMarks","deleteSelection","insertText","setMeta","getMeta","scrollIntoView","$bd6418fbd98bcc23$var$bind","$bd6418fbd98bcc23$var$FieldDesc","desc","init","$bd6418fbd98bcc23$var$baseFields","config","_marks","_old","prev","$bd6418fbd98bcc23$var$Configuration","plugins","fields","pluginsByKey","$bd6418fbd98bcc23$export$afa855cbfaff27f2","$bd6418fbd98bcc23$var$prototypeAccessors$1","applyTransaction","filterTransaction","rootTr","transactions","trs","newState","applyInner","haveNew","appendTransaction","oldState","newInstance","field","$bd6418fbd98bcc23$var$applyListeners","$config","reconfigure","pluginFields","addApplyListener","removeApplyListener","$bd6418fbd98bcc23$var$bindProps","Function","$bd6418fbd98bcc23$export$901cf72dabf2112a","props","$bd6418fbd98bcc23$var$createKey","getState","$bd6418fbd98bcc23$var$keys","$bd6418fbd98bcc23$export$1692d8b0e89cecc3","$1917b436a314f564$var$result","navigator","$1917b436a314f564$var$ie_edge","userAgent","$1917b436a314f564$var$ie_upto10","$1917b436a314f564$var$ie_11up","$1917b436a314f564$var$ie","ie","ie_version","documentMode","gecko","gecko_version","$1917b436a314f564$var$chrome","chrome","chrome_version","safari","vendor","ios","maxTouchPoints","mac","platform","android","webkit","documentElement","webkit_version","$1917b436a314f564$var$domIndex","$1917b436a314f564$var$parentNode","assignedSlot","$1917b436a314f564$var$reusedRange","$1917b436a314f564$var$textRange","createRange","setEnd","setStart","$1917b436a314f564$var$isEquivalentPosition","off","targetNode","targetOff","$1917b436a314f564$var$scanFor","$1917b436a314f564$var$atomElements","$1917b436a314f564$var$nodeSize","$1917b436a314f564$var$hasBlockDesc","contentEditable","pmViewDesc","$1917b436a314f564$var$selectionCollapsed","domSel","collapsed","isCollapsed","browser","rangeCount","getRangeAt","$1917b436a314f564$var$keyEvent","keyCode","event","createEvent","initEvent","$1917b436a314f564$var$windowRect","left","right","clientWidth","bottom","clientHeight","$1917b436a314f564$var$getSide","side","$1917b436a314f564$var$clientRect","rect","getBoundingClientRect","scaleX","width","offsetWidth","scaleY","height","offsetHeight","$1917b436a314f564$var$scrollRectIntoView","view","startDOM","scrollThreshold","someProp","scrollMargin","atTop","body","bounding","moveX","moveY","defaultView","scrollBy","startX","scrollLeft","startY","scrollTop","dX","dY","$1917b436a314f564$var$scrollStack","$1917b436a314f564$var$restoreScrollStack","dTop","$1917b436a314f564$var$preventScrollSupported","$1917b436a314f564$var$findOffsetInNode","coords","closest","coordsClosest","dxClosest","rowBot","rowTop","childIndex","rects","getClientRects","dx","$1917b436a314f564$var$singleRect","$1917b436a314f564$var$inRect","$1917b436a314f564$var$findOffsetInText","$1917b436a314f564$var$elementFromPoint","element","box","startI","$1917b436a314f564$var$posAtCoords","caretPositionFromPoint","offsetNode","caretRangeFromPoint","assign$1","startContainer","startOffset","elt","root","elementFromPoint","draggable","$1917b436a314f564$var$targetKludge","outside","docView","nearestDesc","posBefore","posAfter","posFromDOM","$1917b436a314f564$var$posFromCaret","$1917b436a314f564$var$posFromElement","posAtStart","border","$1917b436a314f564$var$BIDI","$1917b436a314f564$var$coordsAtPos","domFromPos","supportEmptyRange","takeSide","$1917b436a314f564$var$flattenV","rectBefore","rectAfter","$1917b436a314f564$var$flattenH","ignoreForCoords","x","y","$1917b436a314f564$var$withFlushedState","viewState","activeElement","updateState","focus","$1917b436a314f564$var$maybeRTL","$1917b436a314f564$var$cachedState","$1917b436a314f564$var$cachedDir","$1917b436a314f564$var$cachedResult","$1917b436a314f564$var$endOfTextblock","nearest","boxes","$1917b436a314f564$var$endOfTextblockVertical","getSelection","modify","oldRange","oldNode","focusNode","oldOff","focusOffset","oldBidiLevel","caretBidiLevel","domAfterPos","removeAllRanges","addRange","$1917b436a314f564$var$endOfTextblockHorizontal","$1917b436a314f564$var$ViewDesc","dirty","$1917b436a314f564$var$prototypeAccessors","posAtEnd","contentLost","domAtom","matchesWidget","matchesMark","matchesNode","matchesHack","_nodeName","parseRule","stopEvent","destroy","posBeforeChild","localPosFromDOM","domBefore","domAfter","onlyNodes","getDesc","nodeDOM","descAt","$1917b436a314f564$var$TrailingHackViewDesc","$1917b436a314f564$var$WidgetViewDesc","widget","parseRange","fromOffset","toOffset","childBase","emptyChildAt","force","anchorDOM","headDOM","brKludge","offset$1","anchorNode","anchorOffset","domSelExtended","extend","collapse","DOMException","ignoreMutation","mutation","markDirty","startInside","endInside","markParentsDirty","$1917b436a314f564$var$nothing","ViewDesc","WidgetViewDesc","classList","stop","ignoreSelection","$1917b436a314f564$var$CompositionViewDesc","CompositionViewDesc","textDOM","prototypeAccessors$2","mut","oldValue","$1917b436a314f564$var$MarkViewDesc","MarkViewDesc","custom","nodeViews","reparseInView","$1917b436a314f564$var$replaceNodes","$1917b436a314f564$var$NodeViewDesc","NodeViewDesc","outerDeco","innerDeco","updateChildren","prototypeAccessors$3","descObj","hasAttribute","$1917b436a314f564$var$applyOuterDeco","$1917b436a314f564$var$CustomNodeViewDesc","$1917b436a314f564$var$TextViewDesc","$1917b436a314f564$var$sameOuterDeco","composition","composing","localCompositionInfo","localComposition","compositionInChild","updater","$1917b436a314f564$var$ViewTreeUpdater","deco","onWidget","onNode","locals","forChild","decoIndex","restNode","parentIndex","widgets","$1917b436a314f564$var$compareSide","cutAt","$1917b436a314f564$var$iterDeco","insideNode","syncToMarks","placeWidget","compIndex","findNodeMatch","findIndexWithChild","updateNodeAt","updateNextNode","addNode","addTextblockHacks","destroyRest","changed","protectLocalComposition","$1917b436a314f564$var$renderDescs","oldCSS","cssText","getComputedStyle","listStyle","$1917b436a314f564$var$iosHacks","$1917b436a314f564$var$nearbyTextNode","textPos","childStart","$1917b436a314f564$var$findTextInFragment","removeChild","compositionNodes","updateInner","updateOuterDeco","needsWrap","oldDOM","$1917b436a314f564$var$patchOuterDeco","$1917b436a314f564$var$computeOuterDeco","selectNode","deselectNode","removeAttribute","$1917b436a314f564$var$docViewDesc","TextViewDesc","prototypeAccessors$4","pmIsDeco","inParent","trackWrites","parentDOM","TrailingHackViewDesc","prototypeAccessors$5","CustomNodeViewDesc","descs","written","childDOM","$1917b436a314f564$var$rm","insertBefore","$1917b436a314f564$var$OuterDecoLevel","$1917b436a314f564$var$noDeco","class","outerDOM","prevComputed","curComputed","curDOM","$1917b436a314f564$var$patchAttributes","prevList","Boolean","curList","removeProperty","lockedNode","lock","preMatch","parentDesc","curDesc","descI","fI","Map","$1917b436a314f564$var$preMatch","$1917b436a314f564$var$selectionFromDOM","origin","inWidget","$1917b436a314f564$var$isOnEdge","$1917b436a314f564$var$selectionBetween","$1917b436a314f564$var$editorOwnsSelection","editable","hasFocus","$1917b436a314f564$var$hasSelection","$1917b436a314f564$var$selectionToDOM","$1917b436a314f564$var$syncNodeSelection","mouseDown","allowDefault","curSel","domObserver","currentSelection","delayedSelectionSync","setCurSelection","disconnectSelection","cursorWrapper","img","disabled","$1917b436a314f564$var$selectCursorWrapper","resetEditableFrom","resetEditableTo","$1917b436a314f564$var$brokenSelectBetweenUneditable","$1917b436a314f564$var$temporarilyEditableNear","$1917b436a314f564$var$resetEditable","removeEventListener","hideSelectionGuard","addEventListener","setTimeout","$1917b436a314f564$var$removeClassOnSelectionChange","connectSelection","destroyBetween","maxKeep","markDesc","targetDesc","domNode","nextDOM","addHackNode","className","$1917b436a314f564$var$setEditable","wasDraggable","lastSelectedViewDesc","$1917b436a314f564$var$clearNodeSelection","$1917b436a314f564$var$moveSelectionBlock","$side","$1917b436a314f564$var$apply","dispatch","$1917b436a314f564$var$selectHorizontally","mods","endOfTextblock","nodePos","$1917b436a314f564$var$nodeLen","$1917b436a314f564$var$isIgnorable","$1917b436a314f564$var$skipIgnoredNodesLeft","moveNode","moveOffset","$1917b436a314f564$var$isBlockNode","$1917b436a314f564$var$setSelFocus","$1917b436a314f564$var$skipIgnoredNodesRight","$1917b436a314f564$var$selectVertically","beyond","$1917b436a314f564$var$stopNativeHorizontalDelete","nextNode","$1917b436a314f564$var$switchEditable","$1917b436a314f564$var$captureKeyDown","ctrlKey","metaKey","altKey","shiftKey","$1917b436a314f564$var$getMods","$1917b436a314f564$var$safariDownArrowBug","$1917b436a314f564$var$ruleFromNode","$1917b436a314f564$var$readDOMChange","typeOver","addedNodes","lastSelectionTime","lastSelectionOrigin","newSel","shared","from_","to_","lastKeyCode","startDoc","editableContent","$1917b436a314f564$var$parseBetween","preferredPos","preferredSide","compare","lastKeyCodeTime","change","endA","endB","$1917b436a314f564$var$findDiff","lastIOSEnter","$1917b436a314f564$var$resolveSelection","domChangeCount","nextSel","inlineChange","old","$newStart","$newEnd","$1917b436a314f564$var$skipClosingAndOpening","$next","$1917b436a314f564$var$looksLikeJoin","suppressSelectionUpdates","toB","lastAndroidDelete","markChange","$from1","chFrom","chTo","curMarks","prevMarks","$1917b436a314f564$var$isMarkChange","parsedSel","fromEnd","mayOpen","$1917b436a314f564$export$38b79e3fdcfcfd68","serializer","$1917b436a314f564$var$detachedDoc","$1917b436a314f564$var$wrapMap","wrapper","$1917b436a314f564$export$5d42ca91c11c9e4d","plainText","dom1","inCode","asText","metas","firstTag","innerHTML","$1917b436a314f564$var$readHTML","querySelectorAll","$1917b436a314f564$var$restoreReplacedSpaces","contextNode","sliceData","$1917b436a314f564$var$inlineParents","$1917b436a314f564$var$addContext","$1917b436a314f564$var$closeSlice","lastWrap","inLast","$1917b436a314f564$var$addToSibling","$1917b436a314f564$var$closeRight","wrapped","$1917b436a314f564$var$withWrappers","d1","$1917b436a314f564$var$normalizeSiblings","sibling","$1917b436a314f564$var$closeRange","thead","tbody","caption","colgroup","col","td","th","$1917b436a314f564$var$_detachedDoc","implementation","createHTMLDocument","$1917b436a314f564$var$observeOptions","childList","characterData","characterDataOldValue","attributes","attributeOldValue","subtree","$1917b436a314f564$var$useCharData","$1917b436a314f564$var$SelectionState","$1917b436a314f564$var$DOMObserver","handleDOMChange","flushingSoon","observer","MutationObserver","mutations","removedNodes","flushSoon","flush","onCharData","prevValue","onSelectionChange","suppressingSelectionUpdates","forceFlush","clearTimeout","observe","take","takeRecords","disconnect","ignoreSelectionChange","container","commonAncestorContainer","registerMutation","brs","$1917b436a314f564$var$cssChecked","whiteSpace","console","$1917b436a314f564$var$checkCSS","attributeName","$1917b436a314f564$var$handlers","$1917b436a314f564$var$editHandlers","$1917b436a314f564$var$setSelectionOrigin","$1917b436a314f564$var$ensureListeners","currentHandlers","eventHandlers","$1917b436a314f564$var$runCustomHandler","handlers","handler","defaultPrevented","$1917b436a314f564$var$eventCoords","clientX","clientY","$1917b436a314f564$var$runHandlerOnContext","propName","i1","$1917b436a314f564$var$updateSelection","focused","$1917b436a314f564$var$handleSingleClick","selectedNode","selectAt","$1917b436a314f564$var$selectClickedNode","$1917b436a314f564$var$selectClickedLeaf","$1917b436a314f564$var$handleDoubleClick","$1917b436a314f564$var$handleTripleClick","button","$1917b436a314f564$var$defaultTripleClick","$1917b436a314f564$var$forceDOMFlush","$1917b436a314f564$export$76b14d3c719c32fc","keydown","$1917b436a314f564$var$inOrNearComposition","preventDefault","lastIOSEnterFallbackTimeout","keyup","keypress","charCode","$1917b436a314f564$var$selectNodeModifier","mousedown","flushed","lastClick","click","dy","$1917b436a314f564$var$isNear","posAtCoords","done","$1917b436a314f564$var$MouseDown","targetPos","mightDrag","addAttr","setUneditable","up","abs","timeStamp","compositionEndedAt","buttons","touchdown","contextmenu","$1917b436a314f564$var$timeoutComposition","$1917b436a314f564$var$scheduleComposeEnd","delay","composingTimeout","$1917b436a314f564$var$clearComposition","forceUpdate","compositionstart","compositionupdate","markCursor","compositionend","$1917b436a314f564$var$brokenClipboardAPI","$1917b436a314f564$var$doPaste","singleNode","$1917b436a314f564$var$sliceSingleNode","data","clipboardData","clearData","setData","selectNodeContents","blur","$1917b436a314f564$var$captureCopy","paste","getData","$1917b436a314f564$var$capturePaste","$1917b436a314f564$var$Dragging","$1917b436a314f564$var$dragCopyModifier","$1917b436a314f564$var$prop","dragstart","dataTransfer","effectAllowed","dragging","dragend","dragover","dragenter","drop","eventPos","$mouse","isNode","beforeInsert","relatedTarget","beforeinput","inputType","$1917b436a314f564$var$compareObjs","$1917b436a314f564$var$WidgetType","$1917b436a314f564$var$noSpec","span","oldOffset","$1917b436a314f564$export$10e30b733df217ea","valid","$1917b436a314f564$var$InlineType","inclusiveStart","inclusiveEnd","is","$1917b436a314f564$var$NodeType","$1917b436a314f564$var$prototypeAccessors$1","$1917b436a314f564$var$none","$1917b436a314f564$export$93bf62eb445cec98","local","decorations","$1917b436a314f564$var$buildTree","$1917b436a314f564$var$empty","predicate","findInner","childOff","mapInner","newLocal","onRemove","oldChildren","oldEnd","newEnd","dSize","i2","mustRebuild","fromLocal","toLocal","childOffset","childNode","oldOffset1","gather","i3","$1917b436a314f564$var$mapAndGatherRemainingDecorations","$1917b436a314f564$var$byPos","$1917b436a314f564$var$mapChildren","addInner","baseOffset","$1917b436a314f564$var$takeSpansForNode","$1917b436a314f564$var$moveSpans","$1917b436a314f564$var$withoutNulls","removeInner","dec","localSet","$1917b436a314f564$var$DecorationGroup","$1917b436a314f564$var$removeOverlap","localsInner","removeOverlap","members","spans","hasNulls","localStart","working","$1917b436a314f564$var$insertAhead","$1917b436a314f564$var$viewDecorations","mappedDecos","member","sorted","$1917b436a314f564$export$eece2fccabbb77c5","_props","directPlugins","$1917b436a314f564$var$checkStateComponent","_root","mount","mounted","$1917b436a314f564$var$getEditable","$1917b436a314f564$var$updateCursorWrapper","$1917b436a314f564$var$buildNodeViews","$1917b436a314f564$var$computeDocDeco","event2","bubbles","$1917b436a314f564$var$eventBelongsToView","event1","$1917b436a314f564$var$initInput","prevDirectPlugins","pluginViews","updatePluginViews","$1917b436a314f564$var$prototypeAccessors$2","isDestroyed","contenteditable","translate","handleDOMEvents","updateStateInner","setProps","reconfigured","redraw","updateSel","nA","nB","$1917b436a314f564$var$changedNodeViews","scroll","scrollToSelection","updateDoc","sel1","sel2","refDOM","refTop","newRefTop","oldScrollPos","overflowAnchor","innerHeight","localRect","$1917b436a314f564$var$storeScrollPos","forceSelUpdate","chromeKludge","coordsAtPos","destroyPluginViews","prevState","pluginView","setActive","stored","preventScroll","$1917b436a314f564$var$focusPreventScroll","getPrototypeOf","domAtPos","posAtDOM","$1917b436a314f564$var$destroyInput","dispatchEvent","$1917b436a314f564$var$dispatchEvent","dispatchTransaction","$68a347fc045093ef$exports","$a948bd695a9908e8$export$4902baddc787debb","paragraph","horizontal_rule","heading","ordered_list","order","bullet_list","list_item","hard_break","em","strong","$a948bd695a9908e8$var$MarkdownParseState","tokenHandlers","$a948bd695a9908e8$var$attrs","$a948bd695a9908e8$var$noCloseToken","noCloseToken","$a948bd695a9908e8$var$withoutTrailingNewline","$a948bd695a9908e8$var$noOp","addText","merged","$a948bd695a9908e8$var$maybeMerge","openMark","closeMark","parseTokens","toks","openNode","closeNode","$a948bd695a9908e8$export$a64f782182dea128","tokenizer","tokens1","type1","$a948bd695a9908e8$var$tokenHandlers","$a948bd695a9908e8$var$listIsTight","$a948bd695a9908e8$export$7517583227ad0cb8","$parcel$interopDefault","$a948bd695a9908e8$export$ae9f6f04acb6c60c","serialize","$a948bd695a9908e8$export$61055fa707e69319","renderContent","$a948bd695a9908e8$export$f996452ca6e9a0ae","wrapBlock","write","ensureNewLine","closeBlock","repeat","renderList","bullet","maxW","nStr","esc","mixable","expelEnclosingWhitespace","_state","$a948bd695a9908e8$var$isPlainURL","_mark","$a948bd695a9908e8$var$backticksFor","escape","ticks","delim","closed","inTightList","tightLists","flushClose","atBlank","delimMin","firstDelim","startOfLine","trailing","progress","leading","lead","inner$1","trail","noEsc","mark1","markString","isTight","prevTight","escapeExtraCharacters","quote","getEnclosingWhitespace","$4e6c8a35bd5a72fe$export$e2253033e6e1df16","$4e6c8a35bd5a72fe$export$fba63a578e423eb","$4e6c8a35bd5a72fe$var$chrome","$4e6c8a35bd5a72fe$var$safari","$4e6c8a35bd5a72fe$var$gecko","$4e6c8a35bd5a72fe$var$mac","$4e6c8a35bd5a72fe$var$ie","$4e6c8a35bd5a72fe$var$brokenModifierNames","$4e6c8a35bd5a72fe$var$i","$4e6c8a35bd5a72fe$var$code","$88b21d2a5b08e512$var$mac","$88b21d2a5b08e512$var$normalizeKeyName","ctrl","mod","$88b21d2a5b08e512$var$modifiers","$88b21d2a5b08e512$export$5043418e2ef368d5","bindings","handleKeyDown","$88b21d2a5b08e512$export$53f558754f8b9fd1","$88b21d2a5b08e512$var$normalize","baseName","$4e6c8a35bd5a72fe$export$fb33aafd75404f4c","isChar","direct","fromCode","withShift","$a661b3a35e314cb8$var$RopeSequence","leafAppend","leafPrepend","appendInner","$a661b3a35e314cb8$var$Append","sliceInner","getInner","forEachInner","forEachInvertedInner","values","$a661b3a35e314cb8$var$Leaf","RopeSequence","Leaf","flatten","Append","leftLen","$a661b3a35e314cb8$export$2e2bcd8739ae039","$32d882d682e66c64$var$Branch","items","eventCount","popEvent","preserveItems","remap","remapping","remaining","transform","addAfter","$32d882d682e66c64$var$Item","addTransform","histOptions","newItems","oldItems","lastItem","cutPoint","$32d882d682e66c64$var$DEPTH_OVERFLOW","mirrorPos","mirrorOffset","addMaps","rebased","rebasedTransform","rebasedCount","rebasedItems","newUntil","iRebased","newMaps","branch","emptyItemCount","compress","events","newItem","$32d882d682e66c64$export$95c891a1f5736881","undone","prevRanges","prevTime","$32d882d682e66c64$var$rangesFor","$32d882d682e66c64$var$mapRanges","$32d882d682e66c64$var$histTransaction","$32d882d682e66c64$export$55abd4691b317664","$32d882d682e66c64$export$1688e416fee0a49e","$32d882d682e66c64$var$mustPreserveItems","$32d882d682e66c64$var$historyKey","newHist","redo","historyState","$32d882d682e66c64$var$cachedPreserveItems","$32d882d682e66c64$var$cachedPreserveItemsPlugins","historyPreserveItems","$32d882d682e66c64$var$closeHistoryKey","newGroupDelay","hist","historyTr","appended","newGroup","adjacent","$32d882d682e66c64$var$isAdjacentTo","$32d882d682e66c64$var$applyTransaction","$32d882d682e66c64$export$21f930c44940fd98","$af0fa59999019c3f$export$e9a518a637d1e641","$af0fa59999019c3f$var$textblockAt","$af0fa59999019c3f$var$findCutBefore","$af0fa59999019c3f$var$findCutAfter","$af0fa59999019c3f$export$4bb15e6d4372b393","nodeSel","$af0fa59999019c3f$export$8dd967a262b064bb","$af0fa59999019c3f$export$590e8b2c435046d9","$af0fa59999019c3f$var$defaultBlockAt","$af0fa59999019c3f$export$634b78845598ff5b","above","$af0fa59999019c3f$export$e99155638ff4dff0","can","$af0fa59999019c3f$export$a37f6aaa9169911d","$af0fa59999019c3f$var$deleteBarrier","$cut","conn","$af0fa59999019c3f$var$joinMaybeClear","joinAt","selAfter","$af0fa59999019c3f$export$6e5e3c49755affd0","wrapping","$af0fa59999019c3f$export$36987f561c736aad","applicable","$af0fa59999019c3f$export$797ad2667b8015a8","$af0fa59999019c3f$var$markApplies","ref$2","$from$1","$to$1","$af0fa59999019c3f$export$146a774cdef7663a","commands","$af0fa59999019c3f$var$backspace","$af0fa59999019c3f$var$del","$af0fa59999019c3f$export$eb36e8971b04df36","Enter","Backspace","Delete","$af0fa59999019c3f$export$f292ad8dbd5063c8","$af0fa59999019c3f$var$key","$af0fa59999019c3f$export$4a0c2b85b1f0a889","os","$e9c32d0e4acc2548$export$b8e3092a3bfa2062","editorView","$e9c32d0e4acc2548$var$DropCursorView","color","cursorPos","timeout","updateOverlay","setCursor","nodeRect","offsetParent","parentRect","position","pageXOffset","pageYOffset","scheduleRemoval","dragleave","$b9da85012735b0b5$export$3d3d259665dcb4d4","Selection","$b9da85012735b0b5$var$GapBookmark","$b9da85012735b0b5$var$closedBefore","$b9da85012735b0b5$var$closedAfter","override","allowGapCursor","mustMove","$cur","$b9da85012735b0b5$var$handleKeyDown","ArrowLeft","$b9da85012735b0b5$var$arrow","ArrowRight","ArrowUp","ArrowDown","axis","dirStr","$found","$b9da85012735b0b5$var$handleClick","$b9da85012735b0b5$var$drawGapCursor","$9b347e6d1c598f1e$export$2e2bcd8739ae039","$9b347e6d1c598f1e$var$add","$4372b960828c1ae3$var$getIcon","icon","$4372b960828c1ae3$var$hashPath","getElementById","collection","$4372b960828c1ae3$var$prefix","display","sym","$4372b960828c1ae3$var$buildSVG","svg","location","cloneNode","css","$4372b960828c1ae3$export$2ce376c2cc3355c8","$4372b960828c1ae3$var$translate","prefix","run","select","selected","$4372b960828c1ae3$var$setClass","$4372b960828c1ae3$var$lastMenuEvent","$4372b960828c1ae3$var$markMenuEvent","$4372b960828c1ae3$var$isMenuEvent","$4372b960828c1ae3$export$931cbfb6bfb85fc","$4372b960828c1ae3$var$renderDropdownItems","updates","$4372b960828c1ae3$var$combineUpdates","something","listeningOnClose","menuDOM","$4372b960828c1ae3$export$ef5c18bf09e4884f","$4372b960828c1ae3$export$df03f54e09e486fa","selectParentNode","undo","bulletList","orderedList","$4372b960828c1ae3$export$11baffb4edd2ca7f","$4372b960828c1ae3$export$58f79fea701cb352","$4372b960828c1ae3$export$e7da091474561953","$4372b960828c1ae3$export$e59d9ce4b90da7a2","$4372b960828c1ae3$export$fdbfb7c42a1822a2","$4372b960828c1ae3$export$92aed8e2efb56f10","command","passedOptions","on","$4372b960828c1ae3$var$MenuBarView","menu","spacer","maxHeight","widthForMaxHeight","floating","separators","localUpdates","localNodes","update$1","needSep","hasContent","$4372b960828c1ae3$export$32280ef9552def7c","contentUpdate","agent","$4372b960828c1ae3$var$isIOS","updateFloat","potentialScrollers","$4372b960828c1ae3$var$getAllWrapping","scrollFunc","updateScrollCursor","minHeight","selRect","Node","DOCUMENT_POSITION_FOLLOWING","$4372b960828c1ae3$var$selectionIsInverted","menuRect","scrollable","scrollHeight","$4372b960828c1ae3$var$findWrappingScrollable","scrollAncestor","editorRect","$8a3a734c18a758a8$export$a8aef45c6262afee","listType","doJoin","outerRange","$insert","joinBefore","splitDepth","splitPos","$8a3a734c18a758a8$var$doWrapInList","$8a3a734c18a758a8$export$e74cd5adb935a538","itemType","endOfList","$8a3a734c18a758a8$var$liftToOuterList","indexBefore","$8a3a734c18a758a8$var$liftOutOfList","$f9abce06c509e708$export$9b55e2b000ad65f2","cutOff","$f9abce06c509e708$var$run","textBefore","$f9abce06c509e708$export$8b5652a4bcfffc13","undoable","isInputRules","toUndo","$f9abce06c509e708$export$d52f6fa9078fe05f","$f9abce06c509e708$export$a5b94313d6908893","$f9abce06c509e708$export$896039c3677cf296","$f9abce06c509e708$export$f7316d89abe4e1c1","regexp","joinPredicate","$f9abce06c509e708$export$cc081314d3f6ffb0","$b198ee2c6597928b$var$openPrompt","mouseOutside","domFields","submitButton","$b198ee2c6597928b$var$prefix","cancelButton","innerWidth","submit","read","bad","$b198ee2c6597928b$var$reportInvalid","clean","$b198ee2c6597928b$var$getValues","callback","elements","msg","offsetLeft","offsetTop","$b198ee2c6597928b$var$Field","validateType","_value","required","$b198ee2c6597928b$var$TextField","Field","TextField","placeholder","autocomplete","$b198ee2c6597928b$var$canInsert","$b198ee2c6597928b$var$cmdItem","cmd","$b198ee2c6597928b$var$markActive","$b198ee2c6597928b$var$markItem","$b198ee2c6597928b$var$wrapListItem","$b198ee2c6597928b$export$630b7735451169d5","toggleStrong","toggleEm","toggleCode","toggleLink","insertImage","attrs1","wrapBulletList","wrapOrderedList","wrapBlockQuote","$4372b960828c1ae3$export$8f5e79e4d0433569","makeParagraph","makeCodeBlock","insertHorizontalRule","insertMenu","typeMenu","makeHead1","makeHead2","makeHead3","makeHead4","makeHead5","makeHead6","inlineMenu","blockMenu","fullMenu","$b198ee2c6597928b$var$mac","$b198ee2c6597928b$export$d9ca128b11caeeaf","mapKeys","br","cmd1","grandParent","keepItem","nestedBefore","$8a3a734c18a758a8$export$dd505f850a3798a4","$b198ee2c6597928b$export$85d07b429441b866","$b198ee2c6597928b$var$orderedListRule","$b198ee2c6597928b$var$bulletListRule","$b198ee2c6597928b$var$codeBlockRule","maxLevel","$b198ee2c6597928b$var$headingRule","ref1","handleTextInput","$f9abce06c509e708$export$9bc12e8cb1b5422f","$b198ee2c6597928b$export$a24aa9c6e8fd0231","createSelectionBetween","_view","handleClick","menuBar","$4372b960828c1ae3$export$4bada28d90893e2d","floatingMenu","menuContent","history","$aa17119637129bd2$export$d5163f1ce1e6a5f9","textarea","$aa17119637129bd2$export$17ba2ff80b207066","$apGeW$utils","registerSargassoClass","$apGeW$Sargasso","elem","watchDOM","elementTools","uid","Event","srcElement","checked","View","sleep","DOMChanged"],"version":3,"file":"markdown.mjs.map"}